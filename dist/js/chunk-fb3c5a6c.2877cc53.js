(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fb3c5a6c"],{"4c28":function(e,t,a){},"53ca":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function n(e){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}},"71a1":function(e,t,a){},"7d85":function(e,t,a){"use strict";a("d068")},"890e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("ul",[a("li",[a("storeChoose",{staticStyle:{"margin-left":"-2px"},on:{changeMallList:e.changeMallList}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clearLog}},[e._v("清除日志")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setQurey}},[e._v("参数设置")]),a("el-checkbox",{staticStyle:{"margin-top":"5px","margin-left":"5px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")])],1),a("li",{staticClass:"row2"},[a("el-row",{attrs:{gutter:25}},[a("el-col",{attrs:{span:15}},[a("ul",[a("li",{staticStyle:{"align-items":"center","margin-bottom":"5px"}},[a("label",{staticStyle:{width:"128px"}},[e._v("店铺ID信息：")]),a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:e.mallIDinfo,callback:function(t){e.mallIDinfo=t},expression:"mallIDinfo"}}),a("div",[a("el-button",{staticStyle:{"margin-left":"10px","margin-bottom":"5px"},attrs:{type:"primary",size:"mini"},on:{click:e.addCancerMall}},[e._v("添加关注店铺")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clearMallIDinfo}},[e._v("清空店铺信息")])],1)],1),a("li",{staticStyle:{"margin-left":"80px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.startCancer}},[e._v("开始关注")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.stopSet}},[e._v("取消操作")])],1)])]),a("el-col",{attrs:{span:9}},[a("div",{staticClass:"grid-content bg-purple"}),a("ul",[a("li",[a("el-button",{staticStyle:{width:"105px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.Unfollower(1)}}},[e._v("开始取关")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.stopSet}},[e._v("取消操作")])],1),a("li",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.Unfollower(0)}}},[e._v("取关所有用户")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.canCerFollowUnFollowMe}},[e._v("取关未关注我的用户")])],1),a("li",{staticStyle:{height:"30px"}})])])],1)],1),a("li",{staticStyle:{color:"red"}},[e._v("温馨提示：关注用户或者取关啊用户后，获取到的关注用户量和粉丝量可能不准确，有缓存（shopee官网缓存），请稍后查看。")]),a("li",[a("el-table",{attrs:{"header-cell-style":{background:"#f7fafa"},data:e.tableList,"row-style":{height:"50px"},height:"calc(100vh - 220px)"}},[a("el-table-column",{attrs:{type:"index",label:"序列号","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"",label:"站点","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(e._f("chineseSite")(a.country)))]}}])}),a("el-table-column",{attrs:{prop:"",label:"店铺名","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.mall_alias_name||a.platform_mall_name))]}}])}),a("el-table-column",{attrs:{prop:"following",label:"关注中","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.following)?Number(a.following):"-"))]}}])}),a("el-table-column",{attrs:{prop:"fence",label:"粉丝","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.fence)?Number(a.fence):"-"))]}}])}),a("el-table-column",{attrs:{prop:"newFollow",label:"新增关注数量","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.newFollow)?Number(a.newFollow):"-"))]}}])}),a("el-table-column",{attrs:{prop:"cancerFollow",label:"取关数量","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.cancerFollow)?Number(a.cancerFollow):"-"))]}}])}),a("el-table-column",{attrs:{prop:"state",label:"操作状态","min-width":"150px",align:"center"}})],1)],1)]),a("el-dialog",{staticClass:"dialog_mall",attrs:{title:"店铺搜索",visible:e.dialog_mallSearch,width:"950px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialog_mallSearch=t}}},[a("ul",[a("li",[a("label",[e._v("关键词")]),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("label",[e._v("评论数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.minComment,callback:function(t){e.minComment=t},expression:"minComment"}}),e._v("- "),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.maxComment,callback:function(t){e.maxComment=t},expression:"maxComment"}}),a("label",[e._v("点赞数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.minLike,callback:function(t){e.minLike=t},expression:"minLike"}}),e._v("- "),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.maxLike,callback:function(t){e.maxLike=t},expression:"maxLike"}})],1),a("li",[a("label",[e._v("评分数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.minScore,callback:function(t){e.minScore=t},expression:"minScore"}}),e._v("- "),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.maxScore,callback:function(t){e.maxScore=t},expression:"maxScore"}}),a("label",{staticStyle:{"margin-left":"50px"}},[e._v("店铺数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.mallNum,callback:function(t){e.mallNum=t},expression:"mallNum"}}),a("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",size:"mini"},on:{click:e.searchMall}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addTargetMall}},[e._v("添加勾选店铺")])],1),a("li",[a("el-table",{attrs:{"header-cell-style":{background:"#f7fafa"},data:e.mallSearchList,"row-style":{height:"50px"},"max-height":"400"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",width:"55",type:"selection"}}),a("el-table-column",{attrs:{align:"center",label:"序号",width:"55",type:"index"}}),a("el-table-column",{attrs:{prop:"shopid",label:"店铺ID","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"产品标题","min-width":"150px",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"",label:"主图","min-width":"100px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tooltip",{staticStyle:{width:"50px",height:"50px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e._f("imageRender")([n.image])}})],1),a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e._f("imageRender")([n.image,!0])}})],1)]}}])}),a("el-table-column",{attrs:{prop:"liked_count",label:"点赞数","min-width":"100px",align:"center",fixed:"right"}}),a("el-table-column",{attrs:{prop:"totalRate",label:"评论数","min-width":"100px",align:"center",fixed:"right"}}),a("el-table-column",{attrs:{prop:"rating_star",label:"产品评分","min-width":"100px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.item_rating.rating_star.toFixed(2)))]}}])}),a("el-table-column",{attrs:{prop:"",label:"操作","min-width":"200px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.open(n)}}},[e._v("查看产品")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.addMallIDinfo(n)}}},[e._v("添加店铺")])]}}])})],1)],1)])]),a("el-dialog",{staticClass:"dialog_mall",attrs:{title:"用户设置",visible:e.dialog_userInfo,width:"700px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialog_userInfo=t}}},[a("autoFollow",{attrs:{"user-info":e.userInfo,mall:e.selmallList},on:{isSave:e.setSave}})],1),a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}})],1)},r=[],o=a("53ca"),i=a("2909"),s=a("b85c"),l=a("1da1"),c=a("5530"),u=(a("96cf"),a("159b"),a("caad"),a("2532"),a("99af"),a("3ca3"),a("ddb0"),a("a9e3"),a("d3b7"),a("25f0"),a("4ec9"),a("4de4"),a("b680"),a("a434"),a("ac1f"),a("1276"),a("d81d"),a("c740"),a("feb6")),m=a("cf9f"),f=a("f68b"),p=a("0e0b"),_=a("d1dd"),g={name:"BusinessAnalyseGoodsDiscount",components:{StoreChoose:u["a"],autoFollow:m["a"]},data:function(){return{AutoAddFenceInstance:new _["a"](this),MallAPIInstance:new f["a"](this),selmallList:[],isSave:!1,dialog_userInfo:!1,userInfo:"",mallIDinfo:"",showlog:!1,tableList:[],dialog_mallSearch:!1,keyword:"",minComment:"50",maxComment:"5000",minLike:"100",maxLike:"10000",minScore:"4.5",maxScore:"5",mallNum:"10",mallSearchList:[],sel_mallSearchList:[],isStop:!1}},watch:{selmallList:{handler:function(e){var t=this;this.tableList=[],e.length&&e.forEach((function(e){var a=Object(c["a"])({},e);a["following"]=0,a["fence"]=0,a["newFollow"]=0,a["cancerFollow"]=0,a["state"]="-",t.tableList.push(a)}))},deep:!0}},created:function(){},mounted:function(){this.getUserinfo()},methods:{addMallIDinfo:function(e){this.mallIDinfo=this.mallIDinfo.includes(e.shopid)?this.mallIDinfo:this.mallIDinfo+","+e.shopid,","===this.mallIDinfo.substr(0,1)&&(this.mallIDinfo=this.mallIDinfo.substr(1))},clearMallIDinfo:function(){this.mallIDinfo=""},canCerFollowUnFollowMe:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.showlog=!1,e.isStop=!1,e.tableList.length){t.next=5;break}return e.$message.warning("请选择要操作的数据"),t.abrupt("return");case 5:return e.userInfo.auto_attention_set||e.$message.warning("请先设置参数"),e.$refs.Logs.writeLog("正在执行数据.....",!0),t.next=9,Object(p["c"])(e.tableList,e.canCerFollowUnFollowMeFun);case 9:e.$refs.Logs.writeLog("数据执行结束",!0);case 10:case"end":return t.stop()}}),t)})))()},canCerFollowUnFollowMeFun:function(e){var t=arguments,a=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,o,i,l,c,u,m,f,p,_,g,d,h,b,w,v,x,k,y;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,a.$refs.Logs.writeLog("当前操作店铺：【".concat(e.mall_alias_name||e.platform_mall_name,"】"),!0),n.next=5,a.isLogin(e);case 5:if(o=n.sent,o){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,a.getHomeMallData(e);case 10:if(i=n.sent,a.$set(e,"following",i?i.account.following_count:0),a.$set(e,"fence",i?i.follower_count:0),i){n.next=16;break}return a.$refs.Logs.writeLog("店铺暂无数据"),n.abrupt("return");case 16:return l={},l["country"]=e.country,l["mallId"]=e.platform_mall_id,l["shopid"]=e.platform_mall_id,l["offset"]=0,n.next=23,a.GetShopLikes(l);case 23:c=n.sent,u=c;case 25:if(20!==c.length){n.next=36;break}if(!a.isStop){n.next=28;break}return n.abrupt("break",36);case 28:return l["offset"]+=20,a.$refs.Logs.writeLog("店铺第【".concat(l.offset/20+1,"】页粉丝获取"),!0),n.next=32,a.GetShopLikes(l);case 32:c=n.sent,u=u.concat(c),n.next=25;break;case 36:return a.$refs.Logs.writeLog("店铺粉丝获取结束",!0),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取店铺关注"),!0),m=0,f={},f["country"]=e.country,f["mallId"]=e.platform_mall_id,f["offset"]=0,f["mallName"]=e.mall_alias_name||e.platform_mall_name,n.next=46,a.getHomeFllowering(f);case 46:if(p=n.sent,p.length){n.next=50;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无关注"),!0),n.abrupt("return");case 50:_=null,g=null,d=Object(s["a"])(p),n.prev=53,b=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=h.value,!a.isStop){t.next=3;break}return t.abrupt("return","break");case 3:if(!u.length){t.next=7;break}if(_=u.indexOf((function(e){return Number(e.userid)===Number(n.userid)})),!(_>=0)){t.next=7;break}return t.abrupt("return","continue");case 7:return t.next=9,a.runCancerAttention(n,e,e.platform_mall_id);case 9:g=t.sent,g&&m++;case 11:case"end":return t.stop()}}),t)})),d.s();case 56:if((h=d.n()).done){n.next=65;break}return n.delegateYield(b(),"t0",58);case 58:if(w=n.t0,"break"!==w){n.next=61;break}return n.abrupt("break",65);case 61:if("continue"!==w){n.next=63;break}return n.abrupt("continue",63);case 63:n.next=56;break;case 65:n.next=70;break;case 67:n.prev=67,n.t1=n["catch"](53),d.e(n.t1);case 70:return n.prev=70,d.f(),n.finish(70);case 73:if(!(p.length>=20)){n.next=104;break}if(!a.isStop){n.next=76;break}return n.abrupt("break",104);case 76:return f["offset"]+=20,n.next=79,a.getHomeFllowering(f);case 79:p=n.sent,v=Object(s["a"])(p),n.prev=81,k=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=x.value,!a.isStop){t.next=3;break}return t.abrupt("return","break");case 3:if(!u.length){t.next=7;break}if(_=u.indexOf((function(e){return Number(e.userid)===Number(n.userid)})),!(_>=0)){t.next=7;break}return t.abrupt("return","continue");case 7:return t.next=9,a.runCancerAttention(n,e,e.platform_mall_id);case 9:g=t.sent,g&&m++;case 11:case"end":return t.stop()}}),t)})),v.s();case 84:if((x=v.n()).done){n.next=93;break}return n.delegateYield(k(),"t2",86);case 86:if(y=n.t2,"break"!==y){n.next=89;break}return n.abrupt("break",93);case 89:if("continue"!==y){n.next=91;break}return n.abrupt("continue",91);case 91:n.next=84;break;case 93:n.next=98;break;case 95:n.prev=95,n.t3=n["catch"](81),v.e(n.t3);case 98:return n.prev=98,v.f(),n.finish(98);case 101:a.$set(e,"cancerFollow",m),n.next=73;break;case 104:a.$set(e,"cancerFollow",m),a.$refs.Logs.writeLog("成功取关【".concat(m,"】个用户"),!0),a.$refs.Logs.writeLog("店铺执行结束",!0),n.next=111;break;case 109:n.prev=109,n.t4=n["catch"](1);case 111:return n.prev=111,--r.count,n.finish(111);case 114:case"end":return n.stop()}}),n,null,[[1,109,111,114],[53,67,70,73],[81,95,98,101]])})))()},stopSet:function(){this.isStop=!0,Object(p["z"])(),this.$refs.Logs.writeLog("正在取消操作")},isLogin:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.MallAPIInstance.isLogin(e);case 2:if(n=a.sent,200!==n.code||!n.data){a.next=7;break}return a.abrupt("return",!0);case 7:return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺未登录"),!1),a.abrupt("return",!1);case 9:case"end":return a.stop()}}),a)})))()},Unfollower:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.tableList.length){a.next=3;break}return t.$message.warning("请选择要操作的店铺"),a.abrupt("return");case 3:return t.userInfo.auto_attention_set||t.$message.warning("请先设置参数"),t.tableList.forEach((function(t){t.type=e;var a=Object(c["a"])({},t);a["following"]=0,a["fence"]=0,a["newFollow"]=0,a["cancerFollow"]=0,a["state"]="-"})),t.isStop=!1,t.showlog=!1,a.next=9,Object(p["c"])(t.tableList,t.UnfollowerFun);case 9:case"end":return a.stop()}}),a)})))()},UnfollowerFun:function(e){var t=arguments,a=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,o,i,l,c,u,m,f,p,_,g,d,h,b,w,v;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,n.next=4,a.isLogin(e);case 4:if(o=n.sent,o){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,a.getHomeMallData(e);case 9:if(i=n.sent,a.$set(e,"following",i?i.account.following_count:0),a.$set(e,"fence",i?i.follower_count:0),i){n.next=15;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无数据")),n.abrupt("return");case 15:return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第一页关注")),l={},l["country"]=e.country,l["mallId"]=e.platform_mall_id,l["offset"]=0,l["mallName"]=e.mall_alias_name||e.platform_mall_name,c=0,n.next=24,a.getHomeFllowering(l);case 24:if(u=n.sent,u.length){n.next=28;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无关注")),n.abrupt("return");case 28:m=u.length,f=null,p=Object(s["a"])(u),n.prev=31,p.s();case 33:if((_=p.n()).done){n.next=68;break}if(g=_.value,!a.isStop){n.next=37;break}return n.abrupt("return");case 37:if(0!==e.type&&Number(a.userInfo.auto_attention_set.CancelFollowNumber)){n.next=48;break}return n.next=40,a.runCancerAttention(g,e,e.platform_mall_id);case 40:if(f=n.sent,!f){n.next=45;break}c++,n.next=46;break;case 45:return n.abrupt("continue",66);case 46:n.next=66;break;case 48:return n.next=50,a.filterShopDatas(g,e.country,e.platform_mall_id);case 50:if(d=n.sent,d){n.next=55;break}return n.abrupt("continue",66);case 55:return n.next=57,a.runCancerAttention(g,e,e.platform_mall_id);case 57:if(f=n.sent,!f){n.next=65;break}if(c++,!(c>=Number(a.userInfo.auto_attention_set.CancelFollowNumber))){n.next=63;break}return m=0,n.abrupt("break",68);case 63:n.next=66;break;case 65:return n.abrupt("continue",66);case 66:n.next=33;break;case 68:n.next=73;break;case 70:n.prev=70,n.t0=n["catch"](31),p.e(n.t0);case 73:return n.prev=73,p.f(),n.finish(73);case 76:a.$set(e,"cancerFollow",c);case 77:if(!(m>=20)){n.next=135;break}if(!a.isStop){n.next=80;break}return n.abrupt("return");case 80:return l["offset"]+=20,n.next=83,a.getHomeFllowering(l);case 83:u=n.sent,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(l.offset/20+1,"页关注")),m=u.length,h=Object(s["a"])(u),n.prev=87,h.s();case 89:if((b=h.n()).done){n.next=124;break}if(w=b.value,!a.isStop){n.next=93;break}return n.abrupt("return");case 93:if(0!==e.type&&Number(a.userInfo.auto_attention_set.CancelFollowNumber)){n.next=104;break}return n.next=96,a.runCancerAttention(w,e,e.platform_mall_id);case 96:if(f=n.sent,!f){n.next=101;break}c++,n.next=102;break;case 101:return n.abrupt("continue",122);case 102:n.next=122;break;case 104:return n.next=106,a.filterShopDatas(w,e.country,e.platform_mall_id);case 106:if(v=n.sent,v){n.next=111;break}return n.abrupt("continue",122);case 111:return n.next=113,a.runCancerAttention(w,e,e.platform_mall_id);case 113:if(f=n.sent,!f){n.next=121;break}if(c++,!(c>=Number(a.userInfo.auto_attention_set.CancelFollowNumber))){n.next=119;break}return m=0,n.abrupt("break",124);case 119:n.next=122;break;case 121:return n.abrupt("continue",122);case 122:n.next=89;break;case 124:n.next=129;break;case 126:n.prev=126,n.t1=n["catch"](87),h.e(n.t1);case 129:return n.prev=129,h.f(),n.finish(129);case 132:a.$set(e,"cancerFollow",c),n.next=77;break;case 135:a.$set(e,"cancerFollow",c),a.$set(e,"state","操作结束"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】取关【").concat(c,"】个粉丝")),n.next=142;break;case 140:n.prev=140,n.t2=n["catch"](1);case 142:return n.prev=142,--r.count,n.finish(142);case 145:case"end":return n.stop()}}),n,null,[[1,140,142,145],[31,70,73,76],[87,126,129,132]])})))()},getHomeMallData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.platform_mall_id,a.next=5,t.MallAPIInstance.UserProfile(n);case 5:if(r=a.sent,200!==r.code){a.next=20;break}return o=r.data.username,n["username"]=o,a.next=11,t.MallAPIInstance.getHomeMallinfo(n);case 11:if(i=a.sent,200!==i.code){a.next=16;break}return a.abrupt("return",i.data);case 16:return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】主页详情获取失败，").concat(i.message),!1),a.abrupt("return","");case 18:a.next=22;break;case 20:return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】用户名获取失败，").concat(r.message),!1),a.abrupt("return","");case 22:case"end":return a.stop()}}),a)})))()},getHomeFllowering:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["offset"]=e.offset,n["limit"]=20,n["offset_of_offset"]=0,n["timeStamp"]=(new Date).getTime(),a.next=9,t.MallAPIInstance.getFllowering(n);case 9:if(r=a.sent,200!==r.code){a.next=15;break}return t.$refs.Logs.writeLog("【".concat(e.mallName,"】第【").concat(e.offset/20+1,"】页获取成功"),!0),a.abrupt("return",r.data);case 15:return t.$refs.Logs.writeLog("【".concat(e.mallName,"】获取失败，").concat(r.message),!1),a.abrupt("return",[]);case 17:case"end":return a.stop()}}),a)})))()},open:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.tableList[0].country,r={mallId:e.shopid.toString()},a.next=4,t.$shopeemanService.getWebUrlLocal(n,r);case 4:o=a.sent,t.$BaseUtilService.openUrl("".concat(o,"/product/").concat(e.shopid,"/").concat(e.itemid));case 6:case"end":return a.stop()}}),a)})))()},test:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.AutoAddFenceInstance.autoAddFenceActive();case 1:case"end":return t.stop()}}),t)})))()},addCancerMall:function(){this.tableList.length?this.dialog_mallSearch=!0:this.$message.warning("请先设置参数")},searchMallInstance:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["by"]="relevancy",n["keyword"]=t.keyword,n["limit"]=60,n["newest"]=e.newest,n["order"]="desc",n["page_type"]="search",n["rating_filter"]=t.userInfo.auto_attention_set.MinOrderEvaluation,a.prev=10,a.next=13,t.MallAPIInstance.addCancerMall(n);case 13:if(r=a.sent,200!==r.status){a.next=18;break}return a.abrupt("return",JSON.parse(r.data).items);case 18:return t.$refs.Logs.writeLog("店铺搜索请求失败,230-line:".concat(r.status||"请求超时"),!1),a.abrupt("return",[]);case 20:a.next=26;break;case 22:return a.prev=22,a.t0=a["catch"](10),t.$refs.Logs.writeLog("店铺搜索请求失败,234-line:".concat(a.t0),!1),a.abrupt("return",[]);case 26:case"end":return a.stop()}}),a,null,[[10,22]])})))()},filterList:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=[],r=new Map,e.forEach((function(e){r.has(e.item_basic.itemid)||r.has(e.item_basic.shopid)||r.set(e.itemid,e)})),n=Object(i["a"])(r.values()),o=n.filter((function(e){var a=null,n=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t}));if(a=Number(e.item_basic.liked_count)>=Number(t.minLike)&&Number(e.item_basic.liked_count)<=Number(t.maxLike)&&e.item_basic.item_rating.rating_star.toFixed(2)>=Number(t.minScore)&&e.item_basic.item_rating.rating_star.toFixed(2)<=Number(t.maxScore)&&n>=Number(t.minComment)&&n<=Number(t.maxComment)&&e.item_basic.stock>=Number(t.userInfo.auto_attention_set.ProductMax),a)return e})),a.abrupt("return",o);case 6:case"end":return a.stop()}}),a)})))()},searchMall:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n,r,o,s,l,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.keyword){e.next=3;break}return t.$message.warning("请输入关键字"),e.abrupt("return");case 3:if(t.showlog=!1,t.$refs.Logs.writeLog("正在获取店铺信息......",!0),a=Number(t.mallNum),!(a>=0)){e.next=39;break}n=[],r=0;case 9:if(!(r<a)){e.next=36;break}return o={},o["country"]=t.tableList[0].country,o["mallId"]=t.tableList[0].platform_mall_id,o["newest"]=60*r,e.next=16,t.searchMallInstance(o);case 16:if(s=e.sent,s.length){e.next=20;break}return t.$refs.Logs.writeLog("暂无数据",!0),e.abrupt("return");case 20:if(!s.length){e.next=33;break}return e.next=23,t.filterList(s);case 23:if(l=e.sent,!l.length){e.next=31;break}if((c=n).push.apply(c,Object(i["a"])(l)),!(n.length>=a)){e.next=29;break}return n=n.splice(0,a),e.abrupt("break",36);case 29:e.next=33;break;case 31:return t.$refs.Logs.writeLog("此关键词暂无更多数据！"),e.abrupt("break",36);case 33:r++,e.next=9;break;case 36:t.$refs.Logs.writeLog("店铺搜索获取结束"),t.mallSearchList=[],n.forEach((function(e){e.item_basic.totalRate=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t})),t.mallSearchList.push(e.item_basic)}));case 39:case"end":return e.stop()}}),e)})))()},addTargetMall:function(e){if(this.sel_mallSearchList.length){var t=[];this.sel_mallSearchList.forEach((function(e){t.push(e.shopid)})),this.mallIDinfo=t.toString(),this.dialog_mallSearch=!1}else this.$message.warning("请选择店铺")},startCancer:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.mallIDinfo){t.next=3;break}return e.$message.warning("请先获取关注店铺"),t.abrupt("return");case 3:return e.userInfo.auto_attention_set||e.$message.warning("请先设置参数"),e.isStop=!1,e.showlog=!1,e.$refs.Logs.writeLog("数据正在处理......",!0),a=e.mallIDinfo.split(","),e.tableList.map((function(e){e["mallIDlist"]=a})),t.next=11,Object(p["c"])(e.tableList,e.getFllowerInfo);case 11:e.$refs.Logs.writeLog("数据处理结束",!0);case 12:case"end":return t.stop()}}),t)})))()},getFllowerInfo:function(e){var t=arguments,a=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,i,l,c,u,m,f,_,g;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,i=e.mallIDlist,a.$set(e,"following",0),a.$set(e,"fence",0),a.$set(e,"newFollow",0),a.$set(e,"cancerFollow",0),a.$set(e,"state","-"),a.$refs.Logs.writeLog("正在查询【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺关注信息")),n.next=11,a.isLogin(e);case 11:if(l=n.sent,l){n.next=15;break}return a.$set(e,"state","店铺未登录"),n.abrupt("return");case 15:return n.next=17,a.getHomeMallData(e);case 17:if(c=n.sent,a.$set(e,"following",c?c.account.following_count:0),a.$set(e,"fence",c?c.follower_count:0),c){n.next=24;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无数据"),!0),a.$set(e,"state","店铺数据请求失败"),n.abrupt("return");case 24:u=Number(e.newFollow),m=Object(s["a"])(i),n.prev=26,_=regeneratorRuntime.mark((function t(){var n,r,o,i,l,c,m,_,g,d,h,b,w,v,x,k,y,L,S,I,T,N,D,F,$,A,O,M,R,U;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=f.value,!a.isStop){t.next=4;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 4:if(r={},r["country"]=e.country,r["mallId"]=e.platform_mall_id,r["shopid"]=n,"0"!==a.userInfo.auto_attention_set.FollowType){t.next=135;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】正在获取").concat(n,"店铺粉丝信息"),!0),o=!0,r["offset"]=0,t.next=14,a.GetShopLikes(r);case 14:i=t.sent,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(r.offset/20+1,"页粉丝")),l=Object(s["a"])(i),t.prev=17,l.s();case 19:if((c=l.n()).done){t.next=63;break}if(m=c.value,!a.isStop){t.next=24;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 24:return t.next=26,a.filterShopDatas(i,e.country,e.platform_mall_id);case 26:if(_=t.sent,_){t.next=29;break}return t.abrupt("continue",61);case 29:return t.next=31,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),m.ShopId);case 31:if(g=t.sent,!g.attention_shop_id){t.next=34;break}return t.abrupt("continue",61);case 34:return t.next=36,a.runAttention(m,e,n);case 36:if(d=t.sent,!d){t.next=45;break}return u++,a.$set(e,"newFollow",u),t.next=42,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:m.ShopId});case 42:t.sent,t.next=50;break;case 45:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(m.UserName,"失败,"),!1),o=!1,t.abrupt("continue",61);case 50:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=57;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=55;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 55:t.next=61;break;case 57:if(!(e.following+u>=3e3)){t.next=61;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 61:t.next=19;break;case 63:t.next=68;break;case 65:t.prev=65,t.t0=t["catch"](17),l.e(t.t0);case 68:return t.prev=68,l.f(),t.finish(68);case 71:a.$set(e,"newFollow",u);case 72:if(!o){t.next=131;break}if(!a.isStop){t.next=76;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 76:return r["offset"]+=20,t.next=79,a.GetShopLikes(r);case 79:i=t.sent,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(r.offset/20+1,"页粉丝数据")),h=0;case 82:if(!(h<i.length)){t.next=125;break}if(!a.isStop){t.next=86;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 86:return b=i[h],t.next=89,a.filterShopDatas(b,e.country,e.platform_mall_id);case 89:if(w=t.sent,w){t.next=92;break}return t.abrupt("continue",122);case 92:return t.next=94,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),b.ShopId);case 94:if(v=t.sent,!v.attention_shop_id){t.next=97;break}return t.abrupt("continue",122);case 97:return t.next=99,a.runAttention(b,e,n);case 99:if(x=t.sent,!x){t.next=107;break}return u++,t.next=104,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:b.ShopId});case 104:t.sent,t.next=111;break;case 107:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(b.UserName,"失败,"),!1),t.abrupt("continue",122);case 111:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=118;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=116;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 116:t.next=122;break;case 118:if(!(e.following+u>=3e3)){t.next=122;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 122:h++,t.next=82;break;case 125:return i.length<20&&(a.$refs.Logs.writeLog("【".concat(n,"】查找结束")),o=!1),a.$set(e,"newFollow",u),t.next=129,Object(p["y"])(1e3*Number(a.userInfo.auto_attention_set.FollowInterval));case 129:t.next=72;break;case 131:a.$set(e,"state","操作结束"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】成功关注").concat(u,"个粉丝")),t.next=248;break;case 135:return a.$refs.Logs.writeLog("正在获取评价用户信息",!0),k=!0,y=[],L=a.mallSearchList.findIndex((function(e){return e.shopid===Number(n)})),S=a.mallSearchList[L].itemid,I=0,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取").concat(n,"第【").concat(I/52+1,"】页评价用户")),t.next=144,a.GetShopComment(S,n,e,I);case 144:if(y=t.sent,y.length){t.next=148;break}return a.$refs.Logs.writeLog("".concat(n,"暂无用户评价")),t.abrupt("return","continue");case 148:T=0;case 149:if(!(T<y.length)){t.next=188;break}return N=y[T],D={},D["ShopId"]=N.author_shopid,D["UserName"]=N.author_username,t.next=156,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),D.ShopId);case 156:if(F=t.sent,!F.attention_shop_id){t.next=159;break}return t.abrupt("continue",185);case 159:return t.next=161,a.runAttention(D,e,N.shopid);case 161:if($=t.sent,!$){t.next=169;break}return u++,t.next=166,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:D.ShopId});case 166:t.sent,t.next=174;break;case 169:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(D.UserName,"失败,"),!1),k=!1,t.abrupt("continue",185);case 174:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=181;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=179;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 179:t.next=185;break;case 181:if(!(e.following+u>=3e3)){t.next=185;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 185:T++,t.next=149;break;case 188:a.$set(e,"newFollow",u);case 189:if(!k){t.next=246;break}if(!a.isStop){t.next=193;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 193:return I+=52,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取").concat(n,"第【").concat(I/52+1,"】页评价用户")),t.next=197,a.GetShopComment(S,n,e,I);case 197:y=t.sent,A=0;case 199:if(!(A<y.length)){t.next=240;break}if(!a.isStop){t.next=203;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 203:return O=y[A],M={},M["ShopId"]=O.shopid,M["UserName"]=O.author_username,t.next=209,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),M.ShopId);case 209:if(R=t.sent,!R.attention_shop_id){t.next=212;break}return t.abrupt("continue",237);case 212:return t.next=214,a.runAttention(M,e,n);case 214:if(U=t.sent,!U){t.next=222;break}return u++,t.next=219,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:M.ShopId});case 219:t.sent,t.next=226;break;case 222:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(M.UserName,"失败,"),!1),t.abrupt("continue",237);case 226:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=233;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=231;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 231:t.next=237;break;case 233:if(!(e.following+u>=3e3)){t.next=237;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 237:A++,t.next=199;break;case 240:return y.length<52&&(a.$refs.Logs.writeLog("【".concat(n,"】查找结束")),k=!1),a.$set(e,"newFollow",u),t.next=244,Object(p["y"])(1e3*Number(a.userInfo.auto_attention_set.FollowInterval));case 244:t.next=189;break;case 246:a.$set(e,"state","操作结束"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】成功关注").concat(u,"个粉丝"));case 248:case"end":return t.stop()}}),t,null,[[17,65,68,71]])})),m.s();case 29:if((f=m.n()).done){n.next=38;break}return n.delegateYield(_(),"t0",31);case 31:if(g=n.t0,"continue"!==g){n.next=34;break}return n.abrupt("continue",36);case 34:if("object"!==Object(o["a"])(g)){n.next=36;break}return n.abrupt("return",g.v);case 36:n.next=29;break;case 38:n.next=43;break;case 40:n.prev=40,n.t1=n["catch"](26),m.e(n.t1);case 43:return n.prev=43,m.f(),n.finish(43);case 46:a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注结束"),!0),n.next=52;break;case 49:n.prev=49,n.t2=n["catch"](1),a.$refs.Logs.writeLog("用户信息获取失败-line373，".concat(n.t2),!1);case 52:return n.prev=52,--r.count,n.finish(52);case 55:case"end":return n.stop()}}),n,null,[[1,49,52,55],[26,40,43,46]])})))()},getHomeFollowingList:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.platform_mall_id,n["offset"]=0,n["mallName"]=e.mall_alias_name||e.platform_mall_name,t.next=7,a.getHomeFllowering(n);case 7:if(r=t.sent,o=r,o.length){t.next=11;break}return t.abrupt("return",[]);case 11:if(!(r.length>=20)){t.next=21;break}if(!a.isStop){t.next=14;break}return t.abrupt("break",21);case 14:return n["offset"]+=20,t.next=17,a.getHomeFllowering(n);case 17:r=t.sent,o=o.concat(r),t.next=11;break;case 21:return t.abrupt("return",o);case 22:case"end":return t.stop()}}),t)})))()},GetShopComment:function(e,t,a,n){var r=this;return Object(l["a"])(regeneratorRuntime.mark((function o(){var i,s,l,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i={},i["mallId"]=a.platform_mall_id,i["country"]=a.country,i["itemid"]=e,i["offset"]=n,i["shopid"]=t,o.next=8,r.MallAPIInstance.getShoppComment(i);case 8:if(s=o.sent,200!==s.code){o.next=15;break}return l=s.data.ratings||[],c=l.filter((function(e){if(e.rating_star>=Number(r.userInfo.auto_attention_set.MinOrderEvaluation))return e})),o.abrupt("return",c);case 15:return r.$refs.Logs.writeLog("商品评价获取失败".concat(s.message),!1),o.abrupt("return",[]);case 17:case"end":return o.stop()}}),o)})))()},runAttention:function(e,t,a){var n=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o={},o["country"]=t.country,o["mallId"]=t.platform_mall_id,o["userShopid"]=e.ShopId,o["followMallID"]=a,r.next=7,n.MallAPIInstance.buyerFollow(o);case 7:if(i=r.sent,200===i.code){r.next=12;break}n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"失败,").concat(i.message),!1),r.next=18;break;case 12:if(!i.data){r.next=17;break}return n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"成功"),!0),r.abrupt("return",!0);case 17:n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"失败,").concat(i.message),!1);case 18:return r.abrupt("return",!1);case 19:case"end":return r.stop()}}),r)})))()},runCancerAttention:function(e,t,a){var n=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o={},o["country"]=t.country,o["mallId"]=t.platform_mall_id,o["ShopId"]=e.ShopId,o["followMallID"]=a,r.next=7,n.MallAPIInstance.buyerUNFollow(o);case 7:if(i=r.sent,200===i.code){r.next=13;break}return n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】取关").concat(e.ShopId,"失败"),!1),r.abrupt("return",!1);case 13:return n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】取关").concat(e.ShopId,"成功"),!0),r.abrupt("return",!0);case 15:case"end":return r.stop()}}),r)})))()},filterShopDatas:function(e,t,a){var n=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var o,i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.getActiveUser({country:t,mallId:a,userName:e.UserName});case 2:if(o=r.sent,i=new Date((new Date).toLocaleDateString()).getTime(),s=i-i*(Number(n.userInfo.auto_attention_set.LastLoginDay)-1),!(o>s)){r.next=9;break}return r.abrupt("return",!0);case 9:return r.abrupt("return",!1);case 10:case"end":return r.stop()}}),r)})))()},getActiveUser:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["username"]=e.userName,a.next=6,t.MallAPIInstance.getActiveTimeFollower(n);case 6:if(r=a.sent,200!==r.code){a.next=11;break}return a.abrupt("return",1e3*Number(r.data.last_active_time));case 11:return t.$refs.Logs.writeLog("店铺活跃状态获取失败:".concat(r.message),!1),a.abrupt("return","");case 13:case"end":return a.stop()}}),a)})))()},GetShopLikes:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["shopid"]=e.shopid,n["offset"]=e.offset,n["limit"]=20,n["offset_of_offset"]=0,n["timeStamp"]=(new Date).getTime(),a.next=10,t.MallAPIInstance.getFllower(n);case 10:if(r=a.sent,200!==r.code){a.next=15;break}return a.abrupt("return",r.data);case 15:return t.$refs.Logs.writeLog("粉丝获取失败，".concat(r.message),!1),a.abrupt("return",[]);case 17:case"end":return a.stop()}}),a)})))()},setSave:function(e){this.dialog_userInfo=!1,this.getUserinfo()},setQurey:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dialog_userInfo=!0;case 1:case"end":return t.stop()}}),t)})))()},getUserinfo:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showlog=!0,t.next=3,e.$api.userSet();case 3:a=t.sent,200===a.data.code?e.userInfo=a.data.data:e.$message.warning("信息获取失败！".concat(a.data.data.message)),e.userInfo.auto_attention_set||(e.userInfo.auto_attention_set={},e.userInfo.auto_attention_set.ProductMax="5",e.userInfo.auto_attention_set.LastLoginDay="5",e.userInfo.auto_attention_set.FollowType="0",e.userInfo.auto_attention_set.FollowNumber="100",e.userInfo.auto_attention_set.FollowInterval="10",e.userInfo.auto_attention_set.MinOrderEvaluation="4.5",e.userInfo.auto_attention_set.IsNotFollowMinOrderEvaluation=!0,e.userInfo.auto_attention_set.FollowedDay="30",e.userInfo.auto_attention_set.IsNotFollowFollowedDay=!0,e.userInfo.auto_attention_set.CancelFollowNumber="100",e.userInfo.auto_attention_set.IsOpenTimerBrushFans=!1,e.userInfo.auto_attention_set.OpenHour="10",e.userInfo.auto_attention_set.OpenMinute="00"),e.userInfo.auto_attention_set||e.$message.warning("请先设置参数");case 7:case"end":return t.stop()}}),t)})))()},clearLog:function(){this.$refs.Logs.consoleMsg=""},changeMallList:function(e){this.selmallList=e},handleSelectionChange:function(e){this.sel_mallSearchList=e}}},d=g,h=(a("7d85"),a("2877")),b=Object(h["a"])(d,n,r,!1,null,"547e0d94",null);t["default"]=b.exports},8992:function(e,t,a){"use strict";a("4c28")},cf9f:function(e,t,a){"use strict";var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("ul",[a("span",[e._v("  通用设置  ")]),a("li",[a("div",[a("label",[e._v("店铺商品上限：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.limitgGoods,callback:function(t){e.limitgGoods=t},expression:"limitgGoods"}}),a("label",{staticStyle:{"margin-left":"120px"}},[e._v("最后活跃时间：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.lastOnline,callback:function(t){e.lastOnline=t},expression:"lastOnline"}}),e._v("  天内 ")],1)]),a("span",[e._v("  关注设置  ")]),a("li",[a("ul",{staticStyle:{"margin-top":"-10px"}},[a("span",{staticStyle:{"margin-left":"-20px"}},[e._v("  关注对象  ")]),a("li",{staticStyle:{width:"450px","margin-left":"-20px"}},[a("el-radio-group",{model:{value:e.followActor,callback:function(t){e.followActor=t},expression:"followActor"}},[a("el-radio",{attrs:{label:"0"}},[e._v("店铺粉丝")])],1)],1)]),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("label",[e._v("关注数量：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.followNum,callback:function(t){e.followNum=t},expression:"followNum"}}),e._v(" （0为无限制） "),a("label",{staticStyle:{"margin-left":"110px"}},[e._v("关注间隔：")]),a("el-input",{staticStyle:{width:"50px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.interTime,callback:function(t){e.interTime=t},expression:"interTime"}}),e._v(" 秒 ")],1),a("div",[a("el-checkbox",{staticStyle:{"margin-bottom":"10px"},model:{value:e.market,callback:function(t){e.market=t},expression:"market"}},[e._v("不关注订单评价小于等于 ")]),a("el-input",{staticStyle:{width:"50px"},attrs:{size:"mini"},on:{blur:function(t){e.market=!0}},model:{value:e.marketNum,callback:function(t){e.marketNum=t},expression:"marketNum"}}),e._v(" 的用户 ")],1),a("div",[a("el-checkbox",{model:{value:e.followDay,callback:function(t){e.followDay=t},expression:"followDay"}},[e._v("不关注 ")]),a("el-input",{staticStyle:{width:"75px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},on:{blur:function(t){e.followDay=!0}},model:{value:e.followDayNum,callback:function(t){e.followDayNum=t},expression:"followDayNum"}}),e._v(" 天内关注过的用户 ")],1)]),a("span",[e._v("  取关设置  ")]),a("li",[a("div",[a("label",[e._v("取关数量：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.cancerFollowNum,callback:function(t){e.cancerFollowNum=t},expression:"cancerFollowNum"}}),e._v(" （0为无限制） ")],1)]),a("span",[e._v("  自动关注  ")]),a("li",{staticClass:"orderSet"},[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 开启任务请前往【爆粉神器】添加执行任务的店铺，随后进行参数设置"),a("br"),e._v(" 注意：1.关键词不能为空"),a("br"),e._v("           2.一个站点只能执行一条任务"),a("br"),e._v("           3.同一个站点的任务保存会替换原来的任务"),a("br")]),a("el-checkbox",{model:{value:e.startAddFence,callback:function(t){e.startAddFence=t},expression:"startAddFence"}},[e._v("开启定时刷粉")])],1),a("label",[e._v("每日启动时间  ")]),a("el-time-select",{staticStyle:{width:"100px"},attrs:{"picker-options":{start:"00:00",step:"00:01",end:"23:59"},placeholder:"选择时间",size:"mini"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),a("label",{staticStyle:{"margin-left":"20px"}},[e._v("关注关键词：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini"},model:{value:e.followKey,callback:function(t){e.followKey=t},expression:"followKey"}}),a("el-button",{attrs:{size:"mini"},on:{click:e.checkLog}},[e._v("查看日志")])],1)]),a("el-button",{staticStyle:{flex:"1","margin-left":"200px",width:"100px"},attrs:{size:"mini"},on:{click:function(t){return e.save()}}},[e._v("保存")])],1),a("el-dialog",{attrs:{title:"日志",visible:e.logVisible,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},on:{"update:visible":function(t){e.logVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"max-height":"400px",data:e.logList,"tooltip-effect":"dark","header-cell-style":{textAlign:"center",backgroundColor:"#f5f7fa"},"cell-style":{textAlign:"center"},"row-style":{height:"80px"}}},[a("el-table-column",{attrs:{label:"操作","min-width":"320px",prop:"option","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"时间","min-width":"180px",prop:"activeTime"}})],1)],1)],1)},o=[],i=a("ade3"),s=a("1da1"),l=(a("d3b7"),a("25f0"),a("ac1f"),a("1276"),a("d81d"),a("a9e3"),a("99af"),a("5319"),a("96cf"),a("0e0b")),c={components:{},props:["userInfo","mall"],data:function(){return{logVisible:!1,logList:[],userID:"",uid:"",showlog:!0,limitgGoods:"5",lastOnline:"1",followActor:"0",followNum:"100",interTime:"10",market:!0,marketNum:"4.5",followDay:!0,followDayNum:"30",cancerFollowNum:100,startAddFence:!1,startTime:"10:00",followKey:""}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["A"])((function(){return e.userInfo&&e.userInfo.id}));case 2:return t.next=4,e.getUserinfo();case 4:case"end":return t.stop()}}),t)})))()},methods:(n={checkLog:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.logVisible=!0,a=["MY","TW","VN","ID","PH","TH","SG","BR","MX","CO","CL","PL"],n=0,r=a;case 3:if(!(n<r.length)){t.next=16;break}return o=r[n],t.next=7,window.BaseUtilBridgeService.getAttentionUserTask(o);case 7:if(i=t.sent,!i.length){t.next=13;break}return t.next=11,window.BaseUtilBridgeService.getAttentionUserLog(i[0].id);case 11:s=t.sent,s?e.logList=JSON.parse(s[0].log_message):e.$message.warning("日志请求失败");case 13:n++,t.next=3;break;case 16:case"end":return t.stop()}}),t)})))()},getUserinfo:function(){if(this.userInfo&&this.userInfo.auto_attention_set){var e,t,a,n,r,o,i,s,l,c,u,m;this.limitgGoods=(null===(e=this.userInfo.auto_attention_set)||void 0===e?void 0:e.ProductMax)||this.limitgGoods,this.lastOnline=(null===(t=this.userInfo.auto_attention_set)||void 0===t?void 0:t.LastLoginDay)||this.lastOnline,this.followActor=(null===(a=this.userInfo.auto_attention_set)||void 0===a?void 0:a.FollowType.toString())||this.followActor,this.followNum=(null===(n=this.userInfo.auto_attention_set)||void 0===n?void 0:n.FollowNumber)||this.followNum,this.interTime=(null===(r=this.userInfo.auto_attention_set)||void 0===r?void 0:r.FollowInterval)||this.interTime,this.marketNum=(null===(o=this.userInfo.auto_attention_set)||void 0===o?void 0:o.MinOrderEvaluation)||this.marketNum,this.market=(null===(i=this.userInfo.auto_attention_set)||void 0===i?void 0:i.IsNotFollowMinOrderEvaluation)||this.market,this.followDayNum=(null===(s=this.userInfo.auto_attention_set)||void 0===s?void 0:s.FollowedDay)||this.followDayNum,this.followDay=(null===(l=this.userInfo.auto_attention_set)||void 0===l?void 0:l.IsNotFollowFollowedDay)||this.followDay,this.cancerFollowNum=(null===(c=this.userInfo.auto_attention_set)||void 0===c?void 0:c.CancelFollowNumber)||this.cancerFollowNum,this.startAddFence=(null===(u=this.userInfo.auto_attention_set)||void 0===u?void 0:u.IsOpenTimerBrushFans)||this.startAddFence;var f=this.userInfo.auto_attention_set;this.startTime=(null===(m=this.userInfo.auto_attention_set)||void 0===m?void 0:m.OpenHour)+":"+("0"===f.OpenMinute?"00":f.OpenMinute)||this.startTime,this.followKey=this.userInfo.auto_attention_set.KeyWord||this.followKey}},add0:function(e){return e<10?"0"+e:e},formatTime:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=t.getHours(),i=t.getMinutes(),s=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(r)+" "+this.add0(o)+":"+this.add0(i)+":"+this.add0(s)},autoAddFence:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.startAddFence||e.mall){t.next=3;break}return e.$message.warning("请前往【爆粉神器】设置需要执行的任务的店铺"),t.abrupt("return",!1);case 3:if(!e.startAddFence||e.followKey){t.next=6;break}return e.$message.warning("关键词不能为空"),t.abrupt("return",!1);case 6:if(a=e.startTime.split(":"),!e.startAddFence){t.next=38;break}return n={},n["country"]=e.mall[0].country,n["log_message"]=[],t.next=13,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 13:if(r=t.sent,!r.length){t.next=20;break}return t.next=17,window.BaseUtilBridgeService.deleteAttentionUserTask(r[0].id);case 17:t.sent,n["log_message"].push("任务删除"),n["created_at"]=e.formatTime((new Date).getTime());case 20:return o={country:e.mall[0].country,mall_ids:e.mall.map((function(e){return e["platform_mall_id"]})).toString(),mall_names:e.mall.map((function(e){return e["mall_alias_name"]||e["platform_mall_name"]})).toString(),product_max:e.limitgGoods,last_login_day:e.lastOnline,open_hour:a[0].toString(),open_minute:a[1].toString(),key_word:e.followKey,follow_number:e.followNum,follow_interval:e.interTime,is_not_follow_min_order_evaluation:e.market?1:0,min_order_evaluation:e.marketNum,is_not_follow_followed_day:e.followDay?1:0,followed_day:e.followDayNum,followed_type:e.followActor,cancel_follow_number:Number(e.cancerFollowNum),cancel_follow_sort_type:0,exec_time:1e3*e.teskTime(e.startTime)},t.next=23,window.BaseUtilBridgeService.saveAttentionUserTask(o);case 23:if(i=t.sent,"200"!==i.code){t.next=33;break}return t.next=27,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 27:s=t.sent,n["task_id"]=s[0].id,n["log_message"].push("任务创建成功"),n["created_at"]=e.formatTime((new Date).getTime()),t.next=35;break;case 33:n["log_message"].push("任务创建失败"),n["created_at"]=e.formatTime((new Date).getTime());case 35:return n["log_message"]=n["log_message"].toString(),t.next=38,window.BaseUtilBridgeService.saveAttentionUserLog(n);case 38:return t.abrupt("return",!0);case 39:case"end":return t.stop()}}),t)})))()},teskTime:function(e){var t="".concat((new Date).getFullYear(),"-").concat((new Date).getMonth(),"-").concat((new Date).getDay()," ").concat(e,":00"),a=t.replace(/:/g,"-");a=a.replace(/ /g,"-");var n=a.split("-"),r=new Date(Date.UTC(n[0],n[1]-1,n[2],n[3]-8,n[4],n[5]));return r.getTime()/1e3}},Object(i["a"])(n,"add0",(function(e){return e<10?"0"+e:e})),Object(i["a"])(n,"formatTime",(function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=t.getHours(),i=t.getMinutes(),s=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(r)+" "+this.add0(o)+":"+this.add0(i)+":"+this.add0(s)})),Object(i["a"])(n,"save",(function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,s,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.startAddFence){t.next=6;break}return t.next=3,e.autoAddFence();case 3:if(a=t.sent,a){t.next=6;break}return t.abrupt("return");case 6:if(n=e.startTime.split(":"),!e.startAddFence){t.next=20;break}return r={},r["country"]=e.mall[0].country,r["log_message"]=[],o={country:e.mall[0].country,mall_ids:e.mall.map((function(e){return e["platform_mall_id"]})).toString(),mall_names:e.mall.map((function(e){return e["mall_alias_name"]||e["platform_mall_name"]})).toString(),product_max:e.limitgGoods,last_login_day:e.lastOnline,open_hour:n[0],open_minute:n[1],key_word:e.followKey,follow_number:e.followNum,follow_interval:e.interTime,is_not_follow_min_order_evaluation:e.market,min_order_evaluation:e.marketNum,is_not_follow_followed_day:e.followDay,followed_day:e.followDayNum,followed_type:e.followActor,cancel_follow_number:e.cancerFollowNum,cancel_follow_sort_type:0},t.next=14,window.BaseUtilBridgeService.saveAttentionUserTask(JSON.stringify(o));case 14:return i=t.sent,i?(r["task_id"]=i.task_id,r["log_message"].push("任务创建成功"),r["created_at"]=e.formatTime((new Date).getTime())):(r["log_message"].push("任务创建失败"),r["created_at"]=e.formatTime((new Date).getTime())),r["log_message"]=r["log_message"].toString(),t.next=19,window.BaseUtilBridgeService.saveAttentionUserLog(r);case 19:t.sent;case 20:return s={ProductMax:e.limitgGoods,LastLoginDay:e.lastOnline,FollowType:e.followActor,FollowNumber:e.followNum,FollowInterval:e.interTime,MinOrderEvaluation:e.marketNum,IsNotFollowMinOrderEvaluation:e.market,FollowedDay:e.followDayNum,IsNotFollowFollowedDay:e.followDay,CancelFollowNumber:e.cancerFollowNum,IsOpenTimerBrushFans:e.startAddFence,OpenHour:n[0],OpenMinute:n[1],KeyWord:e.followKey,IsNotFollowCrossBorderSeller:!1,CancelFollowSortType:"0"},l={content:{autoAttentionSet:JSON.stringify(s)},type:4},t.prev=22,t.next=25,e.$api.setUserinfo(JSON.stringify(l));case 25:c=t.sent,200===c.data.code?e.$message.success("信息修改成功！"):e.$message.warning("信息修改失败！".concat(c.data.message)),t.next=31;break;case 29:t.prev=29,t.t0=t["catch"](22);case 31:e.$emit("isSave",!0);case 32:case"end":return t.stop()}}),t,null,[[22,29]])})))()})),n)},u=c,m=(a("e5c5"),a("2877")),f=Object(m["a"])(u,r,o,!1,null,"a6bbd672",null);t["a"]=f.exports},d068:function(e,t,a){},d1dd:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a("53ca"),r=a("b85c"),o=a("2909"),i=a("1da1"),s=a("d4ec"),l=a("bee2"),c=a("ade3"),u=(a("96cf"),a("a9e3"),a("ac1f"),a("1276"),a("a434"),a("159b"),a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("4de4"),a("b680"),a("d81d"),a("99af"),a("25f0"),a("c740"),a("f68b")),m=a("0e0b"),f=a("2b0e"),p=null,_=function(){function e(){Object(s["a"])(this,e),Object(c["a"])(this,"mallTest",""),Object(c["a"])(this,"MallAPIInstance",new u["a"](new f["default"])),Object(c["a"])(this,"mallSearchList",[]),Object(c["a"])(this,"storeLogList",{})}return Object(l["a"])(e,[{key:"autoAddFenceActive",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,o,i,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=["MY","TW","VN","ID","PH","TH","SG","BR","MX","CO","CL","PL"],a=0,n=t;case 2:if(!(a<n.length)){e.next=14;break}return r=n[a],o={},o["country"]=r,o["log_message"]=[],e.next=9,window.BaseUtilBridgeService.getAttentionUserTask(r);case 9:i=e.sent,i.length&&(s=(new Date).getTime(),l=Number(i[0].exec_time),this.runTesk(s-l,i));case 11:a++,e.next=2;break;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"runTesk",value:function(e,t){var a=this;this.storeLogList["".concat(t[0].country)]={},this.storeLogList["".concat(t[0].country)].log_message=[],e=e>0?0:0-e,e?this.storeLogList["".concat(t[0].country)].log_message.push({option:"【".concat(t[0].country,"】该任务还未到执行时间"),activeTime:this.formatTime((new Date).getTime())}):this.storeLogList["".concat(t[0].country)].log_message.push({option:"【".concat(t[0].country,"】任务即将执行...."),activeTime:this.formatTime((new Date).getTime())}),setTimeout(Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.searchMall(t[0]);case 2:return e.next=4,a.startCancer(t[0]);case 4:return n={country:t[0].country,mall_ids:t[0].mall_ids,mall_names:t[0].mall_names,product_max:t[0].product_max,last_login_day:t[0].last_login_day,open_hour:t[0].open_hour,open_minute:t[0].open_minute,key_word:t[0].key_word,follow_number:t[0].follow_number,follow_interval:t[0].follow_interval,is_not_follow_min_order_evaluation:t[0].is_not_follow_min_order_evaluation,min_order_evaluation:t[0].min_order_evaluation,is_not_follow_followed_day:t[0].is_not_follow_followed_day,followed_day:t[0].followed_day,followed_type:t[0].followed_type,cancel_follow_number:t[0].cancel_follow_number,cancel_follow_sort_type:t[0].cancel_follow_sort_type,exec_time:(new Date).getTime()},e.next=7,window.BaseUtilBridgeService.saveAttentionUserTask(n);case 7:return e.sent,e.next=10,window.BaseUtilBridgeService.getAttentionUserTask(t[0].country);case 10:return r=e.sent,a.storeLogList["".concat(t[0].country)].task_id=r[0].id,a.storeLogList["".concat(t[0].country)].country=r[0].country,a.storeLogList["".concat(t[0].country)].created_at=a.formatTime((new Date).getTime()),a.storeLogList["".concat(t[0].country)].log_message=JSON.stringify(a.storeLogList["".concat(t[0].country)].log_message),e.next=17,window.BaseUtilBridgeService.saveAttentionUserLog(a.storeLogList["".concat(t[0].country)]);case 17:e.sent;case 18:case"end":return e.stop()}}),e)}))),e)}},{key:"add0",value:function(e){return e<10?"0"+e:e}},{key:"formatTime",value:function(t){var a=new e,n=new Date(t),r=n.getFullYear(),o=n.getMonth()+1,i=n.getDate(),s=n.getHours(),l=n.getMinutes(),c=n.getSeconds();return r+"-"+a.add0(o)+"-"+a.add0(i)+" "+a.add0(s)+":"+a.add0(l)+":"+a.add0(c)}},{key:"searchMall",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,i,s,l,c,u=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=10*t.mall_ids.split(",").length,n=[],this.storeLogList["".concat(t.country)].log_message.push({option:"正在查询【".concat(t.key_word,"】相关店铺...."),activeTime:this.formatTime((new Date).getTime())}),r=0;case 4:if(!(r<a)){e.next=32;break}return i={},i["country"]=t.country,i["mallId"]=Number(t.mall_ids.split(",")[0]),i["newest"]=60*r,i["keyword"]=t.key_word,i["min_order_evaluation"]=t.min_order_evaluation,e.next=13,this.searchMallInstance(i);case 13:if(s=e.sent,s.length){e.next=17;break}return this.storeLogList["".concat(t.country)].log_message.push({option:"暂无数据",activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return");case 17:return e.next=19,this.filterList(s,t);case 19:if(l=e.sent,!l.length){e.next=27;break}if((c=n).push.apply(c,Object(o["a"])(l)),!(n.length>=a)){e.next=25;break}return n=n.splice(0,a),e.abrupt("break",32);case 25:e.next=29;break;case 27:return this.storeLogList["".concat(t.country)].log_message.push({option:"此关键词暂无更多数据！",activeTime:this.formatTime((new Date).getTime())}),e.abrupt("break",32);case 29:r++,e.next=4;break;case 32:this.storeLogList["".concat(t.country)].log_message.push({option:"店铺搜索获取结束",activeTime:this.formatTime((new Date).getTime())}),this.mallSearchList=[],n.forEach((function(e){e.item_basic.totalRate=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t})),u.mallSearchList.push(e.item_basic)}));case 35:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"searchMallInstance",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.mallId,a["by"]="relevancy",a["keyword"]=t.keyword,a["limit"]=60,a["newest"]=t.newest,a["order"]="desc",a["page_type"]="search",a["rating_filter"]=t.min_order_evaluation,e.prev=10,e.next=13,this.MallAPIInstance.addCancerMall(a);case 13:if(n=e.sent,200!==n.status){e.next=18;break}return e.abrupt("return",JSON.parse(n.data).items);case 18:return this.storeLogList["".concat(t.country)].log_message.push({option:"店铺搜索请求失败,230-line:".concat(n.status),activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return",[]);case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e["catch"](10),this.storeLogList["".concat(t.country)].log_message.push({option:"店铺搜索请求失败,234-line:".concat(e.t0),activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return",[]);case 26:case"end":return e.stop()}}),e,this,[[10,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"filterList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a){var n,r,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[],r=new Map,t.forEach((function(e){r.has(e.item_basic.itemid)||r.has(e.item_basic.shopid)||r.set(e.itemid,e)})),n=Object(o["a"])(r.values()),i=Number(a.product_max),s=n.filter((function(e){var t=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t}));if(Number(e.item_basic.liked_count)>=100&&Number(e.item_basic.liked_count)<=1e4&&Number(e.item_basic.item_rating.rating_star.toFixed(2))>=4.5&&Number(e.item_basic.item_rating.rating_star.toFixed(2))<=5&&t>=50&&t<=5e3&&e.item_basic.stock>=i)return e})),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"startCancer",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.mallSearchList.length<=0)){e.next=3;break}return this.storeLogList["".concat(t.country)].log_message.push({option:"当前关键词【".concat(t.key_word,"】暂无数据"),activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return");case 3:return a=t.mall_ids.split(","),n=t.mall_names.split(","),r=this.mallSearchList.map((function(e){return e.shopid})),o=a.map((function(e,a){var o={};return o.platform_mall_id=e,o.mall_alias_name=n[a],o.country=t.country,o.mallIDlist=r,o.Tesk_follow_number=t.follow_number,o.followed_type=t.followed_type,o.follow_interval=t.follow_interval,o.last_login_day=t.last_login_day,o.min_order_evaluation=t.min_order_evaluation,o})),p=this,this.storeLogList["".concat(t.country)].log_message.push({option:"开始处理关注店铺数据......",activeTime:this.formatTime((new Date).getTime())}),e.next=11,Object(m["c"])(o,this.getFllowerInfo);case 11:this.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.country,"】数据处理结束"),activeTime:this.formatTime((new Date).getTime())});case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getFllowerInfo",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,o,i,s,l,c,u,f,_,g=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=g.length>1&&void 0!==g[1]?g[1]:{count:1},e.prev=1,o=t.mallIDlist,t.following=0,t.fence=0,t.newFollow=0,t.cancerFollow=0,t.state="-",e.next=10,p.isLoginFun(t);case 10:if(i=e.sent,i){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,p.getHomeMallData(t);case 15:if(s=e.sent,s){e.next=19;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】店铺暂无数据"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return");case 19:l=t.newFollow,c=Object(r["a"])(o),e.prev=21,f=regeneratorRuntime.mark((function e(){var a,n,o,i,s,c,f,_,g,d,h,b,w,v,x,k,y,L,S,I,T,N,D,F,$,A,O,M,R,U;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=u.value,!p.isStop){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:if(n={},n["country"]=t.country,n["mallId"]=t.platform_mall_id,n["shopid"]=a,"0"!==t.followed_type){e.next=123;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】正在获取").concat(a,"店铺粉丝信息"),activeTime:p.formatTime((new Date).getTime())}),o=!0,n["offset"]=0,e.next=13,p.GetShopLikes(n);case 13:i=e.sent,p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取第").concat(n.offset/20+1,"页粉丝"),activeTime:p.formatTime((new Date).getTime())}),s=Object(r["a"])(i),e.prev=16,s.s();case 18:if((c=s.n()).done){e.next=56;break}if(f=c.value,!p.isStop){e.next=22;break}return e.abrupt("return",{v:void 0});case 22:return e.next=24,p.filterShopDatas(i,t.country,t.platform_mall_id);case 24:if(_=e.sent,_){e.next=27;break}return e.abrupt("continue",54);case 27:return e.next=29,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),f.ShopId);case 29:if(g=e.sent,!g.attention_shop_id){e.next=32;break}return e.abrupt("continue",54);case 32:return e.next=34,p.runAttention(f,t,a);case 34:if(d=e.sent,!d){e.next=42;break}return l++,e.next=39,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:f.ShopId});case 39:e.sent,e.next=45;break;case 42:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(f.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),o=!1,e.abrupt("continue",54);case 45:if(!Number(t.Tesk_follow_number)){e.next=50;break}if(!(l>=Number(t.Tesk_follow_number))){e.next=48;break}return e.abrupt("return",{v:void 0});case 48:e.next=54;break;case 50:if(!(t.following+l>=3e3)){e.next=54;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增关注").concat(l,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 54:e.next=18;break;case 56:e.next=61;break;case 58:e.prev=58,e.t0=e["catch"](16),s.e(e.t0);case 61:return e.prev=61,s.f(),e.finish(61);case 64:p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增关注").concat(l,"个"),activeTime:p.formatTime((new Date).getTime())});case 65:if(!o){e.next=119;break}if(!p.isStop){e.next=68;break}return e.abrupt("return",{v:void 0});case 68:return n["offset"]+=20,e.next=71,p.GetShopLikes(n);case 71:i=e.sent,p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取第").concat(n.offset/20+1,"页粉丝数据"),activeTime:p.formatTime((new Date).getTime())}),h=0;case 74:if(!(h<i.length)){e.next=113;break}if(!p.isStop){e.next=77;break}return e.abrupt("return",{v:void 0});case 77:return b=i[h],e.next=80,p.filterShopDatas(b,t.country,t.platform_mall_id,t.last_login_day);case 80:if(w=e.sent,w){e.next=83;break}return e.abrupt("continue",110);case 83:return e.next=85,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),b.ShopId);case 85:if(v=e.sent,!v.attention_shop_id){e.next=88;break}return e.abrupt("continue",110);case 88:return e.next=90,p.runAttention(b,t,a);case 90:if(x=e.sent,!x){e.next=98;break}return l++,e.next=95,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:b.ShopId});case 95:e.sent,e.next=100;break;case 98:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(b.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("continue",110);case 100:if(!Number(t.Tesk_follow_number)){e.next=106;break}if(!(l>=Number(t.Tesk_follow_number))){e.next=104;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(l,"个粉丝"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 104:e.next=110;break;case 106:if(!(t.following+l>=3e3)){e.next=110;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(l,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 110:h++,e.next=74;break;case 113:return i.length<20&&(p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(a,"】查找结束"),activeTime:p.formatTime((new Date).getTime())}),o=!1),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(l,"个"),activeTime:p.formatTime((new Date).getTime())}),e.next=117,Object(m["y"])(1e3*Number(t.follow_interval));case 117:e.next=65;break;case 119:p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(l,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】操作结束"),activeTime:that.formatTime((new Date).getTime())}),e.next=226;break;case 123:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】正在获取评价用户信息"),activeTime:p.formatTime((new Date).getTime())}),k=!0,y=[],L=p.mallSearchList.findIndex((function(e){return e.shopid===Number(a)})),S=p.mallSearchList[L].itemid,I=0,p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取").concat(a,"第【").concat(I/52+1,"】页评价用户"),activeTime:p.formatTime((new Date).getTime())}),e.next=132,p.GetShopComment(S,a,t,I);case 132:if(y=e.sent,y.length){e.next=136;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"".concat(a,"暂无用户评价"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return","continue");case 136:T=0;case 137:if(!(T<y.length)){e.next=173;break}return N=y[T],D={},D["ShopId"]=N.author_shopid,D["UserName"]=N.author_username,e.next=144,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),D.ShopId);case 144:if(F=e.sent,!F.attention_shop_id){e.next=147;break}return e.abrupt("continue",170);case 147:return e.next=149,p.runAttention(D,t,N.shopid);case 149:if($=e.sent,!$){e.next=157;break}return l++,e.next=154,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:D.ShopId});case 154:e.sent,e.next=160;break;case 157:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(D.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),k=!1,e.abrupt("continue",170);case 160:if(!Number(t.Tesk_follow_number)){e.next=166;break}if(!(l>=Number(t.Tesk_follow_number))){e.next=164;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注成功"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 164:e.next=170;break;case 166:if(!(t.following+l>=3e3)){e.next=170;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(l,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 170:T++,e.next=137;break;case 173:p.$set(t,"newFollow",l);case 174:if(!k){e.next=224;break}if(!p.isStop){e.next=177;break}return e.abrupt("return",{v:void 0});case 177:return I+=52,p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取").concat(a,"第【").concat(I/52+1,"】页评价用户"),activeTime:p.formatTime((new Date).getTime())}),e.next=181,p.GetShopComment(S,a,t,I);case 181:y=e.sent,A=0;case 183:if(!(A<y.length)){e.next=219;break}if(!p.isStop){e.next=186;break}return e.abrupt("return",{v:void 0});case 186:return O=y[A],M={},M["ShopId"]=O.shopid,M["UserName"]=O.author_username,e.next=192,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),M.ShopId);case 192:if(R=e.sent,!R.attention_shop_id){e.next=195;break}return e.abrupt("continue",216);case 195:return e.next=197,p.runAttention(M,t,a);case 197:if(U=e.sent,!U){e.next=205;break}return l++,e.next=202,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:M.ShopId});case 202:e.sent,e.next=207;break;case 205:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(M.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("continue",216);case 207:if(!Number(t.Tesk_follow_number)){e.next=213;break}if(!(l>=Number(t.Tesk_follow_number))){e.next=211;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注成功"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 211:e.next=216;break;case 213:if(!(t.following+l>=3e3)){e.next=216;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 216:A++,e.next=183;break;case 219:return y.length<52&&(p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】查找结束"),activeTime:p.formatTime((new Date).getTime())}),k=!1),e.next=222,Object(m["y"])(1e3*Number(t.follow_interval));case 222:e.next=174;break;case 224:p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】成功关注").concat(l,"个粉丝"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】操作结束"),activeTime:p.formatTime((new Date).getTime())});case 226:case"end":return e.stop()}}),e,null,[[16,58,61,64]])})),c.s();case 24:if((u=c.n()).done){e.next=33;break}return e.delegateYield(f(),"t0",26);case 26:if(_=e.t0,"continue"!==_){e.next=29;break}return e.abrupt("continue",31);case 29:if("object"!==Object(n["a"])(_)){e.next=31;break}return e.abrupt("return",_.v);case 31:e.next=24;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e["catch"](21),c.e(e.t1);case 38:return e.prev=38,c.f(),e.finish(38);case 41:p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注结束"),activeTime:p.formatTime((new Date).getTime())}),e.next=47;break;case 44:e.prev=44,e.t2=e["catch"](1),p.storeLogList["".concat(t.country)].log_message.push({option:"用户信息获取失败-line373，".concat(e.t2),activeTime:p.formatTime((new Date).getTime())});case 47:return e.prev=47,--a.count,e.finish(47);case 50:case"end":return e.stop()}}),e,null,[[1,44,47,50],[21,35,38,41]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isLoginFun",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.MallAPIInstance.isLogin(t);case 2:if(a=e.sent,200!==a.code||!a.data){e.next=7;break}return e.abrupt("return",!0);case 7:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】店铺未登录"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getHomeMallData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.platform_mall_id,e.next=5,p.MallAPIInstance.UserProfile(a);case 5:if(n=e.sent,200!==n.code){e.next=19;break}return r=n.data.username,a["username"]=r,e.next=11,p.MallAPIInstance.getHomeMallinfo(a);case 11:if(o=e.sent,200!==o.code){e.next=16;break}return e.abrupt("return",o.data);case 16:return e.abrupt("return","");case 17:e.next=20;break;case 19:return e.abrupt("return","");case 20:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getHomeFollowingList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={},n["country"]=t.country,n["mallId"]=t.platform_mall_id,n["offset"]=0,n["mallName"]=t.mall_alias_name||t.platform_mall_name,e.next=7,this.getHomeFllowering(n);case 7:if(r=e.sent,o=r,o.length){e.next=11;break}return e.abrupt("return",[]);case 11:if(!(r.length>=20)){e.next=21;break}if(!this.isStop){e.next=14;break}return e.abrupt("break",21);case 14:return n["offset"]+=20,e.next=17,this.getHomeFllowering(n);case 17:r=e.sent,o=o.concat(r),e.next=11;break;case 21:return e.abrupt("return",o);case 22:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"GetShopLikes",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.mallId,a["shopid"]=t.shopid,a["offset"]=t.offset,a["limit"]=20,a["offset_of_offset"]=0,a["timeStamp"]=(new Date).getTime(),e.next=10,p.MallAPIInstance.getFllower(a);case 10:if(n=e.sent,200!==n.code){e.next=15;break}return e.abrupt("return",n.data);case 15:return p.storeLogList["".concat(t.country)].log_message.push({option:"粉丝获取失败",activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"filterShopDatas",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a,n,r){var o,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.getActiveUser({country:a,mallId:n,userName:t.UserName});case 2:if(o=e.sent,i=new Date((new Date).toLocaleDateString()).getTime(),s=i-i*(Number(r)-1),!(o>s)){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));function t(t,a,n,r){return e.apply(this,arguments)}return t}()},{key:"getActiveUser",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.mallId,a["username"]=t.userName,e.next=6,p.MallAPIInstance.getActiveTimeFollower(a);case 6:if(n=e.sent,200!==n.code){e.next=11;break}return e.abrupt("return",1e3*Number(n.data.last_active_time));case 11:return p.$refs.Logs.writeLog("店铺活跃状态获取失败:".concat(n.message),!1),e.abrupt("return","");case 13:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"runAttention",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a,n){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={},r["country"]=a.country,r["mallId"]=a.platform_mall_id,r["userShopid"]=t.ShopId,r["followMallID"]=n,e.next=7,p.MallAPIInstance.buyerFollow(r);case 7:if(o=e.sent,200===o.code){e.next=12;break}p.storeLogList["".concat(a.country)].log_message.push({option:"【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"失败,").concat(o.message),activeTime:p.formatTime((new Date).getTime())}),e.next=18;break;case 12:if(!o.data){e.next=17;break}return p.storeLogList["".concat(a.country)].log_message.push({option:"【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"成功"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",!0);case 17:p.storeLogList["".concat(a.country)].log_message.push({option:"【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"失败,").concat(o.message),activeTime:p.formatTime((new Date).getTime())});case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e)})));function t(t,a,n){return e.apply(this,arguments)}return t}()},{key:"GetShopComment",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a,n,r){var o,i,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o={},o["mallId"]=n.platform_mall_id,o["country"]=n.country,o["itemid"]=t,o["offset"]=r,o["shopid"]=a,e.next=8,p.MallAPIInstance.getShoppComment(o);case 8:if(i=e.sent,200!==i.code){e.next=15;break}return s=i.data.ratings||[],l=s.filter((function(e){if(e.rating_star>=Number(n.min_order_evaluation))return e})),e.abrupt("return",l);case 15:return p.storeLogList["".concat(n.country)].log_message.push({option:"商品评价获取失败".concat(i.message),activeTime:that.formatTime((new Date).getTime())}),e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e)})));function t(t,a,n,r){return e.apply(this,arguments)}return t}()}]),e}()},e5c5:function(e,t,a){"use strict";a("71a1")},feb6:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ul",{staticClass:"storeChooseUL"},[e.isMall?a("li",[e._v(e._s(e._f("chineseSite")(e.countryVal)))]):a("li",{style:e.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:e.spanWidth}},[e._v("所属站点：")]),a("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:"",disabled:e.isBanPerform},model:{value:e.countryVal,callback:function(t){e.countryVal=t},expression:"countryVal"}},[e.isAll?a("el-option",{attrs:{label:"全部",value:""}}):e._e(),e._l(e.countries,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),a("li",{style:e.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:e.spanWidth}},[e._v("店铺分组：")]),a("el-select",{staticClass:"selectBox",attrs:{disabled:e.isBanPerform,multiple:"","collapse-tags":"",filterable:"",size:"mini"},model:{value:e.groupId,callback:function(t){e.groupId=t},expression:"groupId"}},e._l(e.groupIdList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.group_name,value:e.id}})})),1)],1),a("li",{style:e.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:e.spanWidth}},[e._v("店铺名称：")]),a("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadmoreMall,expression:"loadmoreMall"}],staticClass:"selectBox",attrs:{disabled:e.isBanPerform,placeholder:"",multiple:!e.isAShop,"collapse-tags":"","filter-method":e.filterMall,size:"mini",filterable:"",clearable:""},on:{"visible-change":function(t){return e.filterMall("")}},model:{value:e.site,callback:function(t){e.site=t},expression:"site"}},[e.isAShop?e._e():a("el-option",{attrs:{label:"全部",value:""}}),e._l(e.siteShowList,(function(t,n){return e.showMall(t,n)?a("el-option",{key:n,attrs:{label:t.mall_alias_name||t.platform_mall_name,value:t.platform_mall_id}}):e._e()}))],2)],1),e.isReset?a("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[a("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary",disabled:e.isBanPerform},on:{click:e.reset}},[e._v("　刷　　新　")])],1):e._e()])])},r=[],o=a("1da1"),i=a("b85c"),s=a("2909"),l=(a("96cf"),a("d81d"),a("fb6a"),a("caad"),a("2532"),a("d3b7"),a("25f0"),a("99af"),a("6062"),a("3ca3"),a("ddb0"),a("4de4"),a("159b"),a("c740"),a("7db0"),a("7646")),c=a("2b0e");c["default"].directive("loadmore",{bind:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){this.scrollHeight-this.scrollTop<=this.clientHeight+50?t.value(!0,this):this.scrollTop<30&&t.value(!1,this)}))}});var u={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},parentCountry:{type:String,default:"TH"},isMall:{type:Boolean,default:function(){return!1}},isBanPerform:{type:Boolean,default:function(){return!1}},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}},isAShop:{type:Boolean,default:function(){return!1}}},data:function(){return{isAllowSet1:!0,isAllowSet2:!0,countryVal:null,groupId:[],groupIdList:[],site:[],siteList:[],siteShowList:[],countries:this.$filters.countries_option,mallListAPIInstance:new l["a"](this),isShowName:"",isShowNameAll:!1,showMallNumber:100,mallShowIndex:0,jsonMallData:[],filterMallTime:null}},watch:{siteList:function(e){this.siteShowList=e},countryVal:{handler:function(e,t){this.isShowName="",this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},deep:!0},groupId:{handler:function(e,t){var a=this;if(this.isAllowSet2){this.isShowName="",this.isAllowSet2=!1;var n=t.indexOf("")>-1,r=e.indexOf("")>-1;n!==r?this.groupId=r?Object(s["a"])(this.groupIdList.map((function(e){return e.id}))):[]:r?this.groupId=e.slice(1):this.groupIdList.length>0&&this.groupId.length===this.groupIdList.length-1&&this.groupId.unshift(""),setTimeout((function(){a.isAllowSet2=!0,a.ddMallGoodsGetMallList(2)}),10)}},deep:!0},site:{handler:function(e,t){var a=this;if(this.isAllowSet1){this.isAllowSet1=!1;var n=this.isShowName;if(!this.isAShop){var r=t.includes(""),o=e.includes("");if(r!==o||t.toString()===e.toString()&&this.isShowNameAll)if(o&&(!n||n&&!this.isShowNameAll)){var l=n&&Object(s["a"])(this.siteShowList.map((function(e){return e.platform_mall_id})))||[""].concat(Object(s["a"])(this.siteList.map((function(e){return e.platform_mall_id})))),c=new Set([].concat(Object(s["a"])(l),Object(s["a"])(t)));this.site=Object(s["a"])(c),this.isShowNameAll=!0,n&&this.siteList.length===this.site.length&&this.site.unshift("")}else{this.isShowNameAll=!1;var u=[];if(n){var m=n&&Object(s["a"])(this.siteShowList.map((function(e){return e.platform_mall_id}))),f=m.length>this.site.length&&this.site||m,p=m.length>this.site.length&&m||this.site;u=new Set(this.site);var _,g=Object(i["a"])(p);try{for(g.s();!(_=g.n()).done;){var d=_.value;f.includes(d)&&u.delete(d)}}catch(h){g.e(h)}finally{g.f()}u.delete("")}this.site=Object(s["a"])(u)}else o?this.site=e.slice(1):this.siteList.length>0&&this.siteList.length===this.site.length?this.site.unshift(""):this.isShowNameAll=!1}setTimeout((function(){a.changeMallList(),a.filterMall(n),a.isAllowSet1=!0}),10)}},deep:!0}},mounted:function(){this.countryVal=this.isMall?this.parentCountry:this.isAll?"":"TH"},methods:{reset:function(){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},ddMallGoodsGetMallList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r,o,i,l,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.site=[],n=t.countryVal,r=[],!(t.jsonMallData.length>0)){a.next=7;break}r=t.jsonMallData,a.next=12;break;case 7:return a.next=9,t.$appConfig.temporaryCacheInfo("get","mallAllData","");case 9:o=a.sent,r=JSON.parse(o)||[],t.jsonMallData=JSON.parse(o)||[];case 12:if(!(r.length>0)){a.next=17;break}1===e&&(t.siteList=""===n?r:r.filter((function(e){return e.country===n}))),2===e&&(0===t.groupId.length?t.siteList=[]:(t.siteList=[],t.groupId.forEach((function(e){r.forEach((function(a){n?e===a.group_id&&n===a.country&&t.siteList.push(a):e===a.group_id&&t.siteList.push(a)}))})))),a.next=22;break;case 17:return i={country:"",mallGroupIds:""},a.next=20,t.mallListAPIInstance.ddMallGoodsGetMallList(i);case 20:l=a.sent,200===l.code?(t.$appConfig.temporaryCacheInfo("save","mallAllData",l.data),c=l.data||[],t.siteList=c,t.jsonMallData=c,t.siteList=""===n?c:c.filter((function(e){return e.country===n}))):t.$message.error("获取分组、店铺列表失败");case 22:u=[],0===t.groupIdList.length&&(t.groupIdList=[{group_name:"全部",id:""}],t.siteList.forEach((function(e){var t=u.findIndex((function(t){return t&&t.id===e.group_id}));e.group_name&&t<0&&u.push({group_name:e.group_name,id:e.group_id})})),u.zzSort("id"),t.groupIdList=[].concat(Object(s["a"])(t.groupIdList),u),t.groupId=[""].concat(Object(s["a"])(u.map((function(e){return e.id}))))),setTimeout((function(){t.isAllowSet2=!0,t.isAllowSet1=!0,t.site=!t.isAShop&&[""]||""}),10);case 25:case"end":return a.stop()}}),a)})))()},changeMallList:function(){var e=this,t=[],a="";if(this.isAShop){var n=this.siteList.find((function(t){return t.platform_mall_id===e.site}));a=this.site,t.push(n)}else this.site.forEach((function(n){if(n){var r=e.siteList.find((function(e){return e.platform_mall_id===n}));t.push(r),a+=n+","}}));!this.countryVal&&this.groupId.indexOf("")>-1&&(a=t.length!==this.siteList.length&&a||""),this.source?this.$emit("changeMallList",{mallList:t,source:this.source,searchAll:a,country:this.countryVal.toLocaleUpperCase()}):(t["country"]=this.countryVal,this.$emit("changeMallList",t))},filterMall:function(e){var t=this,a=e&&this.isShowName!==e?1e3:100;this.filterMallTime&&(clearTimeout(this.filterMallTime),this.filterMallTime=null),this.filterMallTime=setTimeout((function(){t.isShowName!==e&&(t.mallShowIndex=0),t.isShowName=e||"";var a=t.siteList;e&&(a=t.siteList.filter((function(t){var a=t.mall_alias_name||t.platform_mall_name;return a.includes(e)}))),t.siteShowList=a}),a)},showMall:function(e,t){var a=e.mall_alias_name||e.platform_mall_name,n=this.site[0]===e.platform_mall_id;return n||this.mallShowIndex<=t&&t<=this.mallShowIndex+this.showMallNumber&&(!this.isShowName||a.includes(this.isShowName))},loadmoreMall:function(e,t){if(this.siteShowList.length>this.showMallNumber){var a=0;e?(a=this.mallShowIndex+10,a=a<this.siteShowList.length-this.showMallNumber&&a||this.siteShowList.length-this.showMallNumber):(a=this.mallShowIndex-10,a=a>0&&a||0),a!==this.mallShowIndex&&(t.scrollTop=e?t.scrollTop-100:30),this.mallShowIndex=a}}}},m=u,f=(a("8992"),a("2877")),p=Object(f["a"])(m,n,r,!1,null,null,null);t["a"]=p.exports}}]);