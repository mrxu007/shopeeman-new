(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e721780"],{"0b640":function(e,t,a){"use strict";a("5c9e")},"5c9e":function(e,t,a){},add3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("div",{staticClass:"condetion",staticStyle:{"background-color":"white",padding:"8px"}},[a("div",{staticClass:"row1"},[a("storeChoose",{staticStyle:{"margin-left":"-20px"},attrs:{"show-mall-all":!0},on:{changeMallList:e.changeMallList}}),a("div",{staticStyle:{"margin-left":"20px"}},[a("label",[e._v("活动：")]),a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),a("el-option",{attrs:{label:"进行中",value:"1"}}),a("el-option",{attrs:{label:"接下来有活动",value:"2"}}),a("el-option",{attrs:{label:"活动已过期",value:"3"}})],1)],1),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},on:{click:e.getTableList}},[e._v("搜索")])],1),a("div",{staticClass:"row2",staticStyle:{"margin-top":"8px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.addProTest}},[e._v("创建运费促销活动")]),a("el-button",{attrs:{size:"mini"},on:{click:e.stopCreate}},[e._v("停止活动创建")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.MallstopTestMul}},[e._v("批量结束勾选活动")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.clearLog}},[e._v("清除日志")]),a("el-checkbox",{staticStyle:{"margin-left":"8px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")]),a("el-checkbox",{model:{value:e.isShowPast,callback:function(t){e.isShowPast=t},expression:"isShowPast"}},[e._v("不显示过期活动")])],1)]),a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}}),a("div",{staticClass:"tableDetail",staticStyle:{"margin-top":"8px"}},[a("u-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{data:e.tableList,height:"800px","use-virtual":"",border:!1,"header-cell-style":{background:"#f7fafa"}},on:{"selection-change":e.handleSelectionChange}},[a("u-table-column",{attrs:{type:"selection",width:"55",fixed:""}}),a("u-table-column",{attrs:{type:"index",fixed:"",label:"序号","min-width":"50px"}}),a("u-table-column",{attrs:{prop:"",label:"站点",align:"center","min-width":"50px",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(e._f("chineseSite")(a.country)))]}}])}),a("u-table-column",{attrs:{prop:"mallName",label:"店铺",align:"center","min-width":"100px"}}),a("u-table-column",{attrs:{prop:"promotion_name",label:"促销名称",align:"center","min-width":"150px"}}),a("u-table-column",{attrs:{prop:"voucher_status",label:"活动状态",align:"center","min-width":"80px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return["进行中"===r.voucher_status?a("span",{staticStyle:{color:"#0ad10a"}},[e._v(e._s(r.voucher_status))]):e._e(),"即将开始"===r.voucher_status?a("span",{staticStyle:{color:"orange"}},[e._v(e._s(r.voucher_status))]):e._e(),"已过期"===r.voucher_status?a("span",[e._v(e._s(r.voucher_status))]):e._e()]}}])}),a("u-table-column",{attrs:{prop:"",label:"促销期间",align:"center","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",[3220050630===r.end_time?a("div",[e._v(" 无限制 ")]):a("div",{staticStyle:{display:"flex","flex-flow":"column"}},[a("span",[e._v(e._s(r.formStartime)+"-")]),a("span",[e._v(e._s(r.formEndtime))])])])]}}])}),a("u-table-column",{attrs:{prop:"deliverWay",label:"运送渠道",align:"center","min-width":"180px"}}),a("u-table-column",{attrs:{prop:"topNum",label:"运费",align:"center","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v("购买满"+e._s(e._f("siteCoin")(r.country))+e._s(r.tiers&&r.tiers[0].min_order_total)+",")]),0===Number(r.tiers[0].discount_delta)?a("span",[e._v("免运费")]):a("span",[e._v("运费减免"+e._s(e._f("siteCoin")(r.country))+e._s(r.tiers&&r.tiers[0].discount_delta))])]}}])}),a("u-table-column",{attrs:{prop:"min_spend",label:"操作",align:"center","min-width":"80px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return["进行中"===r.voucher_status?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.MallstopTest(r)}}},[e._v("停止")]):e._e(),"即将开始"===r.voucher_status?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.MalldelTest(r)}}},[e._v("删除 ")]):e._e()]}}])})],1)],1),a("el-dialog",{staticClass:"edit-group-dialog",attrs:{visible:e.proVisible,width:"860px",top:"5vh",title:"运费促销","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.proVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"160px"}},[a("el-form-item",{attrs:{label:"促销名称"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"字符长度需小于20",size:"mini"},model:{value:e.proName,callback:function(t){e.proName=t},expression:"proName"}})],1),a("el-form-item",{staticStyle:{color:"red"},attrs:{label:"促销时间"}},[a("el-radio-group",{model:{value:e.proTimeType,callback:function(t){e.proTimeType=t},expression:"proTimeType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("无限制")]),a("el-radio",{attrs:{label:"1"}},[e._v("所选的促销期间 "),a("el-date-picker",{staticStyle:{width:"330px"},attrs:{size:"mini","value-format":"timestamp",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.proTime,callback:function(t){e.proTime=t},expression:"proTime"}})],1)],1)],1),a("el-form-item",{attrs:{label:"运输渠道"}},[a("el-checkbox-group",{model:{value:e.deliverWay,callback:function(t){e.deliverWay=t},expression:"deliverWay"}},e._l(e.deliverWayList,(function(t){return a("el-checkbox",{key:t.channelid,attrs:{disabled:e.isDeliverWay,label:t.channelid}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"运费",align:"center"}},[a("el-table",{attrs:{data:e.freightlist,"header-cell-style":{background:"#f7fafa"},"row-style":{height:"60px"}}},[a("el-table-column",{attrs:{type:"index",label:"阶层","max-width":"60px"}}),a("el-table-column",{attrs:{prop:"minCost",label:"最低消费金额",width:"190px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" ￥| "),a("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},on:{blur:function(a){return e.checkMinCost(t.row.minCost)}},model:{value:t.row.minCost,callback:function(a){e.$set(t.row,"minCost",a)},expression:"scope.row.minCost"}}),a("br"),a("span",{staticStyle:{color:"red","margin-top":"-4px"}},[e._v(" "+e._s(e.minCostLimit)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"freight",label:"运费",width:"340px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio-group",{staticClass:"freightType",model:{value:t.row.freightType,callback:function(a){e.$set(t.row,"freightType",a)},expression:"scope.row.freightType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("免运费")]),a("el-radio",{attrs:{label:"0"}},[e._v(" 补贴"+e._s("￥|")+" "),a("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini"},on:{blur:function(a){return e.checkFreightCost(t.row.freight)}},model:{value:t.row.freight,callback:function(a){e.$set(t.row,"freight",a)},expression:"scope.row.freight"}}),a("br"),"0"===t.row.freightType?a("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.freightLimit)+" ")]):e._e()],1)],1)]}}])}),a("el-table-column",{attrs:{prop:"",label:"操作",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e.freightlist.length>1?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.delrule(r)}}},[e._v("删除")]):e._e()]}}])})],1),e.freightlist.length>1?a("span",{staticStyle:{color:"red"}},[e._v(" 请注意，随后的阶级应具有更高的最低消费。更高的最低消费应具有更高的运费回扣，“免运”应运用于最高的最低消费。 ")]):e._e()],1),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"primary",disabled:e.freightlist.length>=3},on:{click:e.addRule}},[e._v("新增促销规则")])],1),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.addProTestFun}},[e._v("保存")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.proVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},n=[],i=a("1da1"),o=(a("96cf"),a("159b"),a("c740"),a("99af"),a("a434"),a("a9e3"),a("b0c0"),a("feb6")),s=a("a254"),l=a("0e0b"),c={components:{storeChoose:o["a"]},data:function(){return{arrList:[],willList:[],doingList:[],pastList:[],isDeliverWay:!1,deliverWayList:[],freightlist:[{minCost:"",freightType:"0",freight:""}],deliverWay:[],proTimeType:"0",proTime:[],proName:"",isShowPast:!0,tableLoading:!1,singerStop:!1,MarketManagerAPIInstance:new s["a"](this),showlog:!0,activeType:"0",tableList:[],proVisible:!1,dialogtitle:"",coupontype:"2",couponName:"",rewardType:"0",discountType:"1",discountNum:"",limitPrice:"0",maxPrice:"",minPrice:"",pickerOptions:{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}},useQuantity:"",couponhide:"0",couponGoodslist:[],selectMallList:[],stoptoping:!1,mallTableSelect:[],getTable:[],minCostLimit:"",freightLimit:""}},created:function(){},methods:{getProDelivery:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={country:e.country,mallId:e.platform_mall_id},a.prev=1,a.next=4,t.MarketManagerAPIInstance.ProDelivery(r);case 4:if(n=a.sent,0!==n.ecode){a.next=13;break}if(i=n.data.data.enabled||[],i.length){a.next=10;break}return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】暂无物流选项"),!1),a.abrupt("return");case 10:t.deliverWayList.length?i.forEach((function(e){var a=t.deliverWayList.findIndex((function(t){return e.channelid===t.channelid}));a<0&&t.deliverWayList.push(e)})):t.deliverWayList=i,a.next=14;break;case 13:t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】物流：").concat(n.message),!1);case 14:a.next=19;break;case 16:a.prev=16,a.t0=a["catch"](1),t.$message.warning("".concat(a.t0));case 19:case"end":return a.stop()}}),a,null,[[1,16]])})))()},delrule:function(e){var t=this.couponGoodslist.findIndex((function(t){return t===e}));this.freightlist.splice(t,1)},save:function(){},addRule:function(){var e={minCost:"",freightType:"0",freight:""};this.freightlist.push(e)},clearLog:function(){this.$refs.Logs.consoleMsg=""},handleSelectionChange:function(e){this.mallTableSelect=e},MallstopTestMul:function(){var e=this;this.mallTableSelect.length?this.$confirm("您确定要结束此运费促销吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.mallTableSelect.length)){t.next=7;break}return t.next=4,e.MallstopTestFun(e.mallTableSelect[a]);case 4:a++,t.next=1;break;case 7:e.getTableList();case 8:case"end":return t.stop()}}),t)})))).catch((function(){})):this.$message.warning("请选择要操作的数据")},MallstopTest:function(e){var t=this;this.$confirm("您确定要结束此运费促销吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.MallstopTestFun(e)})).catch((function(){}))},MallstopTestFun:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={country:e.country,mallId:e.platform_mall_id,datainfo:e},a.prev=1,t.showlog=!1,a.next=5,t.MarketManagerAPIInstance.stopPromotion(r);case 5:n=a.sent,0===n.ecode?(t.$refs.Logs.writeLog("------已停止【".concat(e.promotion_name,"】优惠活动------"),!0),t.$set(e,"voucher_status","已过期"),t.$set(e,"formEndtime",t.formatTime((new Date).getTime())),t.$set(e,"end_time",(new Date).getTime()/1e3)):t.$refs.Logs.writeLog("停止【".concat(e.promotion_name,"】优惠活动,").concat(n.message),!1),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),t.$refs.Logs.writeLog("停止【".concat(e.promotion_name,"】--catch,").concat(a.t0),!1);case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},MalldelTest:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("您确定要删除此运费促销吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.MalldelTestFun(e)})).catch((function(){}));case 1:case"end":return a.stop()}}),a)})))()},MalldelTestFun:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={country:e.country,mallId:e.platform_mall_id,datainfo:e},a.prev=1,t.showlog=!1,a.next=5,t.MarketManagerAPIInstance.stopPromotion(r);case 5:n=a.sent,0===n.ecode?(t.$refs.Logs.writeLog("------已删除【".concat(e.promotion_name,"】优惠活动------"),!0),i=t.tableList.findIndex((function(t){return t===e})),t.tableList.splice(i,1)):t.$refs.Logs.writeLog("删除【".concat(e.promotion_name,"】优惠活动,").concat(n.message),!1),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),t.$refs.Logs.writeLog("删除【".concat(e.promotion_name,"】--catch,").concat(a.t0),!1);case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},stopCreate:function(){Object(l["w"])(),this.$refs.Logs.writeLog("已停止创建")},add0:function(e){return e<10?"0"+e:e},formatTime:function(e){var t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),i=t.getHours(),o=t.getMinutes(),s=t.getSeconds();return a+"-"+this.add0(r)+"-"+this.add0(n)+" "+this.add0(i)+":"+this.add0(o)+":"+this.add0(s)},changeMallList:function(e){this.selectMallList=e},getInfo:function(e){var t=arguments,a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,i,o,s,l,c,u,m,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:{count:1},r.prev=1,i={country:e.country,mallId:e.platform_mall_id,offset:e.offset,limit:10},r.next=5,a.MarketManagerAPIInstance.logisticsPromotion(i);case 5:if(o=r.sent,0===o.ecode){r.next=12;break}return s="","token not found"===o.message&&(s="店铺未登录"),"marketing module no permission"===o.message&&(s="营销无权限模块"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】数据请求失败,").concat(s||o.message),!1),r.abrupt("return");case 12:if(l=0===o.ecode?o.data.data.promotions:[],c=0===o.ecode?o.data.data.channels_info:[],l.length){r.next=17;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】暂无数据")),r.abrupt("return");case 17:if(!l.length){r.next=33;break}for(u=function(t){var r=l[t];r.platform_mall_id=e.platform_mall_id,r.country=e.country,r.mallName=e.mall_alias_name||e.platform_mall_name,r.formStartime=a.formatTime(1e3*r.start_time),r.formEndtime=a.formatTime(1e3*r.end_time);var n=(new Date).getTime();n<1e3*r.start_time?(r.voucher_status="即将开始",a.willList.push(r)):n>1e3*r.start_time&&n<1e3*r.end_time?(r.voucher_status="进行中",a.doingList.push(r)):(r.voucher_status="已过期",a.pastList.push(r));var i=c.findIndex((function(e){return Number(r.channel_ids[0])===Number(e.channel_id)}));r.deliverWay=c[i].name,r.channalData=c[i],a.arrList.push(r)},m=0;m<l.length;m++)u(m);if(a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】总数据：").concat(o.data.data.total_num,"条,正在请求第【").concat(i.offset/i.limit+1,"】页"),!0),!(l.length<i.limit)){r.next=25;break}l.length=[],r.next=31;break;case 25:return i.offset=i.offset+i.limit,r.next=28,a.MarketManagerAPIInstance.logisticsPromotion(i);case 28:p=r.sent,l=0===p.data.code?p.data.data.promotions:[],c=0===p.data.code?p.data.data.channels_info:[];case 31:r.next=17;break;case 33:a.isShowPast?"0"===a.activeType?a.getTable=a.willList.concat(a.doingList):"1"===a.activeType?a.getTable=a.doingList:"2"===a.activeType?a.getTable=a.willList:a.getTable=[]:("1"===a.activeType&&(a.getTable=a.doingList),"2"===a.activeType&&(a.getTable=a.willList),"3"===a.activeType&&(a.getTable=a.pastList),"0"===a.activeType&&(a.getTable=a.arrList)),r.next=39;break;case 36:r.prev=36,r.t0=r["catch"](1),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】--catch，").concat(r.t0),!1);case 39:return r.prev=39,n.count--,r.finish(39);case 42:case"end":return r.stop()}}),r,null,[[1,36,39,42]])})))()},getTableList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$refs.multipleTable.clearSelection(),e.selectMallList.forEach((function(e){e.offset=0,e.prizeList=[]})),e.getTable=[],e.arrList=[],e.willList=[],e.doingList=[],e.pastList=[],e.showlog=!1,e.tableLoading=!0,e.$refs.Logs.writeLog("正在请求数据......",!0),t.next=12,Object(l["c"])(e.selectMallList,e.getInfo);case 12:t.sent,e.$refs.Logs.writeLog("请求数据结束"),e.tableLoading=!1,e.tableList=e.getTable;case 16:case"end":return t.stop()}}),t)})))()},checkMinCost:function(e){!Number(e)||Number(e)>1e4?this.minCostLimit="最低消费金额范围0 -30000":this.minCostLimit=""},checkFreightCost:function(e){!Number(e)||Number(e)>1500?this.freightLimit="最低消费金额范围0 -1500":this.freightLimit=""},addProTest:function(){if(this.showlog=!0,this.selectMallList.length){this.proVisible=!0,this.deliverWayList=[];for(var e=0;e<this.selectMallList.length;e++)this.getProDelivery(this.selectMallList[e])}else this.$message.warning("请选择需要创建的店铺")},addProTestFun:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.proName&&!(e.proName.length>20)){t.next=3;break}return e.$message.warning("促销名称不能为空，且不能大于20个字符"),t.abrupt("return");case 3:if(e.proTime.length&&e.proTimeType,"1"!==e.proTimeType){t.next=15;break}if(e.proTime.length){t.next=8;break}return e.$message.warning("请选择活动有效时间"),t.abrupt("return");case 8:if(a=(new Date).getTime(),!(a>Number(e.proTime[0]))){t.next=12;break}return e.$message.warning("请输入比当前较晚的开始时间"),t.abrupt("return");case 12:if(!Number(e.proTime[1]-Number(e.proTime[0])<36e5)){t.next=15;break}return e.$message.warning("结束时间至少比开始时间晚一个小时"),t.abrupt("return");case 15:if(e.deliverWay.length){t.next=18;break}return e.$message.warning("运输渠道不能为空"),t.abrupt("return");case 18:r=0;case 19:if(!(r<e.freightlist.length)){t.next=27;break}if(n=e.freightlist[r],n.minCost&&("0"!==n.freightType||n.freight)){t.next=24;break}return e.$message.warning("请设置运费规则"),t.abrupt("return");case 24:r++,t.next=19;break;case 27:if(!e.freightlist.length){t.next=43;break}i=0;case 29:if(!(i<e.freightlist.length)){t.next=43;break}if(!(i>=1)){t.next=40;break}if(!(e.freightlist[i].minCost>=e.freightlist[i-1].minCost)){t.next=34;break}return e.$message.warning("多层最低消费金额应小于上一层最低消费金额"),t.abrupt("return");case 34:if("1"===e.freightlist[0].freightType||"1"!==e.freightlist[i].freightType){t.next=37;break}return e.$message.warning("免运费应在最高层使用"),t.abrupt("return");case 37:if(!("0"!==e.freightlist[0].freightType&&e.freightlist[i].freight>=e.freightlist[i-1].freight)){t.next=40;break}return e.$message.warning("多层运费金额应小于上一层运费金额"),t.abrupt("return");case 40:i++,t.next=29;break;case 43:return e.proVisible=!1,e.showlog=!1,e.$refs.Logs.writeLog("正在创建任务......"),t.next=48,Object(l["c"])(e.selectMallList,e.createPromiton);case 48:t.sent,e.$refs.Logs.writeLog("创建任务结束"),e.getTableList();case 51:case"end":return t.stop()}}),t)})))()},createPromiton:function(e){var t=arguments,a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,i,o,s,l,c,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:{count:1},i="",o="","0"===a.proTimeType?(i=Math.floor((new Date).getTime()/1e3),o=3220050630):(i=Math.floor(Number(a.proTime[0])/1e3),o=Math.floor(Number(a.proTime[1])/1e3)),s=[],a.freightlist.forEach((function(e,t){var a={discount_flag:"0"===e.freightType?2:4,placeholder:"",index:t,min_order_total:Number(e.minCost),discount_delta:"0"===e.freightType?0:Number(e.freight)};s.push(a)})),r.prev=6,l={country:e.country,mallId:e.platform_mall_id,start_time:i,end_time:o,tiers:s,channel_ids:[Number(a.deliverWay)],promotion_name:a.proName},r.next=10,a.MarketManagerAPIInstance.checkPromotionTest(l);case 10:c=r.sent,0!==c.ecode?(u="",1400109500===c.data.code&&(u="所选期间与该店铺的其他活动期间重叠"),1400101105===c.data.code&&(u="运输渠道未知"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建失败：").concat(u||c.message),!1)):a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建成功"),!0),r.next=17;break;case 14:r.prev=14,r.t0=r["catch"](6),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建失败：").concat(r.t0,"};"),!1);case 17:return r.prev=17,n.count--,r.finish(17);case 20:case"end":return r.stop()}}),r,null,[[6,14,17,20]])})))()}}},u=c,m=(a("0b640"),a("2877")),p=Object(m["a"])(u,r,n,!1,null,"d7a63540",null);t["default"]=p.exports},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var r=a("06c5");function n(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=Object(r["a"])(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(l)throw o}}}}}}]);