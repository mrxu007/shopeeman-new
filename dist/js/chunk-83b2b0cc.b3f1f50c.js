(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-83b2b0cc"],{4968:function(e,t,a){"use strict";a("9f41")},"4c28":function(e,t,a){},"559d":function(e,t,a){},"71a1":function(e,t,a){},"890e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("ul",[a("li",[a("storeChoose",{staticStyle:{"margin-left":"-2px"},on:{changeMallList:e.changeMallList}}),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clearLog}},[e._v("清除日志")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setQurey}},[e._v("参数设置")]),a("el-checkbox",{staticStyle:{"margin-top":"5px","margin-left":"5px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")])],1),a("li",{staticClass:"row2"},[a("el-row",{attrs:{gutter:25}},[a("el-col",{attrs:{span:15}},[a("ul",[a("li",{staticStyle:{"align-items":"center","margin-bottom":"5px"}},[a("label",{staticStyle:{width:"128px"}},[e._v("店铺ID信息：")]),a("el-input",{attrs:{type:"textarea",resize:"none",rows:3,placeholder:"请输入内容"},model:{value:e.mallIDinfo,callback:function(t){e.mallIDinfo=t},expression:"mallIDinfo"}}),a("div",[a("el-button",{staticStyle:{"margin-left":"10px","margin-bottom":"5px"},attrs:{type:"primary",size:"mini"},on:{click:e.addCancerMall}},[e._v("添加关注店铺 ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clearMallIDinfo}},[e._v("清空店铺信息")])],1)],1),a("li",{staticStyle:{"margin-left":"80px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.startCancer}},[e._v("开始关注")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.stopSet}},[e._v("取消操作")])],1)])]),a("el-col",{attrs:{span:9}},[a("div",{staticClass:"grid-content bg-purple"}),a("ul",[a("li",[a("el-button",{staticStyle:{width:"105px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.Unfollower(1)}}},[e._v("开始取关")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.stopSet}},[e._v("取消操作")])],1),a("li",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.Unfollower(0)}}},[e._v("取关所有用户")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.canCerFollowUnFollowMe}},[e._v("取关未关注我的用户")])],1),a("li",{staticStyle:{height:"30px"}})])])],1)],1),a("li",{staticStyle:{color:"red"}},[e._v("温馨提示：关注用户或者取关啊用户后，获取到的关注用户量和粉丝量可能不准确，有缓存（shopee官网缓存），请稍后查看。")]),a("li",[a("el-table",{attrs:{"header-cell-style":{background:"#f7fafa"},data:e.tableList,"row-style":{height:"50px"},height:"calc(100vh - 220px)"}},[a("el-table-column",{attrs:{type:"index",label:"序列号","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"",label:"站点","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(e._f("chineseSite")(a.country)))]}}])}),a("el-table-column",{attrs:{prop:"",label:"店铺名","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.mall_alias_name||a.platform_mall_name))]}}])}),a("el-table-column",{attrs:{prop:"following",label:"关注中","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.following)?Number(a.following):"-"))]}}])}),a("el-table-column",{attrs:{prop:"fence",label:"粉丝","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.fence)?Number(a.fence):"-"))]}}])}),a("el-table-column",{attrs:{prop:"newFollow",label:"新增关注数量","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.newFollow)?Number(a.newFollow):"-"))]}}])}),a("el-table-column",{attrs:{prop:"cancerFollow",label:"取关数量","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(Number(a.cancerFollow)?Number(a.cancerFollow):"-"))]}}])}),a("el-table-column",{attrs:{prop:"state",label:"操作状态","min-width":"150px",align:"center"}})],1)],1)]),a("div",{staticClass:"dialog_shell"},[a("el-dialog",{staticClass:"dialog_mall",attrs:{title:"店铺搜索",visible:e.dialog_mallSearch,width:"1000px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialog_mallSearch=t}}},[a("ul",[a("li",[a("label",[e._v("关键词")]),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("label",[e._v("评论数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.minComment,callback:function(t){e.minComment=t},expression:"minComment"}}),e._v(" - "),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.maxComment,callback:function(t){e.maxComment=t},expression:"maxComment"}}),a("label",[e._v("点赞数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.minLike,callback:function(t){e.minLike=t},expression:"minLike"}}),e._v(" - "),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.maxLike,callback:function(t){e.maxLike=t},expression:"maxLike"}})],1),a("li",[a("label",[e._v("评分数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.minScore,callback:function(t){e.minScore=t},expression:"minScore"}}),e._v(" - "),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.maxScore,callback:function(t){e.maxScore=t},expression:"maxScore"}}),a("label",{staticStyle:{"margin-left":"50px"}},[e._v("店铺数")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.mallNum,callback:function(t){e.mallNum=t},expression:"mallNum"}}),a("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",size:"mini"},on:{click:e.searchMall}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addTargetMall}},[e._v("添加勾选店铺")])],1),a("li",[a("el-table",{attrs:{"header-cell-style":{background:"#f7fafa"},data:e.mallSearchList,"row-style":{height:"50px"},"max-height":"400"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",width:"50",type:"selection"}}),a("el-table-column",{attrs:{align:"center",label:"序号",width:"55",type:"index"}}),a("el-table-column",{attrs:{prop:"shopid",label:"店铺ID",width:"120px",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"产品标题","min-width":"150px",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"",label:"主图",width:"80px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tooltip",{staticStyle:{width:"50px",height:"50px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e._f("imageRender")([n.image])}})],1),a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e._f("imageRender")([n.image,!0])}})],1)]}}])}),a("el-table-column",{attrs:{prop:"liked_count",label:"点赞数",width:"100px",align:"center",fixed:"right"}}),a("el-table-column",{attrs:{prop:"totalRate",label:"评论数",width:"100px",align:"center",fixed:"right"}}),a("el-table-column",{attrs:{prop:"rating_star",label:"产品评分",width:"80px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.item_rating.rating_star.toFixed(2)))]}}])}),a("el-table-column",{attrs:{prop:"",label:"操作",width:"200px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.open(n)}}},[e._v("查看产品")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.addMallIDinfo(n)}}},[e._v("添加店铺")])]}}])})],1)],1)])]),a("el-dialog",{staticClass:"dialog_mall",attrs:{title:"用户设置",visible:e.dialog_userInfo,width:"700px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialog_userInfo=t}}},[a("autoFollow",{attrs:{"user-info":e.userInfo,mall:e.selmallList},on:{isSave:e.setSave}})],1)],1),a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}})],1)},r=[],o=a("53ca"),i=a("2909"),l=a("b85c"),s=a("1da1"),c=a("5530"),u=(a("96cf"),a("159b"),a("caad"),a("2532"),a("99af"),a("3ca3"),a("ddb0"),a("a9e3"),a("d3b7"),a("25f0"),a("4ec9"),a("4de4"),a("b680"),a("a434"),a("ac1f"),a("1276"),a("d81d"),a("c740"),a("feb6")),m=a("cf9f"),f=a("f68b"),p=a("0e0b"),_=a("d1dd"),g={name:"BusinessAnalyseGoodsDiscount",components:{StoreChoose:u["a"],autoFollow:m["a"]},data:function(){return{AutoAddFenceInstance:new _["a"](this),MallAPIInstance:new f["a"](this),selmallList:[],isSave:!1,dialog_userInfo:!1,userInfo:{},mallIDinfo:"",showlog:!1,tableList:[],dialog_mallSearch:!1,keyword:"",minComment:"50",maxComment:"5000",minLike:"100",maxLike:"10000",minScore:"4.5",maxScore:"5",mallNum:"10",mallSearchList:[],sel_mallSearchList:[],isStop:!1}},watch:{selmallList:{handler:function(e){var t=this;this.tableList=[],e.length&&e.forEach((function(e){var a=Object(c["a"])({},e);a["following"]=0,a["fence"]=0,a["newFollow"]=0,a["cancerFollow"]=0,a["state"]="-",t.tableList.push(a)}))},deep:!0}},created:function(){},mounted:function(){this.getUserinfo()},methods:{addMallIDinfo:function(e){this.mallIDinfo=this.mallIDinfo.includes(e.shopid)?this.mallIDinfo:this.mallIDinfo+","+e.shopid,","===this.mallIDinfo.substr(0,1)&&(this.mallIDinfo=this.mallIDinfo.substr(1))},clearMallIDinfo:function(){this.mallIDinfo=""},canCerFollowUnFollowMe:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.showlog=!1,e.isStop=!1,e.tableList.length){t.next=5;break}return e.$message.warning("请选择要操作的数据"),t.abrupt("return");case 5:return e.userInfo.auto_attention_set||e.$message.warning("请先设置参数"),e.$refs.Logs.writeLog("正在执行数据.....",!0),t.next=9,Object(p["d"])(e.tableList,e.canCerFollowUnFollowMeFun);case 9:e.$refs.Logs.writeLog("数据执行结束",!0);case 10:case"end":return t.stop()}}),t)})))()},canCerFollowUnFollowMeFun:function(e){var t=arguments,a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,i,s,c,u,m,f,p,_,g,d,b,h,w,v,x,k,y;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,a.$refs.Logs.writeLog("当前操作店铺：【".concat(e.mall_alias_name||e.platform_mall_name,"】"),!0),n.next=5,a.isLogin(e);case 5:if(o=n.sent,o){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,a.getHomeMallData(e);case 10:if(i=n.sent,a.$set(e,"following",i?i.account.following_count:0),a.$set(e,"fence",i?i.follower_count:0),i){n.next=16;break}return a.$refs.Logs.writeLog("店铺暂无数据"),n.abrupt("return");case 16:return s={},s["country"]=e.country,s["mallId"]=e.platform_mall_id,s["shopid"]=e.platform_mall_id,s["offset"]=0,n.next=23,a.GetShopLikes(s);case 23:c=n.sent,u=c;case 25:if(20!==c.length){n.next=36;break}if(!a.isStop){n.next=28;break}return n.abrupt("break",36);case 28:return s["offset"]+=20,a.$refs.Logs.writeLog("店铺第【".concat(s.offset/20+1,"】页粉丝获取"),!0),n.next=32,a.GetShopLikes(s);case 32:c=n.sent,u=u.concat(c),n.next=25;break;case 36:return a.$refs.Logs.writeLog("店铺粉丝获取结束",!0),console.log("99999",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取店铺关注"),!0),m=0,f={},f["country"]=e.country,f["mallId"]=e.platform_mall_id,f["offset"]=0,f["mallName"]=e.mall_alias_name||e.platform_mall_name,n.next=47,a.getHomeFllowering(f);case 47:if(p=n.sent,p.length){n.next=51;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无关注"),!0),n.abrupt("return");case 51:_=null,g=null,d=Object(l["a"])(p),n.prev=54,h=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=b.value,!a.isStop){t.next=3;break}return t.abrupt("return","break");case 3:if(!u.length){t.next=8;break}if(_=u.indexOf((function(e){return Number(e.userid)===Number(n.userid)})),console.log("fence",_),!(_>=0)){t.next=8;break}return t.abrupt("return","continue");case 8:return t.next=10,a.runCancerAttention(n,e,e.platform_mall_id);case 10:g=t.sent,g&&m++;case 12:case"end":return t.stop()}}),t)})),d.s();case 57:if((b=d.n()).done){n.next=66;break}return n.delegateYield(h(),"t0",59);case 59:if(w=n.t0,"break"!==w){n.next=62;break}return n.abrupt("break",66);case 62:if("continue"!==w){n.next=64;break}return n.abrupt("continue",64);case 64:n.next=57;break;case 66:n.next=71;break;case 68:n.prev=68,n.t1=n["catch"](54),d.e(n.t1);case 71:return n.prev=71,d.f(),n.finish(71);case 74:if(!(p.length>=20)){n.next=105;break}if(!a.isStop){n.next=77;break}return n.abrupt("break",105);case 77:return f["offset"]+=20,n.next=80,a.getHomeFllowering(f);case 80:p=n.sent,v=Object(l["a"])(p),n.prev=82,k=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=x.value,!a.isStop){t.next=3;break}return t.abrupt("return","break");case 3:if(!u.length){t.next=7;break}if(_=u.indexOf((function(e){return Number(e.userid)===Number(n.userid)})),!(_>=0)){t.next=7;break}return t.abrupt("return","continue");case 7:return t.next=9,a.runCancerAttention(n,e,e.platform_mall_id);case 9:g=t.sent,g&&m++;case 11:case"end":return t.stop()}}),t)})),v.s();case 85:if((x=v.n()).done){n.next=94;break}return n.delegateYield(k(),"t2",87);case 87:if(y=n.t2,"break"!==y){n.next=90;break}return n.abrupt("break",94);case 90:if("continue"!==y){n.next=92;break}return n.abrupt("continue",92);case 92:n.next=85;break;case 94:n.next=99;break;case 96:n.prev=96,n.t3=n["catch"](82),v.e(n.t3);case 99:return n.prev=99,v.f(),n.finish(99);case 102:a.$set(e,"cancerFollow",m),n.next=74;break;case 105:a.$set(e,"cancerFollow",m),a.$refs.Logs.writeLog("成功取关【".concat(m,"】个用户"),!0),a.$refs.Logs.writeLog("店铺执行结束",!0),n.next=113;break;case 110:n.prev=110,n.t4=n["catch"](1),console.log("354line-".concat(n.t4));case 113:return n.prev=113,--r.count,n.finish(113);case 116:case"end":return n.stop()}}),n,null,[[1,110,113,116],[54,68,71,74],[82,96,99,102]])})))()},stopSet:function(){this.isStop=!0,Object(p["B"])(),this.$refs.Logs.writeLog("正在取消操作")},isLogin:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.MallAPIInstance.isLogin(e);case 2:if(n=a.sent,200!==n.code||!n.data){a.next=7;break}return a.abrupt("return",!0);case 7:return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺未登录"),!1),a.abrupt("return",!1);case 9:case"end":return a.stop()}}),a)})))()},Unfollower:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.tableList.length){a.next=3;break}return t.$message.warning("请选择要操作的店铺"),a.abrupt("return");case 3:return t.userInfo.auto_attention_set||t.$message.warning("请先设置参数"),t.tableList.forEach((function(t){t.type=e;var a=Object(c["a"])({},t);a["following"]=0,a["fence"]=0,a["newFollow"]=0,a["cancerFollow"]=0,a["state"]="-"})),t.isStop=!1,t.showlog=!1,a.next=9,Object(p["d"])(t.tableList,t.UnfollowerFun);case 9:case"end":return a.stop()}}),a)})))()},UnfollowerFun:function(e){var t=arguments,a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,i,s,c,u,m,f,p,_,g,d,b,h,w,v;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,n.next=4,a.isLogin(e);case 4:if(o=n.sent,o){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,a.getHomeMallData(e);case 9:if(i=n.sent,a.$set(e,"following",i?i.account.following_count:0),a.$set(e,"fence",i?i.follower_count:0),i){n.next=15;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无数据")),n.abrupt("return");case 15:return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第一页关注")),s={},s["country"]=e.country,s["mallId"]=e.platform_mall_id,s["offset"]=0,s["mallName"]=e.mall_alias_name||e.platform_mall_name,c=0,n.next=24,a.getHomeFllowering(s);case 24:if(u=n.sent,u.length){n.next=28;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无关注")),n.abrupt("return");case 28:m=u.length,console.log("217",u),f=null,p=Object(l["a"])(u),n.prev=32,p.s();case 34:if((_=p.n()).done){n.next=69;break}if(g=_.value,!a.isStop){n.next=38;break}return n.abrupt("return");case 38:if(0!==e.type&&Number(a.userInfo.auto_attention_set.CancelFollowNumber)){n.next=49;break}return n.next=41,a.runCancerAttention(g,e,e.platform_mall_id);case 41:if(f=n.sent,!f){n.next=46;break}c++,n.next=47;break;case 46:return n.abrupt("continue",67);case 47:n.next=67;break;case 49:return n.next=51,a.filterShopDatas(g,e.country,e.platform_mall_id);case 51:if(d=n.sent,d){n.next=56;break}return n.abrupt("continue",67);case 56:return n.next=58,a.runCancerAttention(g,e,e.platform_mall_id);case 58:if(f=n.sent,!f){n.next=66;break}if(c++,!(c>=Number(a.userInfo.auto_attention_set.CancelFollowNumber))){n.next=64;break}return m=0,n.abrupt("break",69);case 64:n.next=67;break;case 66:return n.abrupt("continue",67);case 67:n.next=34;break;case 69:n.next=74;break;case 71:n.prev=71,n.t0=n["catch"](32),p.e(n.t0);case 74:return n.prev=74,p.f(),n.finish(74);case 77:a.$set(e,"cancerFollow",c);case 78:if(!(m>=20)){n.next=137;break}if(!a.isStop){n.next=81;break}return n.abrupt("return");case 81:return s["offset"]+=20,n.next=84,a.getHomeFllowering(s);case 84:u=n.sent,console.log("385",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(s.offset/20+1,"页关注")),m=u.length,b=Object(l["a"])(u),n.prev=89,b.s();case 91:if((h=b.n()).done){n.next=126;break}if(w=h.value,!a.isStop){n.next=95;break}return n.abrupt("return");case 95:if(0!==e.type&&Number(a.userInfo.auto_attention_set.CancelFollowNumber)){n.next=106;break}return n.next=98,a.runCancerAttention(w,e,e.platform_mall_id);case 98:if(f=n.sent,!f){n.next=103;break}c++,n.next=104;break;case 103:return n.abrupt("continue",124);case 104:n.next=124;break;case 106:return n.next=108,a.filterShopDatas(w,e.country,e.platform_mall_id);case 108:if(v=n.sent,v){n.next=113;break}return n.abrupt("continue",124);case 113:return n.next=115,a.runCancerAttention(w,e,e.platform_mall_id);case 115:if(f=n.sent,!f){n.next=123;break}if(c++,!(c>=Number(a.userInfo.auto_attention_set.CancelFollowNumber))){n.next=121;break}return m=0,n.abrupt("break",126);case 121:n.next=124;break;case 123:return n.abrupt("continue",124);case 124:n.next=91;break;case 126:n.next=131;break;case 128:n.prev=128,n.t1=n["catch"](89),b.e(n.t1);case 131:return n.prev=131,b.f(),n.finish(131);case 134:a.$set(e,"cancerFollow",c),n.next=78;break;case 137:a.$set(e,"cancerFollow",c),a.$set(e,"state","操作结束"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】取关【").concat(c,"】个粉丝")),n.next=145;break;case 142:n.prev=142,n.t2=n["catch"](1),console.log("318-".concat(n.t2));case 145:return n.prev=145,--r.count,n.finish(145);case 148:case"end":return n.stop()}}),n,null,[[1,142,145,148],[32,71,74,77],[89,128,131,134]])})))()},getHomeMallData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.platform_mall_id,a.next=5,t.MallAPIInstance.UserProfile(n);case 5:if(r=a.sent,200!==r.code){a.next=20;break}return o=r.data.username,n["username"]=o,a.next=11,t.MallAPIInstance.getHomeMallinfo(n);case 11:if(i=a.sent,200!==i.code){a.next=16;break}return a.abrupt("return",i.data);case 16:return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】主页详情获取失败，").concat(i.message),!1),a.abrupt("return","");case 18:a.next=22;break;case 20:return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】用户名获取失败，").concat(r.message),!1),a.abrupt("return","");case 22:case"end":return a.stop()}}),a)})))()},getHomeFllowering:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["offset"]=e.offset,n["limit"]=20,n["offset_of_offset"]=0,n["timeStamp"]=(new Date).getTime(),a.next=9,t.MallAPIInstance.getFllowering(n);case 9:if(r=a.sent,200!==r.code){a.next=15;break}return t.$refs.Logs.writeLog("【".concat(e.mallName,"】第【").concat(e.offset/20+1,"】页获取成功"),!0),a.abrupt("return",r.data);case 15:return t.$refs.Logs.writeLog("【".concat(e.mallName,"】获取失败，").concat(r.message),!1),a.abrupt("return",[]);case 17:case"end":return a.stop()}}),a)})))()},open:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.tableList[0].country,r={mallId:e.shopid.toString()},a.next=4,t.$shopeemanService.getWebUrlLocal(n,r);case 4:o=a.sent,t.$BaseUtilService.openUrl("".concat(o,"/product/").concat(e.shopid,"/").concat(e.itemid));case 6:case"end":return a.stop()}}),a)})))()},test:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.AutoAddFenceInstance.autoAddFenceActive();case 1:case"end":return t.stop()}}),t)})))()},addCancerMall:function(){this.tableList.length?this.dialog_mallSearch=!0:this.$message.warning("请先设置参数")},searchMallInstance:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["by"]="relevancy",n["keyword"]=t.keyword,n["limit"]=60,n["newest"]=e.newest,n["order"]="desc",n["page_type"]="search",console.log("479",t.userInfo),n["rating_filter"]=t.userInfo.auto_attention_set.MinOrderEvaluation,a.prev=11,a.next=14,t.MallAPIInstance.addCancerMall(n);case 14:if(r=a.sent,200!==r.status){a.next=19;break}return a.abrupt("return",JSON.parse(r.data).items);case 19:return t.$refs.Logs.writeLog("店铺搜索请求失败,230-line:".concat(r.status||"请求超时"),!1),a.abrupt("return",[]);case 21:a.next=27;break;case 23:return a.prev=23,a.t0=a["catch"](11),t.$refs.Logs.writeLog("店铺搜索请求失败,234-line:".concat(a.t0),!1),a.abrupt("return",[]);case 27:case"end":return a.stop()}}),a,null,[[11,23]])})))()},filterList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=[],r=new Map,e.forEach((function(e){r.has(e.item_basic.itemid)||r.has(e.item_basic.shopid)||r.set(e.itemid,e)})),n=Object(i["a"])(r.values()),o=n.filter((function(e){var a=null,n=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t}));if(a=Number(e.item_basic.liked_count)>=Number(t.minLike)&&Number(e.item_basic.liked_count)<=Number(t.maxLike)&&e.item_basic.item_rating.rating_star.toFixed(2)>=Number(t.minScore)&&e.item_basic.item_rating.rating_star.toFixed(2)<=Number(t.maxScore)&&n>=Number(t.minComment)&&n<=Number(t.maxComment)&&e.item_basic.stock>=Number(t.userInfo.auto_attention_set.ProductMax),a)return e})),a.abrupt("return",o);case 6:case"end":return a.stop()}}),a)})))()},searchMall:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,n,r,o,l,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t.userInfo),t.keyword){e.next=4;break}return t.$message.warning("请输入关键字"),e.abrupt("return");case 4:if(t.showlog=!1,t.$refs.Logs.writeLog("正在获取店铺信息......",!0),a=Number(t.mallNum),!(a>=0)){e.next=42;break}n=[],r=0;case 10:if(!(r<a)){e.next=39;break}return o={},o["country"]=t.tableList[0].country,o["mallId"]=t.tableList[0].platform_mall_id,o["newest"]=60*r,e.next=17,t.searchMallInstance(o);case 17:if(l=e.sent,l.length){e.next=21;break}return t.$refs.Logs.writeLog("暂无数据",!0),e.abrupt("return");case 21:if(console.log("310",l),!l.length){e.next=36;break}return e.next=25,t.filterList(l);case 25:if(s=e.sent,console.log("299",s),!s.length){e.next=34;break}if((c=n).push.apply(c,Object(i["a"])(s)),!(n.length>=a)){e.next=32;break}return n=n.splice(0,a),e.abrupt("break",39);case 32:e.next=36;break;case 34:return t.$refs.Logs.writeLog("此关键词暂无更多数据！"),e.abrupt("break",39);case 36:r++,e.next=10;break;case 39:t.$refs.Logs.writeLog("店铺搜索获取结束"),t.mallSearchList=[],n.forEach((function(e){e.item_basic.totalRate=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t})),t.mallSearchList.push(e.item_basic)}));case 42:case"end":return e.stop()}}),e)})))()},addTargetMall:function(e){if(this.sel_mallSearchList.length){var t=[];this.sel_mallSearchList.forEach((function(e){t.push(e.shopid)})),this.mallIDinfo=t.toString(),this.dialog_mallSearch=!1}else this.$message.warning("请选择店铺")},startCancer:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.mallIDinfo){t.next=3;break}return e.$message.warning("请先获取关注店铺"),t.abrupt("return");case 3:return e.userInfo.auto_attention_set||e.$message.warning("请先设置参数"),e.isStop=!1,e.showlog=!1,e.$refs.Logs.writeLog("数据正在处理......",!0),a=e.mallIDinfo.split(","),e.tableList.map((function(e){e["mallIDlist"]=a})),t.next=11,Object(p["d"])(e.tableList,e.getFllowerInfo);case 11:e.$refs.Logs.writeLog("数据处理结束",!0);case 12:case"end":return t.stop()}}),t)})))()},getFllowerInfo:function(e){var t=arguments,a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,i,s,c,u,m,f,_,g;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,i=e.mallIDlist,a.$set(e,"following",0),a.$set(e,"fence",0),a.$set(e,"newFollow",0),a.$set(e,"cancerFollow",0),a.$set(e,"state","-"),a.$refs.Logs.writeLog("正在查询【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺关注信息")),n.next=11,a.isLogin(e);case 11:if(s=n.sent,s){n.next=15;break}return a.$set(e,"state","店铺未登录"),n.abrupt("return");case 15:return n.next=17,a.getHomeMallData(e);case 17:if(c=n.sent,a.$set(e,"following",c?c.account.following_count:0),a.$set(e,"fence",c?c.follower_count:0),console.log("111111",c.account.following_count,c.follower_count),c){n.next=25;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无数据"),!0),a.$set(e,"state","店铺数据请求失败"),n.abrupt("return");case 25:u=Number(e.newFollow),m=Object(l["a"])(i),n.prev=27,_=regeneratorRuntime.mark((function t(){var n,r,o,i,s,c,m,_,g,d,b,h,w,v,x,k,y,L,S,I,T,N,F,D,$,O,A,U,M,R;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=f.value,!a.isStop){t.next=4;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 4:if(r={},r["country"]=e.country,r["mallId"]=e.platform_mall_id,r["shopid"]=n,"0"!==a.userInfo.auto_attention_set.FollowType){t.next=135;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】正在获取").concat(n,"店铺粉丝信息"),!0),o=!0,r["offset"]=0,t.next=14,a.GetShopLikes(r);case 14:i=t.sent,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(r.offset/20+1,"页粉丝")),s=Object(l["a"])(i),t.prev=17,s.s();case 19:if((c=s.n()).done){t.next=63;break}if(m=c.value,!a.isStop){t.next=24;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 24:return t.next=26,a.filterShopDatas(i,e.country,e.platform_mall_id);case 26:if(_=t.sent,_){t.next=29;break}return t.abrupt("continue",61);case 29:return t.next=31,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),m.ShopId);case 31:if(g=t.sent,!g.attention_shop_id){t.next=34;break}return t.abrupt("continue",61);case 34:return t.next=36,a.runAttention(m,e,n);case 36:if(d=t.sent,!d){t.next=45;break}return u++,a.$set(e,"newFollow",u),t.next=42,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:m.ShopId});case 42:t.sent,t.next=50;break;case 45:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(m.UserName,"失败,"),!1),o=!1,t.abrupt("continue",61);case 50:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=57;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=55;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 55:t.next=61;break;case 57:if(!(e.following+u>=3e3)){t.next=61;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 61:t.next=19;break;case 63:t.next=68;break;case 65:t.prev=65,t.t0=t["catch"](17),s.e(t.t0);case 68:return t.prev=68,s.f(),t.finish(68);case 71:a.$set(e,"newFollow",u);case 72:if(!o){t.next=131;break}if(!a.isStop){t.next=76;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 76:return r["offset"]+=20,t.next=79,a.GetShopLikes(r);case 79:i=t.sent,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(r.offset/20+1,"页粉丝数据")),b=0;case 82:if(!(b<i.length)){t.next=125;break}if(!a.isStop){t.next=86;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 86:return h=i[b],t.next=89,a.filterShopDatas(h,e.country,e.platform_mall_id);case 89:if(w=t.sent,w){t.next=92;break}return t.abrupt("continue",122);case 92:return t.next=94,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),h.ShopId);case 94:if(v=t.sent,!v.attention_shop_id){t.next=97;break}return t.abrupt("continue",122);case 97:return t.next=99,a.runAttention(h,e,n);case 99:if(x=t.sent,!x){t.next=107;break}return u++,t.next=104,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:h.ShopId});case 104:t.sent,t.next=111;break;case 107:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(h.UserName,"失败,"),!1),t.abrupt("continue",122);case 111:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=118;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=116;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 116:t.next=122;break;case 118:if(!(e.following+u>=3e3)){t.next=122;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 122:b++,t.next=82;break;case 125:return i.length<20&&(a.$refs.Logs.writeLog("【".concat(n,"】查找结束")),o=!1),a.$set(e,"newFollow",u),t.next=129,Object(p["A"])(1e3*Number(a.userInfo.auto_attention_set.FollowInterval));case 129:t.next=72;break;case 131:a.$set(e,"state","操作结束"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】成功关注").concat(u,"个粉丝")),t.next=249;break;case 135:return a.$refs.Logs.writeLog("正在获取评价用户信息",!0),k=!0,y=[],L=a.mallSearchList.findIndex((function(e){return e.shopid===Number(n)})),S=a.mallSearchList[L].itemid,I=0,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取").concat(n,"第【").concat(I/52+1,"】页评价用户")),t.next=144,a.GetShopComment(S,n,e,I);case 144:if(y=t.sent,y.length){t.next=148;break}return a.$refs.Logs.writeLog("".concat(n,"暂无用户评价")),t.abrupt("return","continue");case 148:T=0;case 149:if(!(T<y.length)){t.next=188;break}return N=y[T],F={},F["ShopId"]=N.author_shopid,F["UserName"]=N.author_username,t.next=156,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),F.ShopId);case 156:if(D=t.sent,!D.attention_shop_id){t.next=159;break}return t.abrupt("continue",185);case 159:return t.next=161,a.runAttention(F,e,N.shopid);case 161:if($=t.sent,!$){t.next=169;break}return u++,t.next=166,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:F.ShopId});case 166:t.sent,t.next=174;break;case 169:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(F.UserName,"失败,"),!1),k=!1,t.abrupt("continue",185);case 174:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=181;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=179;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 179:t.next=185;break;case 181:if(!(e.following+u>=3e3)){t.next=185;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 185:T++,t.next=149;break;case 188:a.$set(e,"newFollow",u),console.log("452",u);case 190:if(!k){t.next=247;break}if(!a.isStop){t.next=194;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 194:return I+=52,a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取").concat(n,"第【").concat(I/52+1,"】页评价用户")),t.next=198,a.GetShopComment(S,n,e,I);case 198:y=t.sent,O=0;case 200:if(!(O<y.length)){t.next=241;break}if(!a.isStop){t.next=204;break}return a.$set(e,"state","操作结束"),t.abrupt("return",{v:void 0});case 204:return A=y[O],U={},U["ShopId"]=A.shopid,U["UserName"]=A.author_username,t.next=210,window.BaseUtilBridgeService.getAttentionUser(e.country,e.platform_mall_id.toString(),U.ShopId);case 210:if(M=t.sent,!M.attention_shop_id){t.next=213;break}return t.abrupt("continue",238);case 213:return t.next=215,a.runAttention(U,e,n);case 215:if(R=t.sent,!R){t.next=223;break}return u++,t.next=220,BaseUtilBridgeService.saveAttentionUser({country:e.country,mall_id:e.platform_mall_id.toString(),attention_shop_id:U.ShopId});case 220:t.sent,t.next=227;break;case 223:return a.$set(e,"newFollow",u),a.$set(e,"state","关注失败"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(U.UserName,"失败,"),!1),t.abrupt("continue",238);case 227:if(!Number(a.userInfo.auto_attention_set.FollowNumber)){t.next=234;break}if(!(u>=Number(a.userInfo.auto_attention_set.FollowNumber))){t.next=232;break}return a.$set(e,"newFollow",u),a.$set(e,"state","关注成功"),t.abrupt("return",{v:void 0});case 232:t.next=238;break;case 234:if(!(e.following+u>=3e3)){t.next=238;break}return a.$set(e,"newFollow",u),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:void 0});case 238:O++,t.next=200;break;case 241:return y.length<52&&(a.$refs.Logs.writeLog("【".concat(n,"】查找结束")),k=!1),a.$set(e,"newFollow",u),t.next=245,Object(p["A"])(1e3*Number(a.userInfo.auto_attention_set.FollowInterval));case 245:t.next=190;break;case 247:a.$set(e,"state","操作结束"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】成功关注").concat(u,"个粉丝"));case 249:case"end":return t.stop()}}),t,null,[[17,65,68,71]])})),m.s();case 30:if((f=m.n()).done){n.next=39;break}return n.delegateYield(_(),"t0",32);case 32:if(g=n.t0,"continue"!==g){n.next=35;break}return n.abrupt("continue",37);case 35:if("object"!==Object(o["a"])(g)){n.next=37;break}return n.abrupt("return",g.v);case 37:n.next=30;break;case 39:n.next=44;break;case 41:n.prev=41,n.t1=n["catch"](27),m.e(n.t1);case 44:return n.prev=44,m.f(),n.finish(44);case 47:a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注结束"),!0),n.next=53;break;case 50:n.prev=50,n.t2=n["catch"](1),a.$refs.Logs.writeLog("用户信息获取失败-line373，".concat(n.t2),!1);case 53:return n.prev=53,--r.count,n.finish(53);case 56:case"end":return n.stop()}}),n,null,[[1,50,53,56],[27,41,44,47]])})))()},getHomeFollowingList:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.platform_mall_id,n["offset"]=0,n["mallName"]=e.mall_alias_name||e.platform_mall_name,t.next=7,a.getHomeFllowering(n);case 7:if(r=t.sent,o=r,o.length){t.next=11;break}return t.abrupt("return",[]);case 11:if(!(r.length>=20)){t.next=21;break}if(!a.isStop){t.next=14;break}return t.abrupt("break",21);case 14:return n["offset"]+=20,t.next=17,a.getHomeFllowering(n);case 17:r=t.sent,o=o.concat(r),t.next=11;break;case 21:return t.abrupt("return",o);case 22:case"end":return t.stop()}}),t)})))()},GetShopComment:function(e,t,a,n){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function o(){var i,l,s,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i={},i["mallId"]=a.platform_mall_id,i["country"]=a.country,i["itemid"]=e,i["offset"]=n,i["shopid"]=t,o.next=8,r.MallAPIInstance.getShoppComment(i);case 8:if(l=o.sent,200!==l.code){o.next=15;break}return s=l.data.ratings||[],c=s.filter((function(e){if(e.rating_star>=Number(r.userInfo.auto_attention_set.MinOrderEvaluation))return e})),o.abrupt("return",c);case 15:return r.$refs.Logs.writeLog("商品评价获取失败".concat(l.message),!1),o.abrupt("return",[]);case 17:case"end":return o.stop()}}),o)})))()},runAttention:function(e,t,a){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o={},o["country"]=t.country,o["mallId"]=t.platform_mall_id,o["userShopid"]=e.ShopId,o["followMallID"]=a,r.next=7,n.MallAPIInstance.buyerFollow(o);case 7:if(i=r.sent,200===i.code){r.next=12;break}n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"失败,").concat(i.message),!1),r.next=18;break;case 12:if(!i.data){r.next=17;break}return n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"成功"),!0),r.abrupt("return",!0);case 17:n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"失败,").concat(i.message),!1);case 18:return r.abrupt("return",!1);case 19:case"end":return r.stop()}}),r)})))()},runCancerAttention:function(e,t,a){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o={},o["country"]=t.country,o["mallId"]=t.platform_mall_id,o["ShopId"]=e.ShopId,o["followMallID"]=a,r.next=7,n.MallAPIInstance.buyerUNFollow(o);case 7:if(i=r.sent,200===i.code){r.next=13;break}return n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】取关").concat(e.ShopId,"失败"),!1),r.abrupt("return",!1);case 13:return n.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】取关").concat(e.ShopId,"成功"),!0),r.abrupt("return",!0);case 15:case"end":return r.stop()}}),r)})))()},filterShopDatas:function(e,t,a){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,i,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.getActiveUser({country:t,mallId:a,userName:e.UserName});case 2:if(o=r.sent,i=new Date((new Date).toLocaleDateString()).getTime(),l=i-i*(Number(n.userInfo.auto_attention_set.LastLoginDay)-1),!(o>l)){r.next=9;break}return r.abrupt("return",!0);case 9:return r.abrupt("return",!1);case 10:case"end":return r.stop()}}),r)})))()},getActiveUser:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["username"]=e.userName,a.next=6,t.MallAPIInstance.getActiveTimeFollower(n);case 6:if(r=a.sent,200!==r.code){a.next=11;break}return a.abrupt("return",1e3*Number(r.data.last_active_time));case 11:return t.$refs.Logs.writeLog("店铺活跃状态获取失败:".concat(r.message),!1),a.abrupt("return","");case 13:case"end":return a.stop()}}),a)})))()},GetShopLikes:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["country"]=e.country,n["mallId"]=e.mallId,n["shopid"]=e.shopid,n["offset"]=e.offset,n["limit"]=20,n["offset_of_offset"]=0,n["timeStamp"]=(new Date).getTime(),a.next=10,t.MallAPIInstance.getFllower(n);case 10:if(r=a.sent,200!==r.code){a.next=15;break}return a.abrupt("return",r.data);case 15:return t.$refs.Logs.writeLog("粉丝获取失败，".concat(r.message),!1),a.abrupt("return",[]);case 17:case"end":return a.stop()}}),a)})))()},setSave:function(e){this.dialog_userInfo=!1,this.getUserinfo()},setQurey:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dialog_userInfo=!0;case 1:case"end":return t.stop()}}),t)})))()},getUserinfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showlog=!0,t.next=3,e.$appConfig.getUserConfig();case 3:a=t.sent,e.userInfo=a&&JSON.parse(a),e.userInfo.auto_attention_set||(e.userInfo.auto_attention_set={},e.userInfo.auto_attention_set.ProductMax="5",e.userInfo.auto_attention_set.LastLoginDay="5",e.userInfo.auto_attention_set.FollowType="0",e.userInfo.auto_attention_set.FollowNumber="100",e.userInfo.auto_attention_set.FollowInterval="10",e.userInfo.auto_attention_set.MinOrderEvaluation="4.5",e.userInfo.auto_attention_set.IsNotFollowMinOrderEvaluation=!0,e.userInfo.auto_attention_set.FollowedDay="30",e.userInfo.auto_attention_set.IsNotFollowFollowedDay=!0,e.userInfo.auto_attention_set.CancelFollowNumber="100",e.userInfo.auto_attention_set.IsOpenTimerBrushFans=!1,e.userInfo.auto_attention_set.OpenHour="10",e.userInfo.auto_attention_set.OpenMinute="00"),e.userInfo.auto_attention_set||e.$message.warning("请先设置参数");case 7:case"end":return t.stop()}}),t)})))()},clearLog:function(){this.$refs.Logs.consoleMsg=""},changeMallList:function(e){this.selmallList=e},handleSelectionChange:function(e){this.sel_mallSearchList=e}}},d=g,b=(a("4968"),a("2877")),h=Object(b["a"])(d,n,r,!1,null,"ebb0073a",null);t["default"]=h.exports},8992:function(e,t,a){"use strict";a("4c28")},"8d7e":function(e,t,a){"use strict";a("559d")},"9f41":function(e,t,a){},cf9f:function(e,t,a){"use strict";var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("ul",[a("span",[e._v("  通用设置  ")]),a("li",[a("div",[a("label",[e._v("店铺商品上限：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.limitgGoods,callback:function(t){e.limitgGoods=t},expression:"limitgGoods"}}),a("label",{staticStyle:{"margin-left":"120px"}},[e._v("最后活跃时间：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.lastOnline,callback:function(t){e.lastOnline=t},expression:"lastOnline"}}),e._v("  天内 ")],1)]),a("span",[e._v("  关注设置  ")]),a("li",[a("ul",{staticStyle:{"margin-top":"-10px"}},[a("span",{staticStyle:{"margin-left":"-20px"}},[e._v("  关注对象  ")]),a("li",{staticStyle:{width:"450px","margin-left":"-20px"}},[a("el-radio-group",{model:{value:e.followActor,callback:function(t){e.followActor=t},expression:"followActor"}},[a("el-radio",{attrs:{label:"0"}},[e._v("店铺粉丝")])],1)],1)]),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("label",[e._v("关注数量：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.followNum,callback:function(t){e.followNum=t},expression:"followNum"}}),e._v(" （0为无限制） "),a("label",{staticStyle:{"margin-left":"110px"}},[e._v("关注间隔：")]),a("el-input",{staticStyle:{width:"50px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.interTime,callback:function(t){e.interTime=t},expression:"interTime"}}),e._v(" 秒 ")],1),a("div",[a("el-checkbox",{staticStyle:{"margin-bottom":"10px"},model:{value:e.market,callback:function(t){e.market=t},expression:"market"}},[e._v("不关注订单评价小于等于 ")]),a("el-input",{staticStyle:{width:"50px"},attrs:{size:"mini"},on:{blur:function(t){e.market=!0}},model:{value:e.marketNum,callback:function(t){e.marketNum=t},expression:"marketNum"}}),e._v(" 的用户 ")],1),a("div",[a("el-checkbox",{model:{value:e.followDay,callback:function(t){e.followDay=t},expression:"followDay"}},[e._v("不关注 ")]),a("el-input",{staticStyle:{width:"75px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},on:{blur:function(t){e.followDay=!0}},model:{value:e.followDayNum,callback:function(t){e.followDayNum=t},expression:"followDayNum"}}),e._v(" 天内关注过的用户 ")],1)]),a("span",[e._v("  取关设置  ")]),a("li",[a("div",[a("label",[e._v("取关数量：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d.]/g,0)",size:"mini"},model:{value:e.cancerFollowNum,callback:function(t){e.cancerFollowNum=t},expression:"cancerFollowNum"}}),e._v(" （0为无限制） ")],1)]),a("span",[e._v("  自动关注  ")]),a("li",{staticClass:"orderSet"},[a("div",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 开启任务请前往【爆粉神器】添加执行任务的店铺，随后进行参数设置"),a("br"),e._v(" 注意：1.关键词不能为空"),a("br"),e._v("           2.一个站点只能执行一条任务"),a("br"),e._v("           3.同一个站点的任务保存会替换原来的任务"),a("br")]),a("el-checkbox",{model:{value:e.startAddFence,callback:function(t){e.startAddFence=t},expression:"startAddFence"}},[e._v("开启定时刷粉")])],1),a("label",[e._v("每日启动时间  ")]),a("el-time-select",{staticStyle:{width:"100px"},attrs:{"picker-options":{start:"00:00",step:"00:01",end:"23:59"},placeholder:"选择时间",size:"mini"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),a("label",{staticStyle:{"margin-left":"20px"}},[e._v("关注关键词：")]),a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini"},model:{value:e.followKey,callback:function(t){e.followKey=t},expression:"followKey"}}),a("el-button",{attrs:{size:"mini"},on:{click:e.checkLog}},[e._v("查看日志")])],1)]),a("el-button",{staticStyle:{flex:"1","margin-left":"200px",width:"100px"},attrs:{size:"mini"},on:{click:function(t){return e.save()}}},[e._v("保存")])],1),a("el-dialog",{attrs:{title:"日志",visible:e.logVisible,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},on:{"update:visible":function(t){e.logVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{"max-height":"400px",data:e.logList,"tooltip-effect":"dark","header-cell-style":{textAlign:"center",backgroundColor:"#f5f7fa"},"cell-style":{textAlign:"center"},"row-style":{height:"80px"}}},[a("el-table-column",{attrs:{label:"操作","min-width":"320px",prop:"option","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"时间","min-width":"180px",prop:"activeTime"}})],1)],1)],1)},o=[],i=a("ade3"),l=a("1da1"),s=(a("d3b7"),a("25f0"),a("ac1f"),a("1276"),a("d81d"),a("a9e3"),a("99af"),a("5319"),a("96cf"),a("0e0b")),c={components:{},props:["userInfo","mall"],data:function(){return{logVisible:!1,logList:[],userID:"",uid:"",showlog:!0,limitgGoods:"5",lastOnline:"1",followActor:"0",followNum:"100",interTime:"10",market:!0,marketNum:"4.5",followDay:!0,followDayNum:"30",cancerFollowNum:100,startAddFence:!1,startTime:"10:00",followKey:""}},mounted:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["C"])((function(){return e.userInfo&&e.userInfo.id}));case 2:return t.next=4,e.getUserinfo();case 4:case"end":return t.stop()}}),t)})))()},methods:(n={checkLog:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.logVisible=!0,a=["MY","TW","VN","ID","PH","TH","SG","BR","MX","CO","CL","PL"],n=0,r=a;case 3:if(!(n<r.length)){t.next=17;break}return o=r[n],t.next=7,window.BaseUtilBridgeService.getAttentionUserTask(o);case 7:if(i=t.sent,!i.length){t.next=14;break}return t.next=11,window.BaseUtilBridgeService.getAttentionUserLog(i[0].id);case 11:l=t.sent,console.log("log",l),l?e.logList=JSON.parse(l[0].log_message):e.$message.warning("日志请求失败");case 14:n++,t.next=3;break;case 17:case"end":return t.stop()}}),t)})))()},getUserinfo:function(){if(this.userInfo&&this.userInfo.auto_attention_set){var e,t,a,n,r,o,i,l,s,c,u,m;this.limitgGoods=(null===(e=this.userInfo.auto_attention_set)||void 0===e?void 0:e.ProductMax)||this.limitgGoods,this.lastOnline=(null===(t=this.userInfo.auto_attention_set)||void 0===t?void 0:t.LastLoginDay)||this.lastOnline,this.followActor=(null===(a=this.userInfo.auto_attention_set)||void 0===a?void 0:a.FollowType.toString())||this.followActor,this.followNum=(null===(n=this.userInfo.auto_attention_set)||void 0===n?void 0:n.FollowNumber)||this.followNum,this.interTime=(null===(r=this.userInfo.auto_attention_set)||void 0===r?void 0:r.FollowInterval)||this.interTime,this.marketNum=(null===(o=this.userInfo.auto_attention_set)||void 0===o?void 0:o.MinOrderEvaluation)||this.marketNum,this.market=(null===(i=this.userInfo.auto_attention_set)||void 0===i?void 0:i.IsNotFollowMinOrderEvaluation)||this.market,this.followDayNum=(null===(l=this.userInfo.auto_attention_set)||void 0===l?void 0:l.FollowedDay)||this.followDayNum,this.followDay=(null===(s=this.userInfo.auto_attention_set)||void 0===s?void 0:s.IsNotFollowFollowedDay)||this.followDay,this.cancerFollowNum=(null===(c=this.userInfo.auto_attention_set)||void 0===c?void 0:c.CancelFollowNumber)||this.cancerFollowNum,this.startAddFence=(null===(u=this.userInfo.auto_attention_set)||void 0===u?void 0:u.IsOpenTimerBrushFans)||this.startAddFence;var f=this.userInfo.auto_attention_set;this.startTime=(null===(m=this.userInfo.auto_attention_set)||void 0===m?void 0:m.OpenHour)+":"+("0"===f.OpenMinute?"00":f.OpenMinute)||this.startTime,this.followKey=this.userInfo.auto_attention_set.KeyWord||this.followKey}},add0:function(e){return e<10?"0"+e:e},formatTime:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=t.getHours(),i=t.getMinutes(),l=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(r)+" "+this.add0(o)+":"+this.add0(i)+":"+this.add0(l)},autoAddFence:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.startAddFence||e.mall){t.next=3;break}return e.$message.warning("请前往【爆粉神器】设置需要执行的任务的店铺"),t.abrupt("return",!1);case 3:if(!e.startAddFence||e.followKey){t.next=6;break}return e.$message.warning("关键词不能为空"),t.abrupt("return",!1);case 6:if(a=e.startTime.split(":"),!e.startAddFence){t.next=39;break}return n={},n["country"]=e.mall[0].country,n["log_message"]=[],t.next=13,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 13:if(r=t.sent,console.log(r),!r.length){t.next=21;break}return t.next=18,window.BaseUtilBridgeService.deleteAttentionUserTask(r[0].id);case 18:t.sent,n["log_message"].push("任务删除"),n["created_at"]=e.formatTime((new Date).getTime());case 21:return o={country:e.mall[0].country,mall_ids:e.mall.map((function(e){return e["platform_mall_id"]})).toString(),mall_names:e.mall.map((function(e){return e["mall_alias_name"]||e["platform_mall_name"]})).toString(),product_max:e.limitgGoods,last_login_day:e.lastOnline,open_hour:a[0].toString(),open_minute:a[1].toString(),key_word:e.followKey,follow_number:e.followNum,follow_interval:e.interTime,is_not_follow_min_order_evaluation:e.market?1:0,min_order_evaluation:e.marketNum,is_not_follow_followed_day:e.followDay?1:0,followed_day:e.followDayNum,followed_type:e.followActor,cancel_follow_number:Number(e.cancerFollowNum),cancel_follow_sort_type:0,exec_time:1e3*e.teskTime(e.startTime)},t.next=24,window.BaseUtilBridgeService.saveAttentionUserTask(o);case 24:if(i=t.sent,"200"!==i.code){t.next=34;break}return t.next=28,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 28:l=t.sent,n["task_id"]=l[0].id,n["log_message"].push("任务创建成功"),n["created_at"]=e.formatTime((new Date).getTime()),t.next=36;break;case 34:n["log_message"].push("任务创建失败"),n["created_at"]=e.formatTime((new Date).getTime());case 36:return n["log_message"]=n["log_message"].toString(),t.next=39,window.BaseUtilBridgeService.saveAttentionUserLog(n);case 39:return t.abrupt("return",!0);case 40:case"end":return t.stop()}}),t)})))()},teskTime:function(e){var t="".concat((new Date).getFullYear(),"-").concat((new Date).getMonth(),"-").concat((new Date).getDay()," ").concat(e,":00"),a=t.replace(/:/g,"-");a=a.replace(/ /g,"-");var n=a.split("-"),r=new Date(Date.UTC(n[0],n[1]-1,n[2],n[3]-8,n[4],n[5]));return r.getTime()/1e3}},Object(i["a"])(n,"add0",(function(e){return e<10?"0"+e:e})),Object(i["a"])(n,"formatTime",(function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=t.getHours(),i=t.getMinutes(),l=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(r)+" "+this.add0(o)+":"+this.add0(i)+":"+this.add0(l)})),Object(i["a"])(n,"save",(function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r,o,i,l,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.startAddFence){t.next=6;break}return t.next=3,e.autoAddFence();case 3:if(a=t.sent,a){t.next=6;break}return t.abrupt("return");case 6:if(n=e.startTime.split(":"),!e.startAddFence){t.next=20;break}return r={},r["country"]=e.mall[0].country,r["log_message"]=[],o={country:e.mall[0].country,mall_ids:e.mall.map((function(e){return e["platform_mall_id"]})).toString(),mall_names:e.mall.map((function(e){return e["mall_alias_name"]||e["platform_mall_name"]})).toString(),product_max:e.limitgGoods,last_login_day:e.lastOnline,open_hour:n[0],open_minute:n[1],key_word:e.followKey,follow_number:e.followNum,follow_interval:e.interTime,is_not_follow_min_order_evaluation:e.market,min_order_evaluation:e.marketNum,is_not_follow_followed_day:e.followDay,followed_day:e.followDayNum,followed_type:e.followActor,cancel_follow_number:e.cancerFollowNum,cancel_follow_sort_type:0},t.next=14,window.BaseUtilBridgeService.saveAttentionUserTask(JSON.stringify(o));case 14:return i=t.sent,i?(r["task_id"]=i.task_id,r["log_message"].push("任务创建成功"),r["created_at"]=e.formatTime((new Date).getTime())):(r["log_message"].push("任务创建失败"),r["created_at"]=e.formatTime((new Date).getTime())),r["log_message"]=r["log_message"].toString(),t.next=19,window.BaseUtilBridgeService.saveAttentionUserLog(r);case 19:t.sent;case 20:return l={ProductMax:e.limitgGoods,LastLoginDay:e.lastOnline,FollowType:e.followActor,FollowNumber:e.followNum,FollowInterval:e.interTime,MinOrderEvaluation:e.marketNum,IsNotFollowMinOrderEvaluation:e.market,FollowedDay:e.followDayNum,IsNotFollowFollowedDay:e.followDay,CancelFollowNumber:e.cancerFollowNum,IsOpenTimerBrushFans:e.startAddFence,OpenHour:n[0],OpenMinute:n[1],KeyWord:e.followKey,IsNotFollowCrossBorderSeller:!1,CancelFollowSortType:"0"},s={content:{autoAttentionSet:JSON.stringify(l)},type:4},t.prev=22,console.log("saveParams",l),t.next=26,e.$api.setUserinfo(JSON.stringify(s));case 26:c=t.sent,200===c.data.code?e.$message.success("信息修改成功！"):e.$message.warning("信息修改失败！".concat(c.data.message)),console.log("137",c),t.next=34;break;case 31:t.prev=31,t.t0=t["catch"](22),console.log("139line-".concat(t.t0));case 34:e.$emit("isSave",!0);case 35:case"end":return t.stop()}}),t,null,[[22,31]])})))()})),n)},u=c,m=(a("e5c5"),a("2877")),f=Object(m["a"])(u,r,o,!1,null,"a6bbd672",null);t["a"]=f.exports},d1dd:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a("53ca"),r=a("b85c"),o=a("2909"),i=a("1da1"),l=a("d4ec"),s=a("bee2"),c=a("ade3"),u=(a("96cf"),a("a9e3"),a("ac1f"),a("1276"),a("a434"),a("159b"),a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("4de4"),a("b680"),a("d81d"),a("99af"),a("25f0"),a("c740"),a("f68b")),m=a("0e0b"),f=a("2b0e"),p=null,_=function(){function e(){Object(l["a"])(this,e),Object(c["a"])(this,"mallTest",""),Object(c["a"])(this,"MallAPIInstance",new u["a"](new f["default"])),Object(c["a"])(this,"mallSearchList",[]),Object(c["a"])(this,"storeLogList",{})}return Object(s["a"])(e,[{key:"autoAddFenceActive",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,o,i,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=["MY","TW","VN","ID","PH","TH","SG","BR","MX","CO","CL","PL"],a=0,n=t;case 2:if(!(a<n.length)){e.next=14;break}return r=n[a],o={},o["country"]=r,o["log_message"]=[],e.next=9,window.BaseUtilBridgeService.getAttentionUserTask(r);case 9:i=e.sent,i.length&&(console.log(i),l=(new Date).getTime(),s=Number(i[0].exec_time),this.runTesk(l-s,i));case 11:a++,e.next=2;break;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"runTesk",value:function(e,t){var a=this;this.storeLogList["".concat(t[0].country)]={},this.storeLogList["".concat(t[0].country)].log_message=[],e=e>0?0:0-e,e?(console.log("该任务还未到执行时间",t[0].country,t[0]),this.storeLogList["".concat(t[0].country)].log_message.push({option:"【".concat(t[0].country,"】该任务还未到执行时间"),activeTime:this.formatTime((new Date).getTime())})):(console.log("任务即将执行",t[0].country,t[0]),this.storeLogList["".concat(t[0].country)].log_message.push({option:"【".concat(t[0].country,"】任务即将执行...."),activeTime:this.formatTime((new Date).getTime())})),setTimeout(Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.searchMall(t[0]);case 2:return e.next=4,a.startCancer(t[0]);case 4:return n={country:t[0].country,mall_ids:t[0].mall_ids,mall_names:t[0].mall_names,product_max:t[0].product_max,last_login_day:t[0].last_login_day,open_hour:t[0].open_hour,open_minute:t[0].open_minute,key_word:t[0].key_word,follow_number:t[0].follow_number,follow_interval:t[0].follow_interval,is_not_follow_min_order_evaluation:t[0].is_not_follow_min_order_evaluation,min_order_evaluation:t[0].min_order_evaluation,is_not_follow_followed_day:t[0].is_not_follow_followed_day,followed_day:t[0].followed_day,followed_type:t[0].followed_type,cancel_follow_number:t[0].cancel_follow_number,cancel_follow_sort_type:t[0].cancel_follow_sort_type,exec_time:(new Date).getTime()},e.next=7,window.BaseUtilBridgeService.saveAttentionUserTask(n);case 7:return r=e.sent,console.log("addTest",r),e.next=11,window.BaseUtilBridgeService.getAttentionUserTask(t[0].country);case 11:return o=e.sent,a.storeLogList["".concat(t[0].country)].task_id=o[0].id,a.storeLogList["".concat(t[0].country)].country=o[0].country,a.storeLogList["".concat(t[0].country)].created_at=a.formatTime((new Date).getTime()),a.storeLogList["".concat(t[0].country)].log_message=JSON.stringify(a.storeLogList["".concat(t[0].country)].log_message),e.next=18,window.BaseUtilBridgeService.saveAttentionUserLog(a.storeLogList["".concat(t[0].country)]);case 18:i=e.sent,console.log("日志存储",i);case 20:case"end":return e.stop()}}),e)}))),e)}},{key:"add0",value:function(e){return e<10?"0"+e:e}},{key:"formatTime",value:function(t){var a=new e,n=new Date(t),r=n.getFullYear(),o=n.getMonth()+1,i=n.getDate(),l=n.getHours(),s=n.getMinutes(),c=n.getSeconds();return r+"-"+a.add0(o)+"-"+a.add0(i)+" "+a.add0(l)+":"+a.add0(s)+":"+a.add0(c)}},{key:"searchMall",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,i,l,s,c,u=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=10*t.mall_ids.split(",").length,n=[],console.log("正在查询关注店铺"),this.storeLogList["".concat(t.country)].log_message.push({option:"正在查询【".concat(t.key_word,"】相关店铺...."),activeTime:this.formatTime((new Date).getTime())}),r=0;case 5:if(!(r<a)){e.next=35;break}return i={},i["country"]=t.country,i["mallId"]=Number(t.mall_ids.split(",")[0]),i["newest"]=60*r,i["keyword"]=t.key_word,i["min_order_evaluation"]=t.min_order_evaluation,e.next=14,this.searchMallInstance(i);case 14:if(l=e.sent,l.length){e.next=19;break}return console.log("暂无数据"),this.storeLogList["".concat(t.country)].log_message.push({option:"暂无数据",activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return");case 19:return e.next=21,this.filterList(l,t);case 21:if(s=e.sent,!s.length){e.next=29;break}if((c=n).push.apply(c,Object(o["a"])(s)),!(n.length>=a)){e.next=27;break}return n=n.splice(0,a),e.abrupt("break",35);case 27:e.next=32;break;case 29:return console.log("此关键词暂无更多数据！"),this.storeLogList["".concat(t.country)].log_message.push({option:"此关键词暂无更多数据！",activeTime:this.formatTime((new Date).getTime())}),e.abrupt("break",35);case 32:r++,e.next=5;break;case 35:console.log("店铺搜索获取结束"),this.storeLogList["".concat(t.country)].log_message.push({option:"店铺搜索获取结束",activeTime:this.formatTime((new Date).getTime())}),this.mallSearchList=[],n.forEach((function(e){e.item_basic.totalRate=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t})),u.mallSearchList.push(e.item_basic)})),console.log("店铺数据",this.mallSearchList);case 40:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"searchMallInstance",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.mallId,a["by"]="relevancy",a["keyword"]=t.keyword,a["limit"]=60,a["newest"]=t.newest,a["order"]="desc",a["page_type"]="search",a["rating_filter"]=t.min_order_evaluation,e.prev=10,e.next=13,this.MallAPIInstance.addCancerMall(a);case 13:if(n=e.sent,200!==n.status){e.next=18;break}return e.abrupt("return",JSON.parse(n.data).items);case 18:return console.log("店铺搜索请求失败,230-line:".concat(n.status)),this.storeLogList["".concat(t.country)].log_message.push({option:"店铺搜索请求失败,230-line:".concat(n.status),activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return",[]);case 21:e.next=28;break;case 23:return e.prev=23,e.t0=e["catch"](10),console.log("店铺搜索请求失败,234-line:".concat(e.t0)),this.storeLogList["".concat(t.country)].log_message.push({option:"店铺搜索请求失败,234-line:".concat(e.t0),activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return",[]);case 28:case"end":return e.stop()}}),e,this,[[10,23]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"filterList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a){var n,r,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[],r=new Map,t.forEach((function(e){r.has(e.item_basic.itemid)||r.has(e.item_basic.shopid)||r.set(e.itemid,e)})),n=Object(o["a"])(r.values()),i=Number(a.product_max),l=n.filter((function(e){var t=e.item_basic.item_rating.rating_count.reduce((function(e,t,a,n){return e+t}));if(Number(e.item_basic.liked_count)>=100&&Number(e.item_basic.liked_count)<=1e4&&Number(e.item_basic.item_rating.rating_star.toFixed(2))>=4.5&&Number(e.item_basic.item_rating.rating_star.toFixed(2))<=5&&t>=50&&t<=5e3&&e.item_basic.stock>=i)return e})),e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"startCancer",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.mallSearchList.length<=0)){e.next=4;break}return console.log(t.country+"当前关键词【".concat(t.key_word,"】暂无数据")),this.storeLogList["".concat(t.country)].log_message.push({option:"当前关键词【".concat(t.key_word,"】暂无数据"),activeTime:this.formatTime((new Date).getTime())}),e.abrupt("return");case 4:return a=t.mall_ids.split(","),n=t.mall_names.split(","),r=this.mallSearchList.map((function(e){return e.shopid})),o=a.map((function(e,a){var o={};return o.platform_mall_id=e,o.mall_alias_name=n[a],o.country=t.country,o.mallIDlist=r,o.Tesk_follow_number=t.follow_number,o.followed_type=t.followed_type,o.follow_interval=t.follow_interval,o.last_login_day=t.last_login_day,o.min_order_evaluation=t.min_order_evaluation,o})),console.log("开始处理关注店铺数据......"),p=this,this.storeLogList["".concat(t.country)].log_message.push({option:"开始处理关注店铺数据......",activeTime:this.formatTime((new Date).getTime())}),e.next=13,Object(m["d"])(o,this.getFllowerInfo);case 13:this.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.country,"】数据处理结束"),activeTime:this.formatTime((new Date).getTime())}),console.log("【".concat(t.country,"】数据处理结束"));case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getFllowerInfo",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,o,i,l,s,c,u,f,_,g=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=g.length>1&&void 0!==g[1]?g[1]:{count:1},e.prev=1,o=t.mallIDlist,t.following=0,t.fence=0,t.newFollow=0,t.cancerFollow=0,t.state="-",e.next=10,p.isLoginFun(t);case 10:if(i=e.sent,console.log(),i){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,p.getHomeMallData(t);case 16:if(l=e.sent,l){e.next=21;break}return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】店铺暂无数据")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】店铺暂无数据"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return");case 21:s=t.newFollow,c=Object(r["a"])(o),e.prev=23,f=regeneratorRuntime.mark((function e(){var a,n,o,i,l,c,f,_,g,d,b,h,w,v,x,k,y,L,S,I,T,N,F,D,$,O,A,U,M,R;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=u.value,!p.isStop){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:if(n={},n["country"]=t.country,n["mallId"]=t.platform_mall_id,n["shopid"]=a,"0"!==t.followed_type){e.next=136;break}return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】正在获取").concat(a,"店铺粉丝信息")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】正在获取").concat(a,"店铺粉丝信息"),activeTime:p.formatTime((new Date).getTime())}),o=!0,n["offset"]=0,e.next=14,p.GetShopLikes(n);case 14:i=e.sent,console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】获取第").concat(n.offset/20+1,"页粉丝")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取第").concat(n.offset/20+1,"页粉丝"),activeTime:p.formatTime((new Date).getTime())}),l=Object(r["a"])(i),e.prev=18,l.s();case 20:if((c=l.n()).done){e.next=60;break}if(f=c.value,!p.isStop){e.next=24;break}return e.abrupt("return",{v:void 0});case 24:return e.next=26,p.filterShopDatas(i,t.country,t.platform_mall_id);case 26:if(_=e.sent,_){e.next=29;break}return e.abrupt("continue",58);case 29:return e.next=31,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),f.ShopId);case 31:if(g=e.sent,!g.attention_shop_id){e.next=34;break}return e.abrupt("continue",58);case 34:return e.next=36,p.runAttention(f,t,a);case 36:if(d=e.sent,!d){e.next=44;break}return s++,e.next=41,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:f.ShopId});case 41:e.sent,e.next=48;break;case 44:return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(f.UserName,"失败")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(f.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),o=!1,e.abrupt("continue",58);case 48:if(!Number(t.Tesk_follow_number)){e.next=53;break}if(!(s>=Number(t.Tesk_follow_number))){e.next=51;break}return e.abrupt("return",{v:void 0});case 51:e.next=58;break;case 53:if(!(t.following+s>=3e3)){e.next=58;break}return console.log("关注已达上限"),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增关注").concat(s,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 58:e.next=20;break;case 60:e.next=65;break;case 62:e.prev=62,e.t0=e["catch"](18),l.e(e.t0);case 65:return e.prev=65,l.f(),e.finish(65);case 68:console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】新增关注").concat(s,"个")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增关注").concat(s,"个"),activeTime:p.formatTime((new Date).getTime())});case 70:if(!o){e.next=130;break}if(!p.isStop){e.next=73;break}return e.abrupt("return",{v:void 0});case 73:return n["offset"]+=20,e.next=76,p.GetShopLikes(n);case 76:i=e.sent,console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】获取第").concat(n.offset/20+1,"页粉丝数据")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取第").concat(n.offset/20+1,"页粉丝数据"),activeTime:p.formatTime((new Date).getTime())}),b=0;case 80:if(!(b<i.length)){e.next=123;break}if(!p.isStop){e.next=83;break}return e.abrupt("return",{v:void 0});case 83:return h=i[b],e.next=86,p.filterShopDatas(h,t.country,t.platform_mall_id,t.last_login_day);case 86:if(w=e.sent,w){e.next=89;break}return e.abrupt("continue",120);case 89:return e.next=91,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),h.ShopId);case 91:if(v=e.sent,!v.attention_shop_id){e.next=94;break}return e.abrupt("continue",120);case 94:return e.next=96,p.runAttention(h,t,a);case 96:if(x=e.sent,!x){e.next=104;break}return s++,e.next=101,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:h.ShopId});case 101:e.sent,e.next=107;break;case 104:return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(h.UserName,"失败")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(h.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("continue",120);case 107:if(!Number(t.Tesk_follow_number)){e.next=114;break}if(!(s>=Number(t.Tesk_follow_number))){e.next=112;break}return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个粉丝")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个粉丝"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 112:e.next=120;break;case 114:if(!(t.following+s>=3e3)){e.next=120;break}return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个")),console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 120:b++,e.next=80;break;case 123:return i.length<20&&(console.log("【".concat(a,"】查找结束")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(a,"】查找结束"),activeTime:p.formatTime((new Date).getTime())}),o=!1),console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个"),activeTime:p.formatTime((new Date).getTime())}),e.next=128,Object(m["A"])(1e3*Number(t.follow_interval));case 128:e.next=70;break;case 130:console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】操作结束")),console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】操作结束"),activeTime:that.formatTime((new Date).getTime())}),e.next=240;break;case 136:return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】正在获取评价用户信息")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】正在获取评价用户信息"),activeTime:p.formatTime((new Date).getTime())}),k=!0,y=[],L=p.mallSearchList.findIndex((function(e){return e.shopid===Number(a)})),S=p.mallSearchList[L].itemid,I=0,p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取").concat(a,"第【").concat(I/52+1,"】页评价用户"),activeTime:p.formatTime((new Date).getTime())}),e.next=146,p.GetShopComment(S,a,t,I);case 146:if(y=e.sent,y.length){e.next=150;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"".concat(a,"暂无用户评价"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return","continue");case 150:T=0;case 151:if(!(T<y.length)){e.next=187;break}return N=y[T],F={},F["ShopId"]=N.author_shopid,F["UserName"]=N.author_username,e.next=158,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),F.ShopId);case 158:if(D=e.sent,!D.attention_shop_id){e.next=161;break}return e.abrupt("continue",184);case 161:return e.next=163,p.runAttention(F,t,N.shopid);case 163:if($=e.sent,!$){e.next=171;break}return s++,e.next=168,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:F.ShopId});case 168:e.sent,e.next=174;break;case 171:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(F.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),k=!1,e.abrupt("continue",184);case 174:if(!Number(t.Tesk_follow_number)){e.next=180;break}if(!(s>=Number(t.Tesk_follow_number))){e.next=178;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注成功"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 178:e.next=184;break;case 180:if(!(t.following+s>=3e3)){e.next=184;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】新增").concat(s,"个"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 184:T++,e.next=151;break;case 187:p.$set(t,"newFollow",s);case 188:if(!k){e.next=238;break}if(!p.isStop){e.next=191;break}return e.abrupt("return",{v:void 0});case 191:return I+=52,p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】获取").concat(a,"第【").concat(I/52+1,"】页评价用户"),activeTime:p.formatTime((new Date).getTime())}),e.next=195,p.GetShopComment(S,a,t,I);case 195:y=e.sent,O=0;case 197:if(!(O<y.length)){e.next=233;break}if(!p.isStop){e.next=200;break}return e.abrupt("return",{v:void 0});case 200:return A=y[O],U={},U["ShopId"]=A.shopid,U["UserName"]=A.author_username,e.next=206,window.BaseUtilBridgeService.getAttentionUser(t.country,t.platform_mall_id.toString(),U.ShopId);case 206:if(M=e.sent,!M.attention_shop_id){e.next=209;break}return e.abrupt("continue",230);case 209:return e.next=211,p.runAttention(U,t,a);case 211:if(R=e.sent,!R){e.next=219;break}return s++,e.next=216,BaseUtilBridgeService.saveAttentionUser({country:t.country,mall_id:t.platform_mall_id.toString(),attention_shop_id:U.ShopId});case 216:e.sent,e.next=221;break;case 219:return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(U.UserName,"失败"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("continue",230);case 221:if(!Number(t.Tesk_follow_number)){e.next=227;break}if(!(s>=Number(t.Tesk_follow_number))){e.next=225;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注成功"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 225:e.next=230;break;case 227:if(!(t.following+s>=3e3)){e.next=230;break}return p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注已达上限"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",{v:void 0});case 230:O++,e.next=197;break;case 233:return y.length<52&&(p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】查找结束"),activeTime:p.formatTime((new Date).getTime())}),k=!1),e.next=236,Object(m["A"])(1e3*Number(t.follow_interval));case 236:e.next=188;break;case 238:p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】成功关注").concat(s,"个粉丝"),activeTime:p.formatTime((new Date).getTime())}),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】操作结束"),activeTime:p.formatTime((new Date).getTime())});case 240:case"end":return e.stop()}}),e,null,[[18,62,65,68]])})),c.s();case 26:if((u=c.n()).done){e.next=35;break}return e.delegateYield(f(),"t0",28);case 28:if(_=e.t0,"continue"!==_){e.next=31;break}return e.abrupt("continue",33);case 31:if("object"!==Object(n["a"])(_)){e.next=33;break}return e.abrupt("return",_.v);case 33:e.next=26;break;case 35:e.next=40;break;case 37:e.prev=37,e.t1=e["catch"](23),c.e(e.t1);case 40:return e.prev=40,c.f(),e.finish(40);case 43:p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】关注结束"),activeTime:p.formatTime((new Date).getTime())}),e.next=50;break;case 46:e.prev=46,e.t2=e["catch"](1),console.log(e.t2),p.storeLogList["".concat(t.country)].log_message.push({option:"用户信息获取失败-line373，".concat(e.t2),activeTime:p.formatTime((new Date).getTime())});case 50:return e.prev=50,--a.count,e.finish(50);case 53:case"end":return e.stop()}}),e,null,[[1,46,50,53],[23,37,40,43]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"isLoginFun",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.MallAPIInstance.isLogin(t);case 2:if(a=e.sent,200!==a.code||!a.data){e.next=7;break}return e.abrupt("return",!0);case 7:return console.log("【".concat(t.mall_alias_name||t.platform_mall_name,"】店铺未登录")),p.storeLogList["".concat(t.country)].log_message.push({option:"【".concat(t.mall_alias_name||t.platform_mall_name,"】店铺未登录"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getHomeMallData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.platform_mall_id,e.next=5,p.MallAPIInstance.UserProfile(a);case 5:if(n=e.sent,200!==n.code){e.next=19;break}return r=n.data.username,a["username"]=r,e.next=11,p.MallAPIInstance.getHomeMallinfo(a);case 11:if(o=e.sent,200!==o.code){e.next=16;break}return e.abrupt("return",o.data);case 16:return e.abrupt("return","");case 17:e.next=20;break;case 19:return e.abrupt("return","");case 20:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getHomeFollowingList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={},n["country"]=t.country,n["mallId"]=t.platform_mall_id,n["offset"]=0,n["mallName"]=t.mall_alias_name||t.platform_mall_name,e.next=7,this.getHomeFllowering(n);case 7:if(r=e.sent,o=r,o.length){e.next=11;break}return e.abrupt("return",[]);case 11:if(!(r.length>=20)){e.next=21;break}if(!this.isStop){e.next=14;break}return e.abrupt("break",21);case 14:return n["offset"]+=20,e.next=17,this.getHomeFllowering(n);case 17:r=e.sent,o=o.concat(r),e.next=11;break;case 21:return e.abrupt("return",o);case 22:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"GetShopLikes",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.mallId,a["shopid"]=t.shopid,a["offset"]=t.offset,a["limit"]=20,a["offset_of_offset"]=0,a["timeStamp"]=(new Date).getTime(),e.next=10,p.MallAPIInstance.getFllower(a);case 10:if(n=e.sent,200!==n.code){e.next=15;break}return e.abrupt("return",n.data);case 15:return p.storeLogList["".concat(t.country)].log_message.push({option:"粉丝获取失败",activeTime:p.formatTime((new Date).getTime())}),console.log("粉丝获取失败，".concat(n.message)),e.abrupt("return",[]);case 18:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"filterShopDatas",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a,n,r){var o,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.getActiveUser({country:a,mallId:n,userName:t.UserName});case 2:if(o=e.sent,i=new Date((new Date).toLocaleDateString()).getTime(),l=i-i*(Number(r)-1),!(o>l)){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));function t(t,a,n,r){return e.apply(this,arguments)}return t}()},{key:"getActiveUser",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},a["country"]=t.country,a["mallId"]=t.mallId,a["username"]=t.userName,e.next=6,p.MallAPIInstance.getActiveTimeFollower(a);case 6:if(n=e.sent,200!==n.code){e.next=11;break}return e.abrupt("return",1e3*Number(n.data.last_active_time));case 11:return p.$refs.Logs.writeLog("店铺活跃状态获取失败:".concat(n.message),!1),e.abrupt("return","");case 13:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"runAttention",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a,n){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={},r["country"]=a.country,r["mallId"]=a.platform_mall_id,r["userShopid"]=t.ShopId,r["followMallID"]=n,e.next=7,p.MallAPIInstance.buyerFollow(r);case 7:if(o=e.sent,console.log("关注",o),200===o.code){e.next=14;break}console.log("【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"失败,").concat(o.message)),p.storeLogList["".concat(a.country)].log_message.push({option:"【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"失败,").concat(o.message),activeTime:p.formatTime((new Date).getTime())}),e.next=22;break;case 14:if(!o.data){e.next=20;break}return console.log("【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"成功")),p.storeLogList["".concat(a.country)].log_message.push({option:"【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"成功"),activeTime:p.formatTime((new Date).getTime())}),e.abrupt("return",!0);case 20:console.log("【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"失败,").concat(o.message)),p.storeLogList["".concat(a.country)].log_message.push({option:"【".concat(a.mall_alias_name||a.platform_mall_name,"】关注").concat(t.UserName,"失败,").concat(o.message),activeTime:p.formatTime((new Date).getTime())});case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e)})));function t(t,a,n){return e.apply(this,arguments)}return t}()},{key:"GetShopComment",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a,n,r){var o,i,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o={},o["mallId"]=n.platform_mall_id,o["country"]=n.country,o["itemid"]=t,o["offset"]=r,o["shopid"]=a,e.next=8,p.MallAPIInstance.getShoppComment(o);case 8:if(i=e.sent,200!==i.code){e.next=15;break}return l=i.data.ratings||[],s=l.filter((function(e){if(e.rating_star>=Number(n.min_order_evaluation))return e})),e.abrupt("return",s);case 15:return console.log("商品评价获取失败".concat(i.message)),p.storeLogList["".concat(n.country)].log_message.push({option:"商品评价获取失败".concat(i.message),activeTime:that.formatTime((new Date).getTime())}),e.abrupt("return",[]);case 18:case"end":return e.stop()}}),e)})));function t(t,a,n,r){return e.apply(this,arguments)}return t}()}]),e}()},e5c5:function(e,t,a){"use strict";a("71a1")},feb6:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ul",{staticClass:"storeChooseUL"},[e.isMall?a("li",[e._v(e._s(e._f("chineseSite")(e.countryVal)))]):a("li",{style:e.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:e.spanWidth}},[e._v("所属站点：")]),a("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:"",disabled:e.isBanPerform},model:{value:e.countryVal,callback:function(t){e.countryVal=t},expression:"countryVal"}},[e.isAll?a("el-option",{attrs:{label:"全部",value:""}}):e._e(),e._l(e.countries,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),a("li",{style:e.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:e.spanWidth}},[e._v("店铺分组：")]),a("el-select",{staticClass:"selectBox",style:{width:e.inputWidth},attrs:{disabled:e.isBanPerform,multiple:"","collapse-tags":"",filterable:"",size:"mini"},model:{value:e.groupId,callback:function(t){e.groupId=t},expression:"groupId"}},[a("el-option",{attrs:{label:"全部",value:""},nativeOn:{click:function(t){return e.changeGroupSelect(e.groupId,!0)}}}),e._l(e.groupIdList,(function(t,n){return a("el-option",{key:n,attrs:{label:t.group_name,value:t.id},nativeOn:{click:function(t){return e.changeGroupSelect(e.groupId)}}})}))],2)],1),a("li",{directives:[{name:"show",rawName:"v-show",value:e.showGrade<2,expression:"showGrade < 2"}],style:e.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:e.spanWidth}},[e._v("店铺名称：")]),a("el-popover",{attrs:{placement:"top",width:"180",trigger:"click"}},[e.tableShow?a("u-table",{ref:"zz_mall_select_all",staticClass:"zz_mall_select_all",attrs:{"tooltip-effect":"dark","show-header":!1,"row-height":34,border:!1,"big-data-checkbox":"","use-virtual":"","show-body-overflow":"","data-changes-scroll-top":!1,data:e.siteShowList,"max-height":"250","cell-style":{padding:"0px!important"}}},[a("u-table-column",{attrs:{align:"left","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"zz_mall_select_item",class:e.siteId.includes(t.row.platform_mall_id)&&"zz_mall_select_active",on:{click:function(a){return e.changeSiteSelect(t.row.platform_mall_id,!t.row.platform_mall_id)}}},[e._v(" "+e._s(t.row.mall_alias_name||t.row.platform_mall_name)+" ")])]}}],null,!1,749083916)})],1):e._e(),a("div",{staticClass:"zz_mall_select_input",style:{width:e.inputWidth},attrs:{slot:"reference"},slot:"reference"},[e.site.length?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v(" "+e._s(e.site[0].mall_alias_name||e.site[0].platform_mall_name)+" ")]):e._e(),e.site.length>1?a("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("+"+e._s(e.site.length-1))]):e._e(),a("el-input",{attrs:{size:"mini",clearable:""},on:{input:e.searchInput},model:{value:e.searchSite,callback:function(t){e.searchSite=t},expression:"searchSite"}})],1)],1)],1),e.isReset?a("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[a("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary",disabled:e.isBanPerform},on:{click:e.reset}},[e._v(" 　刷　　新　 ")])],1):e._e()])])},r=[],o=a("1da1"),i=a("2909"),l=(a("96cf"),a("a9e3"),a("caad"),a("2532"),a("99af"),a("d81d"),a("fb6a"),a("4de4"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("c740"),a("a434"),a("25f0"),a("7db0"),a("7646")),s={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},inputWidth:{type:String,default:"180px"},parentCountry:{type:String,default:"TH"},isMall:{type:Boolean,default:function(){return!1}},isBanPerform:{type:Boolean,default:function(){return!1}},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}},isAShop:{type:Boolean,default:function(){return!1}},showGrade:{type:Number,default:function(){return 0}}},data:function(){return{countryVal:null,groupId:[],groupIdList:[],allSiteList:[],site:[],siteId:[],siteList:[],siteShowList:[],tableShow:!0,searchSite:"",countries:this.$filters.countries_option,mallListAPIInstance:new l["a"](this),showMallNumber:100,mallShowIndex:0}},watch:{siteList:function(e){this.siteShowList=e},countryVal:{handler:function(e){this.groupId=[],this.groupIdList=[],this.getMallGoodsGetMallList(1)},deep:!0}},mounted:function(){this.countryVal=!this.isAll&&this.parentCountry||""},methods:{reset:function(){this.groupId=[],this.groupIdList=[],this.getMallGoodsGetMallList(1)},changeGroupSelect:function(e,t){console.log("changeGroupSelect"),t?e.includes("")?this.groupId=[""].concat(Object(i["a"])(this.groupIdList.map((function(e){return e.id})))):this.groupId=[]:e.includes("")||e.length!==this.groupIdList.length?e.includes("")&&e.length===this.groupIdList.length&&(this.groupId=e.slice(1)):this.groupId.unshift(""),this.getMallGoodsGetMallList(2)},getMallGoodsGetMallList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,r,o,l,s,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log("getMallGoodsGetMallList - val",e),t.searchSite="",1!==e){a.next=11;break}return n=t.countryVal,a.next=6,t.mallListAPIInstance.ddMallGoodsGetMallList();case 6:r=a.sent,200===r.code?(o=r.data||[],t.isAShop||o.unshift({platform_mall_name:"全部",platform_mall_id:""}),t.allSiteList=o,t.siteList=""===n?o:o.filter((function(e){return(null===e||void 0===e?void 0:e.country)===n||!e.platform_mall_id}))):t.$message.error("获取分组、店铺列表失败"),0===t.groupIdList.length&&(l=new Set(t.siteList.map((function(e){if(e.group_id)return JSON.stringify({group_name:e.group_name,id:e.group_id})}))),l.delete(void 0),s=Object(i["a"])(l),c=s.map((function(e){return JSON.parse(e)})),c.zzSort("id"),t.groupIdList=Object(i["a"])(c),t.groupId=[""].concat(Object(i["a"])(c.map((function(e){return e.id}))))),a.next=14;break;case 11:u=[],u=""===t.groupId[0]?t.allSiteList:t.allSiteList.filter((function(e){if(t.groupId.includes(e.group_id)||!e.platform_mall_id)return e})),t.siteList=u;case 14:t.siteId=[],t.changeSiteSelect("",!0);case 16:case"end":return a.stop()}}),a)})))()},changeSiteSelect:function(e,t){var a=this.searchSite,n=this.siteId;if(this.isAShop)this.siteId=[e];else{if(t)if(a){var r=this.siteShowList.map((function(e){return e.platform_mall_id}));if(n.includes(e))n=n.filter((function(e){return!r.includes(e)}));else{var o=new Set([""].concat(Object(i["a"])(n),Object(i["a"])(r)));n=Object(i["a"])(o)}}else n=n.includes(e)?[]:this.siteList.map((function(e){return e.platform_mall_id}));else{var l=n.findIndex((function(t){return t===e}));if(l>-1)n.splice(l,1),n.includes("")&&n.splice(0,1);else if(n.push(e),a){var s,c=this.siteShowList.filter((function(e){return n.includes(e.platform_mall_id)}));n.includes("")||(null===(s=this.siteShowList)||void 0===s?void 0:s.length)!==c.length+1||n.unshift("")}else{var u;n.includes("")||(null===(u=this.siteList)||void 0===u?void 0:u.length)!==n.length+1||n.unshift("")}}this.siteId=n}this.changeMallList()},changeMallList:function(){(new Date).getTime();var e=[],t="",a=this.siteId;if(this.isAShop){a=a[0];var n=this.siteList.find((function(e){return e.platform_mall_id===a}));t=a,e.push(n)}else this.site=this.siteList.filter((function(e){return a.includes(e.platform_mall_id)})),a.length&&""===a[0]?(a=a.slice(1),e=this.site.slice(1)):e=this.site,t=a.toString();!this.countryVal&&this.groupId.indexOf("")>-1&&(t=e.length!==this.siteList.length&&t||""),console.log("changeMallList",e),this.source?this.$emit("changeMallList",{mallList:e,groupIdList:this.groupId,source:this.source,searchAll:t,country:this.countryVal.toLocaleUpperCase()}):(e["country"]=this.countryVal,this.$emit("changeMallList",e))},searchInput:function(){var e=this;this.searchSetTime&&clearTimeout(this.searchSetTime),this.searchSetTime=null,this.searchSetTime=setTimeout((function(){var t=e.siteList.filter((function(t){var a=!0;if(e.searchSite&&t.platform_mall_id){var n=t.mall_alias_name||t.platform_mall_name;a=n.includes(e.searchSite)}return a}));e.siteShowList=t,e.tableShow=!1,e.$nextTick((function(){e.tableShow=!0}))}),500)}}},c=s,u=(a("8992"),a("8d7e"),a("2877")),m=Object(u["a"])(c,n,r,!1,null,"85b20ae4",null);t["a"]=m.exports}}]);