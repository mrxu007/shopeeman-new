(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e447014"],{"5ea7":function(e,t,a){},e185:function(e,t,a){"use strict";a("5ea7")},fe1b:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"contaniner"},[a("el-row",{staticClass:"header"},[a("ul",{staticStyle:{"margin-bottom":"10px"}},[a("li",[a("span",[e._v("包裹签收时间：")]),a("el-date-picker",{attrs:{"unlink-panels":"",size:"mini",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.form.signingTime,callback:function(t){e.$set(e.form,"signingTime",t)},expression:"form.signingTime"}})],1),a("li",[a("span",[e._v("申请退件时间：")]),a("el-date-picker",{attrs:{"unlink-panels":"",size:"mini",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.form.applyReturnTime,callback:function(t){e.$set(e.form,"applyReturnTime",t)},expression:"form.applyReturnTime"}})],1)]),a("ul",[a("li",[a("span",[e._v("包裹状态：")]),a("el-select",{attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.form.packageStatus,callback:function(t){e.$set(e.form,"packageStatus",t)},expression:"form.packageStatus"}},[a("el-option",{attrs:{label:"全部",value:0}}),e._l(e.packageStatusList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),a("li",[a("span",[e._v("订单编号：")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.form.orderNum,callback:function(t){e.$set(e.form,"orderNum",t)},expression:"form.orderNum"}})],1),a("li",[a("span",[e._v("包裹物流编号：")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.form.logisticsNum,callback:function(t){e.$set(e.form,"logisticsNum",t)},expression:"form.logisticsNum"}})],1),a("li",[a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.cancelLoading},on:{click:function(t){e.page=1,e.getSignPackageList()}}},[e._v("查询")]),a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.cancelLoading},on:{click:function(t){return e.returnParts(e.multipleSelection)}}},[e._v("批量申请退件")]),a("el-button",{attrs:{type:"primary",size:"mini",loading:e.cancelLoading},on:{click:function(t){return e.cancelReturn(e.multipleSelection)}}},[e._v("批量取消退件")])],1)])]),a("el-row",{attrs:{id:"article"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isShowLoading,expression:"isShowLoading"}],ref:"plTable",attrs:{height:"calc(100vh - 205px)",data:e.tableData,"header-cell-style":{backgroundColor:"#f5f7fa"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"50",fixed:""}}),a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",fixed:""}}),a("el-table-column",{attrs:{prop:"package_code",label:"包裹物流单号",width:"150",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(" "+e._s(r.package_code)+" "),r.package_code?a("span",{staticClass:"copyIcon",on:{click:function(t){return e.copy(r.package_code)}}},[a("i",{staticClass:"el-icon-document-copy"})]):e._e()])]}}])}),a("el-table-column",{attrs:{prop:"order_sn",label:"订单编号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(" "+e._s(r.order_sn)+" "),r.order_sn?a("span",{staticClass:"copyIcon",on:{click:function(t){return e.copy(r.order_sn)}}},[a("i",{staticClass:"el-icon-document-copy"})]):e._e()])]}}])}),a("el-table-column",{attrs:{prop:"variation_sku",label:"商品规格",width:"120"}}),a("el-table-column",{attrs:{prop:"warehouse_name",label:"签收仓库",width:"130"}}),a("el-table-column",{attrs:{prop:"package_time",label:"签收时间",width:"110"}}),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[1===r.status?a("span",[e._v("已签收")]):2===r.status?a("span",[e._v("已经拒收")]):3===r.status?a("span",[e._v("匹配不到订单包")]):4===r.status?a("span",[e._v("包裹已销毁")]):5===r.status?a("span",[e._v("包裹丢件")]):6===r.status?a("span",[e._v("申请退件")]):7===r.status?a("span",[e._v("已退件")]):a("span")]}}])}),a("el-table-column",{attrs:{prop:"package_image",label:"签收图片",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.package_image?a("el-tooltip",{staticStyle:{width:"50px",height:"50px"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("img",{attrs:{src:r.package_image,width:"300px",height:"300px"}})]),a("el-image",{attrs:{src:r.package_image,alt:""}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"})])],1):e._e()]}}])}),a("el-table-column",{attrs:{label:"退件信息",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[2===r.isApplyReturn?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.getReturnInfo(r)}}},[e._v("查看")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"appli_return_time",label:"申请退件时间",width:"110"}}),a("el-table-column",{attrs:{prop:"return_shipping_number",label:"退件物流单号",width:"130"}}),a("el-table-column",{attrs:{prop:"return_time",label:"退件时间",width:"100"}}),a("el-table-column",{attrs:{prop:"return_shipping_name",label:"退件物流公司",width:"180"}}),a("el-table-column",{attrs:{label:"操作",width:"100px",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[1===r.isApplyReturn?a("el-button",{attrs:{disabled:e.cancelLoading,type:"primary",size:"mini"},on:{click:function(t){return e.returnParts(r)}}},[e._v("退件")]):e._e(),2===r.isApplyReturn?a("el-button",{attrs:{disabled:e.cancelLoading,type:"primary",size:"mini"},on:{click:function(t){return e.cancelReturn(r)}}},[e._v("取消退件")]):e._e()]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.page,"page-sizes":[30,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{staticClass:"dialog",attrs:{title:"填写退件信息","close-on-click-modal":!1,visible:e.returnMsgDialog,width:"400px","close-on-press-escape":!1,"show-close":!e.isButLoading},on:{"update:visible":function(t){e.returnMsgDialog=t},close:e.handleClose}},[a("el-form",{attrs:{"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"收件人"}},[a("el-input",{attrs:{clearable:"",placeholder:"请填写收件人",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.returnMsg.returnContact,callback:function(t){e.$set(e.returnMsg,"returnContact",t)},expression:"returnMsg.returnContact"}})],1),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{attrs:{clearable:"",placeholder:"请填写联系电话",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.returnMsg.returnPhoneNumber,callback:function(t){e.$set(e.returnMsg,"returnPhoneNumber",t)},expression:"returnMsg.returnPhoneNumber"}})],1),a("el-form-item",{attrs:{label:"退件地区"}},[a("el-cascader",{ref:"refTbCate",attrs:{props:e.props,size:"mini"},on:{change:e.targetCate},model:{value:e.applyRegion,callback:function(t){e.applyRegion=t},expression:"applyRegion"}})],1),a("el-form-item",{attrs:{label:"详细地址"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请填写详细地址",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.returnMsg.returnAddress,callback:function(t){e.$set(e.returnMsg,"returnAddress",t)},expression:"returnMsg.returnAddress"}})],1),e.isOverseas?a("div",[a("p",{staticStyle:{color:"red"}},[e._v("shoppe平台包裹：上传平台返回的退件包裹二维码")]),a("p",{staticStyle:{color:"red"}},[e._v("Lazada平台包裹：上传平台返回的退件包裹PDF文件")]),a("el-form-item",{attrs:{label:"包裹文件"}},[a("div",{staticStyle:{display:"flex"}},[a("div",[a("el-button",{attrs:{loading:e.upFileLiadding,type:"primary",size:"mini"},on:{click:e.reupload}},[a("i",{staticClass:"el-icon-upload el-icon--right"},[e._v(" 上传文件 ")])])],1),a("div",{staticClass:"img-box",staticStyle:{width:"40px",height:"40px","margin-left":"5px"}},[a("img",{attrs:{src:e.returnMsg.returnFile,alt:"",width:"40px",height:"40px"}})])])])],1):e._e(),a("el-form-item",{attrs:{label:"退件备注"}},[a("el-input",{attrs:{type:"textarea",size:"mini",placeholder:"请填写退件备注",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.returnMsg.returnRemarks,callback:function(t){e.$set(e.returnMsg,"returnRemarks",t)},expression:"returnMsg.returnRemarks"}})],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{width:"100px"},attrs:{loading:e.isButLoading,type:"primary",size:"mini"},on:{click:e.saveReturnMsg}},[e._v("保存")])],1)],1),a("el-dialog",{staticClass:"dialog",attrs:{title:"退件详情","close-on-click-modal":!1,visible:e.returnInfoDialog,width:"400px"},on:{"update:visible":function(t){e.returnInfoDialog=t},close:e.handleClose}},[a("el-form",{attrs:{"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"退件人"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.returnInfoVal.return_contact,callback:function(t){e.$set(e.returnInfoVal,"return_contact",t)},expression:"returnInfoVal.return_contact"}})],1),a("el-form-item",{attrs:{label:"退件电话"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.returnInfoVal.return_phone_number,callback:function(t){e.$set(e.returnInfoVal,"return_phone_number",t)},expression:"returnInfoVal.return_phone_number"}})],1),a("el-form-item",{attrs:{label:"退件金额"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.returnInfoVal.return_amount,callback:function(t){e.$set(e.returnInfoVal,"return_amount",t)},expression:"returnInfoVal.return_amount"}})],1),a("el-form-item",{attrs:{label:"退件物流单号"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.returnInfoVal.return_shipping_number,callback:function(t){e.$set(e.returnInfoVal,"return_shipping_number",t)},expression:"returnInfoVal.return_shipping_number"}})],1),a("el-form-item",{attrs:{label:"退件物流公司"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.returnInfoVal.return_shipping_name,callback:function(t){e.$set(e.returnInfoVal,"return_shipping_name",t)},expression:"returnInfoVal.return_shipping_name"}})],1),a("el-form-item",{attrs:{label:"退件地址"}},[a("el-input",{attrs:{type:"textarea",size:"mini"},model:{value:e.returnInfoVal.return_address,callback:function(t){e.$set(e.returnInfoVal,"return_address",t)},expression:"returnInfoVal.return_address"}})],1),a("el-form-item",{attrs:{label:"退件备注"}},[a("el-input",{attrs:{type:"textarea",size:"mini"},model:{value:e.returnInfoVal.return_remarks,callback:function(t){e.$set(e.returnInfoVal,"return_remarks",t)},expression:"returnInfoVal.return_remarks"}})],1)],1)],1),a("div",{staticClass:"logging"},[a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showConsole,callback:function(t){e.showConsole=t},expression:"showConsole"}})],1)],1)},n=[],s=a("1da1"),i=(a("96cf"),a("d81d"),a("b0c0"),a("ac1f"),a("5319"),a("d3b7"),a("25f0"),a("b64b"),a("159b"),a("1276"),a("99af"),a("a9e3"),{data:function(){return{isOverseas:!1,showConsole:!0,applyRegion:[],selectAddress:{province:"",city:"",area:"",address:""},returnMsg:{lists:[],returnContact:"",returnPhoneNumber:"",returnAddress:"",returnRemarks:"",returnFile:""},returnInfoVal:{return_contact:"",return_phone_number:"",return_amount:"",return_shipping_number:"",return_shipping_name:"",return_address:"",return_remarks:""},isShowLoading:!1,isButLoading:!1,cancelLoading:!1,upFileLiadding:!1,form:{signingTime:[(new Date).getTime()-6048e5,new Date],applyReturnTime:"",packageStatus:0,orderNum:"",logisticsNum:""},total:0,pageSize:30,page:1,tableData:[],packageStatusList:[{value:"1",label:"已签收"},{value:"2",label:"已经拒收"},{value:"3",label:"匹配不到订单包"},{value:"4",label:"包裹已销毁"},{value:"5",label:"包裹丢件"},{value:"6",label:"申请退件"},{value:"7",label:"已退件"}],returnMsgDialog:!1,returnInfoDialog:!1,multipleSelection:[],packageCodes:[],props:{lazy:!0,that:this,lazyLoad:function(e,t){var a=this,r=e.level;setTimeout(Object(s["a"])(regeneratorRuntime.mark((function n(){var s,i,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=[],0!==r){n.next=8;break}return n.next=4,a.that.$BaseUtilService.getPddAddressModel("0");case 4:i=n.sent,s=i.map((function(e){return e.label=e.RegionName,e.leaf=e.RegionType>=3,e.value=e.RegionId,e})),n.next=12;break;case 8:return n.next=10,a.that.$BaseUtilService.getPddAddressModel(e.value);case 10:l=n.sent,s=l.map((function(e){return e.label=e.RegionName,e.leaf=e.RegionType>=3,e.value=e.RegionId,e}));case 12:t(s||[]);case 13:case"end":return n.stop()}}),n)}))),1e3)}}}},mounted:function(){this.getSignPackageList()},methods:{reupload:function(){var e=this,t=document.createElement("input");t.type="file",t.onchange=function(){var a=t.files[0];if(!/\.(jpg|png|pdf)$/.test(a.name.toLowerCase()))return e.$refs.Logs.writeLog("格式错误,请上传jpg、png、pdf格式的文件",!1),void(e.showConsole=!1);var r=new FileReader;r.readAsDataURL(a),r.onload=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=r.result,e.upFileLiadding=!0,t.next=4,e.$ossService.uploadFile(n,Math.round(1e8*Math.random())+".png");case 4:s=t.sent,e.returnMsg.returnFile="",e.returnMsg.returnFile=s,e.upFileLiadding=!1;case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};var a=new MouseEvent("click");t.dispatchEvent(a)},targetCate:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.length>0&&(t.selectCateFinally="",r=t.$refs.refTbCate.getCheckedNodes()[0],n={},r.pathLabels.map((function(e){n[e]||(n[e]="1")})),t.returnMsg.returnAddress=Object.keys(n).toString().replace(/,/g,""));case 1:case"end":return a.stop()}}),a)})))()},getReturnInfo:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={packageCode:e.package_code,gpcId:e.gpcId},a.next=3,t.$api.getReturnInfo(r);case 3:n=a.sent,s=n.data,200===s.code?(t.returnInfoDialog=!0,t.returnInfoVal={return_contact:s.data.return_contact,return_phone_number:s.data.return_phone_number,return_amount:s.data.return_amount,return_shipping_number:s.data.return_shipping_number,return_shipping_name:s.data.return_shipping_name,return_address:s.data.return_address,return_remarks:s.data.return_remarks}):t.$message.error(s.message);case 6:case"end":return a.stop()}}),a)})))()},cancelReturn:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.packageCodes=[],!Array.isArray(e)){a.next=7;break}if(e.length){a.next=4;break}return a.abrupt("return",t.$message("请选择需要取消退件的包裹"));case 4:e.map((function(e){t.packageCodes.push(e.package_code)})),a.next=8;break;case 7:t.packageCodes.push(e.package_code);case 8:return t.cancelLoading=!0,a.next=11,t.$api.cancelReturn({packageCodes:t.packageCodes});case 11:r=a.sent,200===r.data.code?(t.getSignPackageList(),t.$message.success("取消退件成功")):t.$message.error(r.data.message),t.cancelLoading=!1;case 14:case"end":return a.stop()}}),a)})))()},returnParts:function(e){var t=this;if(this.returnMsg.returnFile="",this.isOverseas=!1,this.returnMsg.lists=[],Array.isArray(e)){if(!e.length)return this.$message("请选择需要申请退件的包裹");e.every((function(t){return t.warehouse_type===e[0].warehouse_type}))?(e.map((function(e){t.returnMsg.lists.push({gpcId:e.gpcId,packageCode:e.package_code}),3===e.warehouse_type&&(t.isOverseas=!0)})),this.returnMsgDialog=!0):this.$message.error("无法同时退不同仓库的包裹")}else this.returnMsg.lists.push({gpcId:e.gpcId,packageCode:e.package_code}),3===e.warehouse_type&&(this.isOverseas=!0),this.returnMsgDialog=!0},saveReturnMsg:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=/^1([38]\d|5[0-35-9]|7[3678])\d{8}$/,e.returnMsg.returnContact){t.next=3;break}return t.abrupt("return",e.$message("收件人不能为空"));case 3:if(e.returnMsg.returnPhoneNumber){t.next=5;break}return t.abrupt("return",e.$message("联系电话不能为空"));case 5:if(a.test(e.returnMsg.returnPhoneNumber)){t.next=7;break}return t.abrupt("return",e.$message("联系电话码格式有误"));case 7:if(e.applyRegion&&e.applyRegion.length){t.next=9;break}return t.abrupt("return",e.$message("退件地区不能为空"));case 9:if(e.returnMsg.returnAddress){t.next=11;break}return t.abrupt("return",e.$message("详细地址不能为空"));case 11:return e.isButLoading=!0,t.next=14,e.$api.applicationForreJection(e.returnMsg);case 14:r=t.sent,n=r.data,200===n.code?n.data.forEach((function(t){e.$refs.Logs.writeLog("物流单号【".concat(t.split("：")[0],"】申请退件成功"),!0)})):n.data.forEach((function(t){e.$refs.Logs.writeLog("【".concat(t.split("：")[0],"】").concat(t.split("：")[1]),!1)})),e.showConsole=!1,e.getSignPackageList(),e.returnMsgDialog=!1,e.isButLoading=!1;case 21:case"end":return t.stop()}}),t)})))()},getSignPackageList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isShowLoading=!0,a=e.form.signingTime?"".concat(e.$dayjs(e.form.signingTime[0]).format("YYYY-MM-DD HH:mm:ss"),"/").concat(e.$dayjs(e.form.signingTime[1]).format("YYYY-MM-DD HH:mm:ss")):"",r=e.form.applyReturnTime?"".concat(e.$dayjs(e.form.applyReturnTime[0]).format("YYYY-MM-DD HH:mm:ss"),"/").concat(e.$dayjs(e.form.applyReturnTime[1]).format("YYYY-MM-DD HH:mm:ss")):"",n={packageCode:e.form.logisticsNum,mainOrderSn:e.form.orderNum,status:Number(e.form.packageStatus),packageTime:a,appliReturnTime:r,page:e.page,pageSize:e.pageSize},t.prev=4,t.next=7,e.$api.getSignPackageList(n);case 7:s=t.sent,i=s.data,200===i.code?(e.total=i.data.total,l=i.data.data,l&&(e.tableData=l)):e.$message.error("获取数据失败",i.message),t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](4);case 14:e.isShowLoading=!1;case 15:case"end":return t.stop()}}),t,null,[[4,12]])})))()},copy:function(e){var t=document.createElement("div");t.id="tempTarget",t.style.opacity="0",t.innerText=e,document.body.appendChild(t);try{var a=document.createRange();a.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(a),document.execCommand("copy"),window.getSelection().removeAllRanges(),this.$message.success("复制成功")}catch(r){}t.parentElement.removeChild(t)},handleSizeChange:function(e){this.page=1,this.pageSize=e,this.getSignPackageList()},handleCurrentChange:function(e){this.page=e,this.getSignPackageList()},handleClose:function(){this.returnMsg={},this.applyRegion=[],this.returnInfoVal={},this.isButLoading=!1},handleSelectionChange:function(e){this.multipleSelection=e}}}),l=i,o=(a("e185"),a("2877")),u=Object(o["a"])(l,r,n,!1,null,"337120de",null);t["default"]=u.exports}}]);