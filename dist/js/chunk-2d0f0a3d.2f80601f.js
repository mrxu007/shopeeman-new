(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0f0a3d"],{"9cda":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"contaniner"},[a("el-row",{staticClass:"header"},[a("div",{staticClass:"on_new_dialog_box",staticStyle:{"margin-bottom":"10px"}},[a("div",[e._v("店铺站点：")]),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"mini",filterable:""},model:{value:e.countryOption,callback:function(t){e.countryOption=t},expression:"countryOption"}},e._l(e.countriesOption,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),a("div",{staticStyle:{"margin-left":"20px"}},[e._v("任务名称：")]),a("el-input",{staticStyle:{width:"140px"},attrs:{size:"mini"},model:{value:e.taskName,callback:function(t){e.taskName=t},expression:"taskName"}}),a("div",{staticStyle:{"margin-left":"20px"}},[e._v("任务状态：")]),a("el-select",{attrs:{value:"",size:"mini"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.statusList,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1),a("div",{staticStyle:{"margin-left":"20px"}},[e._v("任务日期：")]),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",size:"mini",placeholder:"选择开始日期"},model:{value:e.taskTimeStart,callback:function(t){e.taskTimeStart=t},expression:"taskTimeStart"}}),a("div",{staticStyle:{width:"6px",height:"1px",background:"#1a1a1a",margin:"0 7px"}}),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",size:"mini",placeholder:"选择结束日期"},model:{value:e.taskTimeEnd,callback:function(t){e.taskTimeEnd=t},expression:"taskTimeEnd"}})],1),a("div",{staticClass:"on_new_dialog_box",staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.searchTask}},[e._v("搜索任务")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.startTask}},[e._v("启动任务")]),a("el-button",{attrs:{size:"mini"},on:{click:e.cancelTask}},[e._v("取消任务")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.deleteTask}},[e._v("删除任务")])],1)]),a("u-table",{attrs:{data:e.taskTable,"use-virtual":"","data-changes-scroll-top":!1,"header-cell-style":{backgroundColor:"#f5f7fa",height:"50px"},"row-key":"id",border:!1,"big-data-checkbox":!0,height:"680"},on:{"selection-change":e.handleSelectionChange}},[a("u-table-column",{attrs:{align:"left",type:"selection",width:"50"}}),a("u-table-column",{attrs:{align:"left",label:"序列号",type:"index",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1)+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"任务名称",width:"120","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.task_name)+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"店铺名称","min-width":"120","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",{staticClass:"goodsTableLine"},[e._v(" "+e._s(n.mall_names)+" ")])]}}])}),a("u-table-column",{attrs:{align:"left",label:"店铺站点",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){t.row;return[e._v(" "+e._s(e._f("chineseSite")(e.countryOption))+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"店铺分组",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){t.row;return[e._v("全部 ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"执行时间",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.exec_time)+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"商品总数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.goods_count)+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"上新成功数",width:"120",prop:"category_name"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.success_count)+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"上新失败数",width:"120",prop:"categoryName","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.fail_count)+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"执行状态",width:"120",prop:"price"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.statusShow[Number(a.status)])+" ")]}}])}),a("u-table-column",{attrs:{align:"left",label:"任务详情",width:"120",prop:"sys_label_name","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.viewTask(t)}}},[e._v("查看")])]}}])}),a("u-table-column",{attrs:{align:"left",label:"启动任务",width:"120",prop:"sourceName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.startTask(t)}}},[e._v("启动")])]}}])})],1)],1)},l=[],s=a("1da1"),r=(a("d81d"),a("3ca3"),a("ddb0"),a("c740"),a("a434"),a("96cf"),{data:function(){return{countriesOption:this.$filters.countries_option,countryOption:"TH",taskName:"",taskTimeStart:new Date((new Date).getTime()-1728e5),taskTimeEnd:new Date((new Date).getTime()),taskTable:[],taskSelectTable:[],statusList:[{value:"",label:"全部"},{value:1,label:"已执行"},{value:2,label:"部分失败"},{value:3,label:"待执行"},{value:4,label:"待启动"}],statusShow:{1:"已执行",2:"部分失败",3:"待执行",4:"待启动"},status:""}},methods:{searchTask:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,l,s,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.taskTable=[],a=e.countryOption,n=e.status,l=e.taskName,s=Math.floor(e.taskTimeStart.getTime()/1e3),r=Math.floor(e.taskTimeEnd.getTime()/1e3),t.next=8,e.$collectService.getCronPublishTask(a,n+"",l,s,r);case 8:i=t.sent,e.taskTable=i;case 10:case"end":return t.stop()}}),t)})))()},startTask:function(e){0!==this.taskSelectTable.length||this.$message.error("请选择一个定时任务")},cancelTask:function(){0!==this.taskSelectTable.length||this.$message.error("请选择一个定时任务")},deleteTask:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,l,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.taskSelectTable.length){t.next=3;break}return e.$message.error("请选择一个定时任务"),t.abrupt("return");case 3:return a=e.taskSelectTable.map((function(e){return e.id})),t.next=6,e.$collectService.deleteCronPublishTask(a);case 6:if(n=t.sent,200!=n.code){t.next=20;break}return e.$message.success("删除成功"),t.next=11,e.$collectService.deleteCronPublishConfig(a);case 11:l=regeneratorRuntime.mark((function t(n){var l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$collectService.deleteCronPublishGoods(a[n]+"");case 2:l=e.taskTable.findIndex((function(e){return e.id===a[n]})),e.taskTable.splice(l,1);case 4:case"end":return t.stop()}}),t)})),s=0;case 13:if(!(s<a.length)){t.next=18;break}return t.delegateYield(l(s),"t0",15);case 15:s++,t.next=13;break;case 18:t.next=21;break;case 20:e.$message.error("删除失败");case 21:case"end":return t.stop()}}),t)})))()},viewTask:function(e){},handleSelectionChange:function(e){this.taskSelectTable=e}}}),i=r,o=a("2877"),c=Object(o["a"])(i,n,l,!1,null,null,null);t["default"]=c.exports}}]);