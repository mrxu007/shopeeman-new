(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bc528fd0"],{"176a":function(e,t,n){"use strict";n("d1b0")},"4c28":function(e,t,n){},"890e":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail"},[n("ul",[n("li",[n("storeChoose",{staticStyle:{"margin-left":"-2px"},on:{changeMallList:e.changeMallList}}),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clearLog}},[e._v("清除日志")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setQurey}},[e._v("参数设置")]),n("el-button",{on:{click:e.test}},[e._v("aa")]),n("el-checkbox",{staticStyle:{"margin-top":"5px","margin-left":"5px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")])],1),n("span",{staticClass:"Follow"},[e._v("关注用户")]),n("span",{staticClass:"cancerFollow"},[e._v("取关用户")]),n("li",{staticClass:"row2"},[n("el-row",{attrs:{gutter:25}},[n("el-col",{attrs:{span:15}},[n("ul",[n("li",{staticStyle:{"align-items":"center","margin-bottom":"5px"}},[n("label",{staticStyle:{width:"128px"}},[e._v("店铺ID信息：")]),n("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:e.mallIDinfo,callback:function(t){e.mallIDinfo=t},expression:"mallIDinfo"}}),n("div",[n("el-button",{staticStyle:{"margin-left":"10px","margin-bottom":"5px"},attrs:{type:"primary",size:"mini"},on:{click:e.addCancerMall}},[e._v("添加关注店铺")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clearMallIDinfo}},[e._v("清空店铺信息")])],1)],1),n("li",{staticStyle:{"margin-left":"80px"}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.startCancer}},[e._v("开始关注")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.stopSet}},[e._v("取消操作")])],1)])]),n("el-col",{attrs:{span:9}},[n("div",{staticClass:"grid-content bg-purple"}),n("ul",[n("li",[n("el-button",{staticStyle:{width:"105px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.Unfollower(1)}}},[e._v("开始取关")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.stopSet}},[e._v("取消操作")])],1),n("li",[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.Unfollower(0)}}},[e._v("取关所有用户")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.canCerFollowUnFollowMe}},[e._v("取关未关注我的用户")])],1),n("li",{staticStyle:{height:"30px"}})])])],1)],1),n("li",{staticStyle:{color:"red"}},[e._v("温馨提示：关注用户或者取关啊用户后，获取到的关注用户量和粉丝量可能不准确，有缓存（shopee官网缓存），请稍后查看。")]),n("li",[n("el-table",{attrs:{"header-cell-style":{background:"#f7fafa"},data:e.tableList,"row-style":{height:"50px"},height:"calc(100vh - 220px)"}},[n("el-table-column",{attrs:{type:"index",label:"序列号","min-width":"100px",align:"center"}}),n("el-table-column",{attrs:{prop:"",label:"站点","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(e._f("chineseSite")(n.country)))]}}])}),n("el-table-column",{attrs:{prop:"",label:"店铺名","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(n.mall_alias_name||n.platform_mall_name))]}}])}),n("el-table-column",{attrs:{prop:"following",label:"关注中","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(Number(n.following)?Number(n.following):"-"))]}}])}),n("el-table-column",{attrs:{prop:"fence",label:"粉丝","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(Number(n.fence)?Number(n.fence):"-"))]}}])}),n("el-table-column",{attrs:{prop:"newFollow",label:"新增关注数量","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(Number(n.newFollow)?Number(n.newFollow):"-"))]}}])}),n("el-table-column",{attrs:{prop:"cancerFollow",label:"取关数量","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(Number(n.cancerFollow)?Number(n.cancerFollow):"-"))]}}])}),n("el-table-column",{attrs:{prop:"state",label:"操作状态","min-width":"150px",align:"center"}})],1)],1)]),n("el-dialog",{staticClass:"dialog_mall",attrs:{title:"店铺搜索",visible:e.dialog_mallSearch,width:"950px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialog_mallSearch=t}}},[n("ul",[n("li",[n("label",[e._v("关键词")]),n("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),n("label",[e._v("评论数")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.minComment,callback:function(t){e.minComment=t},expression:"minComment"}}),e._v("- "),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.maxComment,callback:function(t){e.maxComment=t},expression:"maxComment"}}),n("label",[e._v("点赞数")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.minLike,callback:function(t){e.minLike=t},expression:"minLike"}}),e._v("- "),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.maxLike,callback:function(t){e.maxLike=t},expression:"maxLike"}})],1),n("li",[n("label",[e._v("评分数")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.minScore,callback:function(t){e.minScore=t},expression:"minScore"}}),e._v("- "),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.maxScore,callback:function(t){e.maxScore=t},expression:"maxScore"}}),n("label",{staticStyle:{"margin-left":"50px"}},[e._v("店铺数")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.mallNum,callback:function(t){e.mallNum=t},expression:"mallNum"}}),n("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",size:"mini"},on:{click:e.searchMall}},[e._v("搜索")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addTargetMall}},[e._v("添加勾选店铺")])],1),n("li",[n("el-table",{attrs:{"header-cell-style":{background:"#f7fafa"},data:e.mallSearchList,"row-style":{height:"50px"},"max-height":"400"},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{align:"center",width:"55",type:"selection"}}),n("el-table-column",{attrs:{align:"center",label:"序号",width:"55",type:"index"}}),n("el-table-column",{attrs:{prop:"shopid",label:"店铺ID","min-width":"100px",align:"center"}}),n("el-table-column",{attrs:{prop:"name",label:"产品标题","min-width":"150px",align:"center","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"",label:"主图","min-width":"100px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-tooltip",{staticStyle:{width:"50px",height:"50px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e._f("imageRender")([a.image])}})],1),n("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e._f("imageRender")([a.image,!0])}})],1)]}}])}),n("el-table-column",{attrs:{prop:"liked_count",label:"点赞数","min-width":"100px",align:"center",fixed:"right"}}),n("el-table-column",{attrs:{prop:"totalRate",label:"评论数","min-width":"100px",align:"center",fixed:"right"}}),n("el-table-column",{attrs:{prop:"rating_star",label:"产品评分","min-width":"100px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(n.item_rating.rating_star.toFixed(2)))]}}])}),n("el-table-column",{attrs:{prop:"",label:"操作","min-width":"200px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.open(a)}}},[e._v("查看产品")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.addMallIDinfo(a)}}},[e._v("添加店铺")])]}}])})],1)],1)])]),n("el-dialog",{staticClass:"dialog_mall",attrs:{title:"用户设置",visible:e.dialog_userInfo,width:"700px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialog_userInfo=t}}},[n("autoFollow",{attrs:{"user-info":e.userInfo,mall:e.selmallList},on:{isSave:e.setSave}})],1),n("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}})],1)},r=[],i=n("53ca"),o=n("2909"),l=n("b85c"),s=n("1da1"),c=n("5530"),u=(n("96cf"),n("159b"),n("caad"),n("2532"),n("99af"),n("3ca3"),n("ddb0"),n("a9e3"),n("d3b7"),n("25f0"),n("4ec9"),n("4de4"),n("b680"),n("a434"),n("ac1f"),n("1276"),n("d81d"),n("c740"),n("feb6")),m=n("cf9f"),f=n("f68b"),p=n("0e0b"),d=n("d1dd"),g={name:"BusinessAnalyseGoodsDiscount",components:{StoreChoose:u["a"],autoFollow:m["a"]},data:function(){return{AutoAddFenceInstance:new d["a"](this),MallAPIInstance:new f["a"](this),selmallList:[],isSave:!1,dialog_userInfo:!1,userInfo:"",mallIDinfo:"",showlog:!1,tableList:[],dialog_mallSearch:!1,keyword:"裤子",minComment:"50",maxComment:"5000",minLike:"100",maxLike:"10000",minScore:"4.5",maxScore:"5",mallNum:"1",mallSearchList:[],sel_mallSearchList:[],isStop:!1}},watch:{selmallList:{handler:function(e){var t=this;this.tableList=[],e.length&&e.forEach((function(e){var n=Object(c["a"])({},e);n["following"]=0,n["fence"]=0,n["newFollow"]=0,n["cancerFollow"]=0,n["state"]="-",t.tableList.push(n)}))},deep:!0}},created:function(){this.getUserinfo()},methods:{addMallIDinfo:function(e){this.mallIDinfo=this.mallIDinfo.includes(e.shopid)?this.mallIDinfo:this.mallIDinfo+","+e.shopid,","===this.mallIDinfo.substr(0,1)&&(this.mallIDinfo=this.mallIDinfo.substr(1))},clearMallIDinfo:function(){this.mallIDinfo=""},canCerFollowUnFollowMe:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.showlog=!1,e.isStop=!1,e.tableList.length){t.next=5;break}return e.$message.warning("请选择要操作的数据"),t.abrupt("return");case 5:return e.userInfo.auto_attention_set||e.$message.warning("请先设置参数"),e.$refs.Logs.writeLog("正在执行数据.....",!0),t.next=9,Object(p["c"])(e.tableList,e.canCerFollowUnFollowMeFun);case 9:e.$refs.Logs.writeLog("数据执行结束",!0);case 10:case"end":return t.stop()}}),t)})))()},canCerFollowUnFollowMeFun:function(e){var t=arguments,n=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,o,s,c,u,m,f,p,d,g,h,b,w,_,v,x,k,y;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},a.prev=1,n.$refs.Logs.writeLog("当前操作店铺：【".concat(e.mall_alias_name||e.platform_mall_name,"】"),!0),a.next=5,n.isLogin(e);case 5:if(i=a.sent,i){a.next=8;break}return a.abrupt("return");case 8:return a.next=10,n.getHomeMallData(e);case 10:if(o=a.sent,n.$set(e,"following",o?o.account.following_count:0),n.$set(e,"fence",o?o.follower_count:0),o){a.next=16;break}return n.$refs.Logs.writeLog("店铺暂无数据"),a.abrupt("return");case 16:return s={},s["country"]=e.country,s["mallId"]=e.platform_mall_id,s["shopid"]=e.platform_mall_id,s["offset"]=0,a.next=23,n.GetShopLikes(s);case 23:c=a.sent,u=c;case 25:if(20!==c.length){a.next=36;break}if(!n.isStop){a.next=28;break}return a.abrupt("break",36);case 28:return s["offset"]+=20,n.$refs.Logs.writeLog("店铺第【".concat(s.offset/20+1,"】页粉丝获取"),!0),a.next=32,n.GetShopLikes(s);case 32:c=a.sent,u=u.concat(c),a.next=25;break;case 36:return n.$refs.Logs.writeLog("店铺粉丝获取结束",!0),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取店铺关注"),!0),m=0,f={},f["country"]=e.country,f["mallId"]=e.platform_mall_id,f["offset"]=0,f["mallName"]=e.mall_alias_name||e.platform_mall_name,a.next=46,n.getHomeFllowering(f);case 46:if(p=a.sent,p.length){a.next=50;break}return n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无关注"),!0),a.abrupt("return");case 50:d=null,g=null,h=Object(l["a"])(p),a.prev=53,w=regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=b.value,!n.isStop){t.next=3;break}return t.abrupt("return","break");case 3:if(!u.length){t.next=7;break}if(d=u.indexOf((function(e){return Number(e.userid)===Number(a.userid)})),!(d>=0)){t.next=7;break}return t.abrupt("return","continue");case 7:return t.next=9,n.runCancerAttention(a,e,e.platform_mall_id);case 9:g=t.sent,g&&m++;case 11:case"end":return t.stop()}}),t)})),h.s();case 56:if((b=h.n()).done){a.next=65;break}return a.delegateYield(w(),"t0",58);case 58:if(_=a.t0,"break"!==_){a.next=61;break}return a.abrupt("break",65);case 61:if("continue"!==_){a.next=63;break}return a.abrupt("continue",63);case 63:a.next=56;break;case 65:a.next=70;break;case 67:a.prev=67,a.t1=a["catch"](53),h.e(a.t1);case 70:return a.prev=70,h.f(),a.finish(70);case 73:if(!(p.length>=20)){a.next=104;break}if(!n.isStop){a.next=76;break}return a.abrupt("break",104);case 76:return f["offset"]+=20,a.next=79,n.getHomeFllowering(f);case 79:p=a.sent,v=Object(l["a"])(p),a.prev=81,k=regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=x.value,!n.isStop){t.next=3;break}return t.abrupt("return","break");case 3:if(!u.length){t.next=7;break}if(d=u.indexOf((function(e){return Number(e.userid)===Number(a.userid)})),!(d>=0)){t.next=7;break}return t.abrupt("return","continue");case 7:return t.next=9,n.runCancerAttention(a,e,e.platform_mall_id);case 9:g=t.sent,g&&m++;case 11:case"end":return t.stop()}}),t)})),v.s();case 84:if((x=v.n()).done){a.next=93;break}return a.delegateYield(k(),"t2",86);case 86:if(y=a.t2,"break"!==y){a.next=89;break}return a.abrupt("break",93);case 89:if("continue"!==y){a.next=91;break}return a.abrupt("continue",91);case 91:a.next=84;break;case 93:a.next=98;break;case 95:a.prev=95,a.t3=a["catch"](81),v.e(a.t3);case 98:return a.prev=98,v.f(),a.finish(98);case 101:n.$set(e,"cancerFollow",m),a.next=73;break;case 104:n.$set(e,"cancerFollow",m),n.$refs.Logs.writeLog("成功取关【".concat(m,"】个用户"),!0),n.$refs.Logs.writeLog("店铺执行结束",!0),a.next=111;break;case 109:a.prev=109,a.t4=a["catch"](1);case 111:return a.prev=111,--r.count,a.finish(111);case 114:case"end":return a.stop()}}),a,null,[[1,109,111,114],[53,67,70,73],[81,95,98,101]])})))()},stopSet:function(){this.isStop=!0,Object(p["z"])(),this.$refs.Logs.writeLog("正在取消操作")},isLogin:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.MallAPIInstance.isLogin(e);case 2:if(a=n.sent,200!==a.code||!a.data){n.next=7;break}return n.abrupt("return",!0);case 7:return t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺未登录"),!1),n.abrupt("return",!1);case 9:case"end":return n.stop()}}),n)})))()},Unfollower:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.tableList.length){n.next=3;break}return t.$message.warning("请选择要操作的店铺"),n.abrupt("return");case 3:return t.userInfo.auto_attention_set||t.$message.warning("请先设置参数"),t.tableList.forEach((function(t){t.type=e;var n=Object(c["a"])({},t);n["following"]=0,n["fence"]=0,n["newFollow"]=0,n["cancerFollow"]=0,n["state"]="-"})),t.isStop=!1,t.showlog=!1,n.next=9,Object(p["c"])(t.tableList,t.UnfollowerFun);case 9:case"end":return n.stop()}}),n)})))()},UnfollowerFun:function(e){var t=arguments,n=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,i,o,s,c,u,m,f,p,d,g,h,b,w,_,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},a.prev=1,a.next=4,n.isLogin(e);case 4:if(i=a.sent,i){a.next=7;break}return a.abrupt("return");case 7:return a.next=9,n.getHomeMallData(e);case 9:if(o=a.sent,n.$set(e,"following",o?o.account.following_count:0),n.$set(e,"fence",o?o.follower_count:0),o){a.next=15;break}return n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无数据")),a.abrupt("return");case 15:return n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第一页关注")),s={},s["country"]=e.country,s["mallId"]=e.platform_mall_id,s["offset"]=0,s["mallName"]=e.mall_alias_name||e.platform_mall_name,c=0,a.next=24,n.getHomeFllowering(s);case 24:if(u=a.sent,u.length){a.next=28;break}return n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无关注")),a.abrupt("return");case 28:m=u.length,f=null,p=Object(l["a"])(u),a.prev=31,p.s();case 33:if((d=p.n()).done){a.next=68;break}if(g=d.value,!n.isStop){a.next=37;break}return a.abrupt("return");case 37:if(0!==e.type&&Number(n.userInfo.auto_attention_set.CancelFollowNumber)){a.next=48;break}return a.next=40,n.runCancerAttention(g,e,e.platform_mall_id);case 40:if(f=a.sent,!f){a.next=45;break}c++,a.next=46;break;case 45:return a.abrupt("continue",66);case 46:a.next=66;break;case 48:return a.next=50,n.filterShopDatas(g,e.country,e.platform_mall_id);case 50:if(h=a.sent,h){a.next=55;break}return a.abrupt("continue",66);case 55:return a.next=57,n.runCancerAttention(g,e,e.platform_mall_id);case 57:if(f=a.sent,!f){a.next=65;break}if(c++,!(c>=Number(n.userInfo.auto_attention_set.CancelFollowNumber))){a.next=63;break}return m=0,a.abrupt("break",68);case 63:a.next=66;break;case 65:return a.abrupt("continue",66);case 66:a.next=33;break;case 68:a.next=73;break;case 70:a.prev=70,a.t0=a["catch"](31),p.e(a.t0);case 73:return a.prev=73,p.f(),a.finish(73);case 76:n.$set(e,"cancerFollow",c);case 77:if(!(m>=20)){a.next=136;break}if(!n.isStop){a.next=80;break}return a.abrupt("return");case 80:return s["offset"]+=20,a.next=83,n.getHomeFllowering(s);case 83:u=a.sent,n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(s.offset/20+1,"页关注")),m=u.length,b=Object(l["a"])(u),a.prev=87,b.s();case 89:if((w=b.n()).done){a.next=125;break}if(_=w.value,!n.isStop){a.next=93;break}return a.abrupt("return");case 93:if(0!==e.type&&Number(n.userInfo.auto_attention_set.CancelFollowNumber)){a.next=104;break}return a.next=96,n.runCancerAttention(_,e,e.platform_mall_id);case 96:if(f=a.sent,!f){a.next=101;break}c++,a.next=102;break;case 101:return a.abrupt("continue",123);case 102:a.next=123;break;case 104:return a.next=106,n.filterShopDatas(_,e.country,e.platform_mall_id);case 106:if(v=a.sent,v){a.next=111;break}return a.abrupt("continue",123);case 111:return a.next=113,n.runCancerAttention(_,e,e.platform_mall_id);case 113:if(f=a.sent,!f){a.next=122;break}if(c++,!(c>=Number(n.userInfo.auto_attention_set.CancelFollowNumber))){a.next=120;break}return m=0,a.abrupt("break",125);case 120:a.next=123;break;case 122:return a.abrupt("continue",123);case 123:a.next=89;break;case 125:a.next=130;break;case 127:a.prev=127,a.t1=a["catch"](87),b.e(a.t1);case 130:return a.prev=130,b.f(),a.finish(130);case 133:n.$set(e,"cancerFollow",c),a.next=77;break;case 136:n.$set(e,"cancerFollow",c),n.$set(e,"state","操作结束"),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】取关【").concat(c,"】个粉丝")),a.next=143;break;case 141:a.prev=141,a.t2=a["catch"](1);case 143:return a.prev=143,--r.count,a.finish(143);case 146:case"end":return a.stop()}}),a,null,[[1,141,143,146],[31,70,73,76],[87,127,130,133]])})))()},getHomeMallData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={},a["country"]=e.country,a["mallId"]=e.platform_mall_id,n.next=5,t.MallAPIInstance.UserProfile(a);case 5:if(r=n.sent,200!==r.code){n.next=19;break}return i=r.data.username,a["username"]=i,n.next=11,t.MallAPIInstance.getHomeMallinfo(a);case 11:if(o=n.sent,200!==o.code){n.next=16;break}return n.abrupt("return",o.data);case 16:return n.abrupt("return","");case 17:n.next=20;break;case 19:return n.abrupt("return","");case 20:case"end":return n.stop()}}),n)})))()},getHomeFllowering:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={},a["country"]=e.country,a["mallId"]=e.mallId,a["offset"]=e.offset,a["limit"]=20,a["offset_of_offset"]=0,a["timeStamp"]=(new Date).getTime(),n.next=9,t.MallAPIInstance.getFllowering(a);case 9:if(r=n.sent,200!==r.code){n.next=15;break}return t.$refs.Logs.writeLog("【".concat(e.mallName,"】第【").concat(e.offset/20+1,"】页获取成功"),!0),n.abrupt("return",r.data);case 15:return t.$refs.Logs.writeLog("【".concat(e.mallName,"】获取失败，").concat(r.message),!1),n.abrupt("return",[]);case 17:case"end":return n.stop()}}),n)})))()},open:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.tableList[0].country,r={mallId:e.shopid.toString()},n.next=4,t.$shopeemanService.getWebUrlLocal(a,r);case 4:i=n.sent,t.$BaseUtilService.openUrl("".concat(i,"/product/").concat(e.shopid,"/").concat(e.itemid));case 6:case"end":return n.stop()}}),n)})))()},test:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.AutoAddFenceInstance.autoAddFenceActive();case 1:case"end":return t.stop()}}),t)})))()},addCancerMall:function(){this.tableList.length?this.dialog_mallSearch=!0:this.$message.warning("请先设置参数")},searchMallInstance:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={},a["country"]=e.country,a["mallId"]=e.mallId,a["by"]="relevancy",a["keyword"]=t.keyword,a["limit"]=60,a["newest"]=e.newest,a["order"]="desc",a["page_type"]="search",a["rating_filter"]=t.userInfo.auto_attention_set.MinOrderEvaluation,n.prev=10,n.next=13,t.MallAPIInstance.addCancerMall(a);case 13:if(r=n.sent,200!==r.status){n.next=18;break}return n.abrupt("return",JSON.parse(r.data).items);case 18:return t.$refs.Logs.writeLog("店铺搜索请求失败,230-line:".concat(r.status||"请求超时"),!1),n.abrupt("return",[]);case 20:n.next=26;break;case 22:return n.prev=22,n.t0=n["catch"](10),t.$refs.Logs.writeLog("店铺搜索请求失败,234-line:".concat(n.t0),!1),n.abrupt("return",[]);case 26:case"end":return n.stop()}}),n,null,[[10,22]])})))()},filterList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=[],r=new Map,e.forEach((function(e){r.has(e.item_basic.itemid)||r.has(e.item_basic.shopid)||r.set(e.itemid,e)})),a=Object(o["a"])(r.values()),i=a.filter((function(e){var n=null,a=e.item_basic.item_rating.rating_count.reduce((function(e,t,n,a){return e+t}));if(n=Number(e.item_basic.liked_count)>=Number(t.minLike)&&Number(e.item_basic.liked_count)<=Number(t.maxLike)&&e.item_basic.item_rating.rating_star.toFixed(2)>=Number(t.minScore)&&e.item_basic.item_rating.rating_star.toFixed(2)<=Number(t.maxScore)&&a>=Number(t.minComment)&&a<=Number(t.maxComment)&&e.item_basic.stock>=Number(t.userInfo.auto_attention_set.ProductMax),n)return e})),n.abrupt("return",i);case 6:case"end":return n.stop()}}),n)})))()},searchMall:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i,l,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.keyword){e.next=3;break}return t.$message.warning("请输入关键字"),e.abrupt("return");case 3:if(t.showlog=!1,t.$refs.Logs.writeLog("正在获取店铺信息......",!0),n=Number(t.mallNum),!(n>=0)){e.next=43;break}a=[],r=0;case 9:if(!(r<n)){e.next=40;break}return i={},i["country"]=t.tableList[0].country,i["mallId"]=t.tableList[0].platform_mall_id,i["newest"]=60*r,e.next=16,t.searchMallInstance(i);case 16:if(l=e.sent,l.length){e.next=20;break}return t.$refs.Logs.writeLog("暂无数据",!0),e.abrupt("return");case 20:if(!l.length){e.next=35;break}return e.next=23,t.filterList(l);case 23:if(s=e.sent,!s.length){e.next=31;break}if((c=a).push.apply(c,Object(o["a"])(s)),!(a.length>=n)){e.next=29;break}return a=a.splice(0,n),e.abrupt("break",40);case 29:e.next=33;break;case 31:return t.$refs.Logs.writeLog("此关键词暂未搜索到数据，请更换关键词或重试！"),e.abrupt("break",40);case 33:e.next=37;break;case 35:return t.$refs.Logs.writeLog("数据已被过滤空，请更换关键词或放宽搜索条件后重试！"),e.abrupt("break",40);case 37:r++,e.next=9;break;case 40:t.$refs.Logs.writeLog("店铺搜索获取结束"),t.mallSearchList=[],a.forEach((function(e){e.item_basic.totalRate=e.item_basic.item_rating.rating_count.reduce((function(e,t,n,a){return e+t})),t.mallSearchList.push(e.item_basic)}));case 43:case"end":return e.stop()}}),e)})))()},addTargetMall:function(e){if(this.sel_mallSearchList.length){var t=[];this.sel_mallSearchList.forEach((function(e){t.push(e.shopid)})),this.mallIDinfo=t.toString(),this.dialog_mallSearch=!1}else this.$message.warning("请选择店铺")},startCancer:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.mallIDinfo){t.next=3;break}return e.$message.warning("请先获取关注店铺"),t.abrupt("return");case 3:return e.userInfo.auto_attention_set||e.$message.warning("请先设置参数"),e.isStop=!1,e.showlog=!1,e.$refs.Logs.writeLog("数据正在处理......",!0),n=e.mallIDinfo.split(","),e.tableList.map((function(e){e["mallIDlist"]=n})),t.next=11,Object(p["c"])(e.tableList,e.getFllowerInfo);case 11:e.$refs.Logs.writeLog("数据处理结束",!0);case 12:case"end":return t.stop()}}),t)})))()},getFllowerInfo:function(e){var t=arguments,n=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o,s,c,u,m,f,d,g,h;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{count:1},a.prev=1,o=e.mallIDlist,n.$set(e,"following",0),n.$set(e,"fence",0),n.$set(e,"newFollow",0),n.$set(e,"cancerFollow",0),n.$set(e,"state","-"),n.$refs.Logs.writeLog("正在查询【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺关注信息")),a.next=11,n.isLogin(e);case 11:if(s=a.sent,s){a.next=14;break}return a.abrupt("return");case 14:return a.next=16,n.getHomeMallData(e);case 16:if(c=a.sent,n.$set(e,"following",c?c.account.following_count:0),n.$set(e,"fence",c?c.follower_count:0),c){a.next=23;break}return n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺暂无数据"),!0),n.$set(e,"state","店铺暂无数据"),a.abrupt("return");case 23:return a.next=25,n.getHomeFollowingList(e,c.account.following_count);case 25:u=a.sent,n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】店铺关注用户数：【").concat(u.length,"】"),!0),m=Number(e.newFollow),f=Object(l["a"])(o),a.prev=29,g=regeneratorRuntime.mark((function t(){var a,r,o,s,c,f,g,h,b,w,_,v,x,k,y,L,S,I,N,$,F,A;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=d.value,!n.isStop){t.next=3;break}return t.abrupt("return",{v:void 0});case 3:if(r={},r["country"]=e.country,r["mallId"]=e.platform_mall_id,r["shopid"]=a,"0"!==n.userInfo.auto_attention_set.FollowType){t.next=67;break}return n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】正在获取").concat(a,"店铺粉丝信息"),!0),o=!0,r["offset"]=0,t.next=13,n.GetShopLikes(r);case 13:s=t.sent,n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(r.offset/20+1,"页粉丝")),c=Object(l["a"])(s),t.prev=16,g=regeneratorRuntime.mark((function t(){var r,i,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=f.value,!n.isStop){t.next=3;break}return t.abrupt("return",{v:{v:void 0}});case 3:return t.next=5,n.filterShopDatas(s,e.country,e.platform_mall_id);case 5:if(i=t.sent,i){t.next=8;break}return t.abrupt("return","continue");case 8:if(!u.length){t.next=12;break}if(l=u.findIndex((function(e){return e.ShopId===r.ShopId})),!(l>=0)){t.next=12;break}return t.abrupt("return","continue");case 12:return t.next=14,n.runAttention(r,e,a);case 14:if(c=t.sent,!c){t.next=19;break}m++,t.next=24;break;case 19:return n.$set(e,"newFollow",m),n.$set(e,"state","关注失败"),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(r.UserName,"失败,"),!1),o=!1,t.abrupt("return","continue");case 24:if(!Number(n.userInfo.auto_attention_set.FollowNumber)){t.next=31;break}if(!(m>=Number(n.userInfo.auto_attention_set.FollowNumber))){t.next=29;break}return n.$set(e,"newFollow",m),n.$set(e,"state","关注成功"),t.abrupt("return",{v:{v:void 0}});case 29:t.next=35;break;case 31:if(!(e.following+m>=3e3)){t.next=35;break}return n.$set(e,"newFollow",m),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:{v:void 0}});case 35:case"end":return t.stop()}}),t)})),c.s();case 19:if((f=c.n()).done){t.next=28;break}return t.delegateYield(g(),"t0",21);case 21:if(h=t.t0,"continue"!==h){t.next=24;break}return t.abrupt("continue",26);case 24:if("object"!==Object(i["a"])(h)){t.next=26;break}return t.abrupt("return",h.v);case 26:t.next=19;break;case 28:t.next=33;break;case 30:t.prev=30,t.t1=t["catch"](16),c.e(t.t1);case 33:return t.prev=33,c.f(),t.finish(33);case 36:n.$set(e,"newFollow",m);case 37:if(!o){t.next=63;break}if(!n.isStop){t.next=40;break}return t.abrupt("return",{v:void 0});case 40:return r["offset"]+=20,t.next=43,n.GetShopLikes(r);case 43:s=t.sent,n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取第").concat(r.offset/20+1,"页粉丝数据")),b=regeneratorRuntime.mark((function t(r){var i,o,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.isStop){t.next=2;break}return t.abrupt("return",{v:{v:void 0}});case 2:return i=s[r],t.next=5,n.filterShopDatas(i,e.country,e.platform_mall_id);case 5:if(o=t.sent,o){t.next=8;break}return t.abrupt("return","continue");case 8:if(!u.length){t.next=12;break}if(l=u.findIndex((function(e){return e.ShopId===i.ShopId})),!(l>=0)){t.next=12;break}return t.abrupt("return","continue");case 12:return t.next=14,n.runAttention(i,e,a);case 14:if(c=t.sent,!c){t.next=19;break}m++,t.next=23;break;case 19:return n.$set(e,"newFollow",m),n.$set(e,"state","关注失败"),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(i.UserName,"失败,"),!1),t.abrupt("return","continue");case 23:if(!Number(n.userInfo.auto_attention_set.FollowNumber)){t.next=30;break}if(!(m>=Number(n.userInfo.auto_attention_set.FollowNumber))){t.next=28;break}return n.$set(e,"newFollow",m),n.$set(e,"state","关注成功"),t.abrupt("return",{v:{v:void 0}});case 28:t.next=34;break;case 30:if(!(e.following+m>=3e3)){t.next=34;break}return n.$set(e,"newFollow",m),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:{v:void 0}});case 34:case"end":return t.stop()}}),t)})),w=0;case 47:if(!(w<s.length)){t.next=57;break}return t.delegateYield(b(w),"t2",49);case 49:if(_=t.t2,"continue"!==_){t.next=52;break}return t.abrupt("continue",54);case 52:if("object"!==Object(i["a"])(_)){t.next=54;break}return t.abrupt("return",_.v);case 54:w++,t.next=47;break;case 57:return s.length<20&&(n.$refs.Logs.writeLog("【".concat(a,"】查找结束")),o=!1),n.$set(e,"newFollow",m),t.next=61,Object(p["y"])(1e3*Number(n.userInfo.auto_attention_set.FollowInterval));case 61:t.next=37;break;case 63:n.$set(e,"state","操作结束"),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】成功关注").concat(m,"个粉丝")),t.next=121;break;case 67:return n.$refs.Logs.writeLog("正在获取评价用户信息",!0),v=!0,x=[],k=n.mallSearchList.findIndex((function(e){return e.shopid===Number(a)})),y=n.mallSearchList[k].itemid,L=0,n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取").concat(a,"第【").concat(L/52+1,"】页评价用户")),t.next=76,n.GetShopComment(y,a,e,L);case 76:if(x=t.sent,x.length){t.next=80;break}return n.$refs.Logs.writeLog("".concat(a,"暂无用户评价")),t.abrupt("return","continue");case 80:S=regeneratorRuntime.mark((function t(a){var r,i,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=x[a],i={},i["ShopId"]=r.author_shopid,i["UserName"]=r.author_username,!u.length){t.next=8;break}if(o=u.findIndex((function(e){return Number(e.ShopId)===Number(i.ShopId)})),!(o>=0)){t.next=8;break}return t.abrupt("return","continue");case 8:return t.next=10,n.runAttention(i,e,r.shopid);case 10:if(l=t.sent,!l){t.next=15;break}m++,t.next=20;break;case 15:return n.$set(e,"newFollow",m),n.$set(e,"state","关注失败"),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(i.UserName,"失败,"),!1),v=!1,t.abrupt("return","continue");case 20:if(!Number(n.userInfo.auto_attention_set.FollowNumber)){t.next=27;break}if(!(m>=Number(n.userInfo.auto_attention_set.FollowNumber))){t.next=25;break}return n.$set(e,"newFollow",m),n.$set(e,"state","关注成功"),t.abrupt("return",{v:{v:void 0}});case 25:t.next=31;break;case 27:if(!(e.following+m>=3e3)){t.next=31;break}return n.$set(e,"newFollow",m),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:{v:void 0}});case 31:case"end":return t.stop()}}),t)})),I=0;case 82:if(!(I<x.length)){t.next=92;break}return t.delegateYield(S(I),"t3",84);case 84:if(N=t.t3,"continue"!==N){t.next=87;break}return t.abrupt("continue",89);case 87:if("object"!==Object(i["a"])(N)){t.next=89;break}return t.abrupt("return",N.v);case 89:I++,t.next=82;break;case 92:n.$set(e,"newFollow",m);case 93:if(!v){t.next=119;break}if(!n.isStop){t.next=96;break}return t.abrupt("return",{v:void 0});case 96:return L+=52,n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】获取").concat(a,"第【").concat(L/52+1,"】页评价用户")),t.next=100,n.GetShopComment(y,a,e,L);case 100:x=t.sent,$=regeneratorRuntime.mark((function t(r){var i,o,l,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.isStop){t.next=2;break}return t.abrupt("return",{v:{v:void 0}});case 2:if(i=x[r],o={},o["ShopId"]=i.shopid,o["UserName"]=i.author_username,!u.length){t.next=10;break}if(l=u.findIndex((function(e){return e.ShopId===o.ShopId})),!(l>=0)){t.next=10;break}return t.abrupt("return","continue");case 10:return t.next=12,n.runAttention(o,e,a);case 12:if(s=t.sent,!s){t.next=17;break}m++,t.next=21;break;case 17:return n.$set(e,"newFollow",m),n.$set(e,"state","关注失败"),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注").concat(o.UserName,"失败,"),!1),t.abrupt("return","continue");case 21:if(!Number(n.userInfo.auto_attention_set.FollowNumber)){t.next=28;break}if(!(m>=Number(n.userInfo.auto_attention_set.FollowNumber))){t.next=26;break}return n.$set(e,"newFollow",m),n.$set(e,"state","关注成功"),t.abrupt("return",{v:{v:void 0}});case 26:t.next=32;break;case 28:if(!(e.following+m>=3e3)){t.next=32;break}return n.$set(e,"newFollow",m),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注已达上限,"),!0),t.abrupt("return",{v:{v:void 0}});case 32:case"end":return t.stop()}}),t)})),F=0;case 103:if(!(F<x.length)){t.next=113;break}return t.delegateYield($(F),"t4",105);case 105:if(A=t.t4,"continue"!==A){t.next=108;break}return t.abrupt("continue",110);case 108:if("object"!==Object(i["a"])(A)){t.next=110;break}return t.abrupt("return",A.v);case 110:F++,t.next=103;break;case 113:return x.length<52&&(n.$refs.Logs.writeLog("【".concat(a,"】查找结束")),v=!1),n.$set(e,"newFollow",m),t.next=117,Object(p["y"])(1e3*Number(n.userInfo.auto_attention_set.FollowInterval));case 117:t.next=93;break;case 119:n.$set(e,"state","操作结束"),n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】成功关注").concat(m,"个粉丝"));case 121:case"end":return t.stop()}}),t,null,[[16,30,33,36]])})),f.s();case 32:if((d=f.n()).done){a.next=41;break}return a.delegateYield(g(),"t0",34);case 34:if(h=a.t0,"continue"!==h){a.next=37;break}return a.abrupt("continue",39);case 37:if("object"!==Object(i["a"])(h)){a.next=39;break}return a.abrupt("return",h.v);case 39:a.next=32;break;case 41:a.next=46;break;case 43:a.prev=43,a.t1=a["catch"](29),f.e(a.t1);case 46:return a.prev=46,f.f(),a.finish(46);case 49:n.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】关注结束"),!0),a.next=55;break;case 52:a.prev=52,a.t2=a["catch"](1),n.$refs.Logs.writeLog("用户信息获取失败-line373，".concat(a.t2),!1);case 55:return a.prev=55,--r.count,a.finish(55);case 58:case"end":return a.stop()}}),a,null,[[1,52,55,58],[29,43,46,49]])})))()},getHomeFollowingList:function(e,t){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={},a["country"]=e.country,a["mallId"]=e.platform_mall_id,a["offset"]=0,a["mallName"]=e.mall_alias_name||e.platform_mall_name,t.next=7,n.getHomeFllowering(a);case 7:if(r=t.sent,i=r,i.length){t.next=11;break}return t.abrupt("return",[]);case 11:if(!(r.length>=20)){t.next=21;break}if(!n.isStop){t.next=14;break}return t.abrupt("break",21);case 14:return a["offset"]+=20,t.next=17,n.getHomeFllowering(a);case 17:r=t.sent,i=i.concat(r),t.next=11;break;case 21:return t.abrupt("return",i);case 22:case"end":return t.stop()}}),t)})))()},GetShopComment:function(e,t,n,a){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var o,l,s,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o={},o["mallId"]=n.platform_mall_id,o["country"]=n.country,o["itemid"]=e,o["offset"]=a,o["shopid"]=t,i.next=8,r.MallAPIInstance.getShoppComment(o);case 8:if(l=i.sent,200!==l.code){i.next=15;break}return s=l.data.ratings||[],c=s.filter((function(e){if(e.rating_star>=Number(r.userInfo.auto_attention_set.MinOrderEvaluation))return e})),i.abrupt("return",c);case 15:return r.$refs.Logs.writeLog("商品评价获取失败".concat(l.message),!1),i.abrupt("return",[]);case 17:case"end":return i.stop()}}),i)})))()},runAttention:function(e,t,n){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i={},i["country"]=t.country,i["mallId"]=t.platform_mall_id,i["userShopid"]=e.ShopId,i["followMallID"]=n,r.next=7,a.MallAPIInstance.buyerFollow(i);case 7:if(o=r.sent,200===o.code){r.next=12;break}a.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"失败,").concat(o.message),!1),r.next=18;break;case 12:if(!o.data){r.next=17;break}return a.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"成功"),!0),r.abrupt("return",!0);case 17:a.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】关注").concat(e.UserName,"失败,").concat(o.message),!1);case 18:return r.abrupt("return",!1);case 19:case"end":return r.stop()}}),r)})))()},runCancerAttention:function(e,t,n){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i={},i["country"]=t.country,i["mallId"]=t.platform_mall_id,i["ShopId"]=e.ShopId,i["followMallID"]=n,r.next=7,a.MallAPIInstance.buyerUNFollow(i);case 7:if(o=r.sent,200===o.code){r.next=13;break}return a.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】取关").concat(e.ShopId,"失败"),!1),r.abrupt("return",!1);case 13:return a.$refs.Logs.writeLog("【".concat(t.mall_alias_name||t.platform_mall_name,"】取关").concat(e.ShopId,"成功"),!0),r.abrupt("return",!0);case 15:case"end":return r.stop()}}),r)})))()},filterShopDatas:function(e,t,n){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var i,o,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.getActiveUser({country:t,mallId:n,userName:e.UserName});case 2:if(i=r.sent,o=new Date((new Date).toLocaleDateString()).getTime(),l=o-o*(Number(a.userInfo.auto_attention_set.LastLoginDay)-1),!(i>l)){r.next=9;break}return r.abrupt("return",!0);case 9:return r.abrupt("return",!1);case 10:case"end":return r.stop()}}),r)})))()},getActiveUser:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={},a["country"]=e.country,a["mallId"]=e.mallId,a["username"]=e.userName,n.next=6,t.MallAPIInstance.getActiveTimeFollower(a);case 6:if(r=n.sent,200!==r.code){n.next=11;break}return n.abrupt("return",1e3*Number(r.data.last_active_time));case 11:return t.$refs.Logs.writeLog("店铺活跃状态获取失败:".concat(r.message),!1),n.abrupt("return","");case 13:case"end":return n.stop()}}),n)})))()},GetShopLikes:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={},a["country"]=e.country,a["mallId"]=e.mallId,a["shopid"]=e.shopid,a["offset"]=e.offset,a["limit"]=20,a["offset_of_offset"]=0,a["timeStamp"]=(new Date).getTime(),n.next=10,t.MallAPIInstance.getFllower(a);case 10:if(r=n.sent,200!==r.code){n.next=15;break}return n.abrupt("return",r.data);case 15:return t.$refs.Logs.writeLog("粉丝获取失败，".concat(r.message),!1),n.abrupt("return",[]);case 17:case"end":return n.stop()}}),n)})))()},getUserinfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showlog=!0,t.next=3,e.$api.userSet();case 3:n=t.sent,200===n.data.code?e.userInfo=n.data.data:e.$message.warning("信息获取失败！".concat(n.data.data.message)),e.userInfo.auto_attention_set||e.$message.warning("请先设置参数");case 6:case"end":return t.stop()}}),t)})))()},setSave:function(e){this.dialog_userInfo=!1,this.getUserinfo()},setQurey:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dialog_userInfo=!0;case 1:case"end":return t.stop()}}),t)})))()},clearLog:function(){this.$refs.Logs.consoleMsg=""},changeMallList:function(e){this.selmallList=e},handleSelectionChange:function(e){this.sel_mallSearchList=e}}},h=g,b=(n("176a"),n("2877")),w=Object(b["a"])(h,a,r,!1,null,"ad1082ac",null);t["default"]=w.exports},8992:function(e,t,n){"use strict";n("4c28")},cd1f:function(e,t,n){"use strict";n("dfdc")},cf9f:function(e,t,n){"use strict";var a,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail"},[n("ul",[n("span",[e._v("  通用设置  ")]),n("li",[n("div",[n("label",[e._v("店铺商品上限：")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.limitgGoods,callback:function(t){e.limitgGoods=t},expression:"limitgGoods"}}),n("label",{staticStyle:{"margin-left":"120px"}},[e._v("最后活跃时间：")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.lastOnline,callback:function(t){e.lastOnline=t},expression:"lastOnline"}}),e._v("  天内 ")],1)]),n("span",[e._v("  关注设置  ")]),n("li",[n("ul",{staticStyle:{"margin-top":"-10px"}},[n("span",{staticStyle:{"margin-left":"-20px"}},[e._v("  关注对象  ")]),n("li",{staticStyle:{width:"450px","margin-left":"-20px"}},[n("el-radio-group",{model:{value:e.followActor,callback:function(t){e.followActor=t},expression:"followActor"}},[n("el-radio",{attrs:{label:"0"}},[e._v("店铺粉丝")])],1)],1)]),n("div",{staticStyle:{"margin-bottom":"10px"}},[n("label",[e._v("关注数量：")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.followNum,callback:function(t){e.followNum=t},expression:"followNum"}}),e._v(" （0为无限制） "),n("label",{staticStyle:{"margin-left":"110px"}},[e._v("关注间隔：")]),n("el-input",{staticStyle:{width:"50px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.interTime,callback:function(t){e.interTime=t},expression:"interTime"}}),e._v(" 秒 ")],1),n("div",[n("el-checkbox",{staticStyle:{"margin-bottom":"10px"},model:{value:e.market,callback:function(t){e.market=t},expression:"market"}},[e._v("不关注订单评价小于等于 ")]),n("el-input",{staticStyle:{width:"50px"},attrs:{size:"mini"},on:{blur:function(t){e.market=!0}},model:{value:e.marketNum,callback:function(t){e.marketNum=t},expression:"marketNum"}}),e._v(" 的用户 ")],1),n("div",[n("el-checkbox",{model:{value:e.followDay,callback:function(t){e.followDay=t},expression:"followDay"}},[e._v("不关注 ")]),n("el-input",{staticStyle:{width:"75px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},on:{blur:function(t){e.followDay=!0}},model:{value:e.followDayNum,callback:function(t){e.followDayNum=t},expression:"followDayNum"}}),e._v(" 天内关注过的用户 ")],1)]),n("span",[e._v("  取关设置  ")]),n("li",[n("div",[n("label",[e._v("取关数量：")]),n("el-input",{staticStyle:{width:"80px"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,0)",size:"mini"},model:{value:e.cancerFollowNum,callback:function(t){e.cancerFollowNum=t},expression:"cancerFollowNum"}}),e._v(" （0为无限制） ")],1)]),n("span",[e._v("  自动关注  ")]),n("li",{staticClass:"orderSet"},[n("div",[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 开启任务请前往【爆粉神器】添加执行任务的店铺，随后进行参数设置"),n("br"),e._v(" 注意：1.关键词不能为空"),n("br"),e._v("           2.一个站点只能执行一条任务"),n("br"),e._v("           3.同一个站点的任务保存会替换原来的任务"),n("br")]),n("el-checkbox",{model:{value:e.startAddFence,callback:function(t){e.startAddFence=t},expression:"startAddFence"}},[e._v("开启定时刷粉")])],1),n("label",[e._v("每日启动时间  ")]),n("el-time-select",{staticStyle:{width:"100px"},attrs:{"picker-options":{start:"08:30",step:"00:15",end:"18:30"},placeholder:"选择时间",size:"mini"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),n("label",{staticStyle:{"margin-left":"20px"}},[e._v("关注关键词：")]),n("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini"},model:{value:e.followKey,callback:function(t){e.followKey=t},expression:"followKey"}}),n("el-checkbox",{staticStyle:{"margin-left":"8px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")])],1)]),n("el-button",{staticStyle:{flex:"1","margin-left":"200px",width:"100px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.save()}}},[e._v("保存")])],1),n("Logs",{ref:"Logs",staticClass:"logBox",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}})],1)},i=[],o=n("ade3"),l=n("1da1"),s=(n("d3b7"),n("25f0"),n("159b"),n("ac1f"),n("1276"),n("d81d"),n("a9e3"),n("99af"),n("5319"),n("96cf"),n("0e0b")),c={components:{},props:["userInfo","mall"],data:function(){return{userID:"",uid:"",showlog:!0,limitgGoods:"5",lastOnline:"1",followActor:"0",followNum:"100",interTime:"10",market:!0,marketNum:"4.5",followDay:!0,followDayNum:"30",cancerFollowNum:100,startAddFence:!1,startTime:"10:00",followKey:""}},mounted:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["A"])((function(){return e.userInfo&&e.userInfo.id}));case 2:return t.next=4,e.getUserinfo();case 4:e.initLog();case 5:case"end":return t.stop()}}),t)})))()},methods:(a={getUserinfo:function(){if(this.userInfo&&this.userInfo.auto_attention_set){var e,t,n,a,r,i,o,l,s,c,u,m;this.limitgGoods=(null===(e=this.userInfo.auto_attention_set)||void 0===e?void 0:e.ProductMax)||this.limitgGoods,this.lastOnline=(null===(t=this.userInfo.auto_attention_set)||void 0===t?void 0:t.LastLoginDay)||this.lastOnline,this.followActor=(null===(n=this.userInfo.auto_attention_set)||void 0===n?void 0:n.FollowType.toString())||this.followActor,this.followNum=(null===(a=this.userInfo.auto_attention_set)||void 0===a?void 0:a.FollowNumber)||this.followNum,this.interTime=(null===(r=this.userInfo.auto_attention_set)||void 0===r?void 0:r.FollowInterval)||this.interTime,this.marketNum=(null===(i=this.userInfo.auto_attention_set)||void 0===i?void 0:i.MinOrderEvaluation)||this.marketNum,this.market=(null===(o=this.userInfo.auto_attention_set)||void 0===o?void 0:o.IsNotFollowMinOrderEvaluation)||this.market,this.followDayNum=(null===(l=this.userInfo.auto_attention_set)||void 0===l?void 0:l.FollowedDay)||this.followDayNum,this.followDay=(null===(s=this.userInfo.auto_attention_set)||void 0===s?void 0:s.IsNotFollowFollowedDay)||this.followDay,this.cancerFollowNum=(null===(c=this.userInfo.auto_attention_set)||void 0===c?void 0:c.CancelFollowNumber)||this.cancerFollowNum,this.startAddFence=(null===(u=this.userInfo.auto_attention_set)||void 0===u?void 0:u.IsOpenTimerBrushFans)||this.startAddFence;var f=this.userInfo.auto_attention_set;this.startTime=(null===(m=this.userInfo.auto_attention_set)||void 0===m?void 0:m.OpenHour)+":"+("0"===f.OpenMinute?"00":f.OpenMinute)||this.startTime,this.followKey=this.userInfo.auto_attention_set.KeyWord||this.followKey}},add0:function(e){return e<10?"0"+e:e},formatTime:function(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),i=t.getHours(),o=t.getMinutes(),l=t.getSeconds();return n+"-"+this.add0(a)+"-"+this.add0(r)+" "+this.add0(i)+":"+this.add0(o)+":"+this.add0(l)},initLog:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null===(n=e.userInfo.auto_attention_set)||void 0===n||!n.IsOpenTimerBrushFans){t.next=8;break}return t.next=3,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 3:return a=t.sent,t.next=6,window.BaseUtilBridgeService.getAttentionUserLog(a.taskId);case 6:r=t.sent,r.forEach((function(t){e.$refs.Logs.writeLog("".concat(t),!0)}));case 8:case"end":return t.stop()}}),t)})))()},autoAddFence:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.startAddFence||e.mall){t.next=3;break}return e.$message.warning("请前往【爆粉神器】设置需要执行的任务的店铺"),t.abrupt("return",!1);case 3:if(!e.startAddFence||e.followKey){t.next=6;break}return e.$message.warning("关键词不能为空"),t.abrupt("return",!1);case 6:if(n=e.startTime.split(":"),!e.startAddFence){t.next=38;break}return a={},a["country"]=e.mall[0].country,a["log_message"]=[],t.next=13,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 13:if(r=t.sent,!r.length){t.next=20;break}return t.next=17,window.BaseUtilBridgeService.deleteAttentionUserTask(r[0].id);case 17:t.sent,a["log_message"].push("任务删除"),a["created_at"]=e.formatTime((new Date).getTime());case 20:return i={country:e.mall[0].country,mall_ids:e.mall.map((function(e){return e["platform_mall_id"]})).toString(),mall_names:e.mall.map((function(e){return e["mall_alias_name"]||e["platform_mall_name"]})).toString(),product_max:e.limitgGoods,last_login_day:e.lastOnline,open_hour:n[0].toString(),open_minute:n[1].toString(),key_word:e.followKey,follow_number:e.followNum,follow_interval:e.interTime,is_not_follow_min_order_evaluation:e.market?1:0,min_order_evaluation:e.marketNum,is_not_follow_followed_day:e.followDay?1:0,followed_day:e.followDayNum,followed_type:e.followActor,cancel_follow_number:Number(e.cancerFollowNum),cancel_follow_sort_type:0,exec_time:1e3*e.teskTime(e.startTime)},t.next=23,window.BaseUtilBridgeService.saveAttentionUserTask(i);case 23:if(o=t.sent,"200"!==o.code){t.next=33;break}return t.next=27,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 27:l=t.sent,a["task_id"]=l[0].id,a["log_message"].push("任务创建成功"),a["created_at"]=e.formatTime((new Date).getTime()),t.next=35;break;case 33:a["log_message"].push("任务创建失败"),a["created_at"]=e.formatTime((new Date).getTime());case 35:return a["log_message"]=a["log_message"].toString(),t.next=38,window.BaseUtilBridgeService.saveAttentionUserLog(a);case 38:return t.abrupt("return",!0);case 39:case"end":return t.stop()}}),t)})))()},teskTime:function(e){var t="".concat((new Date).getFullYear(),"-").concat((new Date).getMonth(),"-").concat((new Date).getDay()," ").concat(e,":00"),n=t.replace(/:/g,"-");n=n.replace(/ /g,"-");var a=n.split("-"),r=new Date(Date.UTC(a[0],a[1]-1,a[2],a[3]-8,a[4],a[5]));return r.getTime()/1e3}},Object(o["a"])(a,"add0",(function(e){return e<10?"0"+e:e})),Object(o["a"])(a,"formatTime",(function(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),i=t.getHours(),o=t.getMinutes(),l=t.getSeconds();return n+"-"+this.add0(a)+"-"+this.add0(r)+" "+this.add0(i)+":"+this.add0(o)+":"+this.add0(l)})),Object(o["a"])(a,"initLog",(function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.userInfo.auto_attention_set.IsOpenTimerBrushFans){t.next=8;break}return t.next=3,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 3:return n=t.sent,t.next=6,window.BaseUtilBridgeService.getAttentionUserLog(n.taskId);case 6:a=t.sent,a.forEach((function(t){e.$refs.Logs.writeLog("".concat(t),!0)}));case 8:case"end":return t.stop()}}),t)})))()})),Object(o["a"])(a,"save",(function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,o,l,s,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.startAddFence){t.next=6;break}return t.next=3,e.autoAddFence();case 3:if(n=t.sent,n){t.next=6;break}return t.abrupt("return");case 6:if(a=e.startTime.split(":"),!e.startAddFence){t.next=32;break}return r={},r["country"]=e.mall[0].country,r["log_message"]=[],t.next=13,window.BaseUtilBridgeService.getAttentionUserTask(e.mall[0].country);case 13:if(i=t.sent,!i){t.next=21;break}return t.next=18,window.BaseUtilBridgeService.deleteAttentionUserTask(i.id);case 18:t.sent,r["log_message"].push("任务删除"),r["created_at"]=e.formatTime((new Date).getTime());case 21:return o={country:e.mall[0].country,mall_ids:e.mall.map((function(e){return e["platform_mall_id"]})).toString(),mall_names:e.mall.map((function(e){return e["mall_alias_name"]||e["platform_mall_name"]})).toString(),product_max:e.limitgGoods,last_login_day:e.lastOnline,open_hour:a[0],open_minute:a[1],key_word:e.followKey,follow_number:e.followNum,follow_interval:e.interTime,is_not_follow_min_order_evaluation:e.market,min_order_evaluation:e.marketNum,is_not_follow_followed_day:e.followDay,followed_day:e.followDayNum,followed_type:e.followActor,cancel_follow_number:e.cancerFollowNum,cancel_follow_sort_type:0},t.next=25,window.BaseUtilBridgeService.saveAttentionUserTask(JSON.stringify(o));case 25:return l=t.sent,l?(r["task_id"]=l.task_id,r["log_message"].push("任务创建成功"),r["created_at"]=e.formatTime((new Date).getTime())):(r["log_message"].push("任务创建失败"),r["created_at"]=e.formatTime((new Date).getTime())),r["log_message"]=r["log_message"].toString(),t.next=31,window.BaseUtilBridgeService.saveAttentionUserLog(r);case 31:t.sent;case 32:return s={ProductMax:e.limitgGoods,LastLoginDay:e.lastOnline,FollowType:e.followActor,FollowNumber:e.followNum,FollowInterval:e.interTime,MinOrderEvaluation:e.marketNum,IsNotFollowMinOrderEvaluation:e.market,FollowedDay:e.followDayNum,IsNotFollowFollowedDay:e.followDay,CancelFollowNumber:e.cancerFollowNum,IsOpenTimerBrushFans:e.startAddFence,OpenHour:a[0],OpenMinute:a[1],KeyWord:e.followKey,IsNotFollowCrossBorderSeller:!1,CancelFollowSortType:"0"},c={content:{autoAttentionSet:JSON.stringify(s)},type:4},t.prev=34,t.next=37,e.$api.setUserinfo(JSON.stringify(c));case 37:u=t.sent,200===u.data.code?e.$message.success("信息修改成功！"):e.$message.warning("信息修改失败！".concat(u.data.message)),t.next=43;break;case 41:t.prev=41,t.t0=t["catch"](34);case 43:e.$emit("isSave",!0);case 44:case"end":return t.stop()}}),t,null,[[34,41]])})))()})),a)},u=c,m=(n("cd1f"),n("2877")),f=Object(m["a"])(u,r,i,!1,null,"ba35e370",null);t["a"]=f.exports},d1b0:function(e,t,n){},dfdc:function(e,t,n){},feb6:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ul",{staticClass:"storeChooseUL"},[e.isMall?n("li",[e._v(e._s(e._f("chineseSite")(e.countryVal)))]):n("li",{style:e.isReset&&"margin-bottom: 5px"},[n("span",{style:{width:e.spanWidth}},[e._v("所属站点：")]),n("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:"",disabled:e.isBanPerform},model:{value:e.countryVal,callback:function(t){e.countryVal=t},expression:"countryVal"}},[e.isAll?n("el-option",{attrs:{label:"全部",value:""}}):e._e(),e._l(e.countries,(function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),n("li",{style:e.isReset&&"margin-bottom: 5px"},[n("span",{style:{width:e.spanWidth}},[e._v("店铺分组：")]),n("el-select",{staticClass:"selectBox",attrs:{disabled:e.isBanPerform,multiple:"","collapse-tags":"",filterable:"",size:"mini"},model:{value:e.groupId,callback:function(t){e.groupId=t},expression:"groupId"}},e._l(e.groupIdList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.group_name,value:e.id}})})),1)],1),n("li",{style:e.isReset&&"margin-bottom: 5px"},[n("span",{style:{width:e.spanWidth}},[e._v("店铺名称：")]),n("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadmoreMall,expression:"loadmoreMall"}],staticClass:"selectBox",attrs:{disabled:e.isBanPerform,placeholder:"",multiple:!e.isAShop,"collapse-tags":"","filter-method":e.filterMall,size:"mini",filterable:"",clearable:""},on:{"visible-change":function(t){return e.filterMall("")}},model:{value:e.site,callback:function(t){e.site=t},expression:"site"}},[e.isAShop?e._e():n("el-option",{attrs:{label:"全部",value:""}}),e._l(e.siteShowList,(function(t,a){return e.showMall(t,a)?n("el-option",{key:a,attrs:{label:t.mall_alias_name||t.platform_mall_name,value:t.platform_mall_id}}):e._e()}))],2)],1),e.isReset?n("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[n("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary",disabled:e.isBanPerform},on:{click:e.reset}},[e._v("　刷　　新　")])],1):e._e()])])},r=[],i=n("1da1"),o=n("b85c"),l=n("2909"),s=(n("96cf"),n("d81d"),n("fb6a"),n("caad"),n("2532"),n("d3b7"),n("25f0"),n("99af"),n("6062"),n("3ca3"),n("ddb0"),n("4de4"),n("159b"),n("c740"),n("7db0"),n("7646")),c=n("2b0e");c["default"].directive("loadmore",{bind:function(e,t){var n=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");n.addEventListener("scroll",(function(){this.scrollHeight-this.scrollTop<=this.clientHeight+50?t.value(!0,this):this.scrollTop<30&&t.value(!1,this)}))}});var u={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},parentCountry:{type:String,default:"TH"},isMall:{type:Boolean,default:function(){return!1}},isBanPerform:{type:Boolean,default:function(){return!1}},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}},isAShop:{type:Boolean,default:function(){return!1}}},data:function(){return{isAllowSet1:!0,isAllowSet2:!0,countryVal:null,groupId:[],groupIdList:[],site:[],siteList:[],siteShowList:[],countries:this.$filters.countries_option,mallListAPIInstance:new s["a"](this),isShowName:"",isShowNameAll:!1,showMallNumber:100,mallShowIndex:0,jsonMallData:[],filterMallTime:null}},watch:{siteList:function(e){this.siteShowList=e},countryVal:{handler:function(e,t){this.isShowName="",this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},deep:!0},groupId:{handler:function(e,t){var n=this;if(this.isAllowSet2){this.isShowName="",this.isAllowSet2=!1;var a=t.indexOf("")>-1,r=e.indexOf("")>-1;a!==r?this.groupId=r?Object(l["a"])(this.groupIdList.map((function(e){return e.id}))):[]:r?this.groupId=e.slice(1):this.groupIdList.length>0&&this.groupId.length===this.groupIdList.length-1&&this.groupId.unshift(""),setTimeout((function(){n.isAllowSet2=!0,n.ddMallGoodsGetMallList(2)}),10)}},deep:!0},site:{handler:function(e,t){var n=this;if(this.isAllowSet1){this.isAllowSet1=!1;var a=this.isShowName;if(!this.isAShop){var r=t.includes(""),i=e.includes("");if(r!==i||t.toString()===e.toString()&&this.isShowNameAll)if(i&&(!a||a&&!this.isShowNameAll)){var s=a&&Object(l["a"])(this.siteShowList.map((function(e){return e.platform_mall_id})))||[""].concat(Object(l["a"])(this.siteList.map((function(e){return e.platform_mall_id})))),c=new Set([].concat(Object(l["a"])(s),Object(l["a"])(t)));this.site=Object(l["a"])(c),this.isShowNameAll=!0,a&&this.siteList.length===this.site.length&&this.site.unshift("")}else{this.isShowNameAll=!1;var u=[];if(a){var m=a&&Object(l["a"])(this.siteShowList.map((function(e){return e.platform_mall_id}))),f=m.length>this.site.length&&this.site||m,p=m.length>this.site.length&&m||this.site;u=new Set(this.site);var d,g=Object(o["a"])(p);try{for(g.s();!(d=g.n()).done;){var h=d.value;f.includes(h)&&u.delete(h)}}catch(b){g.e(b)}finally{g.f()}u.delete("")}this.site=Object(l["a"])(u)}else i?this.site=e.slice(1):this.siteList.length>0&&this.siteList.length===this.site.length?this.site.unshift(""):this.isShowNameAll=!1}setTimeout((function(){n.changeMallList(),n.filterMall(a),n.isAllowSet1=!0}),10)}},deep:!0}},mounted:function(){this.countryVal=this.isMall?this.parentCountry:this.isAll?"":"TH"},methods:{reset:function(){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},ddMallGoodsGetMallList:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r,i,o,l,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.site=[],a=t.countryVal,r=[],!(t.jsonMallData.length>0)){n.next=7;break}r=t.jsonMallData,n.next=12;break;case 7:return n.next=9,t.$appConfig.temporaryCacheInfo("get","mallAllData","");case 9:i=n.sent,r=JSON.parse(i)||[],t.jsonMallData=JSON.parse(i)||[];case 12:if(!(r.length>0)){n.next=17;break}1===e&&(t.siteList=""===a?r:r.filter((function(e){return e.country===a}))),2===e&&(0===t.groupId.length?t.siteList=[]:(t.siteList=[],t.groupId.forEach((function(e){r.forEach((function(n){a?e===n.group_id&&a===n.country&&t.siteList.push(n):e===n.group_id&&t.siteList.push(n)}))})))),n.next=22;break;case 17:return o={country:"",mallGroupIds:""},n.next=20,t.mallListAPIInstance.ddMallGoodsGetMallList(o);case 20:l=n.sent,200===l.code?(t.$appConfig.temporaryCacheInfo("save","mallAllData",l.data),s=l.data||[],t.siteList=s,t.jsonMallData=s,t.siteList=""===a?s:s.filter((function(e){return e.country===a}))):t.$message.error("获取分组、店铺列表失败");case 22:0===t.groupIdList.length&&(t.groupIdList=[{group_name:"全部",id:""}],t.groupId=[""],t.siteList.forEach((function(e){var n=t.groupIdList.findIndex((function(t){return t.id===e.group_id}));e.group_name&&n<0&&(t.groupIdList.push({group_name:e.group_name,id:e.group_id}),t.groupId.push(e.group_id))}))),setTimeout((function(){t.isAllowSet2=!0,t.isAllowSet1=!0,t.site=!t.isAShop&&[""]||""}),10);case 24:case"end":return n.stop()}}),n)})))()},changeMallList:function(){var e=this,t=[],n="";if(this.isAShop){var a=this.siteList.find((function(t){return t.platform_mall_id===e.site}));n=this.site,t.push(a)}else this.site.forEach((function(a){if(a){var r=e.siteList.find((function(e){return e.platform_mall_id===a}));t.push(r),n+=a+","}}));!this.countryVal&&this.groupId.indexOf("")>-1&&(n=t.length!==this.siteList.length&&n||""),this.source?this.$emit("changeMallList",{mallList:t,source:this.source,searchAll:n,country:this.countryVal.toLocaleUpperCase()}):(t["country"]=this.countryVal,this.$emit("changeMallList",t))},filterMall:function(e){var t=this,n=e&&this.isShowName!==e?1e3:100;this.filterMallTime&&(clearTimeout(this.filterMallTime),this.filterMallTime=null),this.filterMallTime=setTimeout((function(){t.isShowName!==e&&(t.mallShowIndex=0),t.isShowName=e||"";var n=t.siteList;e&&(n=t.siteList.filter((function(t){var n=t.mall_alias_name||t.platform_mall_name;return n.includes(e)}))),t.siteShowList=n}),n)},showMall:function(e,t){var n=e.mall_alias_name||e.platform_mall_name,a=this.site[0]===e.platform_mall_id;return a||this.mallShowIndex<=t&&t<=this.mallShowIndex+this.showMallNumber&&(!this.isShowName||n.includes(this.isShowName))},loadmoreMall:function(e,t){if(this.siteShowList.length>this.showMallNumber){var n=0;e?(n=this.mallShowIndex+10,n=n<this.siteShowList.length-this.showMallNumber&&n||this.siteShowList.length-this.showMallNumber):(n=this.mallShowIndex-10,n=n>0&&n||0),n!==this.mallShowIndex&&(t.scrollTop=e?t.scrollTop-100:30),this.mallShowIndex=n}}}},m=u,f=(n("8992"),n("2877")),p=Object(f["a"])(m,a,r,!1,null,null,null);t["a"]=p.exports}}]);