(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3218d2e7"],{"42d6":function(e,t,a){},4824:function(e,t,a){"use strict";a("b1ac")},"67e0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("div",{staticClass:"condetion",staticStyle:{"background-color":"white",padding:"8px"}},[a("div",{staticClass:"row1"},[a("storeChoose",{staticStyle:{"margin-left":"-20px"},attrs:{"show-mall-all":!0},on:{changeMallList:e.changeMallList}}),a("div",[a("label",[e._v("优惠劵类型：")]),a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.saleType,callback:function(t){e.saleType=t},expression:"saleType"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),a("el-option",{attrs:{label:"即将进行",value:"1"}}),a("el-option",{attrs:{label:"进行中",value:"2"}}),a("el-option",{attrs:{label:"已结束",value:"3"}})],1)],1)],1),a("div",{staticClass:"row2",staticStyle:{"margin-top":"8px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.getTableList}},[e._v("查询")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.stopSearch}},[e._v("取消查询")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.mallCoupon}},[e._v("创建店铺优惠劵")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.goodsCoupon}},[e._v("创建商品优惠劵")]),a("el-button",{attrs:{size:"mini"},on:{click:e.stopCreate}},[e._v("停止创建活动")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.MallvoucherStopMul}},[e._v("批量停止活动")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.MallvoucherDelMul}},[e._v("批量删除活动")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.clearLog}},[e._v("清除日志")]),a("el-checkbox",{staticStyle:{"margin-left":"8px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")])],1)]),a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}}),a("div",{staticClass:"tableDetail",staticStyle:{"margin-top":"8px"}},[a("u-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{data:e.tableList,height:"800px","use-virtual":"",border:!1,"header-cell-style":{background:"#f7fafa"}},on:{"selection-change":e.handleSelectionChange}},[a("u-table-column",{attrs:{type:"selection",width:"55",fixed:""}}),a("u-table-column",{attrs:{type:"index",fixed:"",label:"序号","min-width":"50px"}}),a("u-table-column",{attrs:{prop:"",label:"站点",align:"center","min-width":"50px",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(e._f("chineseSite")(a.country)))]}}])}),a("u-table-column",{attrs:{prop:"mallName",label:"店铺",align:"center","min-width":"150px"}}),a("u-table-column",{attrs:{prop:"name",label:"优惠劵",align:"center","min-width":"150px"}}),a("u-table-column",{attrs:{prop:"voucher_code",label:"优惠码",align:"center","min-width":"180px"}}),a("u-table-column",{attrs:{prop:"voucher_type",label:"优惠类型",align:"center","min-width":"100px"}}),a("u-table-column",{attrs:{prop:"discountInfo",label:"折扣金额",align:"center","min-width":"180px"}}),a("u-table-column",{attrs:{prop:"topNum",label:"最高上限数额",align:"center","min-width":"150px"}}),a("u-table-column",{attrs:{prop:"usage_limit",label:"优惠劵可使用数量",align:"center","min-width":"150px"}}),a("u-table-column",{attrs:{prop:"min_price",label:"最低消费记录",align:"center","min-width":"100px"}}),a("u-table-column",{attrs:{prop:"distributed_count",label:"已领取",align:"center","min-width":"100px"}}),a("u-table-column",{attrs:{prop:"current_usage",label:"已使用",align:"center","min-width":"100px"}}),a("u-table-column",{attrs:{prop:"",label:"期间",align:"center","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",[e._v(e._s(r.formStartime)+"-")]),a("div",[e._v(e._s(r.formEndtime))])]}}])}),a("u-table-column",{attrs:{prop:"voucher_status",label:"状态",align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return["进行中"===r.voucher_status?a("span",{staticStyle:{color:"#0ad10a"}},[e._v(e._s(r.voucher_status))]):e._e(),"即将开始"===r.voucher_status?a("span",{staticStyle:{color:"orange"}},[e._v(e._s(r.voucher_status))]):e._e(),"已过期"===r.voucher_status?a("span",[e._v(e._s(r.voucher_status))]):e._e()]}}])}),a("u-table-column",{attrs:{prop:"",label:"是否在基本页面显示",align:"center","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.rule&&a.rule.hide?"否":"是"))]}}])}),a("u-table-column",{attrs:{prop:"",label:"操作",align:"center","min-width":"100px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",["即将开始"===r.voucher_status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.MallvoucherDelFun(r),e.singerStop=!0}}},[e._v("删除")]):e._e()],1),a("span",["进行中"===r.voucher_status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.MallvoucherStop(r),e.singerStop=!0}}},[e._v("停止")]):e._e()],1)]}}])})],1)],1),a("el-dialog",{staticClass:"edit-group-dialog",attrs:{visible:e.CouponVisible,width:"620px",top:"5vh",title:e.dialogtitle,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.CouponVisible=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"160px"}},[a("el-form-item",{attrs:{label:"当前站点"}},[e._v(" "+e._s(e._f("chineseSite")(e.selectMallList[0]&&e.selectMallList[0].country))+" ")]),a("el-form-item",{staticStyle:{color:"red"},attrs:{label:"币种"}},[e._v(" "+e._s(e._f("siteCoin")(e.selectMallList[0]&&e.selectMallList[0].country))+"(优惠劵活动使用的是当地币种) ")]),a("el-form-item",{attrs:{label:"优惠劵名称"}},[a("el-input",{staticStyle:{width:"260px"},attrs:{size:"mini"},model:{value:e.couponName,callback:function(t){e.couponName=t},expression:"couponName"}})],1),a("el-form-item",{attrs:{label:"奖励类型"}},[a("el-radio-group",{model:{value:e.rewardType,callback:function(t){e.rewardType=t},expression:"rewardType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("折扣")]),a("el-radio",{attrs:{label:"1"}},[e._v("Shoppe币折扣 "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"买家使用Shoppee币回扣优惠劵并获得Shoppee币作为回报。Shoppee币成本将由您吸收",placement:"right-start"}},[a("i",{staticClass:"el-icon-question"})])],1)],1)],1),a("el-form-item",{staticClass:"discountitem",attrs:{label:"折扣类型 | 优惠限额"}},["0"===e.rewardType?a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.discountType,callback:function(t){e.discountType=t},expression:"discountType"}},[a("el-option",{attrs:{label:"折扣",value:"0"}}),a("el-option",{attrs:{label:"折扣金额",value:"1"}})],1):e._e(),"1"===e.rewardType?a("span",[e._v("折扣 ：")]):e._e(),a("div",[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},model:{value:e.discountNum,callback:function(t){e.discountNum=t},expression:"discountNum"}}),"0"===e.discountType||"1"===e.rewardType?a("span",{staticStyle:{color:"red"}},[e._v("%折扣,付款金额中的-%将退还给买家")]):e._e()],1)],1),a("el-form-item",{attrs:{label:"最高优惠金额"}},[a("el-radio-group",{model:{value:e.limitPrice,callback:function(t){e.limitPrice=t},expression:"limitPrice"}},[a("el-radio",{attrs:{label:"0"}},[e._v("无限制")]),a("el-radio",{attrs:{label:"1"}},[e._v("设置金额： "),a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},model:{value:e.maxPrice,callback:function(t){e.maxPrice=t},expression:"maxPrice"}})],1)],1)],1),a("el-form-item",{attrs:{label:"最低消费金额"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},model:{value:e.minPrice,callback:function(t){e.minPrice=t},expression:"minPrice"}})],1),a("el-form-item",{attrs:{label:"优惠时限"}},[a("el-date-picker",{staticStyle:{width:"330px"},attrs:{size:"mini","value-format":"timestamp",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.dateTime,callback:function(t){e.dateTime=t},expression:"dateTime"}})],1),a("el-form-item",{attrs:{label:"优惠劵可使用数量(必填)"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},model:{value:e.useQuantity,callback:function(t){e.useQuantity=t},expression:"useQuantity"}})],1),a("el-form-item",{attrs:{label:"优惠劵显示页面"}},[a("el-radio-group",{model:{value:e.couponhide,callback:function(t){e.couponhide=t},expression:"couponhide"}},[a("el-radio",{attrs:{label:"0"}},[e._v("在基本页面显示")]),a("el-radio",{attrs:{label:"1"}},[e._v("不显示")])],1),"0"===e.couponhide?a("div",{staticStyle:{color:"red","line-height":"16px",height:"32px"}},[e._v(" 选择此选项以便买家可以在商品页面，商品详情页面和购物车页面上查看您的优惠劵。 ")]):e._e(),"1"===e.couponhide?a("div",{staticStyle:{color:"red","line-height":"16px",height:"32px"}},[e._v("您的优惠劵不会显示在任何页面上但您可以与用户分享优惠劵代码。 ")]):e._e()],1),a("el-form-item",{attrs:{label:"优惠商品"}},["1"===e.coupontype?a("span",[e._v("所有商品")]):e._e(),"2"===e.coupontype?a("div",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.goodsItemSelectorVisible=!0}}},[e._v("添加商品")]),a("el-table",{staticClass:"goodstable",attrs:{data:e.couponGoodslist,"header-cell-style":{background:"#f7fafa"},height:"120px"}},[a("el-table-column",{attrs:{prop:"id",label:"商品ID",align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"100px"}},[[a("span",[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("删除")])],1)]],2)],1)],1):e._e()]),a("el-form-item",["1"===e.coupontype?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.mallCouponFun}},[e._v("创建店铺优惠劵")]):e._e(),"2"===e.coupontype?a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("创建商品优惠劵")]):e._e(),a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("取消")])],1)],1)],1),a("div",{staticClass:"on_new_dialog"},[a("el-dialog",{attrs:{visible:e.goodsItemSelectorVisible,top:"7vh",title:"商品选择","close-on-click-modal":!1,"close-on-press-escape":!1,width:"1280px"},on:{"update:visible":function(t){e.goodsItemSelectorVisible=t}}},[e.goodsItemSelectorVisible?a("goodsItemSelector",{attrs:{mall:e.selectMallList},on:{changeGoodsItem:e.changeGoodsItem}}):e._e()],1)],1)],1)},n=[],o=a("2909"),i=a("1da1"),c=(a("96cf"),a("a9e3"),a("d3b7"),a("25f0"),a("b0c0"),a("99af"),a("159b"),a("ac1f"),a("466d"),a("feb6")),l=a("01cd"),s=a("a254"),u=a("0e0b"),p={components:{storeChoose:c["a"],goodsItemSelector:l["a"]},data:function(){return{tableLoading:!1,singerStop:!1,MarketManagerAPIInstance:new s["a"](this),showlog:!0,saleType:"0",tableList:[],goodsItemSelectorVisible:!1,CouponVisible:!1,dialogtitle:"",coupontype:"2",couponName:"",rewardType:"0",discountType:"1",discountNum:"",limitPrice:"0",maxPrice:"",minPrice:"",dateTime:[],pickerOptions:{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}},useQuantity:"",couponhide:"0",couponGoodslist:[],selectMallList:[],stoptoping:!1,mallTableSelect:[]}},created:function(){},methods:{changeGoodsItem:function(e){this.goodsItemSelectorVisible=!1},clearLog:function(){this.$refs.Logs.consoleMsg=""},handleSelectionChange:function(e){this.mallTableSelect=e},MallvoucherStopMul:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.mallTableSelect.length){t.next=3;break}return e.$message.warning("请选择要操作的数据"),t.abrupt("return");case 3:a=0;case 4:if(!(a<e.mallTableSelect.length)){t.next=11;break}if(2!==Number(e.mallTableSelect[a].promotion_type)){t.next=8;break}return t.next=8,e.MallvoucherStop(e.mallTableSelect[a]);case 8:a++,t.next=4;break;case 11:e.getTableList();case 12:case"end":return t.stop()}}),t)})))()},MallvoucherStop:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={country:e.country,mallId:e.platform_mall_id,voucher_id:e.voucher_id.toString()},a.prev=1,t.showlog=!1,a.next=5,t.MarketManagerAPIInstance.MallvoucherStop(r);case 5:n=a.sent,0===n.ecode?t.$refs.Logs.writeLog("------已停止【".concat(e.name,"】优惠活动------"),!0):t.$refs.Logs.writeLog("停止【".concat(e.name,"】优惠活动,").concat(n.message),!1),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),t.$refs.Logs.writeLog("停止【".concat(e.name,"】--catch,").concat(a.t0),!1);case 12:t.singerStop&&t.getTableList(),t.singerStop=!1;case 14:case"end":return a.stop()}}),a,null,[[1,9]])})))()},MallvoucherDelMul:function(){var e=this;this.mallTableSelect.length?this.$confirm("确定要删除这些优惠卷吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.MallvoucherDelMulFun()})).catch((function(){})):this.$message.warning("请选择要操作的数据")},MallvoucherDelMulFun:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.mallTableSelect.length)){t.next=8;break}if(1!==Number(e.mallTableSelect[a].promotion_type)){t.next=5;break}return t.next=5,e.MallvoucherDel(e.mallTableSelect[a]);case 5:a++,t.next=1;break;case 8:e.getTableList();case 9:case"end":return t.stop()}}),t)})))()},MallvoucherDelFun:function(e){var t=this;this.$confirm("确定要删除该优惠卷吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.MallvoucherDel(e)})).catch((function(){}))},MallvoucherDel:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={country:e.country,mallId:e.platform_mall_id,voucher_id:e.voucher_id.toString()},a.prev=1,t.showlog=!1,a.next=5,t.MarketManagerAPIInstance.MallvoucherDel(r);case 5:n=a.sent,0===n.ecode?t.$refs.Logs.writeLog("------成功删除【".concat(e.name,"】优惠活动------"),!0):t.$refs.Logs.writeLog("删除【".concat(e.name,"】优惠活动,").concat(n.message),!1),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),t.$refs.Logs.writeLog("删除【".concat(e.name,"】--catch,").concat(a.t0),!1);case 12:t.singerStop&&t.getTableList(),t.singerStop=!1;case 14:case"end":return a.stop()}}),a,null,[[1,9]])})))()},stopSearch:function(){Object(u["v"])(),this.stoptoping=!0,this.$refs.Logs.writeLog("正在停止查询")},stopCreate:function(){Object(u["v"])(),this.$refs.Logs.writeLog("已停止创建")},add0:function(e){return e<10?"0"+e:e},formatTime:function(e){var t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),o=t.getHours(),i=t.getMinutes(),c=t.getSeconds();return a+"-"+this.add0(r)+"-"+this.add0(n)+" "+this.add0(o)+":"+this.add0(i)+":"+this.add0(c)},changeMallList:function(e){this.selectMallList=e},getInfo:function(e){var t=arguments,a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,i,c,l,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:{count:1},r.prev=1,i={country:e.country,mallId:e.platform_mall_id,offset:e.offset,limit:20,promotion_type:a.saleType},r.next=5,a.MarketManagerAPIInstance.Mallvoucher(i);case 5:c=r.sent,0===c.ecode?(s=c.data.data.voucher_list,s.forEach((function(t){var r;t.platform_mall_id=e.platform_mall_id,t.country=e.country,t.mallName=e.mall_alias_name||e.platform_mall_name,t.voucher_type=(null===(r=t.rule.shopids)||void 0===r?void 0:r.length)>0?"店铺优惠卷":"商品优惠卷",t.formStartime=a.formatTime(1e3*t.start_time),t.formEndtime=a.formatTime(1e3*t.end_time);var n=(new Date).getTime();n<1e3*t.start_time?(t.voucher_status="即将开始",t.promotion_type=1):n>1e3*t.start_time&&n<1e3*t.end_time?(t.voucher_status="进行中",t.promotion_type=2):(t.voucher_status="已过期",t.promotion_type=3),0===Number(t.rule.reward_type)&&(Number(t.discount)>0&&Number(t.max_value)>0?(t.discountInfo="".concat((100-Number(t.discount))/10,"折"),t.topNum=t.max_value):Number(t.discount)>0&&0===Number(t.max_value)?(t.discountInfo="".concat((100-Number(t.discount))/10,"折"),t.topNum="无限制"):(t.discountInfo=t.value,t.topNum="")),1===Number(t.rule.reward_type)&&(t.discountInfo="".concat(t.rule.coin_cashback_voucher.coin_percentage_real,"%折扣,(Shopee币回扣)"),t.topNum=0===Number(t.rule.coin_cashback_voucher.max_coin)?"无限制":t.rule.coin_cashback_voucher.max_coin+"(Shopee币)")})),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】总数据：").concat(c.data.data.total_count,"条,正在请求第【").concat(i.offset/i.limit+1,"】页"),!0),(l=a.getTable).push.apply(l,Object(o["a"])(s)),(null===s||void 0===s?void 0:s.length)>=i.limit&&(e.offset=e.offset+i.limit,a.getInfo(e,{count:1}))):"token not found"===c.message?a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】").concat(c.message,":店铺未登录"),!1):a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】").concat(c.message),!1),r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](1),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】--catch，").concat(r.t0),!1);case 12:return r.prev=12,n.count--,r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[1,9,12,15]])})))()},getTableList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$refs.multipleTable.clearSelection(),e.selectMallList.forEach((function(e){e.offset=0})),e.getTable=[],e.showlog=!1,e.tableLoading=!0,e.$refs.Logs.writeLog("开始请求数据",!0),t.next=8,Object(u["c"])(e.selectMallList,e.getInfo);case 8:t.sent,e.$refs.Logs.writeLog("请求数据结束"),e.tableLoading=!1,e.tableList=e.getTable;case 12:case"end":return t.stop()}}),t)})))()},mallCoupon:function(){this.showlog=!0,this.CouponVisible=!0,this.coupontype="1",this.dialogtitle="新建店铺优惠劵",this.selectMallList.length||this.$message.warning("请选择店铺")},mallCouponFun:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.CouponVisible=!1,e.showlog=!1,e.$refs.Logs.writeLog("正在创建任务"),t.next=5,Object(u["c"])(e.selectMallList,e.createCoupon);case 5:t.sent,e.$refs.Logs.writeLog("创建任务结束"),e.getTableList();case 8:case"end":return t.stop()}}),t)})))()},goodsCoupon:function(){this.CouponVisible=!0,this.coupontype="2",this.dialogtitle="新建商品优惠劵",this.selectMallList.length?this.selectMallList.length>1&&this.$message.warning("只能在一个店铺里创建商品优惠劵"):this.$message.warning("请选择店铺")},IsNumOrAlp:function(e){if(e.length>6)return!1;var t=/[A-Za-z0-9]/g,a=e.match(t);return a},GetUserName:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n="",r.next=3,a.$appConfig.getGlobalCacheInfo("mallInfo",e.platform_mall_id);case 3:if(o=r.sent,n=0===t?JSON.parse(o).mall_account_info.username:JSON.parse(o).mall_account_info.userRealName,n){r.next=10;break}return r.next=8,a.MarketManagerAPIInstance.getShoppUserName(e);case 8:i=r.sent,n=i.data.user_name;case 10:return n||(a.$refs.Logs.writeLog("创建优惠券失败，请先同步店铺信息",!1),n=""),r.abrupt("return",n);case 12:case"end":return r.stop()}}),r)})))()},CreateCouponCode:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,o,i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r="",n=0;case 2:if(!(n<e.length)){a.next=9;break}if(t.IsNumOrAlp(e[n].toString())&&(r+=e[n]),4!==r.length){a.next=6;break}return a.abrupt("break",9);case 6:n++,a.next=2;break;case 9:for(o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="",c=0;c<5;c++)i+=o[Math.floor(Math.random()*o.length)];return a.abrupt("return",(r+i).toUpperCase());case 13:case"end":return a.stop()}}),a)})))()},createCoupon:function(e){var t=arguments,a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,o,i,c,l,s,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=t.length>1&&void 0!==t[1]?t[1]:{count:1},!(a.dateTime[0]<(new Date).getTime())){r.next=4;break}return a.$message.warning("开启时间不能小于当前时间"),r.abrupt("return");case 4:return r.prev=4,o=null,i=null,c=null,"0"===a.rewardType?"0"===a.discountType?o=a.discountNum:i=a.discountNum:c=a.discountNum,l={country:e.country,mallId:e.platform_mall_id,min_price:a.minPrice,name:a.couponName,value:i,end_time:Math.floor(a.dateTime[1]/1e3),start_time:Math.floor(a.dateTime[0]/1e3),max_value:"0"===a.limitPrice?null:a.maxPrice,discount:o,usage_quantity:a.useQuantity,claim_quantity:"0",rule:{voucher_landing_page:"1",reward_type:a.rewardType,hide:a.couponhide,backend_created:"0",items:[],coin_cashback_voucher:{coin_percentage_real:c,max_coin:c?a.maxPrice:null}},voucher_code:null},r.next=12,a.GetUserName(e,0);case 12:if(s=r.sent,s){r.next=15;break}return r.abrupt("return");case 15:return r.next=17,a.CreateCouponCode(s);case 17:return l.voucher_code=r.sent,r.next=20,a.MarketManagerAPIInstance.MallvoucherCreate(l);case 20:if(u=r.sent,"wrong voucher prefix"!==u.message){r.next=36;break}return r.next=24,a.GetUserName(e,1);case 24:if(s=r.sent,s){r.next=27;break}return r.abrupt("return");case 27:return r.next=29,a.CreateCouponCode(s);case 29:return l["voucher_code"]=r.sent,r.next=32,a.MarketManagerAPIInstance.MallvoucherCreate(l);case 32:u=r.sent,0!==u.ecode?a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建失败：").concat(u.message),!1):a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建成功"),!0),r.next=37;break;case 36:0===u.ecode?a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建成功"),!0):a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建失败：").concat(u.message),!1);case 37:r.next=42;break;case 39:r.prev=39,r.t0=r["catch"](4),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建失败：").concat(r.t0,"};"),!1);case 42:return r.prev=42,n.count--,r.finish(42);case 45:case"end":return r.stop()}}),r,null,[[4,39,42,45]])})))()}}},m=p,d=(a("4824"),a("e55f"),a("2877")),h=Object(d["a"])(m,r,n,!1,null,"2d290363",null);t["default"]=h.exports},a254:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("1da1"),n=a("d4ec"),o=a("bee2"),i=(a("b0c0"),a("a9e3"),a("96cf"),function(){function e(t){Object(n["a"])(this,e),this._this=t}return Object(o["a"])(e,[{key:"topGoods",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.goodsID,o={mallId:r,id:n},e.next=5,this._this.$shopeemanService.postChinese(a,"/api/v3/product/boost_product/?",o,{headers:{"Content-Type":"application/json",Accept:"application/json, application/xml, text/json, text/x-json, text/javascript, text/xml","Accept-Encoding":"gzip, deflate"}});case 5:return i=e.sent,c=JSON.parse(JSON.parse(i).data),l=c.code,s=c.message,e.abrupt("return",{ecode:l,message:s});case 12:return e.prev=12,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"getSkuList-catch: ".concat(e.t0)});case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"Mallvoucher",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u,p,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.offset,o=t.limit,i=t.promotion_type,c={mallId:r,offset:n,limit:o,promotion_type:i},e.next=5,this._this.$shopeemanService.getChinese(a,"/api/marketing/v3/voucher/list/?",c,{headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, application/xml, text/json, text/x-json, text/javascript, text/xml","Accept-Encoding":"gzip, deflate"}});case 5:return l=e.sent,s=JSON.parse(l),u=JSON.parse(s.data),p=u.code,m=u.message,e.abrupt("return",{ecode:p,data:u,message:m});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"getSkuList-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"MallvoucherStop",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.voucher_id,o={mallId:r,voucher_id:n},e.next=5,this._this.$shopeemanService.putChinese(a,"/api/marketing/v3/voucher/stop/?",o,{headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate"}});case 5:return i=e.sent,c=JSON.parse(i),l=JSON.parse(c.data),s=l.code,u=l.message,e.abrupt("return",{ecode:s,data:l,message:u});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"getSkuList-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"MallvoucherDel",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.voucher_id,o={mallId:r,voucher_id:n},e.next=5,this._this.$shopeemanService.deleteChinese(a,"/api/marketing/v3/voucher/?",o,{headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate",referer:"/portal/marketing/vouchers/".concat(n)}});case 5:return i=e.sent,c=JSON.parse(i),l=JSON.parse(c.data),s=l.code,u=l.message,e.abrupt("return",{ecode:s,data:l,message:u});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"getSkuList-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"MallvoucherCreate",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u,p,m,d,h,g,f,v,_,b,x;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.min_price,o=t.name,i=t.value,c=t.end_time,l=t.start_time,s=t.max_value,u=t.discount,p=t.usage_quantity,m=t.claim_quantity,d=t.rule,h=t.voucher_code,g={mallId:r,min_price:n,name:o,value:i,end_time:c,start_time:l,max_value:s,discount:u,usage_quantity:p,claim_quantity:m,rule:{voucher_landing_page:d.voucher_landing_page,reward_type:d.reward_type,hide:d.hide,backend_created:d.backend_created,items:d.items,coin_cashback_voucher:{coin_percentage_real:d.coin_cashback_voucher.coin_percentage_real,max_coin:d.coin_cashback_voucher.max_coin}},voucher_code:h},e.next=5,this._this.$shopeemanService.postChineseReferer(a,"/api/marketing/v3/voucher/?",g,{headers:{"Content-Type":"application/json",Accept:"application/json, application/xml, text/json, text/x-json, text/javascript, text/xml",referer:"/portal/marketing/vouchers/new?edit=shop"}});case 5:return f=e.sent,v=JSON.parse(f),_=JSON.parse(v.data),b=_.errcode||_.code,x=_.message,e.abrupt("return",{ecode:b,data:_,message:x});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"MallvoucherCreate-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getShoppUserName",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.platform_mall_id,n={mallId:r},e.next=5,this._this.$shopeemanService.getChineseReferer(a,"/api/selleraccount/user_info/?",n,{headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/plain, */*",referer:"/portal/settings/shop/profile"}});case 5:return o=e.sent,i=JSON.parse(o),c=JSON.parse(i.data).data,e.abrupt("return",{data:c});case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"getShoppUserName-catch: ".concat(e.t0)});case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FollowPrize",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.offset,o=t.limit,i={mallId:r,offset:n,limit:o},e.next=5,this._this.$shopeemanService.getChineseReferer(a,"/api/marketing/v4/follow_prize/list/?",i,{headers:{"Content-Type":"application/json; charset=utf-8",accept:"application/json, text/plain, */*","accept-encoding":"gzip, deflate, br",referer:"/portal/marketing/follow-prize/list"}});case 5:return c=e.sent,l=JSON.parse(c),s=JSON.parse(l.data),u=s.code,p=s.message,e.abrupt("return",{ecode:u,data:s,message:p});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"FollowPrize-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FollowPrizeDetail",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.campaign_id,o={mallId:r,campaign_id:n},e.next=5,this._this.$shopeemanService.getChineseReferer(a,"/api/marketing/v4/follow_prize/?",o,{headers:{accept:"application/json, application/xml, text/json, text/x-json, text/javascript, text/xml","Accept-Encoding":"gzip, deflate"}});case 5:return i=e.sent,c=JSON.parse(i),l=JSON.parse(c.data),s=l.code,u=l.message,e.abrupt("return",{ecode:s,data:l,message:u});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"FollowPrize-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"followPrizeCreate",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u,p,m,d,h,g,f,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.discount,o=t.end_time,i=t.follow_prize_name,c=t.min_spend,l=t.quota,s=t.reward_type,u=t.start_time,p=t.coin_cash_back,m={mallId:r,shopid:Number(r),follow_prize_name:i,start_time:Number(u),end_time:Number(o),quota:Number(l),min_spend:Number(c),reward_type:Number(s),discount:n,coin_cash_back:p},e.next=5,this._this.$shopeemanService.postChineseReferer(a,"/api/marketing/v4/follow_prize/?",m,{headers:{"Content-Type":"application/json",accept:"application/json, application/xml, text/json, text/x-json, text/javascript, text/xml",referer:"/portal/marketing/follow-prize/create"}});case 5:return d=e.sent,h=JSON.parse(d),g=JSON.parse(h.data),f=g.errcode||g.code,v=g.message,e.abrupt("return",{ecode:f,data:g,message:v});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"followPrizeCreate-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"MallPrizeDel",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i,c,l,s,u,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.country,r=t.mallId,n=t.campaign_id,o=t.action,i={mallId:r,campaign_id:n,action:o},e.next=5,this._this.$shopeemanService.postChineseReferer(a,"/api/marketing/v4/follow_prize/operation/?",i,{headers:{"Content-Type":"application/json",Accept:"application/json, application/xml, text/json, text/x-json, text/javascript, text/xml",referer:"/portal/marketing/follow-prize?tab=list"}});case 5:return c=e.sent,l=JSON.parse(c),s=JSON.parse(l.data),u=s.code,p=s.message,e.abrupt("return",{ecode:u,data:s,message:p});case 13:return e.prev=13,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"MallPrizeDel-catch: ".concat(e.t0)});case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}())},b1ac:function(e,t,a){},e55f:function(e,t,a){"use strict";a("42d6")}}]);