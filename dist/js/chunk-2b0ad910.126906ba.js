(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b0ad910"],{"3b9d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"suit-style"},[a("div",{staticClass:"header-btn"},[a("storeChoose",{attrs:{"is-all":!1},on:{changeMallList:t.changeMallList}}),a("div",{staticClass:"header-row"},[a("div",{staticClass:"item-box"},[a("span",[t._v("活动类型：")]),a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择店铺",clearable:"",size:"mini",filterable:""},model:{value:t.activeState,callback:function(e){t.activeState=e},expression:"activeState"}},[a("el-option",{attrs:{label:"全部",value:1}}),t._l(t.statuslist,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],2)],1),a("el-button",{staticStyle:{"margin-left":"27px"},attrs:{type:"primary",disabled:t.loading,size:"mini"},on:{click:t.batchGetSuitData}},[t._v("搜索")]),a("el-button",{attrs:{type:"primary",disabled:t.loading,size:"mini"},on:{click:function(e){t.creatactivity=!0}}},[t._v("创建套装促销活动")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.stopCreate}},[t._v("停止活动创建")]),a("el-button",{attrs:{type:"primary",disabled:t.loading,size:"mini"},on:{click:function(e){return t.batchStopSuit(t.multipleSelection)}}},[t._v("批量删除/结束勾选活动")]),a("el-button",{attrs:{type:"primary",disabled:t.loading,size:"mini"},on:{click:t.clearLog}},[t._v("清除日志")]),a("el-checkbox",{staticClass:"mar-left",model:{value:t.showlog,callback:function(e){t.showlog=e},expression:"showlog"}},[t._v("隐藏日志")]),a("el-checkbox",{model:{value:t.showexpiredactivities,callback:function(e){t.showexpiredactivities=e},expression:"showexpiredactivities"}},[t._v("不显示过期活动")])],1)],1),a("div",{staticClass:"content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"plTable",staticStyle:{"margin-top":"10px"},attrs:{"header-align":"center",height:"calc(100vh - 110px)",data:t.tableData,"header-cell-style":{backgroundColor:"#f5f7fa"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"50"}}),a("el-table-column",{attrs:{align:"center",label:"序号",width:"60",type:"index"}}),a("el-table-column",{attrs:{align:"center",label:"店铺",width:"180",prop:"mallName"}}),a("el-table-column",{attrs:{prop:"name",label:"套装促销名称",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"time_status",label:"活动状态",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(t.changeType(a.time_status))+" ")]}}])}),a("el-table-column",{attrs:{prop:"extinfo_images.item_total_count",label:"商品数量",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"time",label:"促销期间",width:"280",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(t.$dayjs(1e3*a.start_time).format("YYYY/MM/DD HH:mm:ss")+" - "+t.$dayjs(1e3*a.end_time).format("YYYY/MM/DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{prop:"shippingcount",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.updateSuit(i)}}},[t._v("编辑商品")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){}}},[t._v("复制活动")]),2===i.sign?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){}}},[t._v("分享链接")]):t._e(),3===i.time_status?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.batchStopSuit([i])}}},[t._v("结束")]):t._e(),2===i.time_status?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.batchStopSuit([i])}}},[t._v("删除")]):t._e()]}}])})],1)],1),a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:t.showlog,callback:function(e){t.showlog=e},expression:"showlog"}}),t.creatactivity?a("el-dialog",{attrs:{title:"创建套装促销活动","close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.creatactivity,width:"450px"},on:{"update:visible":function(e){t.creatactivity=e}}},[a("div",{staticClass:"create-style"},[a("div",{staticClass:"item-box"},[a("span",[t._v("套装名称：")]),a("el-input",{staticStyle:{width:"260px"},attrs:{clearable:"",size:"mini",placeholder:"24个字符以内",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:t.creatname,callback:function(e){t.creatname=e},expression:"creatname"}})],1),a("div",{staticClass:"item-box mar-top"},[a("span",[t._v("套装期间：")]),a("el-date-picker",{staticStyle:{width:"340px"},attrs:{format:"yyyy-MM-dd HH:mm:ss","unlink-panels":"",size:"mini",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.creattime,callback:function(e){t.creattime=e},expression:"creattime"}})],1),a("div",{staticClass:"item-box mar-top"},[a("span",[t._v("套装类型：")]),a("el-radio-group",{model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[a("el-radio",{attrs:{label:2}},[t._v("折扣比率")]),a("el-radio",{attrs:{label:3}},[t._v("折扣金额")]),a("el-radio",{attrs:{label:1}},[t._v("套装特价")])],1)],1),2==t.radio?a("div",{staticClass:"diff-type mar-top"},[a("div",{staticClass:"diff-item"},[a("p",[t._v("购买")]),a("el-input",{staticStyle:{width:"100px"},attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:t.creatnum,callback:function(e){t.creatnum=e},expression:"creatnum"}}),a("p",[t._v("个商品")]),a("el-input",{staticStyle:{width:"120px"},attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/[^\\d]/g,'')"},on:{input:t.changeCreateDiscount},model:{value:t.creatdiscount,callback:function(e){t.creatdiscount=e},expression:"creatdiscount"}},[a("template",{staticStyle:{width:"30px"},slot:"append"},[t._v("%")])],2)],1),a("div",{staticClass:"diff-item",attrs:{"mar-top":""}},[t.creatdiscount?a("p",{staticClass:"activeColor mar-top"},[t._v("*折扣比率 = 总结算价 - "+t._s(t.creatdiscount)+"%")]):t._e(),t.isNull?a("p",{staticClass:"activeColor mar-top"},[t._v("此栏位最小值必须>=1且为整数")]):t._e()])]):t._e(),3==t.radio?a("div",{staticClass:"diff-type mar-top"},[a("div",{staticClass:"diff-item"},[a("p",[t._v("购买")]),a("el-input",{staticStyle:{width:"100px"},attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:t.creatnum,callback:function(e){t.creatnum=e},expression:"creatnum"}}),a("p",[t._v("个商品")]),a("el-input",{staticStyle:{width:"120px"},attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},on:{change:t.changeCreateDiscount},model:{value:t.creatdiscount,callback:function(e){t.creatdiscount=e},expression:"creatdiscount"}},[a("template",{staticStyle:{width:"30px"},slot:"append"},[t._v(t._s(t._f("siteCoin")(t.country)))])],2)],1),a("div",{staticClass:"diff-item mar-top"},[t.creatdiscount?a("p",{staticClass:"activeColor mar-top"},[t._v("*折扣金额 = 总结算价 - "+t._s(t._f("siteCoin")(t.country))+t._s(t.creatdiscount))]):t._e(),t.isNull?a("p",{staticClass:"activeColor mar-top"},[t._v("此栏位最小值必须>=1且为整数")]):t._e()])]):t._e(),1==t.radio?a("div",{staticClass:"diff-type mar-top"},[a("div",{staticClass:"diff-item"},[a("p",[t._v("购买")]),a("el-input",{staticStyle:{width:"100px"},attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:t.creatnum,callback:function(e){t.creatnum=e},expression:"creatnum"}}),a("p",[t._v("个商品")]),a("el-input",{staticStyle:{width:"120px"},attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},on:{change:t.changeCreateDiscount},model:{value:t.creatdiscount,callback:function(e){t.creatdiscount=e},expression:"creatdiscount"}},[a("template",{staticStyle:{width:"30px"},slot:"append"},[t._v(t._s(t._f("siteCoin")(t.country)))])],2)],1),a("div",{staticClass:"diff-item mar-top"},[t.creatdiscount?a("p",{staticClass:"activeColor mar-top"},[t._v("*套装特价"+t._s(t._f("siteCoin")(t.country))+t._s(t.creatdiscount))]):t._e(),t.isNull?a("p",{staticClass:"activeColor mar-top"},[t._v("此栏位最小值必须>=1且为整数")]):t._e()])]):t._e(),a("div",{staticClass:"item-box mar-top"},[a("span",[t._v("购买限制：")]),t._v(" 买家最多可以购买此套装优惠 "),a("el-input",{staticStyle:{width:"100px"},attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:t.creatcount,callback:function(e){t.creatcount=e},expression:"creatcount"}}),t._v(" 次 ")],1),a("div",{staticClass:"item-box mar-top"},[a("el-button",{staticStyle:{"margin-left":"130px"},attrs:{type:"primary",size:"mini"},on:{click:t.batchCreateSuit}},[t._v("保存")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.creatactivity=!1}}},[t._v("取消")])],1)])]):t._e(),t.updateSuitVisible?a("el-dialog",{attrs:{title:"编辑活动","close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.updateSuitVisible,width:"1200px"},on:{"update:visible":function(e){t.updateSuitVisible=e}}},[a("div",{staticClass:"create-style"},[a("div",{staticClass:"header-btn"},[a("p",{staticClass:"activeColor"},[t._v("开启商品后，请勿更换物流商，否则买家无法购买套装优惠。")]),a("div",{staticClass:"header-row"},[a("div",{staticClass:"item-box"},[a("span",[t._v("商品ID：")]),a("el-input",{attrs:{size:"mini"},model:{value:t.goodsID,callback:function(e){t.goodsID=e},expression:"goodsID"}})],1),a("el-button",{staticClass:"mar-left",attrs:{size:"mini",type:"primary"},on:{click:t.searchSuitGoods}},[t._v("搜索")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.goodsItemSelectorVisible=!0}}},[t._v("添加商品")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.batchDeleteSuitGoods(t.goodsSelection)}}},[t._v("批量删除")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.batchCloseSuitGoods(t.goodsSelection,0)}}},[t._v("批量关闭")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.batchCloseSuitGoods(t.goodsSelection,1)}}},[t._v("批量开启")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.editLoading,expression:"editLoading"}],ref:"editTable",staticStyle:{"margin-top":"10px"},attrs:{"header-align":"center",height:"400",data:t.editGoodsList,"header-cell-style":{backgroundColor:"#f5f7fa"}},on:{"selection-change":t.handleSelectionChange1}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"50"}}),a("el-table-column",{attrs:{align:"center",label:"序号",width:"60",type:"index"}}),a("el-table-column",{attrs:{align:"center",label:"商品ID",width:"120",prop:"itemid"}}),a("el-table-column",{attrs:{label:"商品图片",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticStyle:{width:"32px",height:"32px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:t._f("imageRender")([e.row.images[0]])}})],1),a("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t._f("imageRender")([e.row.images[0],!0])}})],1)]}}],null,!1,3881087189)}),a("el-table-column",{attrs:{prop:"name",label:"标题",width:"140",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"price",label:"价格",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"stock",label:"库存",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"运送渠道",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){e.row;return[t._v(" "+t._s(t.shipType)+" ")]}}],null,!1,644615713)}),a("el-table-column",{attrs:{label:"开关",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},on:{change:function(e){return t.batchCloseSuitGoods([i],i.status)}},model:{value:i.status,callback:function(e){t.$set(i,"status",e)},expression:"row.status"}})]}}],null,!1,2901021208)}),a("el-table-column",{attrs:{prop:"shippingcount",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.batchDeleteSuitGoods([i])}}},[t._v("删除")])]}}],null,!1,880246526)})],1)],1)]):t._e(),a("el-dialog",{attrs:{visible:t.goodsItemSelectorVisible,top:"7vh",title:"商品选择","close-on-click-modal":!1,"close-on-press-escape":!1,width:"1280px"},on:{"update:visible":function(e){t.goodsItemSelectorVisible=e}}},[t.goodsItemSelectorVisible?a("goodsItemSelector",{attrs:{mall:t.selectMallListEdit},on:{changeGoodsItem:t.changeGoodsItem}}):t._e()],1)],1)},n=[],s=a("1da1"),l=(a("96cf"),a("159b"),a("d3b7"),a("25f0"),a("ac1f"),a("1276"),a("c740"),a("99af"),a("a434"),a("caad"),a("2532"),a("a15b"),a("b0c0"),a("4de4"),a("feb6")),r=a("0e0b"),o=a("01cd"),c={components:{storeChoose:l["a"],goodsItemSelector:o["a"]},data:function(){return{isNull:!1,loading:!1,showlog:!1,showexpiredactivities:!0,creatactivity:!1,creatactivity1:!1,radio:2,creatnum:2,creatdiscount:1,creatcount:1,creatname:"",tableData:[],errmall:[],creattime:[],statuslist:[{label:"进行中",value:3},{label:"即将到来",value:2},{label:"已到期",value:4}],activeState:1,selectMallList:[],country:"",multipleSelection:[],updateSuitVisible:!1,editGoodsList:[],goodsSelection:[],goodsID:"",editLoading:!1,shipType:"",activeRow:{},selectMallListEdit:[],goodsItemSelectorVisible:!1}},mounted:function(){var t=(new Date).getTime()+6e5,e=t+36e5;this.creattime=[this.$dayjs(t).format("YYYY-MM-DD HH:mm:ss"),this.$dayjs(e).format("YYYY-MM-DD HH:mm:ss")]},methods:{searchSuitGoods:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,i,n,s,l,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.editGoodsList=[],a={bundle_deal_id:t.activeRow.bundle_deal_id,need_all:0,country:t.activeRow.country,mallId:t.activeRow.mallId},e.next=4,t.$shopeemanService.getSuitShipType(t.activeRow.country,a);case 4:if(i=e.sent,200!==i.code){e.next=17;break}return i.data.shop_logistics_info.disabled&&i.data.shop_logistics_info.disabled.forEach((function(e){t.shipType=t.shipType+"\n".concat(e.display_name,"\n")})),i.data.shop_logistics_info.enabled&&i.data.shop_logistics_info.enabled.forEach((function(e){t.shipType=t.shipType+"\n".concat(e.display_name,"\n")})),n=i.data&&i.data.items||[],s=[],n.forEach((function(t){s.push(t.itemid.toString())})),l={query:"query Products($productIds: [String], $statusType: Int) {\n      products(productIds: $productIds, statusType: $statusType) \n    {\n      items {\n        itemid,\n    sold,\n    price,\n    promotions {\n      itemid,\n      promotionId,\n      startTime,\n      price,\n      endTime,\n      promotionType\n    },\n    logisticsChannels {\n      name,\n      enabled\n    },\n        name,\n        inputOriginPrice,\n        originPrice,\n        normalStock,\n        status,\n        stock,\n        pffTag,\n        normalSellerStock,\n        normalWmsStock,\n        images,\n        hasWholesale,\n        minPurchaseLimit,\n        modelList {\n          itemid,\n          modelid,\n          name,\n          inputOriginPrice,\n          originPrice,\n          normalStock,\n          stock,\n          pffTag,\n          normalSellerStock,\n          normalWmsStock,\n          isDefault\n        }\n      }\n    }\n  \n    }",variables:{productIds:s,statusType:0},mallId:t.activeRow.mallId},t.editLoading=!0,e.next=15,t.$shopeemanService.getSuitGoods(t.activeRow.country,l);case 15:r=e.sent,200===r.code?t.editGoodsList=r.data:t.$message.error("获取商品详情失败");case 17:t.editLoading=!1;case 18:case"end":return e.stop()}}),e)})))()},changeGoodsItem:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.goodsItemSelectorVisible=!1,i=[],t.goodsList.forEach((function(t){t.status=0,t.images=t.images.split(",");var e={item_id:t.itemid,status:0};i.push(e)})),e.editGoodsList=t.goodsList,a.next=6,e.addGoods(i);case 6:case"end":return a.stop()}}),a)})))()},addGoods:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={bundle_deal_id:e.activeRow.bundle_deal_id,items:t,mallId:e.activeRow.mallId},e.editLoading=!0,a.next=4,e.$shopeemanService.mixSuitShipType(e.activeRow.country,i,"post");case 4:if(n=a.sent,e.editLoading=!1,200!==n.code){a.next=10;break}e.$alert("添加商品成功","提示",{confirmButtonText:"确定"}),a.next=11;break;case 10:return a.abrupt("return",e.$alert("添加商品失败，".concat(n.data),"提示",{confirmButtonText:"确定"}));case 11:case"end":return a.stop()}}),a)})))()},searchProductDetail:function(t,e,a){var i=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={product_id:t,version:"3.2.0",shop_id:e},a.next=3,i.$shopeemanService.searchProductDetail(i.activeRow.country,n);case 3:if(s=a.sent,200!==s.code){a.next=8;break}return a.abrupt("return",s.data.model_list);case 8:return a.abrupt("return",[]);case 9:case"end":return a.stop()}}),a)})))()},batchCloseSuitGoods:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var n,s,l,r,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.length){i.next=2;break}return i.abrupt("return",a.$message.warning("请选择商品"));case 2:for(n=[],s=0;s<t.length;s++)l={item_id:t[s].itemid,status:e},n.push(l);return r={bundle_deal_id:a.activeRow.bundle_deal_id,items:n,mallId:a.activeRow.mallId},i.next=7,a.$shopeemanService.mixSuitShipType(a.activeRow.country,r,"put");case 7:if(o=i.sent,200!==o.code){i.next=12;break}t.forEach((function(t){var i=a.editGoodsList.findIndex((function(e){return e.itemid==t.itemid}));a.$set(a.editGoodsList[i],"status",e)})),i.next=13;break;case 12:return i.abrupt("return",a.$message.error("".concat(0==e?"关闭":"开启","失败，").concat(o.data)));case 13:case"end":return i.stop()}}),i)})))()},batchDeleteSuitGoods:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n,s,l,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.length){a.next=2;break}return a.abrupt("return",e.$message.warning("请选择商品"));case 2:for(i=[],n=0;n<t.length;n++)s={item_id:t[n].itemid},i.push(s);return l={bundle_deal_id:e.activeRow.bundle_deal_id,items:i,mallId:e.activeRow.mallId},a.next=7,e.$shopeemanService.mixSuitShipType(e.activeRow.country,l,"delete");case 7:if(r=a.sent,200!==r.code){a.next=12;break}t.forEach((function(t){var a=e.editGoodsList.findIndex((function(e){return e.itemid==t.itemid}));e.editGoodsList.splice(a,1)})),a.next=13;break;case 12:return a.abrupt("return",e.$message.error("删除失败，".concat(r.data.includes("bundle deal error bundle deal ended")?"商品已过期":r.data)));case 13:case"end":return a.stop()}}),a)})))()},updateSuit:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n,s,l,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.activeRow=t,e.selectMallListEdit=[t.mallInfo],e.updateSuitVisible=!0,!t.extinfo.itemid_list||!t.extinfo.itemid_list.length){a.next=18;break}return i=t.extinfo.itemid_list.join(",").split(","),n={query:"query Products($productIds: [String], $statusType: Int) {\n      products(productIds: $productIds, statusType: $statusType) \n    {\n      items {\n        itemid,\n    sold,\n    price,\n    promotions {\n      itemid,\n      promotionId,\n      startTime,\n      price,\n      endTime,\n      promotionType\n    },\n    logisticsChannels {\n      name,\n      enabled\n    },\n        name,\n        inputOriginPrice,\n        originPrice,\n        normalStock,\n        status,\n        stock,\n        pffTag,\n        normalSellerStock,\n        normalWmsStock,\n        images,\n        hasWholesale,\n        minPurchaseLimit,\n        modelList {\n          itemid,\n          modelid,\n          name,\n          inputOriginPrice,\n          originPrice,\n          normalStock,\n          stock,\n          pffTag,\n          normalSellerStock,\n          normalWmsStock,\n          isDefault\n        }\n      }\n    }\n  \n    }",variables:{productIds:i,statusType:0},mallId:t.mallId},e.editLoading=!0,a.next=9,e.$shopeemanService.getSuitGoods(t.country,n);case 9:return s=a.sent,200===s.code?e.editGoodsList=s.data:e.$message.error("获取商品详情失败"),l={bundle_deal_id:t.bundle_deal_id,country:t.country,mallId:t.mallId},a.next=14,e.$shopeemanService.getSuitShipType(t.country,l);case 14:r=a.sent,e.shipType="",200===r.code&&(r.data.shop_logistics_info.disabled&&r.data.shop_logistics_info.disabled.forEach((function(t){e.shipType=e.shipType+"\n".concat(t.display_name,"\n")})),r.data.shop_logistics_info.enabled&&r.data.shop_logistics_info.enabled.forEach((function(t){e.shipType=e.shipType+"\n".concat(t.display_name,"\n")}))),e.editLoading=!1;case 18:case"end":return a.stop()}}),a)})))()},changeType:function(t){switch(t){case 2:return"即将开始";case 3:return"进行中";case 4:return"已过期";default:return""}},batchStopSuit:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n,s,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.length){a.next=2;break}return a.abrupt("return",e.$message.warning("请选择数据！"));case 2:i=0;case 3:if(!(i<t.length)){a.next=20;break}return n=t[i],s={mallId:n.mallId,bundle_deal_id:n.bundle_deal_id,action:2===n.time_status?"delete":"stop"},a.next=8,e.$shopeemanService.stopSuit(n.country,s);case 8:if(l=a.sent,200!==l.code){a.next=16;break}if(e.$refs.Logs.writeLog("店铺【".concat(n.mallName,"】").concat(2===n.time_status?"删除":"停止","活动【").concat(n.name,"】成功"),!0),i!==t.length-1){a.next=14;break}return a.next=14,e.batchGetSuitData();case 14:a.next=17;break;case 16:403===l.code?e.$refs.Logs.writeLog("店铺【".concat(n.mallName,"】").concat(2===n.time_status?"删除":"停止","活动【").concat(n.name,"】失败，店铺未登录"),!1):e.$refs.Logs.writeLog("店铺【".concat(n.mallName,"】").concat(2===n.time_status?"删除":"停止","活动【").concat(n.name,"】失败，").concat(l.data),!1);case 17:i++,a.next=3;break;case 20:case"end":return a.stop()}}),a)})))()},stopCreate:function(){Object(r["v"])(),this.$alert("正在停止操作，可能需要一些时间！","提示",{confirmButtonText:"确定"}),this.loading=!1},changeCreateDiscount:function(t){this.isNull=!t},changeMallList:function(t){this.selectMallList=t,this.country=t.country},batchGetSuitData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.selectMallList.length){e.next=2;break}return e.abrupt("return",t.$message.warning("请选择店铺！"));case 2:return t.loading=!0,t.tableData=[],e.next=6,Object(r["c"])(t.selectMallList,t.getSuitData);case 6:t.loading=!1,t.$refs.Logs.writeLog("套装数据获取结束！",!0);case 8:case"end":return e.stop()}}),e)})))()},getSuitData:function(t){var e=arguments,a=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var n,s,l,r,o,c,u,d;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.length>1&&void 0!==e[1]?e[1]:{count:5},s=t.mall_alias_name||t.platform_mall_name,l=t.platform_mall_id,r=100,i.prev=4,o={status:a.activeState,offset:0,limit:r,mallId:l},i.next=8,a.$shopeemanService.getSuitList(t.country,o);case 8:if(c=i.sent,200!==c.code){i.next=29;break}u=c.data.bundle_deal_list||[];case 11:if(!u.length){i.next=26;break}if(a.showexpiredactivities&&(u=u.filter((function(t){return 4!==t.time_status}))),u.forEach((function(e){e.mallName=s,e.mallId=l,e.country=t.country,e.mallInfo=t})),a.tableData=a.tableData.concat(u),!(u.length<r)){i.next=19;break}u=[],i.next=24;break;case 19:return o.offset+=r,i.next=22,a.$shopeemanService.getSuitList(t.country,o);case 22:d=i.sent,u=200===d.code?d.data.bundle_deal_list:[];case 24:i.next=11;break;case 26:a.$refs.Logs.writeLog("获取店铺【".concat(s,"】套装优惠数据完成"),!0),i.next=30;break;case 29:403===c.code?a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】获取广告失败，店铺未登录"),!1):a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】获取广告失败，").concat(c.data),!1);case 30:i.next=34;break;case 32:i.prev=32,i.t0=i["catch"](4);case 34:return i.prev=34,--n.count,i.finish(34);case 37:case"end":return i.stop()}}),i,null,[[4,32,34,37]])})))()},clearLog:function(){this.$refs.Logs.consoleMsg=""},handleSelectionChange:function(t){this.multipleSelection=t},handleSelectionChange1:function(t){this.goodsSelection=t},batchCreateSuit:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.creatname&&t.creatnum&&t.creatdiscount){e.next=2;break}return e.abrupt("return",t.$message.warning("请完整填写的活动信息！"));case 2:if(t.selectMallList.length){e.next=4;break}return e.abrupt("return",t.$message.warning("请选择店铺！"));case 4:return t.loading=!0,t.creatactivity=!1,e.next=8,Object(r["c"])(t.selectMallList,t.savecreat);case 8:return t.loading=!1,e.next=11,t.batchGetSuitData();case 11:case"end":return e.stop()}}),e)})))()},savecreat:function(t){var e=arguments,a=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var n,s,l,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.length>1&&void 0!==e[1]?e[1]:{count:5},i.prev=1,s=t.platform_mall_id,l={mallId:s,name:a.creatname,rule_type:a.radio,min_amount:a.creatnum,start_time:Math.round(new Date(a.creattime[0]).getTime()/1e3),end_time:Math.round(new Date(a.creattime[1]).getTime()/1e3),usage_limit:a.creatcount,fix_price:0,discount_value:0,discount_percentage:0},1===a.radio?l.fix_price=a.creatdiscount:2===a.radio?l.discount_percentage=a.creatdiscount:l.discount_value=a.creatdiscount,i.next=7,a.$shopeemanService.createSuit(t.country,l);case 7:r=i.sent,200===r.code?a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】创建套装活动成功"),!0):403===r.code?a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】创建套装活动失败，店铺未登录"),!1):a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】创建套装活动失败，").concat(r.data),!1),i.next=13;break;case 11:i.prev=11,i.t0=i["catch"](1);case 13:return i.prev=13,--n.count,i.finish(13);case 16:case"end":return i.stop()}}),i,null,[[1,11,13,16]])})))()}}},u=c,d=(a("4a6b2"),a("2877")),p=Object(d["a"])(u,i,n,!1,null,"43ed0b9a",null);e["default"]=p.exports},"4a6b2":function(t,e,a){"use strict";a("e0a6")},"4c28":function(t,e,a){},8992:function(t,e,a){"use strict";a("4c28")},e0a6:function(t,e,a){},feb6:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ul",{staticClass:"storeChooseUL"},[t.isMall?a("li",[t._v(t._s(t._f("chineseSite")(t.countryVal)))]):a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("所属站点：")]),a("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:""},model:{value:t.countryVal,callback:function(e){t.countryVal=e},expression:"countryVal"}},[t.isAll?a("el-option",{attrs:{label:"全部",value:""}}):t._e(),t._l(t.countries,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],2)],1),a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺分组：")]),a("el-select",{staticClass:"selectBox",attrs:{placeholder:"",multiple:"","collapse-tags":"",size:"mini",filterable:""},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._l(t.groupIdList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.group_name,value:t.id}})}))],2)],1),a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺名称：")]),a("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadmoreMall,expression:"loadmoreMall"}],staticClass:"selectBox",attrs:{placeholder:"",multiple:"","collapse-tags":"","filter-method":t.filterMall,size:"mini",filterable:""},model:{value:t.site,callback:function(e){t.site=e},expression:"site"}},[t.isShowName?t._e():a("el-option",{attrs:{label:"全部",value:""}}),t._l(t.siteShowList,(function(e,i){return t.showMall(e,i)?a("el-option",{key:i,attrs:{label:e.mall_alias_name||e.platform_mall_name,value:e.platform_mall_id}}):t._e()}))],2)],1),t.isReset?a("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[a("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary"},on:{click:t.reset}},[t._v("　刷　　新　")])],1):t._e()])])},n=[],s=a("1da1"),l=a("2909"),r=(a("96cf"),a("99af"),a("d81d"),a("fb6a"),a("d3b7"),a("25f0"),a("159b"),a("c740"),a("7db0"),a("4de4"),a("caad"),a("2532"),a("7646")),o=a("2b0e");o["default"].directive("loadmore",{bind:function(t,e){var a=t.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){this.scrollHeight-this.scrollTop<=this.clientHeight+50?e.value(!0,this):this.scrollTop<30&&e.value(!1,this)}))}});var c={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},parentCountry:{type:String,default:"TH"},isMall:{type:Boolean,default:function(){return!1}},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}}},data:function(){return{isAllowSet1:!0,isAllowSet2:!0,countryVal:null,groupId:[],groupIdList:[],site:[],siteList:[],siteShowList:[],countries:this.$filters.countries_option,mallListAPIInstance:new r["a"](this),isShowName:"",showMallNumber:100,mallShowIndex:0}},watch:{siteList:function(t){this.siteShowList=t},countryVal:{handler:function(t,e){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},deep:!0},groupId:{handler:function(t,e){var a=this;if(this.isAllowSet2){this.isAllowSet2=!1;var i=e.indexOf("")>-1,n=t.indexOf("")>-1;i!==n?this.groupId=n?[""].concat(Object(l["a"])(this.groupIdList.map((function(t){return t.id})))):[]:n?this.groupId=t.slice(1):this.groupIdList.length>0&&this.groupId.length===this.groupIdList.length&&this.groupId.unshift(""),setTimeout((function(){a.isAllowSet2=!0,a.ddMallGoodsGetMallList(2)}),10)}},deep:!0},site:{handler:function(t,e){var a=this;if(this.isAllowSet1){this.isAllowSet1=!1;var i=e.indexOf("")>-1,n=t.indexOf("")>-1;i!==n?this.site=n?[""].concat(Object(l["a"])(this.siteList.map((function(t){return t.platform_mall_id})))):[]:n?this.site=t.slice(1):this.siteList.length>0&&this.siteList.length===this.site.length&&this.site.unshift(""),setTimeout((function(){a.changeMallList(),a.isAllowSet1=!0}),10)}},deep:!0}},mounted:function(){this.countryVal=this.isMall?this.parentCountry:this.isAll?"":"TH"},methods:{reset:function(){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},ddMallGoodsGetMallList:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,i,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.site=[],a=e.countryVal,i=e.groupId.indexOf("")>-1&&e.groupId.slice(1).toString()||e.groupId.toString(),n={country:a,mallGroupIds:i},t.next=6,e.mallListAPIInstance.ddMallGoodsGetMallList(n);case 6:s=t.sent,200===s.code?(e.siteList=s.data||[],0===e.groupIdList.length&&(e.groupId=[""],e.siteList.forEach((function(t){var a=e.groupIdList.findIndex((function(e){return e.id===t.group_id}));t.group_name&&a<0&&(e.groupIdList.push({group_name:t.group_name,id:t.group_id}),e.groupId.push(t.group_id))}))),setTimeout((function(){e.isAllowSet2=!0,e.isAllowSet1=!0,e.site=[""]}),10)):e.$message.error("获取分组、店铺列表失败");case 8:case"end":return t.stop()}}),t)})))()},changeMallList:function(){var t=this,e=[],a="";this.site.forEach((function(i){if(i){var n=t.siteList.find((function(t){return t.platform_mall_id===i}));e.push(n),a+=i+","}})),!this.countryVal&&this.groupId.indexOf("")>-1&&(a=e.length!==this.siteList.length&&a||""),this.source?this.$emit("changeMallList",{mallList:e,source:this.source,searchAll:a,country:this.countryVal.toLocaleUpperCase()}):(e["country"]=this.countryVal,this.$emit("changeMallList",e))},filterMall:function(t){this.isShowName=t||"";var e=this.siteList.filter((function(e){var a=e.mall_alias_name||e.platform_mall_name;return a.includes(t)}));this.showMallNumber=e.length-this.showMallNumber;var a=this.siteList.filter((function(e){var a=e.mall_alias_name||e.platform_mall_name;return!a.includes(t)}));this.siteShowList=[].concat(Object(l["a"])(e),Object(l["a"])(a))},showMall:function(t,e){var a=t.mall_alias_name||t.platform_mall_name,i=this.site[0]===t.platform_mall_id;return i||this.mallShowIndex<=e&&e<=this.mallShowIndex+this.showMallNumber&&(!this.isShowName||a.includes(this.isShowName))},loadmoreMall:function(t,e){if(this.siteShowList.length>this.showMallNumber){var a=0;t?(a=this.mallShowIndex+10,a=a<this.siteShowList.length&&a||this.mallShowIndex):(a=this.mallShowIndex-10,a=a>0&&a||0),a!==this.mallShowIndex&&(e.scrollTop=t?e.scrollTop-100:30),this.mallShowIndex=a}}}},u=c,d=(a("8992"),a("2877")),p=Object(d["a"])(u,i,n,!1,null,null,null);e["a"]=p.exports}}]);