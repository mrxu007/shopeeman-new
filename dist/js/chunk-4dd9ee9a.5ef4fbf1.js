(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dd9ee9a"],{"4dc0":function(t,a,e){"use strict";var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("el-table",{ref:"shopGroupTable",attrs:{"highlight-current-row":"",width:"100",height:"825","data-changes-scroll-top":!1,"row-height":40,border:!1,data:t.shopGruopData,"row-class-name":t.tableRowClassName},on:{"row-click":t.rowClick}},[e("el-table-column",{attrs:{align:"center",prop:"group_name",label:"店铺分组"}})],1)],1)},r=[],o=e("1da1"),s=(e("96cf"),{props:{getData:{type:Function,default:null}},data:function(){return{shopGruopData:[]}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getBindMallCount();case 2:case"end":return a.stop()}}),a)})))()},methods:{tableRowClassName:function(t){t.row;var a=t.rowIndex;if(0===a)return"default-current-row"},rowClick:function(t){this.$emit("getGroupId",t.id),0!==t.id&&(document.querySelector(".default-current-row").style.color="#60627d",document.querySelector(".default-current-row").style.backgroundColor="#fff"),this.getData(),console.log(t)},getBindMallCount:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var e,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$api.getBindMallCount();case 2:e=a.sent,n=e.data,200===n.code?(t.shopGruopData=n.data,t.shopGruopData.unshift({id:0,group_name:"全部分组"}),t.shopGruopData.push({id:-1,group_name:"无分组"}),console.log("shopGroupData",n.data)):t.$message.error("店铺分组数据错误".concat(n.message));case 5:case"end":return a.stop()}}),a)})))()}}}),l=s,u=(e("c5bf"),e("2877")),c=Object(u["a"])(l,n,r,!1,null,"059d950c",null);a["a"]=c.exports},"4f6e":function(t,a,e){},"949c":function(t,a,e){"use strict";e("4f6e")},c5bf:function(t,a,e){"use strict";e("e64f")},c75b:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-row",{staticClass:"contaniner"},[e("el-col",{attrs:{span:3}},[e("mallGroup",{attrs:{"get-data":t.getMallStatistics},on:{getGroupId:t.getGroupId}})],1),e("el-col",{staticClass:"right",attrs:{span:21}},[e("el-row",{staticClass:"header"},[e("el-col",{staticClass:"header-top",attrs:{span:24}},[e("ul",[e("li",[e("span",[t._v("站点：")]),e("el-select",{staticClass:"unnormal",attrs:{placeholder:"",size:"mini",filterable:""},model:{value:t.form.site,callback:function(a){t.$set(t.form,"site",a)},expression:"form.site"}},[e("el-option",{attrs:{label:"全部",value:0}}),t._l(t.countries,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})}))],2)],1),e("li",[e("el-select",{staticClass:"unnormal",attrs:{placeholder:"",size:"mini",filterable:""},model:{value:t.form.shopSelect,callback:function(a){t.$set(t.form,"shopSelect",a)},expression:"form.shopSelect"}},t._l(t.shopSelectList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})})),1),e("el-input",{staticClass:"unnormal2",attrs:{placeholder:"",size:"mini",clearable:"",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:t.form.shopSelectVal,callback:function(a){t.$set(t.form,"shopSelectVal",a)},expression:"form.shopSelectVal"}})],1),e("li",[e("span",[t._v("客服数据统计时间(仅用于同步数据)：")]),e("el-select",{staticClass:"unnormal3",attrs:{placeholder:"",size:"mini",filterable:""},model:{value:t.serviceDataTime,callback:function(a){t.serviceDataTime=a},expression:"serviceDataTime"}},t._l(t.serviceDataTimeList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})})),1)],1),e("li",[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.page=1,t.getMallStatistics()}}},[t._v("查询")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.exportSearch()}}},[t._v("导出数据")]),e("el-button",{attrs:{type:"primary",size:"mini",disabled:t.buttonStatus.asyncData},on:{click:function(a){return t.handlerSelectTableOperating("syncMallData")}}},[t._v("同步店铺数据")])],1),e("li",[e("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.isShowProgress,expression:"isShowProgress"}],staticStyle:{width:"230px"},attrs:{"text-inside":!0,"stroke-width":24,percentage:t.percentage,status:"success"}})],1)])])],1),e("el-row",{staticClass:"header-two"},[e("el-col",{staticClass:"header-two-top",attrs:{span:24}},[e("span",[t._v("当前条件下，待拨款总订单数： "),e("p",[t._v(t._s(t.frozenAmountOrders))])]),e("span",[t._v("待拨款总金额： "),e("p",[t._v(t._s(parseFloat(t.frozenAmount).toFixed(2)))])]),e("span",[t._v("本周已拨款总金额： "),e("p",[t._v(t._s(parseFloat(t.weekAmount).toFixed(2)))])]),e("span",[t._v("本月已拨款总金额： "),e("p",[t._v(t._s(parseFloat(t.monthAmount).toFixed(2)))])]),e("span",[t._v("全部已拨款总金额： "),e("p",[t._v(t._s(parseFloat(t.availableAmount).toFixed(2)))])])])],1),e("el-row",{staticClass:"article"},[e("u-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"plTable",attrs:{"use-virtual":"",height:t.height,"row-height":t.rowHeight,"data-changes-scroll-top":!1,border:!1,"header-cell-style":{textAlign:"center",backgroundColor:"#f5f7fa"}},on:{"selection-change":t.handleSelectionChange}},[e("u-table-column",{attrs:{align:"center",fixed:"",type:"selection",width:"50"}}),e("u-table-column",{attrs:{align:"center",fixed:"",type:"index",label:"序列号",width:"60"}}),e("u-table-column",{attrs:{align:"center",fixed:"",prop:"country",label:"站点",width:"70"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(t._f("chineseSite")(e.country))+" ")]}}])}),e("u-table-column",{attrs:{align:"center",fixed:"",prop:"platform_mall_id",label:"店铺ID",width:"100"}}),e("u-table-column",{attrs:{align:"center",label:"店铺名称",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_alias_name?e.mall_alias_name:e.platform_mall_name)+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"店铺分组",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s("All"===e.group_name?"":e.group_name)+" ")]}}])}),e("u-table-column",{attrs:{align:"center",fixed:"right",label:"操作状态",width:"130","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.row;return[e("span",{style:n.color&&"color:"+n.color},[t._v(t._s(n.status))])]}}])}),e("u-table-column",{attrs:{align:"center",prop:"recent_order_create_time",label:"最近订单创建时间",width:"150"}}),e("u-table-column",{attrs:{align:"center",prop:"yesterday_order_num",label:"昨日订单数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"week_order_num",label:"近7天订单数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"history_order_num",label:"历史订单数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"mall_quota",label:"店铺额度",width:"100",sortable:""}}),e("u-table-column",{attrs:{align:"center",prop:"all_product_num",label:"全部产品数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"active_product_num",label:"上架产品数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"soldout_product_num",label:"售空产品数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"banned_product_num",label:"禁卖产品数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"unlisted_product_num",label:"未上架产品数",width:"100"}}),e("u-table-column",{attrs:{align:"center",prop:"chat_response_rate",label:"聊聊回复率",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"rating_star",label:"卖场评价",width:"80"}}),e("u-table-column",{attrs:{align:"center",prop:"order_non_fulfillment_rate",label:"订单未完成率",width:"100"}}),e("u-table-column",{attrs:{align:"center",prop:"followers_number",label:"关注量",width:"60"}}),e("u-table-column",{attrs:{align:"center",prop:"fans_number",label:"粉丝量",width:"60"}}),e("u-table-column",{attrs:{align:"center",prop:"today_view_product_count",label:"商品浏览量",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"yesterday_view_product_count",label:"昨日浏览量",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"week_view_product_count",label:"近7天浏览量",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"month_view_product_count",label:"近30天浏览量",width:"100"}}),e("u-table-column",{attrs:{align:"center",prop:"today_view_person_count",label:"访客数",width:"60"}}),e("u-table-column",{attrs:{align:"center",prop:"yesterday_view_person_count",label:"昨日访客数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"week_view_person_count",label:"近7日访客数",width:"90"}}),e("u-table-column",{attrs:{align:"center",prop:"month_view_person_count",label:"近30日访客数",width:"100"}}),e("u-table-column",{attrs:{align:"center",label:"客服不重复访客数","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatShopUvData?e.mall_datas.ChatShopUvData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服询问数","min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatsEnquiredData?e.mall_datas.ChatsEnquiredData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服访客询问数","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatVisitorsEnquiredData?e.mall_datas.ChatVisitorsEnquiredData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服已回应数","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatRespondedChatsData?e.mall_datas.ChatRespondedChatsData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服无回应数","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatNonRespondedChatsData?e.mall_datas.ChatNonRespondedChatsData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服咨询买家数","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatBuyersData?e.mall_datas.ChatBuyersData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服咨询订单数","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatOrdersData?e.mall_datas.ChatOrdersData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服咨询件数","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatUnitsData?e.mall_datas.ChatUnitsData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服咨询销售额","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatSalesData?e.mall_datas.ChatSalesData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",label:"客服平均回应时间","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(a){var e=a.row;return[t._v(" "+t._s(e.mall_datas&&e.mall_datas.ChatResponseTimeData?e.mall_datas.ChatResponseTimeData:"-")+" ")]}}])}),e("u-table-column",{attrs:{align:"center",prop:"frozen_amount_orders",label:"待拨款订单数","min-width":"110"}}),e("u-table-column",{attrs:{align:"center",prop:"frozen_amount",label:"待拨款金额","min-width":"110"}}),e("u-table-column",{attrs:{align:"center",prop:"lastweek_amount",label:"本周已拨款","min-width":"110"}}),e("u-table-column",{attrs:{align:"center",prop:"lastmonth_amount",label:"本月已拨款","min-width":"110"}}),e("u-table-column",{attrs:{align:"center",prop:"available_amount",label:"全部已拨款","min-width":"100"}})],1),e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{background:"","current-page":t.page,"page-sizes":[200,700,1e3,2e3],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)],1)},r=[],o=e("1da1"),s=(e("159b"),e("99af"),e("96cf"),e("4dc0")),l=e("0e0b"),u=e("d4ec"),c=e("bee2"),i=(e("b680"),e("ac1f"),e("5319"),e("6c27")),d=e("8237"),p=e.n(d),m=function(){function t(a){Object(u["a"])(this,t),this._this=a}return Object(c["a"])(t,[{key:"getProductStatisticalData",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e){var n,r,o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=a.platform_mall_id,r=a.country,o={mallId:n,version:"3.1.0"},t.next=5,this._this.$shopeemanService.getChinese(r,e,o);case 5:if(s=t.sent,s=JSON.parse(s),200!==s.status){t.next=11;break}return l=s&&s.data&&JSON.parse(s.data)&&JSON.parse(s.data).data,l&&(a["all_product_num"]=l.product_count_for_limit+l.unlisted_count+l.banned_count,a["active_product_num"]=l.product_count_for_limit,a["unlisted_product_num"]=l.unlisted_count,a["banned_product_num"]=l.banned_count,a["mall_quota"]=l.count_for_limit,a["soldout_product_num"]=l.sold_out_count),t.abrupt("return",{code:200,data:l||{}});case 11:return t.abrupt("return",{code:s.status,data:s.data});case 14:return t.prev=14,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 17:case"end":return t.stop()}}),t,this,[[0,14]])})));function a(a,e){return t.apply(this,arguments)}return a}()},{key:"getShopProfile",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e){var n,r,o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=a.platform_mall_id,r=a.country,o={mallId:n,version:"3.1.0"},t.next=5,this._this.$shopeemanService.getChinese(r,e,o);case 5:if(s=t.sent,s=JSON.parse(s),console.log(s),200!==s.status){t.next=12;break}return l=s&&s.data&&JSON.parse(s.data)&&JSON.parse(s.data).data,l&&(a["chat_response_rate"]=l.shop.display_response_rate+"%",a["rating_star"]=parseFloat(l.shop.rating_star).toFixed(2),a["fans_number"]=l.shop.follower_count,a["followers_number"]=l.user.following_count,a["display_response_rate"]=l.shop.display_response_rate+"%"),t.abrupt("return",{code:200,data:l||{}});case 12:return t.abrupt("return",{code:s.status,data:s.data});case 15:return t.prev=15,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function a(a,e){return t.apply(this,arguments)}return a}()},{key:"getShopMetricsvalue",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e){var n,r,o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=a.platform_mall_id,r=a.country,o={mallId:n,version:"3.1.0"},t.next=5,this._this.$shopeemanService.getChinese(r,e,o);case 5:if(s=t.sent,s=JSON.parse(s),console.log(s),200!==s.status){t.next=12;break}return l=s&&s.data&&JSON.parse(s.data)&&JSON.parse(s.data).data,l&&(a["order_non_fulfillment_rate"]=100*l.non_fulfillment_rate+"%"),t.abrupt("return",{code:200,data:l||{}});case 12:return t.abrupt("return",{code:s.status,data:s.data});case 15:return t.prev=15,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function a(a,e){return t.apply(this,arguments)}return a}()},{key:"getKeyMetrics",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e,n,r){var o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a.platform_mall_id,o=a.country,t.next=4,this._this.$shopeemanService.getChinese(o,e,n);case 4:if(s=t.sent,s=JSON.parse(s),console.log(s),200!==s.status){t.next=11;break}return l=s&&s.data&&JSON.parse(s.data)&&JSON.parse(s.data).result,l&&("today"===r?(a["today_view_product_count"]=l.shop_pv.value,a["today_view_person_count"]=l.shop_uv.value):"yesterday"===r?(a["yesterday_view_product_count"]=l.shop_pv.value,a["yesterday_view_person_count"]=l.shop_uv.value):"past7days"===r?(a["week_view_product_count"]=l.shop_pv.value,a["week_view_person_count"]=l.shop_uv.value):"past30days"===r&&(a["month_view_product_count"]=l.shop_pv.value,a["month_view_person_count"]=l.shop_uv.value)),t.abrupt("return",{code:200,data:l||{}});case 11:return t.abrupt("return",{code:s.status,data:s.data});case 14:return t.prev=14,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 17:case"end":return t.stop()}}),t,this,[[0,14]])})));function a(a,e,n,r){return t.apply(this,arguments)}return a}()},{key:"getChatDashboard",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e,n,r){var o,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a.platform_mall_id,o=a.country,t.next=4,this._this.$shopeemanService.getChinese(o,e,n);case 4:if(s=t.sent,s=JSON.parse(s),200!==s.status){t.next=11;break}return u=s&&s.data&&JSON.parse(s.data)&&JSON.parse(s.data).result,console.log(u,"getChatDashboard"),u&&("real_time"===r||"yesterday"===r||"past7days"===r||"past30days"===r)&&(a.mall_datas||(a.mall_datas={}),a.mall_datas.ChatShopUvData=u.shop_uv.value,a.mall_datas.ChatsEnquiredData=u.chats_enquired.value,a.mall_datas.ChatVisitorsEnquiredData=u.visitors_enquired.value,a.mall_datas.ChatRespondedChatsData=u.responded_chats.value,a.mall_datas.ChatNonRespondedChatsData=u.non_responded_chats.value,a.mall_datas.ChatResponseTimeData=Object(l["l"])(u.response_time.value).replace(/-/g,""),a.mall_datas.ChatBuyersData=u.buyers.value,a.mall_datas.ChatOrdersData=u.orders.value,a.mall_datas.ChatUnitsData=u.units.value,a.mall_datas.ChatSalesData=u.sales.value),t.abrupt("return",{code:200,data:u||{}});case 11:return t.abrupt("return",{code:s.status,data:s.data});case 14:return t.prev=14,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 17:case"end":return t.stop()}}),t,this,[[0,14]])})));function a(a,e,n,r){return t.apply(this,arguments)}return a}()},{key:"getBankAccounts",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e){var n,r,o,s,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=a.platform_mall_id,r=a.country,t.next=4,this._this.$appConfig.getGlobalCacheInfo("mallInfo",n);case 4:return o=t.sent,s=JSON.parse(o),l={mallId:n,password_hash:Object(i["sha256"])(p()(s.mall_account_info.password)),page_size:30,page_number:1},t.next=9,this._this.$shopeemanService.postChinese(r,e,l,{headers:{"Content-Type":"application/json",charset:"UTF-8"}});case 9:if(u=t.sent,u=JSON.parse(u),console.log(u),200!==u.status){t.next=14;break}return t.abrupt("return",{code:200,data:{}});case 14:return t.abrupt("return",{code:u.status,data:u.data});case 17:return t.prev=17,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 20:case"end":return t.stop()}}),t,this,[[0,17]])})));function a(a,e){return t.apply(this,arguments)}return a}()},{key:"getIncomeMeta",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e){var n,r,o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=a.platform_mall_id,r=a.country,o={mallId:n},t.next=5,this._this.$shopeemanService.getChinese(r,e,o);case 5:if(s=t.sent,s=JSON.parse(s),console.log(s),200!==s.status){t.next=12;break}return l=s&&s.data&&JSON.parse(s.data)&&JSON.parse(s.data).data,l&&(a["frozen_amount"]=l.frozen,a["lastweek_amount"]=l.last_week_income,a["lastmonth_amount"]=l.last_month_income,a["available_amount"]=l.available),t.abrupt("return",{code:200,data:l||{}});case 12:return t.abrupt("return",{code:s.status,data:s.data});case 15:return t.prev=15,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function a(a,e){return t.apply(this,arguments)}return a}()},{key:"getFrozenAmountOrders",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,e){var n,r,o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=a.platform_mall_id,r=a.country,o={mallId:n,tran_type:2,page_number:1,page_size:10},t.next=5,this._this.$shopeemanService.getChinese(r,e,o);case 5:if(s=t.sent,s=JSON.parse(s),console.log(s),200!==s.status){t.next=12;break}return l=s&&s.data&&JSON.parse(s.data),l&&(a["frozen_amount_orders"]=l.data.page_info.total),t.abrupt("return",{code:200,data:l||{}});case 12:return t.abrupt("return",{code:s.status,data:s.data});case 15:return t.prev=15,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function a(a,e){return t.apply(this,arguments)}return a}()},{key:"uploadMallData",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={allProduct:a.all_product_num,bannedProduct:a.banned_product_num,soldoutProduct:a.soldout_product_num,unlistedProduct:a.unlisted_product_num,activeProduct:a.active_product_num,fansNumber:a.fans_number,followersNumber:a.followers_number,displayResponseRate:a.display_response_rate,ratingStar:a.rating_star,nonFulfillmentRate:a.order_non_fulfillment_rate,todayViewProductCount:a.today_view_product_count,yesterdayViewProductCount:a.yesterday_view_product_count,weekViewProductCount:a.week_view_product_count,monthViewProductCount:a.month_view_product_count,todayViewPersonCount:a.today_view_person_count,yesterdayViewPersonCount:a.yesterday_view_person_count,weekViewPersonCount:a.week_view_person_count,monthViewPersonCount:a.month_view_person_count,mallQuota:a.mall_quota,lastweekAmount:a.lastweek_amount,lastmonthAmount:a.lastmonth_amount,availableAmount:a.available_amount,frozenAmount:a.frozen_amount,frozenAmountOrders:a.frozen_amount_orders,mallDatas:{ChatShopUvData:a.mall_datas.ChatShopUvData,ChatsEnquiredData:a.mall_datas.ChatsEnquiredData,ChatVisitorsEnquiredData:a.mall_datas.ChatVisitorsEnquiredData,ChatRespondedChatsData:a.mall_datas.ChatRespondedChatsData,ChatNonRespondedChatsData:a.mall_datas.ChatNonRespondedChatsData,ChatResponseTimeData:a.mall_datas.ChatResponseTimeData,ChatBuyersData:a.mall_datas.ChatBuyersData,ChatOrdersData:a.mall_datas.ChatOrdersData,ChatUnitsData:a.mall_datas.ChatUnitsData,ChatSalesData:a.mall_datas.ChatSalesData},sysMallId:a.id},console.log("同步上报数据",e),t.next=5,this._this.$api.mallStatisticsSave(e);case 5:if(n=t.sent,200!==n.status){t.next=8;break}return t.abrupt("return",{code:200,data:n.data.date||""});case 8:return t.abrupt("return",{code:n.status,data:n.data});case 11:return t.prev=11,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"theQuarterPoint-catch: ".concat(t.t0)});case 14:case"end":return t.stop()}}),t,this,[[0,11]])})));function a(a){return t.apply(this,arguments)}return a}()}]),t}(),_={components:{mallGroup:s["a"]},data:function(){return{mallDataApiInstance:new m(this),page:1,total:0,pageSize:200,height:638,rowHeight:50,isLoading:!1,percentage:0,isShowProgress:!1,tableData:[],availableAmount:0,monthAmount:0,weekAmount:0,frozenAmount:0,frozenAmountOrders:0,multipleSelection:[],countries:this.$filters.countries_option,form:{groupId:0,agoNoneOrderDays:"0",site:0,shopSelect:"0",shopSelectVal:""},shopSelectList:[{value:"0",label:"店铺名称"},{value:"1",label:"店铺ID"},{value:"2",label:"店铺别名"}],serviceDataTime:"real_time",serviceDataTimeList:[{value:"yesterday",label:"昨天"},{value:"real_time",label:"今天"},{value:"past7days",label:"7天"},{value:"past30days",label:"30天"}],buttonStatus:{asyncData:!1}}},mounted:function(){this.getMallStatistics()},methods:{syncMallData:function(t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",a.$message("暂无同步数据"));case 2:if(!a.buttonStatus.asyncData){e.next=5;break}return a.$message.error("操作过快, 数据正在同步中"),e.abrupt("return");case 5:return a.buttonStatus.asyncData=!0,console.log(t,"syncMallData"),a.isShowProgress=!0,a.percentage=0,e.next=11,Object(l["d"])(t,a.syncMall,3);case 11:n=e.sent,a.percentage=100,console.log(1,"完成",n),a.buttonStatus.asyncData=!1;case 15:case"end":return e.stop()}}),e)})))()},syncMall:function(t){var a=arguments,e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,o,s,l,u,c,i,d,p,m,_,h,f,b,g,v,w,y,D,C,S,k,x;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{count:1},n.prev=1,e.$set(t,"status","开始同步..."),n.next=5,e.mallDataApiInstance.getProductStatisticalData(t,"/api/v3/product/get_product_statistical_data/");case 5:if(o=n.sent,console.log(o,"res1"),403!==o.code){n.next=11;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.abrupt("return");case 11:return n.next=13,e.mallDataApiInstance.getShopProfile(t,"/api/marketing/v4/shop/profile/get/");case 13:if(s=n.sent,console.log(s,"res2"),403!==s.code){n.next=21;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=20,e.mallDataApiInstance.uploadMallData(t);case 20:return n.abrupt("return");case 21:return n.next=23,e.mallDataApiInstance.getShopMetricsvalue(t,"/api/marketing/v4/shop/metrics_value/");case 23:if(l=n.sent,console.log(l,"res3"),403!==l.code){n.next=31;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=30,e.mallDataApiInstance.uploadMallData(t);case 30:return n.abrupt("return");case 31:return u=new Date((new Date).toLocaleDateString()).getTime(),c=new Date((new Date).toLocaleDateString()).getTime()+864e5-1,i={mallId:t.platform_mall_id,start_time:Math.round(u/1e3),end_time:Math.round(c/1e3),period:"real_time",fetag:"fetag"},n.next=36,e.mallDataApiInstance.getKeyMetrics(t,"/api/mydata/v3/dashboard/key-metrics/",i,"today");case 36:if(d=n.sent,console.log(d,"res4"),403!==d.code){n.next=44;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=43,e.mallDataApiInstance.uploadMallData(t);case 43:return n.abrupt("return");case 44:return p={mallId:t.platform_mall_id,start_time:Math.round((u-86400)/1e3),end_time:Math.round((c-86400)/1e3),period:"yesterday",fetag:"fetag"},n.next=47,e.mallDataApiInstance.getKeyMetrics(t,"/api/mydata/v3/dashboard/key-metrics/",p,"yesterday");case 47:if(m=n.sent,console.log(m,"res5"),403!==m.code){n.next=55;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=54,e.mallDataApiInstance.uploadMallData(t);case 54:return n.abrupt("return");case 55:return _={mallId:t.platform_mall_id,start_time:Math.round((u-604800)/1e3),end_time:Math.round(c/1e3),period:"past7days",fetag:"fetag"},n.next=58,e.mallDataApiInstance.getKeyMetrics(t,"/api/mydata/v3/dashboard/key-metrics/",_,"past7days");case 58:if(h=n.sent,console.log(h,"res6"),403!==h.code){n.next=66;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=65,e.mallDataApiInstance.uploadMallData(t);case 65:return n.abrupt("return");case 66:return f={mallId:t.platform_mall_id,start_time:Math.round((u-2592e3)/1e3),end_time:Math.round(c/1e3),period:"past30days",fetag:"fetag"},n.next=69,e.mallDataApiInstance.getKeyMetrics(t,"/api/mydata/v3/dashboard/key-metrics/",f,"past30days");case 69:if(b=n.sent,console.log(b,"res7"),403!==b.code){n.next=77;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=76,e.mallDataApiInstance.uploadMallData(t);case 76:return n.abrupt("return");case 77:return g=e.getTimeStamp(e.serviceDataTime),v=g.startTime,w=g.endTime,y={mallId:t.platform_mall_id,start_time:v,end_time:w,period:e.serviceDataTime},n.next=81,e.mallDataApiInstance.getChatDashboard(t,"/api/mydata/v2/chat/dashboard/funnel/",y,e.serviceDataTime);case 81:if(D=n.sent,console.log(D,"res8"),403!==D.code){n.next=89;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=88,e.mallDataApiInstance.uploadMallData(t);case 88:return n.abrupt("return");case 89:return n.next=91,e.mallDataApiInstance.getBankAccounts(t,"/api/v3/finance/get_bank_accounts/");case 91:if(C=n.sent,console.log(C,"res9"),403!==C.code){n.next=99;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=98,e.mallDataApiInstance.uploadMallData(t);case 98:return n.abrupt("return");case 99:return n.next=101,e.mallDataApiInstance.getIncomeMeta(t,"/api/v3/finance/get_income_meta/");case 101:if(S=n.sent,console.log(S,"res10"),403!==S.code){n.next=109;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=108,e.mallDataApiInstance.uploadMallData(t);case 108:return n.abrupt("return");case 109:return n.next=111,e.mallDataApiInstance.getFrozenAmountOrders(t,"/api/v3/finance/income_transaction_histories/");case 111:if(k=n.sent,console.log(k,"res11"),403!==k.code){n.next=119;break}return e.$set(t,"status","店铺未登录"),e.$set(t,"color","red"),n.next=118,e.mallDataApiInstance.uploadMallData(t);case 118:return n.abrupt("return");case 119:return e.$set(t,"status","同步完成"),e.$set(t,"color","green"),n.next=123,e.mallDataApiInstance.uploadMallData(t);case 123:x=n.sent,console.log(x,"res12"),200===x.code?(e.$set(t,"status","同步成功-上报成功"),e.$set(t,"color","green")):(e.$set(t,"status","同步成功-上报失败"),e.$set(t,"color","red")),console.log(t,"down"),n.next=134;break;case 129:n.prev=129,n.t0=n["catch"](1),console.log("错误",n.t0),e.$set(t,"status","同步失败"),e.$set(t,"color","red");case 134:return n.prev=134,--r.count,n.finish(134);case 137:case"end":return n.stop()}}),n,null,[[1,129,134,137]])})))()},getMallStatistics:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var e,n,r,o,s,l,u,c,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isLoading=!0,t.availableAmount=0,t.monthAmount=0,t.weekAmount=0,t.frozenAmount=0,t.frozenAmountOrders=0,e=t.form.shopSelectVal,n={country:t.form.site,groupId:t.form.groupId,mallName:"0"===t.form.shopSelect?e:"",mallId:"1"===t.form.shopSelect?e:"",mallAliasName:"2"===t.form.shopSelect?e:"",page:t.page,pageSize:t.pageSize},a.next=10,t.$api.getMallStatistics(n);case 10:if(r=a.sent,o=r.data,console.log(o),200!==o.code){a.next=45;break}if(s=o.data,t.total=s.total,t.tableData=s.data,!t.tableData){a.next=40;break}l=0;case 19:if(!(l<t.tableData.length)){a.next=40;break}return u=t.tableData[l],a.next=23,t.$appConfig.getGlobalCacheInfo("mallInfo",u.platform_mall_id);case 23:c=a.sent,i=JSON.parse(c),u.mall_datas=JSON.parse(u.mall_datas),u.available_amount=u.available_amount?parseInt(u.available_amount):0,u.lastmonth_amount=u.lastmonth_amount?parseInt(u.lastmonth_amount):0,u.lastweek_amount=u.lastweek_amount?parseInt(u.lastweek_amount):0,u.frozen_amount=u.frozen_amount?parseInt(u.frozen_amount):0,u.frozen_amount_orders=u.frozen_amount_orders?u.frozen_amount_orders:0,t.availableAmount+=u.available_amount,t.monthAmount+=u.lastmonth_amount,t.weekAmount+=u.lastweek_amount,t.frozenAmount+=u.frozen_amount,t.frozenAmountOrders+=u.frozen_amount_orders,u.group_name=i.GroupName;case 37:l++,a.next=19;break;case 40:t.isLoading=!1,t.$refs.plTable.reloadData(t.tableData),console.log("tableData",t.tableData),a.next=47;break;case 45:t.$message.error("".concat(o.message)),t.isLoading=!1;case 47:case"end":return a.stop()}}),a)})))()},handlerSelectTableOperating:function(t){this.multipleSelection.length?this[t](this.multipleSelection):this[t](this.tableData)},getTimeStamp:function(t){var a=new Date((new Date).toLocaleDateString()).getTime(),e=new Date((new Date).toLocaleDateString()).getTime()+864e5-1,n="",r="";switch(t){case"yesterday":return n=Math.round((a-86400)/1e3),r=Math.round((e-86400)/1e3),{startTime:n,endTime:r};case"real_time":return n=Math.round(a/1e3),r=Math.round(e/1e3),{startTime:n,endTime:r};case"past7days":return n=Math.round(e/1e3),r=Math.round((e-604800)/1e3),{startTime:n,endTime:r};case"past30days":return n=Math.round(e/1e3),r=Math.round((e-2592e3)/1e3),{startTime:n,endTime:r}}},exportSearch:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var e,n,r,o,s,u,c,i,d,p,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(0!==t.total){a.next=2;break}return a.abrupt("return",t.$message("暂无导出数据"));case 2:t.isLoading=!0,e=[],n=t.form.shopSelectVal,r={country:t.form.site,groupId:t.form.groupId,mallName:"0"===t.form.shopSelect?n:"",mallId:"1"===t.form.shopSelect?n:"",mallAliasName:"2"===t.form.shopSelect?n:"",page:1,pageSize:t.pageSize};case 6:if(!(e.length<t.total)){a.next=43;break}return a.prev=7,a.next=10,t.$api.getMallStatistics(r);case 10:if(o=a.sent,s=o.data,200!==s.code){a.next=32;break}if(u=s.data.data,!u){a.next=28;break}c=0;case 16:if(!(c<u.length)){a.next=28;break}return i=u[c],a.next=20,t.$appConfig.getGlobalCacheInfo("mallInfo",i.platform_mall_id);case 20:d=a.sent,p=JSON.parse(d),i.country=t.$filters.chineseSite(i.country),i.mall_datas=JSON.parse(i.mall_datas),i.group_name=p.GroupName;case 25:c++,a.next=16;break;case 28:u.forEach((function(t){e.push(t)})),r.page++,a.next=34;break;case 32:t.$message.error("".concat(s.message)),t.isLoading=!1;case 34:a.next=41;break;case 36:return a.prev=36,a.t0=a["catch"](7),console.log(a.t0),t.isLoading=!1,a.abrupt("break",43);case 41:a.next=6;break;case 43:m="<tr>\n          <td>站点</td>\n          <td>店铺ID</td>\n          <td>店铺名称</td>\n          <td>店铺分组</td>\n          <td>最近创建订单时间</td>\n          <td>昨日订单数</td>\n          <td>近7天订单数</td>\n          <td>历史订单总数</td>\n          <td>店铺额度</td>\n          <td>全部产品数</td>\n          <td>上架产品数</td>\n          <td>售空产品数</td>\n          <td>禁卖产品数</td>\n          <td>未上架产品数</td>\n          <td>聊聊回复率</td>\n          <td>卖场评价</td>\n          <td>订单未完成率</td>\n          <td>关注量</td>\n          <td>粉丝量</td>\n          <td>商品浏览量</td>\n          <td>昨日商品浏览量</td>\n          <td>近7天商品浏览量</td>\n          <td>近30天商品浏览量</td>\n          <td>访客数</td>\n          <td>昨日访客数</td>\n          <td>近7日访客数</td>\n          <td>近30日访客数</td>\n          <td>客服不重复访客数</td>\n          <td>客服询问数</td>\n          <td>客服访客询问数</td>\n          <td>客服已回应数</td>\n          <td>客服无回应数</td>\n          <td>客服咨询买家数</td>\n          <td>客服咨询订单数</td>\n          <td>客服咨询件数</td>\n          <td>客服咨询销售额</td>\n          <td>客服平均回应时间</td>\n          <td>待拨款订单数</td>\n          <td>待拨款金额</td>\n          <td>本周已拨款</td>\n          <td>本月已拨款</td>\n          <td>全部已拨款</td>\n        </tr>",e.forEach((function(a){m+="<tr>\n        <td>".concat(a.country?t.$filters.chineseSite(a.country):"\t","</td>\n        <td>").concat(a.platform_mall_id?a.platform_mall_id:"\t","</td>\n        <td>").concat(a.mall_alias_name?a.mall_alias_name:a.platform_mall_name+"\t","</td>\n        <td>").concat(a.group_name?a.group_name:"\t","</td>\n        <td>").concat(a.recent_order_create_time?a.recent_order_create_time:"\t","</td>\n        <td>").concat(a.yesterday_order_num?a.yesterday_order_num:"\t","</td>\n        <td>").concat(a.week_order_num?a.week_order_num:"\t","</td>\n        <td>").concat(a.history_order_num?a.history_order_num:"\t","</td>\n        <td>").concat(a.mall_quota?a.mall_quota:"\t","</td>\n        <td>").concat(a.all_product_num?a.all_product_num:"\t","</td>\n        <td>").concat(a.active_product_num?a.active_product_num:"\t","</td>\n        <td>").concat(a.soldout_product_num?a.soldout_product_num:"\t","</td>\n        <td>").concat(a.banned_product_num?a.banned_product_num:"\t","</td>\n        <td>").concat(a.unlisted_product_num?a.unlisted_product_num:"\t","</td>\n        <td>").concat(a.chat_response_rate?a.chat_response_rate:"\t","</td>\n        <td>").concat(a.rating_star?a.rating_star:"\t","</td>\n        <td>").concat(a.order_non_fulfillment_rate?a.order_non_fulfillment_rate:"\t","</td>\n        <td>").concat(a.followers_number?a.followers_number:"\t","</td>\n        <td>").concat(a.fans_number?a.fans_number:"\t","</td>\n        <td>").concat(a.today_view_product_count?a.today_view_product_count:"\t","</td>\n        <td>").concat(a.yesterday_view_product_count?a.yesterday_view_product_count:"\t","</td>\n        <td>").concat(a.week_view_product_count?a.week_view_product_count:"\t","</td>\n        <td>").concat(a.month_view_product_count?a.month_view_product_count:"\t","</td>\n        <td>").concat(a.today_view_person_count?a.today_view_person_count:"\t","</td>\n        <td>").concat(a.yesterday_view_person_count?a.yesterday_view_person_count:"\t","</td>\n        <td>").concat(a.week_view_person_count?a.week_view_person_count:"\t","</td>\n        <td>").concat(a.month_view_person_count?a.month_view_person_count:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatShopUvData?a.mall_datas.ChatShopUvData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatsEnquiredData?a.mall_datas.ChatsEnquiredData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatVisitorsEnquiredData?a.mall_datas.ChatVisitorsEnquiredData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatRespondedChatsData?a.mall_datas.ChatRespondedChatsData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatNonRespondedChatsData?a.mall_datas.ChatNonRespondedChatsData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatBuyersData?a.mall_datas.ChatBuyersData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatOrdersData?a.mall_datas.ChatOrdersData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatUnitsData?a.mall_datas.ChatUnitsData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatSalesData?a.mall_datas.ChatSalesData:"\t","</td>\n        <td>").concat(a.mall_datas&&a.mall_datas.ChatResponseTimeData?a.mall_datas.ChatResponseTimeData:"\t","</td>\n        <td>").concat(a.frozen_amount_orders?a.frozen_amount_orders:"\t","</td>\n        <td>").concat(a.frozen_amount?a.frozen_amount:"\t","</td>\n        <td>").concat(a.lastweek_amount?a.lastweek_amount:"\t","</td>\n        <td>").concat(a.lastmonth_amount?a.lastmonth_amount:"\t","</td>\n        <td>").concat(a.available_amount?a.available_amount:"\t","</td>\n        </tr>")})),Object(l["k"])("店铺数据",m),t.isLoading=!1;case 47:case"end":return a.stop()}}),a,null,[[7,36]])})))()},getGroupId:function(t){this.form.groupId=t,this.page=1},handleSizeChange:function(t){this.pageSize=t,this.getMallStatistics()},handleCurrentChange:function(t){this.page=t,this.getMallStatistics()},handleSelectionChange:function(t){this.multipleSelection=t}}},h=_,f=(e("949c"),e("2877")),b=Object(f["a"])(h,n,r,!1,null,"84f112f8",null);a["default"]=b.exports},e64f:function(t,a,e){}}]);