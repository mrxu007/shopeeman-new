(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a6424714"],{"97a6":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"team-management"},[a("div",{staticClass:"operation"},[a("div",{staticClass:"o-item"},[a("span",[e._v("账号名称：")]),a("el-input",{staticStyle:{width:"120px"},attrs:{oninput:"value=value.replace(/\\s+/g,'')",placeholder:"请输入内容",clearable:"",size:"mini"},model:{value:e.accountNameVal,callback:function(t){e.accountNameVal=t},expression:"accountNameVal"}})],1),a("div",{staticClass:"o-item"},[a("el-select",{attrs:{placeholder:"请选择用户状态",size:"mini"},model:{value:e.isEnable,callback:function(t){e.isEnable=t},expression:"isEnable"}},e._l(e.is_enable,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"o-item"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.getChildUserList}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.isShowDialog=!0,e.showAddOrEdit=!0}}},[e._v("添加子账号 ")])],1)]),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isloading,expression:"isloading"}],attrs:{data:e.tableData,stripe:"",height:"calc(100vh - 105px)","header-cell-style":{textAlign:"center",backgroundColor:"#f5f7fa"}}},[a("el-table-column",{attrs:{type:"index",align:"center",label:"序号","min-width":"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{prop:"typeCn",align:"center",label:"类型","min-width":"180"}}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"账号","min-width":"120"}}),a("el-table-column",{attrs:{prop:"groupCn",align:"center",label:"关联店分组","min-width":"180"}}),a("el-table-column",{attrs:{prop:"is_enable",align:"center",label:"状态","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(1===n.is_enable?"启用":"停用"))])]}}])}),a("el-table-column",{attrs:{prop:"note",align:"center",label:"备注","min-width":"180"}}),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.deleteChildUser(n)}}},[e._v("删除")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.isShowDialog=!0,e.showAddOrEdit=!1,e.editSubAccountDia(n)}}},[e._v("修改")])]}}])})],1)],1),a("div",{staticClass:"dialog-content"},[a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"账号创建/修改",visible:e.isShowDialog},on:{"update:visible":function(t){e.isShowDialog=t},close:e.closeDialog}},[a("div",{staticClass:"dialog-left"},[a("div",{staticClass:"form-content"},[a("el-form",{attrs:{"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"用户类型:"}},[a("el-checkbox-group",{model:{value:e.typeListId,callback:function(t){e.typeListId=t},expression:"typeListId"}},e._l(e.typeList,(function(t,n){return a("el-checkbox",{key:n,attrs:{label:t.id+""}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"子账号:"}},[a("el-input",{attrs:{size:"mini",placeholder:"请输入子账号名",clearable:"",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("el-form-item",{attrs:{label:"密码:"}},[a("el-input",{attrs:{placeholder:"请输入密码(不得小于9位)",oninput:"value=value.replace(/\\s+/g,'')","show-password":"",size:"mini"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("el-form-item",{attrs:{label:"状态:"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.diaIsEnable,callback:function(t){e.diaIsEnable=t},expression:"diaIsEnable"}},[e._v("启用")]),a("el-radio",{attrs:{label:"2"},model:{value:e.diaIsEnable,callback:function(t){e.diaIsEnable=t},expression:"diaIsEnable"}},[e._v("停用")])],1),a("el-form-item",{attrs:{label:"备注:"}},[a("el-input",{attrs:{size:"mini",placeholder:"请输入备注",clearable:"",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}})],1)],1)],1),a("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[e.showAddOrEdit?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.startOperation("add")}}},[e._v("新增")]):e._e(),e.showAddOrEdit?e._e():a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.startOperation("updata")}}},[e._v("修改")])],1)]),a("div",{staticClass:"dialog-right"},[a("div",{staticClass:"operation-content"},[a("span",{staticStyle:{width:"60px"}},[e._v("店铺分组:")]),a("el-input",{attrs:{placeholder:"请输入店铺分组名称",clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.shopGroupVal,callback:function(t){e.shopGroupVal=t},expression:"shopGroupVal"}}),a("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"primary",size:"mini"},on:{click:e.getBindMallCount}},[e._v("查找")])],1),a("div",{staticClass:"dialog-table"},[a("el-table",{ref:"shopGruopDataRef",staticStyle:{"min-width":"240px"},attrs:{data:e.shopGruopData,stripe:"","max-height":"400","row-key":e.getRowKey},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center","min-width":"45","reserve-selection":!0}}),a("el-table-column",{attrs:{align:"center",label:"序号","min-width":"40"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{prop:"group_name",align:"center",label:"分组名称","min-width":"80"}}),a("el-table-column",{attrs:{prop:"bind_mall_count",align:"center",label:"绑定店铺数量","min-width":"90"}})],1)],1)])])],1)])},i=[],s=a("1da1"),l=(a("96cf"),a("498a"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),{data:function(){return{isShowDialog:!1,showAddOrEdit:!0,currentPage:1,shopGroupVal:"",accountNameVal:"",multipleSelection:[],typeListId:[],typeList:[],diaIsEnable:"1",name:"",password:"",note:"",total:0,isloading:!1,isEnable:"0",accountId:"",is_enable:[{value:"0",label:"全部"},{value:"1",label:"启用"},{value:"2",label:"停用"}],tableData:[],shopGruopData:[]}},mounted:function(){this.getChildUserList(),this.getBindMallCount(),this.userRoleList()},methods:{getBindMallCount:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={groupName:e.shopGroupVal.trim()},t.next=3,e.$api.getBindMallCount(a);case 3:n=t.sent,i=n.data,200===i.code?e.shopGruopData=i.data:e.$message.error("店铺分组数据错误".concat(i.message));case 6:case"end":return t.stop()}}),t)})))()},userRoleList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.userRoleList();case 2:a=t.sent,n=a.data,200===n.code?e.typeList=n.data:e.$message.error("角色类型获取错误".concat(n.message));case 5:case"end":return t.stop()}}),t)})))()},startOperation:function(e){if(0!==this.typeListId.length)if(this.name)if(0!==this.multipleSelection.length){for(var t=[],a=0;a<this.multipleSelection.length;a++){var n=this.multipleSelection[a];if(0===n.bind_mall_count)return void this.$message("有未绑定店铺的分组");t.push(n.id)}switch(e){case"add":if(!this.password)return void this.$message("请填写密码");if(this.password.trim().length<9)return void this.$message("密码最少必须为9位");this.addSubAccount(t);break;case"updata":if(""!==this.password&&this.password.trim().length<9)return void this.$message("密码最少必须为9位");this.editSubAccount(t);break}}else this.$message("至少选择一个店铺分组");else this.$message("请填写账号");else this.$message("请选择用户类别")},editSubAccountDia:function(e){var t=this;this.accountId=e.id,this.name=e.name,this.diaIsEnable=e.is_enable.toString(),this.note=e.note,e.type.forEach((function(e){t.typeListId.push(e)})),this.isShowDialog&&this.$nextTick((function(){t.shopGruopData.forEach((function(a){e.bind_mall_group_id.forEach((function(e){e===a.id&&t.$refs.shopGruopDataRef.toggleRowSelection(a)}))}))}))},deleteChildUser:function(e){var t=this;this.$confirm("此操作将永久删除该账号, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$api.deleteChildUser({id:e.id});case 2:n=a.sent,i=n.data,200===i.code?t.$message.success("删除成功"):t.$message.error("删除失败:".concat(i.message)),t.getChildUserList();case 6:case"end":return a.stop()}}),a)}))))},editSubAccount:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={id:t.accountId,type:t.typeListId.toString(),name:t.name,password:t.password,note:t.note,isEnable:t.diaIsEnable,groupIds:e.toString()},a.next=3,t.$api.editChildUsers(n);case 3:i=a.sent,s=i.data,200===s.code?t.$message.success("修改成功"):t.$message.error("修改失败:".concat(s.message)),t.isShowDialog=!1,t.getChildUserList();case 8:case"end":return a.stop()}}),a)})))()},addSubAccount:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!(t.tableData.length>=20)){a.next=3;break}return t.$message("子账号数量达到上限制"),a.abrupt("return");case 3:return n={type:t.typeListId.toString(),name:t.name,password:t.password,note:t.note,isEnable:t.diaIsEnable,groupIds:e.toString()},a.next=6,t.$api.saveChildUsers(n);case 6:i=a.sent,s=i.data,200===s.code?t.$message.success("添加成功"):t.$message.error("添加失败:".concat(s.message)),t.isShowDialog=!1,t.getChildUserList();case 11:case"end":return a.stop()}}),a)})))()},getChildUserList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isloading=!0,t.prev=1,t.next=4,e.$api.getChildUserList({name:e.accountNameVal,isEnable:e.isEnable});case 4:a=t.sent,n=a.data,200===n.code?(e.total=n.data.length,e.currentPage=1,e.tableData=n.data,e.isloading=!1):(e.$message.error("获取数据失败".concat(n.message)),e.isloading=!1),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),e.$message.error("获取数据失败"),e.isloading=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},handleSelectionChange:function(e){this.multipleSelection=e},closeDialog:function(){this.accountId="",this.typeListId=[],this.name="",this.password="",this.note="",this.diaIsEnable="1",this.$refs.shopGruopDataRef.clearSelection(),this.shopGroupVal=""},getRowKey:function(e){return e.id}}}),r=l,o=(a("f276"),a("2877")),c=Object(o["a"])(r,n,i,!1,null,null,null);t["default"]=c.exports},e3eaa:function(e,t,a){},f276:function(e,t,a){"use strict";a("e3eaa")}}]);