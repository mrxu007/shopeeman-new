(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1759d147"],{"1e64":function(t,e,a){"use strict";a("fcc2")},"204e":function(t,e,a){},"4c28":function(t,e,a){},"5a71":function(t,e,a){},"5c4f":function(t,e,a){"use strict";a("204e")},8992:function(t,e,a){"use strict";a("4c28")},e6ba:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"contaniner"},[a("el-row",{staticClass:"header-two"},[a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("storeChoose",{on:{changeMallList:t.changeMallList}}),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.synchronousShops}},[t._v("同步店铺金额")]),a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.tiedCardPrepare()}}},[t._v("批量绑卡")])],1),a("el-col",{staticClass:"header-two-top",attrs:{span:24}},[a("p",[t._v("当前可提现总金额："),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.canCarry))])]),a("p",[t._v("当前提现中总金额："),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.withdrawal))])]),a("p",{staticStyle:{"margin-right":"10px"}},[t._v(" 各店铺满 "),a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"",size:"mini"},model:{value:t.demand,callback:function(e){t.demand=e},expression:"demand"}}),t._v(" 才可以提现 ")],1),a("p",{staticStyle:{"margin-right":"5px"}},[t._v(" 预留金额： "),a("el-input",{staticStyle:{margin:"0 5px"},attrs:{placeholder:"",size:"mini"},model:{value:t.reserved,callback:function(e){t.reserved=e},expression:"reserved"}})],1),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.exportData}},[t._v("导出")])],1)],1),a("el-row",{staticClass:"article"},[a("u-table",{ref:"plTable",attrs:{height:"height","use-virtual":"",data:t.tableData,"data-changes-scroll-top":!1,height:t.height,"row-height":t.rowHeight,border:!1},on:{"selection-change":t.handleSelectionChange,"table-body-scroll":t.tableScroll}},[a("u-table-column",{attrs:{align:"center",type:"selection",width:"50"}}),a("u-table-column",{attrs:{align:"center",type:"index",label:"序列号",width:"60"}}),a("u-table-column",{attrs:{align:"center",label:"站点",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("chineseSite")(e.row.country)))]}}])}),a("u-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,width:"120px",label:"店铺名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.platform_mall_name))]}}])}),a("u-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,width:"120px",label:"店铺别名"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.mall_alias_name))]}}])}),a("u-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,width:"120px",label:"银行"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.bankAccounts&&e.row.bankAccounts.list&&e.row.bankAccounts.list[0]&&e.row.bankAccounts.list[0].bank_name)+" ")]}}])}),a("u-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,width:"120px",label:"持卡人"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.bankAccounts&&e.row.bankAccounts.list&&e.row.bankAccounts.list[0]&&e.row.bankAccounts.list[0].account_name)+" ")]}}])}),a("u-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,label:"银行卡号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.bankAccounts&&e.row.bankAccounts.list&&e.row.bankAccounts.list[0]&&e.row.bankAccounts.list[0].account_number)+" ")]}}])}),a("u-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,label:"ICNumber"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.bankAccounts&&e.row.bankAccounts.list&&e.row.bankAccounts.list[0]&&e.row.bankAccounts.list[0].mtime)+" ")]}}])}),a("u-table-column",{attrs:{align:"center",width:"120px",label:"可提现金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.balance))]}}])}),a("u-table-column",{attrs:{align:"center",width:"120px",label:"提现中金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.withdrawal_no))]}}])}),a("u-table-column",{attrs:{align:"center",label:"今日是否可提现"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.num_of_free_times?"是":"否"))]}}])}),a("u-table-column",{attrs:{align:"center","show-overflow-tooltip":!0,label:"操作状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.error||"同步成功"))]}}])})],1)],1),a("div",{staticClass:"deposit_dialog"},[a("el-dialog",{attrs:{title:t.active&&(t.active.mall_alias_name||t.active.platform_mall_name)+"提现密码",visible:t.depositVisible,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(e){t.depositVisible=e}}},[a("el-input",{attrs:{size:"mini"},model:{value:t.depositPassword,callback:function(e){t.depositPassword=e},expression:"depositPassword"}}),a("div",{staticClass:"deposit_footer"},[a("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.batchWithdrawal}},[t._v("确定")])],1)],1)],1),a("div",{staticClass:"tiedCard_dialog"},[a("el-dialog",{attrs:{title:"绑定银行卡",visible:t.tiedCardVisible,"close-on-click-modal":!1,width:"350px"},on:{"update:visible":function(e){t.tiedCardVisible=e}}},[t.active?a("div",{staticClass:"tiedCardBox"},[a("div",{staticClass:"tiedCardItem"},[a("span",{staticClass:"tiedCardLabel"},[t._v("当前店铺名：")]),t._v(" "+t._s(t.active&&(t.active.mall_alias_name||t.active.platform_mall_name))+" ")]),a("div",{staticClass:"tiedCardItem"},[a("span",{staticClass:"tiedCardLabel"},[t._v("当前手机号：")]),t._v(" "+t._s(t.active&&t.active.phone)+" ")]),a("div",{staticClass:"tiedCardItem"},[a("span",{staticClass:"tiedCardLabel"},[t._v("银行账号：")]),t._v(" "+t._s(t.bankCard&&t.bankCard.bank_name)+" ")]),a("div",{staticClass:"tiedCardItem"},[a("span",{staticClass:"tiedCardLabel"},[t._v("持卡人姓名：")]),t._v(" "+t._s(t.bankCard&&t.bankCard.full_name)+" ")]),a("div",{staticClass:"tiedCardItem"},[a("span",{staticClass:"tiedCardLabel"},[t._v("IC卡号：")]),t._v(" "+t._s(t.bankCard&&t.bankCard.ic_number)+" ")]),a("div",{staticClass:"tiedCardItem"},[a("span",{staticClass:"tiedCardLabel"},[t._v("银行名称：")]),t._v(" "+t._s(t.bankCard&&t.bankCard.account_number)+" ")]),a("div",{staticClass:"tiedCardItem"},[a("el-input",{attrs:{size:"mini"},model:{value:t.cardCode,callback:function(e){t.cardCode=e},expression:"cardCode"}},[a("el-button",{attrs:{slot:"append"},on:{click:t.getWalletOtpSeed},slot:"append"},[t._v(" 发送验证码")])],1)],1),a("div",{staticClass:"tiedCardItem",staticStyle:{display:"flex","justify-content":"flex-end"}},[a("el-button",{attrs:{size:"mini"},on:{click:t.cancel}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.tiedCard}},[t._v("确定")])],1)]):t._e()])],1)],1)},n=[],s=a("1da1"),l=(a("96cf"),a("159b"),a("ac1f"),a("1276"),a("c740"),a("a434"),a("4de4"),a("99af"),a("feb6")),r=a("6c27"),o=a("8237"),c=a.n(o),u=a("0e0b"),d=a("7646"),h={components:{storeChoose:l["a"]},data:function(){return{mallListAPIInstance:new d["a"](this),isShowLog:!0,depositVisible:!1,tiedCardVisible:!1,active:null,depositPassword:"",canCarry:0,withdrawal:0,demand:50,reserved:30,height:300,rowHeight:50,SiteList:[],tableData:[],selectData:[],cardCode:"",selectIndex:-1,bankList:[],bankCard:null,seed:""}},watch:{selectData:function(t,e){this.selectIndex=-1}},created:function(){var t=this;this.resizeHeight(),window.addEventListener("resize",(function(e){t.resizeHeight()}))},mounted:function(){this.getBankList()},methods:{synchronousShops:function(){var t=this;this.tableData=[],this.SiteList.forEach(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(a){var i,n,s,l,o,d,h,p,f,m,_,b,g,v,w,k,y,S,C,x,I,L,A,O;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=(new Date).getTime(),n=Object(u["h"])(i,"yyyy-MM-dd"),e.next=4,t.$appConfig.getGlobalCacheInfo("mallInfo",a.platform_mall_id);case 4:return s=e.sent,l=JSON.parse(s),o=l&&l.mall_account_info&&l.mall_account_info.password||"",d=o&&Object(r["sha256"])(c()(o))||"",h=Object(u["h"])(i-2592e6,"yyyy-MM-dd"),p={shop_id:parseInt(a.platform_mall_id),password_hash:d},f={shop_id:parseInt(a.platform_mall_id),transaction_types:"201,203",start_date:n,end_date:h,wallet_type:0,page_number:1,page_size:20},m={shop_id:parseInt(a.platform_mall_id),wallet_type:0},_=JSON.parse(JSON.stringify(a)),b="",e.next=16,t.$shopeemanService.getBankAccounts(a.country,p,{params:{page_size:30,page_number:1},headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 16:return g=e.sent,e.next=19,t.$shopeemanService.getWalletTransactions(a.country,f);case 19:return v=e.sent,e.next=22,t.$shopeemanService.getWalletStatus(a.country,m);case 22:w=e.sent;try{k=JSON.parse(g),y=JSON.parse(v),S=JSON.parse(w),C=JSON.parse(k.data),x=JSON.parse(y.data),I=JSON.parse(S.data),0===C.code?_=Object.assign(_,{bankAccounts:C.data}):b+=(b?",":"")+"无法同步银行卡信息",0===x.code?_=Object.assign(_,{walletTransactionsDate:x.data}):b+=(b?",":"")+"无法同步详细信息",0===I.code?_=Object.assign(_,I.data):b+=(b?",":"")+"无法同步银行卡金额",b=3===b.split(",").length?"同步失败":b}catch(z){b="同步失败"}finally{_=Object.assign(_,{error:b}),L=t.tableData.findIndex((function(t){return t.platform_mall_id===_.platform_mall_id})),L>-1?t.tableData.splice(L,1,_):t.tableData.push(_),A=0,O=0,t.tableData.forEach((function(t){var e=t.withdrawal_no||0,a=t.balance||0;A+=a,O+=e})),t.canCarry=A,t.withdrawal=O}case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},batchWithdrawal:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Object(r["sha256"])(c()(t.depositPassword)),i={payment_password:a,mallId:t.active.platform_mall_id},e.next=4,t.$shopeemanService.verifyPaymentPass(t.active.country,i);case 4:n=e.sent,JSON.parse(n),t.depositVisible=!1,t.selectIndex++,t.allBatchWithdrawal(!0);case 9:case"end":return e.stop()}}),e)})))()},allBatchWithdrawal:function(t){this.selectData.length||t?this.selectIndex<0?(this.selectIndex=0,this.active=this.selectData[this.selectIndex],this.depositVisible=!0):(this.active=this.selectData[this.selectIndex]||null,this.active?this.depositVisible=!0:this.selectIndex=-1):this.$message.error("至少选择一条店铺信息")},cancel:function(){this.selectIndex>=0?(this.selectIndex++,this.depositVisible?(this.depositVisible=!1,this.allBatchWithdrawal(!0)):(this.tiedCardVisible=!1,this.tiedCardPrepare(!0))):(this.depositVisible=!1,this.tiedCardVisible=!1)},getBankList:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.mallListAPIInstance.getBankList();case 2:a=e.sent,t.bankList=a.data||[];case 4:case"end":return e.stop()}}),e)})))()},tiedCardPrepare:function(t){var e=this;this.selectData.length||t?(this.selectData.forEach(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.account_number=!0,t.next=3,e.$appConfig.getGlobalCacheInfo("mallInfo",a.platform_mall_id);case 3:i=t.sent,n=JSON.parse(i),e.$set(a,"phone",n.mall_account_info&&n.mall_account_info.phone||"");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.allTiedCard()):this.$message.error("至少选择一条银行卡信息")},allTiedCard:function(){var t=this;if(this.cardCode="",this.seed="",this.selectData.length||type)if(this.selectIndex<0){this.selectIndex=0,this.active=this.selectData[this.selectIndex];var e=this.bankList.filter((function(e){return e.site===t.active.country})),a=e&&e[0]&&e[0].bank_list||[],i=Math.floor(Math.random()*a.length);this.bankCard=a[i]||null,this.tiedCardVisible=!0}else if(this.active=this.selectData[this.selectIndex]||null,this.active){var n=this.bankList.filter((function(e){return e.site.toLocaleUpperCase()===t.active.country})),s=n&&n[0]&&n[0].bank_list||[],l=Math.floor(Math.random()*s.length);this.bankCard=s[l]||null,this.tiedCardVisible=!0}else this.selectIndex=-1;else this.$message.error("至少选择一条店铺信息")},getWalletOtpSeed:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$shopeemanService.getWalletOtpSeed(t.active.country,{mallId:t.active.platform_mall_id});case 2:a=e.sent,i=JSON.parse(a),i.status>=200&&i.status<300?(n=JSON.parse(i.data).data,t.seed=n.seed,t.$message.success("发送成功")):t.$message.error("发送失败");case 5:case"end":return e.stop()}}),e)})))()},tiedCard:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,i,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.seed&&t.cardCode){e.next=4;break}return a=t.seed?"请输入验证码":"请发送验证码，并输入",t.$message.error(a),e.abrupt("return");case 4:return i={mallId:t.active.platform_mall_id,account_name:t.bankCard.full_name,account_number:t.bankCard.account_number,bank_account_id:null,bank_code:"",bank_name:t.bankCard.bank_name,bank_name_id:t.bankCard.bank_name_id,ic_number:t.bankCard.ic_number,branch_name:"",region:"",status:4},n={params:{seed:t.seed,code:t.cardCode,otp_seed:"bank-account"}},e.next=8,t.$shopeemanService.bindBankAccount(t.active.country,i,n);case 8:s=e.sent,JSON.parse(s),t.tiedCardVisible=!1,t.selectIndex++,t.allTiedCard(!0);case 13:case"end":return e.stop()}}),e)})))()},handleSelectionChange:function(t){this.selectData=t},exportData:function(){if(!this.tableData.length)return this.$message.warning("没有可导出的数据");for(var t=1,e="<tr>\n              <td>编号</td>\n              <td>站点</td>\n              <td>店铺名称</td>\n              <td>银行</td>\n              <td>持卡人</td>\n              <td>银行卡号</td>\n              <td>ICNumber</td>\n              <td>可提现金额</td>\n              <td>提现中金额</td>\n            </tr>",a=0;a<this.tableData.length;a++){var i=this.tableData[a];i.display_path&&i.display_path.split(">")[0]&&"".concat(i.display_path.split(">")[0],"(").concat(i.display_path_cn.split(">")[0],")"),i.display_path&&i.display_path.split(">")[1]&&"".concat(i.display_path.split(">")[1],"(").concat(i.display_path_cn.split(">")[1],")");e+="<tr><td>".concat(t++,"</td>\n                    <td>").concat(this.$filters.chineseSite(i.country)+"\t","</td>\n                    <td>").concat(i.platform_mall_name+"\t","</td>\n                    <td>").concat((i.bankAccounts&&i.bankAccounts.list&&i.bankAccounts.list[0]&&i.bankAccounts.list[0].bank_name||"")+"\t","</td>\n                    <td>").concat((i.bankAccounts&&i.bankAccounts.list&&i.bankAccounts.list[0]&&i.bankAccounts.list[0].account_name||"")+"\t","</td>\n                    <td>").concat((i.bankAccounts&&i.bankAccounts.list&&i.bankAccounts.list[0]&&i.bankAccounts.list[0].account_number||"")+"\t","</td>\n                    <td>").concat((i.bankAccounts&&i.bankAccounts.list&&i.bankAccounts.list[0]&&i.bankAccounts.list[0].mtime||"")+"\t","</td>\n                    <td>").concat((i.balance||"")+"\t","</td>\n                    <td>").concat((i.withdrawal_no||"")+"\t","</td>\n                </tr>")}Object(u["k"])("热搜词推荐",e)},changeMallList:function(t){this.SiteList=Object.assign(t)},resizeHeight:function(){var t=window.outerHeight;this.height=t-150},tableScroll:function(){}}},p=h,f=(a("5c4f"),a("1e64"),a("2877")),m=Object(f["a"])(p,i,n,!1,null,"2a800234",null);e["default"]=m.exports},f4e2:function(t,e,a){"use strict";a("5a71")},fcc2:function(t,e,a){},feb6:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ul",{staticClass:"storeChooseUL"},[t.isMall?a("li",[t._v(t._s(t._f("chineseSite")(t.countryVal)))]):a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("所属站点：")]),a("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:"",disabled:t.isBanPerform},model:{value:t.countryVal,callback:function(e){t.countryVal=e},expression:"countryVal"}},[t.isAll?a("el-option",{attrs:{label:"全部",value:""}}):t._e(),t._l(t.countries,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],2)],1),a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺分组：")]),a("el-select",{staticClass:"selectBox",style:{width:t.inputWidth},attrs:{disabled:t.isBanPerform,multiple:"","collapse-tags":"",filterable:"",size:"mini"},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},[a("el-option",{attrs:{label:"全部",value:""},nativeOn:{click:function(e){return t.changeGroupSelect(t.groupId,!0)}}}),t._l(t.groupIdList,(function(e,i){return a("el-option",{key:i,attrs:{label:e.group_name,value:e.id},nativeOn:{click:function(e){return t.changeGroupSelect(t.groupId)}}})}))],2)],1),a("li",{directives:[{name:"show",rawName:"v-show",value:t.showGrade<2,expression:"showGrade < 2"}],style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺名称：")]),a("el-popover",{attrs:{placement:"top",width:"180",trigger:"click"}},[t.tableShow?a("u-table",{ref:"zz_mall_select_all",staticClass:"zz_mall_select_all",attrs:{"tooltip-effect":"dark","show-header":!1,"row-height":34,border:!1,"big-data-checkbox":"","use-virtual":"","show-body-overflow":"","data-changes-scroll-top":!1,data:t.siteShowList,"max-height":"250","cell-style":{padding:"0px!important"}}},[a("u-table-column",{attrs:{align:"left","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"zz_mall_select_item",class:t.siteId.includes(e.row.platform_mall_id)&&"zz_mall_select_active",on:{click:function(a){return t.changeSiteSelect(e.row.platform_mall_id,!e.row.platform_mall_id)}}},[t._v(" "+t._s(e.row.mall_alias_name||e.row.platform_mall_name)+" ")])]}}],null,!1,749083916)})],1):t._e(),a("div",{staticClass:"zz_mall_select_input",style:{width:t.inputWidth},attrs:{slot:"reference"},on:{click:t.goTableShowTop},slot:"reference"},[t.site.length?a("el-tag",{attrs:{type:"info",size:"mini"}},[t._v(" "+t._s(t.site[0].mall_alias_name||t.site[0].platform_mall_name)+" ")]):t._e(),t.site.length>1?a("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("+"+t._s(t.site.length-1))]):t._e(),a("el-input",{attrs:{size:"mini",clearable:""},on:{input:t.searchInput},model:{value:t.searchSite,callback:function(e){t.searchSite=e},expression:"searchSite"}})],1)],1)],1),t.isReset?a("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[a("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary",disabled:t.isBanPerform},on:{click:t.reset}},[t._v(" 　刷　　新　 ")])],1):t._e()])])},n=[],s=a("1da1"),l=a("2909"),r=(a("96cf"),a("a9e3"),a("caad"),a("2532"),a("99af"),a("d81d"),a("fb6a"),a("4de4"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("c740"),a("a434"),a("25f0"),a("7db0"),a("7646")),o={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},inputWidth:{type:String,default:"180px"},parentCountry:{type:String,default:"TH"},isMall:{type:Boolean,default:function(){return!1}},isBanPerform:{type:Boolean,default:function(){return!1}},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}},isAShop:{type:Boolean,default:function(){return!1}},showGrade:{type:Number,default:function(){return 0}}},data:function(){return{countryVal:null,groupId:[],groupIdList:[],allSiteList:[],site:[],siteId:[],siteList:[],siteShowList:[],tableShow:!0,searchSite:"",countries:this.$filters.countries_option,mallListAPIInstance:new r["a"](this),showMallNumber:100,mallShowIndex:0}},watch:{siteList:function(t){this.siteShowList=t},countryVal:{handler:function(t){this.groupId=[],this.groupIdList=[],this.getMallGoodsGetMallList(1)},deep:!0}},mounted:function(){this.countryVal=!this.isAll&&this.parentCountry||""},methods:{reset:function(){this.groupId=[],this.groupIdList=[],this.getMallGoodsGetMallList(1)},changeGroupSelect:function(t,e){e?t.includes("")?this.groupId=[""].concat(Object(l["a"])(this.groupIdList.map((function(t){return t.id})))):this.groupId=[]:t.includes("")||t.length!==this.groupIdList.length?t.includes("")&&t.length===this.groupIdList.length&&(this.groupId=t.slice(1)):this.groupId.unshift(""),this.getMallGoodsGetMallList(2)},getMallGoodsGetMallList:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n,s,r,o,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.searchSite="",1!==t){a.next=10;break}return i=e.countryVal,a.next=5,e.mallListAPIInstance.ddMallGoodsGetMallList();case 5:n=a.sent,200===n.code?(s=n.data||[],e.isAShop||s.unshift({platform_mall_name:"全部",platform_mall_id:""}),e.allSiteList=""===i?s:s.filter((function(t){return(null===t||void 0===t?void 0:t.country)===i||!t.platform_mall_id})),e.siteList=e.allSiteList):e.$message.error("获取分组、店铺列表失败"),0===e.groupIdList.length&&(r=new Set(e.siteList.map((function(t){if(t.group_id)return JSON.stringify({group_name:t.group_name,id:t.group_id})}))),r.delete(void 0),o=Object(l["a"])(r),c=o.map((function(t){return JSON.parse(t)})),c.zzSort("id"),e.groupIdList=Object(l["a"])(c),e.groupId=[""].concat(Object(l["a"])(c.map((function(t){return t.id}))))),a.next=13;break;case 10:u=[],u=""===e.groupId[0]?e.allSiteList:e.allSiteList.filter((function(t){if(e.groupId.includes(t.group_id)||!t.platform_mall_id)return t})),e.siteList=u;case 13:e.siteId=[],e.changeSiteSelect("",!0);case 15:case"end":return a.stop()}}),a)})))()},changeSiteSelect:function(t,e){var a=this.searchSite,i=this.siteId;if(this.isAShop)this.siteId=[t];else{if(e)if(a){var n=this.siteShowList.map((function(t){return t.platform_mall_id}));if(i.includes(t))i=i.filter((function(t){return!n.includes(t)}));else{var s=new Set([""].concat(Object(l["a"])(i),Object(l["a"])(n)));i=Object(l["a"])(s)}}else i=i.includes(t)?[]:this.siteList.map((function(t){return t.platform_mall_id}));else{var r=i.findIndex((function(e){return e===t}));if(r>-1)i.splice(r,1),i.includes("")&&i.splice(0,1);else if(i.push(t),a){var o,c=this.siteShowList.filter((function(t){return i.includes(t.platform_mall_id)}));i.includes("")||(null===(o=this.siteShowList)||void 0===o?void 0:o.length)!==c.length+1||i.unshift("")}else{var u;i.includes("")||(null===(u=this.siteList)||void 0===u?void 0:u.length)!==i.length+1||i.unshift("")}}this.siteId=i}this.changeMallList()},changeMallList:function(){var t=[],e="",a=this.siteId;if(this.isAShop){a=a[0];var i=this.siteList.find((function(t){return t.platform_mall_id===a}));e=a,t.push(i)}else this.site=this.siteList.filter((function(t){return a.includes(t.platform_mall_id)})),a.length&&""===a[0]?(a=a.slice(1),t=this.site.slice(1)):t=this.site,e=this.groupId.includes("")&&a.length===this.siteList.length-1?"":a.toString();this.source?this.$emit("changeMallList",{mallList:t,groupIdList:this.groupId,source:this.source,searchAll:e,country:this.countryVal.toLocaleUpperCase()}):(t["country"]=this.countryVal,this.$emit("changeMallList",t))},searchInput:function(){var t=this;this.searchSetTime&&clearTimeout(this.searchSetTime),this.searchSetTime=null,this.searchSetTime=setTimeout((function(){var e=t.siteList.filter((function(e){var a=!0;if(t.searchSite&&e.platform_mall_id){var i=e.mall_alias_name||e.platform_mall_name;a=i.includes(t.searchSite)}return a}));t.siteShowList=e,t.tableShow=!1,t.$nextTick((function(){t.tableShow=!0}))}),500)},goTableShowTop:function(){var t=this;this.tableShow=!1,this.$nextTick((function(){t.tableShow=!0}))}}},c=o,u=(a("8992"),a("f4e2"),a("2877")),d=Object(u["a"])(c,i,n,!1,null,"7cb8233b",null);e["a"]=d.exports}}]);