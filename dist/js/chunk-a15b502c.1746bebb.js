(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a15b502c"],{"008a":function(e,t,r){},"0515":function(e,t,r){},"05e9":function(e,t,r){"use strict";r("0515")},"0659":function(e,t,r){},"11ed":function(e,t,r){"use strict";r("43fa")},2551:function(e,t,r){"use strict";r("dcd9")},"297f":function(e,t,r){"use strict";r("fdfd")},"31af":function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var a=r("b85c"),n=r("1da1"),o=r("d4ec"),i=r("bee2"),s=r("ade3"),c=(r("96cf"),r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0"),r("b0c0"),r("99af"),r("7db0"),r("4de4"),r("ac1f"),r("466d"),r("4d63"),r("25f0"),r("bda5")),l=r("6ac8"),u=r("bb97"),d=r("a91f"),p=function(){function e(t){Object(o["a"])(this,e),Object(s["a"])(this,"$appConfig",new d["a"]),Object(s["a"])(this,"$baseUtilService",new l["a"]),Object(s["a"])(this,"$LogisticBridgeService",new u["a"]),Object(s["a"])(this,"$api",c["a"]),Object(s["a"])(this,"userInfo",this.$appConfig.getUserInfo()),Object(s["a"])(this,"logCallback",void 0),Object(s["a"])(this,"buyerAccountContainer",null),Object(s["a"])(this,"ordersContainer",null),Object(s["a"])(this,"allSetting",void 0),Object(s["a"])(this,"_that",null),Object(s["a"])(this,"writeLog",void 0),this.writeLog=t}return Object(i["a"])(e,[{key:"start",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r,n){var o,i,s,c,l,u,d,p,h,m,f=this,g=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=g.length>3&&void 0!==g[3]?g[3]:[],this.writeLog=n,this._that=t,e.next=5,this.getGlobalSetting();case 5:if(i=[],!o.length){e.next=10;break}i=o,e.next=13;break;case 10:return e.next=12,this.getOrdersFromServer();case 12:i=e.sent;case 13:if(i=this.filterOrder(i),i.length){e.next=17;break}return this.writeLog("目前没有需要获取物流单号的订单",!1),e.abrupt("return");case 17:this.writeLog("获取到【".concat(i.length,"】条需要同步物流的订单"),!0),s=new Map,c=function(e){var t=i[e],a=t.shot_order_info.buy_account_info?t.shot_order_info.buy_account_info.name:"",n=t.shot_order_info.buy_account_info?t.shot_order_info.buy_account_info.type:"",o=t.shot_order_sn||t.order_sn;if(!a)return f.writeLog("【".concat(e+1,"/").concat(i.length,"】订单【").concat(o,"】对应的买手号为空，请检查！"),!1),"continue";if(10001==n||1e4==n)return f.writeLog("【".concat(e+1,"/").concat(i.length,"】订单【").concat(o,"】对应的买手号【").concat(a,"】无需同步采购物流！"),!0),"continue";var c=r.find((function(e){return e.name===a&&n===e.type}));if(!c)return f.writeLog("【".concat(e+1,"/").concat(i.length,"】订单【").concat(o,"】对应的买手号【").concat(a,"】没有找到，请登录对应买手号."),!1),"continue";if(s.has(c)){var l=s.get(c);l.push(t)}else s.set(c,[t])},l=0;case 21:if(!(l<i.length)){e.next=28;break}if(u=c(l),"continue"!==u){e.next=25;break}return e.abrupt("continue",25);case 25:l++,e.next=21;break;case 28:if(0===s.size){e.next=49;break}d=Object(a["a"])(s.keys()),e.prev=30,d.s();case 32:if((p=d.n()).done){e.next=41;break}return h=p.value,m=s.get(h),this.buyerAccountContainer=h,this.ordersContainer=m,e.next=39,this.syncLogistic();case 39:e.next=32;break;case 41:e.next=46;break;case 43:e.prev=43,e.t0=e["catch"](30),d.e(e.t0);case 46:return e.prev=46,d.f(),e.finish(46);case 49:case"end":return e.stop()}}),e,this,[[30,43,46,49]])})));function t(t,r,a){return e.apply(this,arguments)}return t}()},{key:"getOrdersFromServer",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.getOrdersFromServerCycle();case 3:return r=e.sent,200===r.code?t=r.data.orderList:this.writeLog("获取需要同步物流的订单失败原因:".concat(r.code,": ").concat(r.data),!1),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getOrdersFromServerCycle",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$api.getOriginalTrackingNumberEmpty();case 3:if(t=e.sent,200!==t.data.code){e.next=7;break}return r={total:t.data.data.length,orderList:t.data.data},e.abrupt("return",{code:200,data:r});case 7:return e.abrupt("return",{code:t.data.code,data:t.data.message});case 10:if(e.prev=10,e.t0=e["catch"](0),!e.t0.response){e.next=14;break}return e.abrupt("return",{code:e.t0.response.status,data:e.t0.response.data.message});case 14:return e.abrupt("return",{code:-2,data:"getOrdersFromServerCycle-catch:".concat(e.t0)});case 15:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"filterOrder",value:function(e){return e.filter((function(e){return!e.logistics||!e.logistics.tracking_number&&e.shot_order_info&&e.shot_order_info.shot_order_sn&&e.buy_account_info}))}},{key:"syncLogistic",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.buyerAccountContainer||!this.ordersContainer){e.next=23;break}e.t0=this.buyerAccountContainer.type,e.next=1===e.t0?4:2===e.t0?7:8===e.t0?10:9===e.t0?13:10===e.t0?16:11===e.t0?19:22;break;case 4:return e.next=6,this.syncLogisticAggregation("拼多多");case 6:return e.abrupt("break",23);case 7:return e.next=9,this.syncLogisticAggregation("淘宝");case 9:return e.abrupt("break",23);case 10:return e.next=12,this.syncLogisticAggregation("1688");case 12:return e.abrupt("break",23);case 13:return e.next=15,this.syncLogisticAggregation("lazada");case 15:return e.abrupt("break",23);case 16:return e.next=18,this.syncLogisticAggregation("京喜");case 18:return e.abrupt("break",23);case 19:return e.next=21,this.syncLogisticAggregation("shopee");case 21:return e.abrupt("break",23);case 22:return e.abrupt("break",23);case 23:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeType",value:function(e){switch(e){case 1:return 1;case 2:return 0;case 8:return 5;case 10:return 3;case 9:return 7;case 11:return 8;default:return e}}},{key:"changeAccountParams",value:function(e){var t={UserNameCache:e.cache_path,Password:"",shotOrderPlatform:this.changeType(e.type),LoginedCookies:e.login_info,UserName:e.name,Cookiestr:JSON.stringify(e.login_info),AccountType:e.type,Ua:e.ua,Country:e.site||""};return t}},{key:"syncLogisticAggregation",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,o,i,s,c,l,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=this.ordersContainer,a=r.length,n=this.changeAccountParams(this.buyerAccountContainer),o=0;case 4:if(!(o<a)){e.next=42;break}if(i=r[o],s=i.shot_order_info.shot_order_sn||"",s){e.next=10;break}return this.writeLog("(".concat(t,")订单【").concat(i.order_sn,"】获取上家物流失败,订单无采购单号"),!1),e.abrupt("continue",39);case 10:return e.prev=10,e.next=13,this.$baseUtilService.getOriginLogistics(n.shotOrderPlatform,s,n);case 13:if(c=e.sent,200===c.Code){e.next=17;break}return this.writeLog("(".concat(t,")订单【").concat(i.order_sn,"】获取上家物流失败, ").concat(c.Msg,"(买手号: ").concat(n.UserName,")"),!1),e.abrupt("continue",39);case 17:if(c.TrackingNumber){e.next=20;break}return this.writeLog("(".concat(t,")订单【").concat(i.order_sn,"】未发货，(买手号: ").concat(n.UserName,")"),!1,"#ff9900"),e.abrupt("continue",39);case 20:return l=this.changetbOrderName(c.TrackingName),u={sysOrderId:i.id,trackingNumber:c.TrackingNumber,trackingNumberCompany:c.TrackingName},e.next=24,this.saveOrderLogistics(u);case 24:if(d=e.sent,200===d.code){e.next=28;break}return this.writeLog("(".concat(t,")订单【").concat(i.order_sn,"】上报物流失败原因: ").concat(d.code,": ").concat(d.data),!1),e.abrupt("continue",39);case 28:this.writeLog("(".concat(t,")订单【").concat(i.order_sn,"】同步物流成功"),!0),i.logistics||(i.logistics={}),i.logistics.tracking_number=c.TrackingNumber,i.logistics.logistics_company=c.TrackingName,i.logistics.logistics_company_code=l,e.next=39;break;case 35:return e.prev=35,e.t0=e["catch"](10),this.writeLog("订单【".concat(i.order_sn,"获取上家物流失败原因(").concat(t,"): ").concat(JSON.stringify(e.t0)),!1),e.abrupt("continue",39);case 39:o++,e.next=4;break;case 42:this.ordersContainer=null,this.buyerAccountContainer=null;case 44:case"end":return e.stop()}}),e,this,[[10,35]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getGlobalSetting",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$appConfig.getUserConfig();case 3:t=e.sent,r=JSON.parse(t),this.allSetting=r,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.allSetting=null;case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveOrderLogistics",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$api.uploadTrackingNumber(t);case 3:if(r=e.sent,200!==r.data.code){e.next=6;break}return e.abrupt("return",{code:200,data:"物流信息上报成功"});case 6:return e.abrupt("return",{code:r.data.code,data:r.data.message});case 9:if(e.prev=9,e.t0=e["catch"](0),!e.t0.response){e.next=13;break}return e.abrupt("return",{code:e.t0.response.status,data:e.t0.response.data.message});case 13:return e.abrupt("return",{code:-2,data:"sync-service-saveOrderLogistics-catch:".concat(JSON.stringify(e.t0))});case 14:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delay",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var r=setTimeout((function(){clearTimeout(r),e(!0)}),t)})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changetbOrderName",value:function(e){var t=JSON.parse(JSON.stringify(e));switch(t){case(t.match(RegExp(/圆通速递/))||{}).input:t="YTO";break;case(t.match(RegExp(/圆通快递/))||{}).input:t="YTO";break;case(t.match(RegExp(/韵达快递/))||{}).input:t="YUNDA";break;case(t.match(RegExp(/天天快递/))||{}).input:t="TTKDEX";break;case(t.match(RegExp(/顺丰速运/))||{}).input:t="SF";break;case(t.match(RegExp(/顺丰快递/))||{}).input:t="SF";break;case(t.match(RegExp(/百世快递/))||{}).input:t="HTKY";break;case(t.match(RegExp(/申通快递/))||{}).input:t="STO";break;case(t.match(RegExp(/中通快递/))||{}).input:t="ZTO";break;case(t.match(RegExp(/优速快递/))||{}).input:t="UC";break;case(t.match(RegExp(/EMS/))||{}).input:t="EMS";break;case(t.match(RegExp(/国通快递/))||{}).input:t="GTO";break;case(t.match(RegExp(/其它/))||{}).input:t="OTHER";break;case(t.match(RegExp(/极兔速递/))||{}).input:t="OTHER";break;case(t.match(RegExp(/邮政快递包裹/))||{}).input:t="POSTB";break;case(t.match(RegExp(/EMS经济快递/))||{}).input:t="EYB";break;default:t="";break}return t}}]),e}()},"3c61":function(e,t,r){"use strict";r("a410")},"3f06":function(e,t,r){},"434e":function(e,t,r){"use strict";r("b5f5")},"43f3":function(e,t,r){"use strict";r("a03f")},"43fa":function(e,t,r){},"47af":function(e,t,r){"use strict";r("882a")},"4c28":function(e,t,r){},5800:function(e,t,r){"use strict";r("63a7")},5855:function(e,t,r){"use strict";r("6cce")},"5a6a":function(e,t,r){"use strict";r("f569")},"5c5f":function(e,t,r){},"63a7":function(e,t,r){},"6cce":function(e,t,r){},"7aac8":function(e,t,r){"use strict";r("5c5f")},"882a":function(e,t,r){},8992:function(e,t,r){"use strict";r("4c28")},"8bfc":function(e,t,r){"use strict";r("9097")},9097:function(e,t,r){},9575:function(e,t,r){"use strict";r("f280")},"980f":function(e,t,r){"use strict";r("0659")},a03f:function(e,t,r){},a410:function(e,t,r){},b5f5:function(e,t,r){},bb97:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r("d4ec"),n=r("bee2"),o=function(){function e(){Object(a["a"])(this,e),this.nativeService=window["LogisticBridgeService"]}return Object(n["a"])(e,[{key:"getLogisticByOrderIdAsync",value:function(e,t){return this.nativeService.getLogisticByOrderIdAsync(e,t)}}]),e}()},bee1:function(e,t,r){"use strict";r("3f06")},c1b2:function(e,t,r){"use strict";r("008a")},c4f0:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-center"},[r("header",[r("transition",{attrs:{name:"slide-fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"selectBox"},[r("div",{staticClass:"left-box mar-right"},[r("div",{staticClass:"base-box"},[r("span",{staticClass:"base-title"},[e._v("基础操作")]),r("div",{staticClass:"base-item"},[r("buyer-account",{attrs:{operation:e.operation,"buyer-account-list":e.buyerAccountList}})],1)])]),r("div",{staticClass:"right-box"},[r("div",{staticClass:"base-box"},[r("span",{staticClass:"base-title"},[e._v("列表筛选操作")]),r("div",{staticClass:"base-item"},[r("el-row",{staticClass:"row-style"},[r("div",{staticClass:"tool-item mar-right"},[r("storeChoose",{attrs:{"is-all":!0,"span-width":"80px","select-width":"180px",source:"orderCenter"},on:{changeMallList:e.changeMallList}})],1),r("div",{staticClass:"tool-item"},[r("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.selectForm.timeType,callback:function(t){e.$set(e.selectForm,"timeType",t)},expression:"selectForm.timeType"}},e._l(e.timeTypeList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),r("el-date-picker",{staticStyle:{width:"300px"},attrs:{size:"mini","unlink-panels":"","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(t){return e.changeTime(t,"selectForm","otherTime")}},model:{value:e.selectForm.otherTime,callback:function(t){e.$set(e.selectForm,"otherTime",t)},expression:"selectForm.otherTime"}})],1)]),r("el-row",{staticClass:"row-style"},[r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("发货状态：")]),r("el-select",{staticClass:"inputBox",attrs:{placeholder:"",size:"mini",multiple:"","collapse-tags":"",filterable:""},on:{change:function(t){return e.changeSelect(t,"orderStatus",e.orderStatusList)}},model:{value:e.orderStatus,callback:function(t){e.orderStatus=t},expression:"orderStatus"}},[r("el-option",{attrs:{label:"全部",value:""},nativeOn:{click:function(t){return e.selectAll("orderStatus",e.orderStatusList)}}}),e._l(e.orderStatusList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("采购状态：")]),r("el-select",{staticClass:"inputBox",attrs:{placeholder:"",size:"mini",multiple:"","collapse-tags":"",filterable:""},on:{change:function(t){return e.changeSelect(t,"shotStatus",e.shotStatusList)}},model:{value:e.shotStatus,callback:function(t){e.shotStatus=t},expression:"shotStatus"}},[r("el-option",{attrs:{label:"全部",value:""},nativeOn:{click:function(t){return e.selectAll("shotStatus",e.shotStatusList)}}}),e._l(e.shotStatusList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("商品来源：")]),r("el-select",{staticClass:"inputBox",attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.selectForm.isOwnOrder,callback:function(t){e.$set(e.selectForm,"isOwnOrder",t)},expression:"selectForm.isOwnOrder"}},[r("el-option",{attrs:{label:"全部",value:""}}),e._l(e.goodsSourceList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("创建时间：")]),r("el-date-picker",{staticStyle:{width:"300px"},attrs:{size:"mini","unlink-panels":"","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:function(t){return e.changeTime(t,"createTime")}},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1)]),r("el-row",{staticClass:"row-style"},[r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("商品ID：")]),r("el-input",{staticClass:"inputBox",attrs:{size:"mini",clearable:""},model:{value:e.selectForm.goodsId,callback:function(t){e.$set(e.selectForm,"goodsId",t)},expression:"selectForm.goodsId"}})],1),r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("颜色标识：")]),r("el-select",{staticClass:"inputBox",attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.selectForm.colorLabelId,callback:function(t){e.$set(e.selectForm,"colorLabelId",t)},expression:"selectForm.colorLabelId"}},[r("el-option",{attrs:{label:"全部",value:0}}),r("el-option",{attrs:{label:"未标识",value:-1}}),r("el-option",{attrs:{label:"已标识",value:-2}}),e._l(e.selectColorList,(function(e){return r("el-option",{key:e.id,style:{color:e.color},attrs:{label:e.name,value:e.id}})}))],2)],1),r("div",{staticClass:"tool-item mar-right gross_profit"},[r("span",[e._v("毛利值：")]),r("el-input",{staticStyle:{width:"63px"},attrs:{size:"mini",clearable:""},model:{value:e.selectForm.minGrossProfit,callback:function(t){e.$set(e.selectForm,"minGrossProfit",t)},expression:"selectForm.minGrossProfit"}}),r("p",{staticStyle:{margin:"0 4px"}},[e._v("-")]),r("el-input",{staticStyle:{width:"64px"},attrs:{size:"mini",clearable:""},model:{value:e.selectForm.maxGrossProfit,callback:function(t){e.$set(e.selectForm,"maxGrossProfit",t)},expression:"selectForm.maxGrossProfit"}})],1),r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("采购时间：")]),r("el-date-picker",{staticStyle:{width:"300px"},attrs:{size:"mini","unlink-panels":"","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:function(t){return e.changeTime(t,"selectForm","shotTime")}},model:{value:e.selectForm.shotTime,callback:function(t){e.$set(e.selectForm,"shotTime",t)},expression:"selectForm.shotTime"}})],1)]),r("el-row",{staticClass:"row-style"},[r("div",{staticClass:"tool-item mar-right"},[r("el-select",{staticStyle:{width:"80px"},attrs:{placeholder:"",size:"mini",filterable:""},on:{change:function(t){e.inputContent=""}},model:{value:e.inputType,callback:function(t){e.inputType=t},expression:"inputType"}},e._l(e.inputTypeList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),r("el-input",{staticStyle:{width:"140px"},attrs:{size:"mini",clearable:""},model:{value:e.inputContent,callback:function(t){e.inputContent=t},expression:"inputContent"}}),r("el-tooltip",{attrs:{effect:"dark",placement:"bottom-start"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 查询选项为订单编号时："),r("br"),e._v(" 1、需进行批量查询时，可用英文逗号隔开各个订单编号"),r("br"),e._v(" 查询选项为备注或商品货号时："),r("br"),e._v(" 1、查询全部数据传空"),r("br"),e._v(" 2、查未备注或无商品货号数据时，传‘无’"),r("br")]),r("i",{staticClass:"el-icon-question"})])],1),r("div",{staticClass:"tool-item mar-right"},[r("span",{staticStyle:{width:"60px"}},[e._v("物流方式：")]),r("el-select",{staticClass:"inputBox",attrs:{placeholder:"",size:"mini",multiple:"","collapse-tags":"",filterable:""},model:{value:e.logisticsIds,callback:function(t){e.logisticsIds=t},expression:"logisticsIds"}},[r("el-option",{attrs:{label:"全部物流",value:""},nativeOn:{click:function(t){return e.selectAll("logisticsIds",e.shipTypeList)}}}),e._l(e.shipTypeList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.ShipName,value:e.ShipId}})}))],2)],1),r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("付款方式：")]),r("el-select",{staticClass:"inputBox",attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.selectForm.paymentMenthod,callback:function(t){e.$set(e.selectForm,"paymentMenthod",t)},expression:"selectForm.paymentMenthod"}},e._l(e.payMethodList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),r("div",{staticClass:"tool-item mar-right"},[r("span",[e._v("海外商品：")]),r("el-select",{staticClass:"inputBox",staticStyle:{width:"100px"},attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.selectForm.isOverseasGoods,callback:function(t){e.$set(e.selectForm,"isOverseasGoods",t)},expression:"selectForm.isOverseasGoods"}},[r("el-option",{attrs:{label:"全部",value:""}}),r("el-option",{attrs:{label:"是",value:"1"}}),r("el-option",{attrs:{label:"否",value:"-1"}})],1)],1)]),r("el-row",{staticClass:"row-style"},[r("el-button",{staticClass:"btnMini",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.getOrderList(1)}}},[e._v("搜索")]),r("el-button",{staticClass:"btnMedium",attrs:{type:"primary",size:"mini"},on:{click:e.syncOriginGoodsNum}},[e._v("一键同步上家库存 ")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:e.batchShipInfo}},[e._v("批量添加采购物流单号")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:e.getLazadaPayType}},[e._v("批量获取Lazada付款方式 ")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:function(t){e.uploadStoreShipAmountVisible=!0}}},[e._v(" 上报仓库发货金额 ")]),r("el-button",{staticClass:"btnMedium",attrs:{type:"primary",size:"mini"},on:{click:e.openBefore}},[e._v("批量添加本地备注")])],1),r("el-row",{staticClass:"row-style"},[r("el-button",{staticClass:"btnMini",attrs:{type:"primary",size:"mini"},on:{click:function(t){e.lookForbidVisible=!0}}},[e._v("查看禁运品 ")]),r("el-button",{staticClass:"btnMedium",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.outStoreBefore("自有仓库商品出库","1")}}},[e._v(" 自有仓库商品出库 ")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.outStoreBefore("产品中心商品出库","2")}}},[e._v(" 产品中心商品出库 ")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.outStoreBefore("海外仓备货商品出库","3")}}},[e._v(" 海外仓备货商品出库 ")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.outStoreBefore("国内仓备货商品出库","4")}}},[e._v(" 国内仓备货商品出库 ")]),r("el-button",{staticClass:"btnMedium mar-right",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.batchReplyOrderBuyer(e.multipleSelection)}}},[e._v("批量评价订单买家 ")]),r("el-checkbox",{staticClass:"mar-right",model:{value:e.showConsole,callback:function(t){e.showConsole=t},expression:"showConsole"}},[e._v("隐藏日志")])],1),r("el-row",{staticClass:"row-style"},[r("el-button",{staticClass:"btnMini",attrs:{size:"mini"},on:{click:e.applyAsyncExportOrder}},[e._v("导出数据")]),r("el-button",{staticClass:"btnMedium",attrs:{size:"mini"},on:{click:function(t){e.orderReportVisible=!0}}},[e._v("导出数据报表")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:e.batchPrintOrderSurface}},[e._v("批量打印面单 ")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:e.purchaseGlobalOrder}},[e._v("批量天猫淘宝海外平台拍单 ")]),r("el-button",{staticClass:"btnLongMax",attrs:{type:"primary",size:"mini"},on:{click:e.getCrossBorderOrderInfo}},[e._v(" 批量获取天猫淘宝海外平台订单信息 ")]),r("el-button",{staticClass:"btnLong",attrs:{type:"primary",size:"mini"},on:{click:e.openPddDisount}},[e._v("拼多多月卡优惠券查询")])],1)],1)])])])]),r("div",{staticClass:"showBtn"},[r("p",{staticStyle:{"margin-right":"10px"},on:{click:e.updateTableColumnShow}},[e._v("适配表格高度"),r("i",{staticClass:"el-icon-refresh"})]),e.isShow?r("p",{on:{click:function(t){e.isShow=!1}}},[e._v("收起"),r("i",{staticClass:"el-icon-caret-top"})]):r("p",{on:{click:function(t){e.isShow=!0}}},[e._v("展开"),r("i",{staticClass:"el-icon-caret-bottom"})])])],1),r("div",{staticClass:"content",style:{height:e.isShow?"calc(100vh - 360px)":"calc(100vh - 50px)"}},[r("p",{staticStyle:{padding:"0 10px",color:"red"}},[e._v(" 温馨提示：1、最终毛利 = 订单收入-采购金额-仓库发货金额（生成仓库发货金额才会去计算，会有汇率差）；含邮费毛利 = 订单收入-采购价；2、调整列表顺序，请至【配置自定义列】按钮，拖动表头进行排列 ")]),e.tableColumnShow?r("u-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{"use-virtual":"","row-height":60,"tooltip-effect":"dark",border:!1,data:e.tableData,height:e.isShow&&e.tableHeight||e.tableHeight+290,"cell-style":{padding:"0"},"header-cell-style":{backgroundColor:"#f5f7fa"},resizable:!0,"default-sort":e.sortRule},on:{"selection-change":e.handleSelectionChange,"sort-change":e.sortChange}},[e.tableColumnShow?r("u-table-column",{attrs:{align:"center",type:"selection",width:"50",fixed:"left"}}):e._e(),e.tableColumnShow?r("u-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((e.currentPage-1)*e.pageSize+t.$index+1))]}}],null,!1,2114148009)}):e._e(),e._l(e.tableColumnList,(function(t){return e.tableColumnShow&&1===t.is_show?r("u-table-column",{key:t.key,attrs:{width:t.width||"80",align:t.align||"left",label:t.name,prop:t.prop||"",sortable:t.sortable||!1,fixed:t.fixed,"show-overflow-tooltip":t.showOverflowTooltip||!1,resizable:!0},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row,o=a.$index;return[t.iCopy?r("i",{staticClass:"el-icon-document-copy copyStyle",staticStyle:{float:"left","line-height":"20px"},on:{click:function(r){e.copyItem(e.getTableRow(n,t.iCopy))}}}):e._e(),t.iColor?r("p",{style:{background:e.changeColorLabel(n[t.iColor]),height:"20px"}}):e._e(),0===t.showType?r("p",{staticStyle:{padding:"0",display:"flex","flex-flow":"column"}},[t.propList?e._l(t.propList,(function(t,a){return r("span",{key:a,class:(t.rowClick?"tableActive":t.rowDblClick&&"copyStyle")||"",staticStyle:{"text-overflow":"ellipsis",overflow:"hidden"},on:{click:function(r){t.rowClick&&e.tableRowBound(t.rowClick,n,o,t)},dblclick:function(r){t.rowDblClick&&e.tableRowBound(t.rowDblClick,n,o,t)}}},[e._v(" "+e._s(t.name)+"："+e._s(t.filter&&t.filter(e.getTableRow(n,t.prop))||e.getTableRow(n,t.prop))+" ")])})):r("span",{class:(t.rowClick?"tableActive":t.rowDblClick&&"copyStyle")||"",staticStyle:{"text-overflow":"ellipsis",overflow:"hidden"},on:{click:function(r){t.rowClick&&e.tableRowBound(t.rowClick,n,o,t)},dblclick:function(r){t.rowDblClick&&e.tableRowBound(t.rowDblClick,n,o,t)}}},[e._v(" "+e._s(t.filter&&t.filter(e.getTableRow(n,t.prop))||e.getTableRow(n,t.prop))+" ")])],2):2===t.showType?r("el-dropdown",{staticStyle:{width:"90px"},attrs:{trigger:"click",size:"mini"}},[r("el-button",{staticStyle:{width:"100px",margin:"0"},attrs:{size:"mini",plain:"",type:"primary"}},[e._v(" 操作"),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.singleBuyInfo(n)}}},[e._v("采购信息编辑")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.addPurchaseLink(n)}}},[e._v("添加采购链接")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.addMoreTrackingNumber(n)}}},[e._v("添加多物流单号")])]),r("el-dropdown-item",[r("div",{on:{click:function(t){return e.setColorSingle(n)}}},[e._v("标记颜色标识")])]),r("el-dropdown-item",[r("div",{on:{click:function(t){return e.setAbroadSingle(n)}}},[e._v("标记海外商品")])]),r("el-dropdown-item",[r("div",{on:{click:function(t){return e.pushOrderToStoreSingle(n)}}},[e._v("推送订单至仓库")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItemdropdownItem",on:{click:function(t){e.clickRow=n,e.billsDetailVisible=!0}}},[e._v(" 账单明细 ")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.SyncOrder(n)}}},[e._v("同步此店铺订单")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.SyncOrderSingle(n)}}},[e._v("同步此订单")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.syncLogisticsSingle(n)}}},[e._v("同步此订单物流")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.singlePurchase(n)}}},[e._v("重新采购")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.getSHtrackPath(n)}}},[e._v("虾皮物流轨迹")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.getorderPath(n)}}},[e._v("订单轨迹")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.handleOutOrder(n)}}},[e._v("手动发货")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.batchReplyOrderBuyer([n])}}},[e._v("回复订单评论")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.viewDetails("itemDetail",n.goods_info.goods_id,n.mall_info.platform_mall_id)}}},[e._v(" 商品编辑 ")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.goodsDelist(n)}}},[e._v("商品下架")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.goodsDelete(n)}}},[e._v("商品删除")])]),r("el-dropdown-item",[r("div",{staticClass:"dropdownItem",on:{click:function(t){return e.goodsTop(n)}}},[e._v("商品置顶")])])],1)],1):4===t.showType?r("p",{staticStyle:{display:"flex","flex-direction":"column",padding:"0"},style:{color:t.rowColor&&e.tableRowBound(t.rowColor,n,o,t)||""}},[r("span",{staticStyle:{"text-overflow":"ellipsis",overflow:"hidden"}},[e._v(" "+e._s(t.rowShow&&e.tableRowBound(t.rowShow,n,o,t)||e.getTableRow(n,t.prop))+" ")]),t.propLink&&t.propLinkName?r("el-link",{attrs:{size:"mini",type:"danger"},on:{click:function(r){t.rowClick&&e.tableRowBound(t.rowClick,n,o,t)}}},[e._v(" "+e._s(t.propLinkName)+" ")]):t.propLink&&1===Number(e.getTableRow(n,t.propLink))?r("el-link",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.setSKURelation(n)}}},[e._v(" "+e._s(n.empty_info?"重新映射SKU":"加入收藏")+" ")]):e._e()],1):7===t.showType?r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){t.rowClick&&e.tableRowBound(t.rowClick,n,o,t)}}},[e._v(" "+e._s(t.buttonName)+" ")]):8===t.showType?r("div",[e.getTableRow(n,t.prop)?r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.cancelSecondSale(n)}}},[e._v(" 取消二次销售 ")]):e._e(),n.isSecond?r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.chooseSecondSale(n)}}},[e._v(" "+e._s(n.secondSaleTitle)+" ")]):e._e()],1):10===t.showType?r("el-tooltip",{staticStyle:{width:"40px",height:"40px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:t.filter([e.getTableRow(n,t.prop)])}})],1),r("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:t.filter([e.getTableRow(n,t.prop),!0])}})],1):11===t.showType?r("div",[r("p",{staticStyle:{"line-height":"20px",padding:"0",color:"#000"}},[e._v(" "+e._s(e.getTableRow(n,t.prop))+e._s(t.filter&&t.filter(n.country))+" ")]),r("p",{staticStyle:{"line-height":"20px",padding:"0",color:"#000"}},[e._v(" "+e._s(e.changeMoney(e.getTableRow(n,t.prop),n.country))+"￥ ")])]):12===t.showType?r("el-dropdown",{on:{command:function(t){e.soSameItem(t,n)}}},[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("图搜同款")]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("p",{staticStyle:{"text-align":"center","margin-bottom":"5px"}},[e._v("选择平台")]),r("el-dropdown-item",{attrs:{command:"淘宝"}},[e._v("淘宝")]),r("el-dropdown-item",{attrs:{command:"1688"}},[e._v("1688")])],1)],1):16===t.showType?r("div",[r("p",{staticStyle:{"line-height":"20px",padding:"0",color:"#000"}},[e._v(" "+e._s(e.changeMoney(e.getTableRow(n,t.prop),n.country,"toA"))+e._s(t.filter(n.country)))]),r("p",{staticStyle:{"line-height":"20px",padding:"0",color:"#000"}},[e._v(e._s(e.getTableRow(n,t.prop))+"￥")])]):17===t.showType&&1==n.shot_order_info.shot_status?r("div",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.singlePurchase(n)}}},[e._v("采购")])],1):19===t.showType?r("p",{staticStyle:{padding:"0"}},[e.getTableRow(n,t.prop)?r("i",{staticClass:"el-icon-document-copy copyStyle tableActive",on:{click:function(r){e.copyItem(e.getTableRow(n,t.prop))}}}):e._e(),r("span",{staticClass:"tableActive",on:{click:function(t){return e.clickBuyOrder(n)}}},[e._v(e._s(e.getTableRow(n,t.prop)))])]):23===t.showType?r("div",[n.id!==e.activeRemarkID?r("div",{staticStyle:{cursor:"pointer","min-width":"20px"},on:{click:function(t){return t.stopPropagation(),e.editRemark(n.id)}}},[r("p",{staticClass:"remark_p",on:{dblclick:function(t){return e.copyItem(n.remark)}}},[e._v(e._s(n.remark))])]):e._e(),n.id===e.activeRemarkID?r("el-input",{attrs:{size:"mini"},on:{blur:function(t){return e.changeRemark(n.id)}},model:{value:e.orderRemark,callback:function(t){e.orderRemark=t},expression:"orderRemark"}}):e._e()],1):24===t.showType?r("div",[r("div",{directives:[{name:"show",rawName:"v-show",value:!(n.id===e.activeRemarkIDNode),expression:"!(row.id === activeRemarkIDNode)"}],staticStyle:{cursor:"pointer"},on:{click:function(t){return e.editRemarkNode(n.id)}}},[r("el-input",{attrs:{disabled:"",size:"mini"},model:{value:n.note,callback:function(t){e.$set(n,"note",t)},expression:"row.note"}})],1),n.id===e.activeRemarkIDNode?r("el-input",{attrs:{size:"mini"},on:{blur:function(t){return e.changeRemarkNode(n.id)}},model:{value:e.orderRemarkNode,callback:function(t){e.orderRemarkNode=t},expression:"orderRemarkNode"}}):e._e()],1):e._e()]}}],null,!0)}):e._e()}))],2):e._e(),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","page-sizes":[20,50,100,200],"page-size":e.pageSize,"current-page":e.currentPage,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),r("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showConsole,callback:function(t){e.showConsole=t},expression:"showConsole"}}),e.columnVisible?r("el-dialog",{attrs:{visible:e.columnVisible,width:"800px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.columnVisible=t}}},[r("template",{slot:"title"},[r("div",{staticStyle:{display:"flex","align-items":"center"}},[r("div",{staticStyle:{"margin-right":"25px",color:"#000","font-weight":"700"}},[e._v("配置订单列表显示列")]),r("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"-15px"}},[e._v(" 列表名定位： "),r("el-input",{staticStyle:{width:"150px"},attrs:{size:"mini"},model:{value:e.column_search,callback:function(t){e.column_search=t},expression:"column_search"}}),r("el-tooltip",{attrs:{effect:"dark",placement:"bottom"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 用于定位对应订单列所处位置，方便您进行自定义设置（会以红色加粗标注）"),r("br")]),r("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"16px!important","margin-left":"5px"}})])],1)])]),r("div",{staticClass:"column-style"},[r("draggable",{attrs:{filter:".forbid",handle:".mover",group:"columnConfig"},on:{update:e.datadragEnd},model:{value:e.columnConfigShowList,callback:function(t){e.columnConfigShowList=t},expression:"columnConfigShowList"}},[r("transition-group",e._l(e.columnConfigShowList,(function(t,a){return r("div",{key:t.id,class:a<2?"forbid column-item":"column-item"},[r("div",{staticClass:"column-top"},[r("span",{class:e.column_search&&t.column_header.includes(e.column_search)?"mover_search mover":"mover"},[e._v(" "+e._s(t.column_header))]),r("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","inactive-color":"#a9a9a9","active-value":1,"inactive-value":-1},model:{value:t.is_show,callback:function(r){e.$set(t,"is_show",r)},expression:"item.is_show"}})],1),r("div",{staticClass:"column-bottom"},[e._v(" 宽度： "),r("el-input",{staticStyle:{width:"80px",margin:"0 5px"},attrs:{size:"mini",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:t.width,callback:function(r){e.$set(t,"width",r)},expression:"item.width"}}),e._v(" PX ")],1)])})),0)],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.checkAllColumn(1)}}},[e._v("显示所有列")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.checkAllColumn(-1)}}},[e._v("隐藏所有列")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.uploadColumn}},[e._v("应用")])],1)],2):e._e(),r("el-dialog",{attrs:{title:"标记为海外商品",visible:e.abroadVisible,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.abroadVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("div",{staticClass:"abroad-mar"},[r("el-radio",{attrs:{label:1},model:{value:e.isAbroadGood,callback:function(t){e.isAbroadGood=t},expression:"isAbroadGood"}},[e._v("海外商品")]),r("el-radio",{attrs:{label:-1},model:{value:e.isAbroadGood,callback:function(t){e.isAbroadGood=t},expression:"isAbroadGood"}},[e._v("非海外商品")])],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.setAbroadGood(e.multipleSelection)}}},[e._v("确 定")])],1)]),r("el-dialog",{attrs:{title:"批量添加本地备注",visible:e.localRamarkVisible,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.localRamarkVisible=t},open:e.openBefore}},[r("div",{staticClass:"remark-style"},[r("span",[e._v("本地备注")]),r("el-input",{attrs:{type:"textarea",resize:"none",rows:4,placeholder:"请输入内容"},model:{value:e.localRamark,callback:function(t){e.localRamark=t},expression:"localRamark"}})],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.batchSetRemark}},[e._v("批量添加")])],1)]),e.colorVisible?r("el-dialog",{attrs:{title:"选择颜色标识",visible:e.colorVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.colorVisible=t}}},[r("div",{staticClass:"color-style"},[r("el-table",{ref:"colorTable",staticStyle:{width:"100%"},attrs:{data:e.colorList,"tooltip-effect":"dark",height:"500",loading:e.colorLoading}},[r("el-table-column",{attrs:{label:"标识选择",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-radio",{attrs:{label:t.$index},nativeOn:{change:function(r){return e.getCurrentRow(t.row)}},model:{value:e.colorRadio,callback:function(t){e.colorRadio=t},expression:"colorRadio"}})]}}],null,!1,3784151285)}),r("el-table-column",{attrs:{prop:"name",label:"颜色"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("div",{staticClass:"colorBox",style:{background:e.row.color}})]}}],null,!1,482107263)}),r("el-table-column",{attrs:{prop:"name",label:"标识名称"}})],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.setColor(e.multipleSelection)}}},[e._v("设置颜色")])],1)]):e._e(),e.purchaseInfoVisible?r("el-dialog",{attrs:{title:"添加采购信息",visible:e.purchaseInfoVisible,width:"500px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.purchaseInfoVisible=t}}},[r("purchase-info",{attrs:{"choose-data":e.multipleSelection,"buyer-account-list":e.buyerAccountList,"deal-type":e.dealType},on:{close:e.closeDialog}})],1):e._e(),e.pushOrderToStoreVisible?r("el-dialog",{attrs:{title:"同步数据至仓库",visible:e.pushOrderToStoreVisible,width:"1200px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.pushOrderToStoreVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("push-order",{attrs:{"choose-data":e.multipleSelection}})],1):e._e(),e.shipInfoVisible?r("el-dialog",{attrs:{title:"批量添加采购物流单号",visible:e.shipInfoVisible,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.shipInfoVisible=t},close:e.closeDialog}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.shipLoading,expression:"shipLoading"}]},[r("div",{staticClass:"item-box"},[r("span",[e._v("绑定仓库：")]),r("el-select",{staticClass:"btnLongMax",attrs:{size:"mini"},model:{value:e.shipBindStore,callback:function(t){e.shipBindStore=t},expression:"shipBindStore"}},e._l(e.shipStoreList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.warehouse_name,value:e.id}})})),1)],1),r("div",{staticClass:"item-box"},[r("span",[e._v("采购物流单号：")]),r("el-input",{staticClass:"btnLongMax",attrs:{size:"mini",clearable:""},model:{value:e.shipNo,callback:function(t){e.shipNo=t},expression:"shipNo"}})],1),r("div",{staticClass:"item-box"},[r("span",[e._v("采购物流公司：")]),r("el-input",{staticClass:"btnLongMax",attrs:{size:"mini",clearable:""},model:{value:e.shipCompany,callback:function(t){e.shipCompany=t},expression:"shipCompany"}})],1)]),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.batchSaveShipInfo}},[e._v("确 定")])],1)]):e._e(),e.uploadStoreShipAmountVisible?r("el-dialog",{attrs:{title:"上报仓库发货金额",visible:e.uploadStoreShipAmountVisible,width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadStoreShipAmountVisible=t}}},[r("upload-store-ship-amount",{on:{close:e.closeDialog}})],1):e._e(),e.goodsOutStoreVisible?r("el-dialog",{attrs:{visible:e.goodsOutStoreVisible,width:"1400px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.goodsOutStoreVisible=t}}},[r("div",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.outStoreTitle))]),r("goods-out-store",{attrs:{"choose-data":e.uniqueArr(e.multipleSelection),"out-store-type":e.outStoreType},on:{dynamicSet:e.setTableData,close:e.closeDialog}})],1):e._e(),e.addBuyLinkVisible?r("el-dialog",{attrs:{title:"添加采购链接",visible:e.addBuyLinkVisible,width:"1200px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.addBuyLinkVisible=t},close:e.closeDialog}},[r("buy-link",{attrs:{"link-row":e.clickRow},on:{close:e.closeDialog}})],1):e._e(),r("el-dialog",{attrs:{title:"查看禁运品",visible:e.lookForbidVisible,width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(t){e.lookForbidVisible=t}}},[r("div",{staticClass:"forbid"},[r("div",{staticClass:"forbid-left"},[r("p",{staticClass:"title"},[e._v("航空禁运品")]),e._l(e.forbidData,(function(t,a){return r("p",{key:a},[e._v("("+e._s(a+1)+") "+e._s(t))])}))],2),r("div",{staticClass:"forbid-right"},[r("p",{staticClass:"title"},[e._v("泰国海关禁止进口商品")]),r("div",{staticClass:"right-col"},e._l(e.forbidTHData,(function(t,a){return r("p",{key:a,staticClass:"half"},[e._v("("+e._s(a+1)+") "+e._s(t))])})),0)])])]),e.addMoreTraNumberVisible?r("el-dialog",{attrs:{title:"添加多物流单号",visible:e.addMoreTraNumberVisible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.addMoreTraNumberVisible=t},close:e.closeDialog}},[r("div",{staticClass:"tra-style"},[r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"60px"}},[e._v("绑定仓库")]),r("el-select",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.bindStore,callback:function(t){e.bindStore=t},expression:"bindStore"}},e._l(e.warehouseData,(function(e,t){return r("el-option",{key:t,attrs:{label:e.warehouse_name,value:e.id}})})),1)],1),e._l(e.trackingNumberList,(function(t,a){return r("div",{key:a,staticClass:"tra-content"},[r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"80px"}},[e._v("物流单号"+e._s(a+1))]),r("el-input",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:t.original_tracking_number,callback:function(r){e.$set(t,"original_tracking_number",r)},expression:"item.original_tracking_number"}})],1),r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"80px"}},[e._v("物流公司"+e._s(a+1))]),r("el-input",{staticClass:"inputWidth mar-right",attrs:{size:"mini"},model:{value:t.original_logistics_company,callback:function(r){e.$set(t,"original_logistics_company",r)},expression:"item.original_logistics_company"}})],1),r("el-button",{staticClass:"item-box mar-right",attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.deleteTraNumber(a,t)}}},[e._v("删除 ")]),a===e.trackingNumberList.length-1?r("el-button",{staticClass:"item-box",attrs:{type:"primary",size:"mini"},on:{click:e.addTraNumber}},[e._v("添加 ")]):e._e()],1)})),r("p",[e._v("关于绑定仓库选项:")]),r("p",[e._v("1、仅显示当前订单店铺绑定的仓库")]),r("p",[e._v("2、采购类型如果为国内平台时，显示国内中转仓，如果为国外平台则显示海外仓")])],2),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveAddMoreTra}},[e._v("保 存")])],1)]):e._e(),e.billsDetailVisible?r("el-dialog",{attrs:{title:"账单明细",visible:e.billsDetailVisible,top:"5vh",width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(t){e.billsDetailVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("bill-detail",{attrs:{"choose-data":e.clickRow}})],1):e._e(),e.trackPathVisible?r("el-dialog",{attrs:{title:"物流轨迹",visible:e.trackPathVisible,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.trackPathVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("el-steps",{attrs:{direction:"vertical",active:1}},[r("el-step",{attrs:{title:"暂无物流信息",description:e.$dayjs(new Date).format("YYYY-MM-DD HH:mm")}})],1)],1):e._e(),e.spTrackPathVisible?r("el-dialog",{attrs:{title:"虾皮物流轨迹",visible:e.spTrackPathVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.spTrackPathVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("div",{staticClass:"track-step"},[r("div",{staticClass:"step-header"},[r("div",{staticClass:"step-item"},[r("span",[e._v("物流名称：")]),r("p",[e._v(e._s(e.clickRow.logistics_name))])]),r("div",{staticClass:"step-item"},[r("span",[e._v("物流编号:")]),r("p",[e._v(e._s(e.clickRow.tracking_no))])])]),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.shipInfoLoading,expression:"shipInfoLoading"}],staticClass:"step-content"},[r("el-steps",{attrs:{direction:"vertical",active:1,space:"80px"}},e._l(e.spTrackPath,(function(t,a){return r("el-step",{key:a,attrs:{icon:"el-icon-s-help",title:t.description,description:e.$dayjs(1e3*t.ctime).format("YYYY-MM-DD HH:mm")}})})),1)],1)])]):e._e(),e.orderPathVisible?r("el-dialog",{attrs:{title:"订单轨迹",visible:e.orderPathVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.orderPathVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("div",{staticClass:"track-step"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.orderPathInfoLoading,expression:"orderPathInfoLoading"}],staticClass:"step-content"},[r("el-steps",{attrs:{direction:"vertical",active:1,space:"80px"}},e._l(e.orderTrackPath,(function(e,t){return r("el-step",{key:t,attrs:{icon:"el-icon-s-help",title:e[0],description:e[1]}})})),1)],1)])]):e._e(),e.orderReportVisible?r("el-dialog",{attrs:{title:"订单报表",visible:e.orderReportVisible,top:"5vh",width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.orderReportVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("export-report")],1):e._e(),e.replayOrderBuyerVisible?r("el-dialog",{attrs:{title:"回复订单买家",visible:e.replayOrderBuyerVisible,top:"5vh",width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.replayOrderBuyerVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("reply-buyer",{attrs:{"choose-data":e.replyBuyerData},on:{close:function(t){return e.closeDialog("noRefresh")}}})],1):e._e(),e.handOutOrderVisible?r("el-dialog",{attrs:{title:"填写发货单号",visible:e.handOutOrderVisible,top:"5vh",width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.handOutOrderVisible=t},close:e.closeDialog}},[r("div",{staticClass:"handle-out"},[r("div",{staticClass:"item"},[r("span",[e._v("当前订单状态：")]),r("p",[e._v(e._s(e.changeTypeName(e.clickRow.order_status,e.orderStatusList)))])]),r("div",{staticClass:"item"},[r("span",[e._v("订单号：")]),r("p",[e._v(e._s(e.clickRow.order_sn))])]),r("div",{staticClass:"item"},[r("span",[e._v("站点：")]),r("p",[e._v(e._s(e._f("chineseSite")(e.clickRow.country)))])]),r("div",{staticClass:"item"},[r("span",[e._v("发货物流名称：")]),r("el-input",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.shippingProof,callback:function(t){e.shippingProof=t},expression:"shippingProof"}})],1),r("div",{staticClass:"item"},[r("span",[e._v("发货物流单号：")]),r("el-input",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.shippingTraceNo,callback:function(t){e.shippingTraceNo=t},expression:"shippingTraceNo"}})],1)]),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveHandleOut}},[e._v("保 存")])],1)]):e._e(),e.secondSaleVisible?r("el-dialog",{attrs:{title:"二次销售",visible:e.secondSaleVisible,top:"5vh",width:"1500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.secondSaleVisible=t},close:e.closeDialog}},[r("second-sale",{attrs:{"choose-data":e.clickRow,"second-order-data":e.secondOrderList},on:{close:e.closeDialog}})],1):e._e(),e.collectionVisible?r("el-dialog",{attrs:{title:"图搜同款",visible:e.collectionVisible,top:"5vh",width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(t){e.collectionVisible=t},close:function(t){return e.closeDialog("noRefresh")}}},[r("image-collection",{attrs:{"choose-data":e.clickRow,"collect-type":e.collectType},on:{close:function(t){return e.closeDialog("noRefresh")}}})],1):e._e(),e.ordersShipmentVisible?r("el-dialog",{attrs:{title:"批量订单发货",visible:e.ordersShipmentVisible,top:"5vh",width:"1200px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.ordersShipmentVisible=t}}},[r("UploadOrdersShipment",{attrs:{"select-mall-list":e.selectMallList}})],1):e._e()],1)},n=[],o=r("2909"),i=r("b85c"),s=r("1da1"),c=r("5530"),l=(r("96cf"),r("159b"),r("ac1f"),r("5319"),r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0"),r("7db0"),r("b0c0"),r("99af"),r("c740"),r("b64b"),r("caad"),r("2532"),r("25f0"),r("a9e3"),r("b680"),r("4de4"),r("a434"),r("1276"),r("d81d"),r("a15b"),r("bcd0")),u=r("e578"),d=r("0e0b"),p=r("feb6"),h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"account-plugin"},[r("div",{staticClass:"box"},[r("div",{staticClass:"left",staticStyle:{"margin-right":"10px"}},e._l(e.operation.left,(function(t,a){return r("div",{key:a,staticClass:"btn-item"},[r("el-button",{attrs:{type:t.type||"",size:t.size||"mini"},on:{click:function(r){return e.handelBtn(t.key,t.click,t.clickParams)}}},[e._v(e._s(t.title))]),"ship"===t.check?r("el-checkbox",{staticStyle:{"margin-left":"5px"},model:{value:e.isCheckOrderShip,callback:function(t){e.isCheckOrderShip=t},expression:"isCheckOrderShip"}},[e._v("勾选订单同步")]):e._e()],1)})),0),r("div",{staticClass:"center"},[e._l(e.operation.center,(function(t,a){return r("div",{key:a,staticClass:"account-item"},[r("span",[e._v(e._s(t.title))]),r("el-select",{attrs:{size:t.size||"mini",clearable:"",placeholder:"请选择"},on:{change:function(t){return e.accountChange()}},model:{value:e.selectAccount[e.platformValue[t.platform]],callback:function(r){e.$set(e.selectAccount,e.platformValue[t.platform],r)},expression:"selectAccount[platformValue[item.platform]]"}},e._l(e.publicAccount(t.platform),(function(t,a){return r("el-option",{key:a,attrs:{label:t.site?t.site+"-"+t.name:t.name,value:t.id}},[r("span",[e._v(e._s(t.site)),t.site?r("span",[e._v("-")]):e._e(),e._v(e._s(t.name))]),r("i",{staticClass:"el-icon-delete",staticStyle:{float:"right",color:"#8492a6","font-size":"14px",margin:"10px -10px 0 0"},on:{click:function(r){e.activeAccount=t,e.deleteAccount=!0}}})])})),1),r("el-button",{staticStyle:{"margin-right":"6px",width:"165px"},attrs:{size:t.size||"mini"},on:{click:function(r){return e.publicCenter(e.selectAccount[e.platformValue[t.platform]],t.platform)}}},[e._v(" "+e._s(t.centerTitle))])],1)})),r("div",{staticClass:"account-item"},[r("span",[e._v("天猫淘宝海外账号")]),r("el-select",{attrs:{size:"mini",clearable:"",placeholder:"请选择"},on:{change:function(t){return e.accountChange()}},model:{value:e.selectAccount[e.platformValue[13]],callback:function(t){e.$set(e.selectAccount,e.platformValue[13],t)},expression:"selectAccount[platformValue[13]]"}},e._l(e.buyerAccountListGlobal,(function(t,a){return r("el-option",{key:a,attrs:{label:t.account,value:t.id}},[r("span",[e._v(e._s(t.account))])])})),1),r("el-button",{staticStyle:{"margin-right":"6px",width:"165px"},attrs:{size:"mini"},on:{click:e.reFreshGlobal}},[e._v("刷新天猫淘宝海外平台账号")])],1)],2),r("div",{staticClass:"right"},e._l(e.operation.right,(function(t,a){return r("div",{key:a,staticClass:"btn-item"},[r("el-button",{attrs:{type:t.type||"",size:t.size||"mini"},on:{click:function(r){return e.handelBtn(t.key,t.click,t.clickParams)}}},[e._v(e._s(t.title))])],1)})),0)]),r("p"),r("el-dialog",{attrs:{title:"选择登录平台",visible:e.loginAccount,width:"520px"},on:{"update:visible":function(t){e.loginAccount=t}}},[r("div",{staticClass:"btn-header"},[r("div",{staticClass:"sub-row"},[r("div",{staticClass:"row"},[r("p",[e._v("代理设置只适用于shopee和lazada")])]),r("div",{staticClass:"row"},[e._v(" 代理设置： "),r("el-select",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{placeholder:"",size:"mini",filterable:"",clearable:""},model:{value:e.proxyType,callback:function(t){e.proxyType=t},expression:"proxyType"}},e._l(e.proxyList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.ip_alias,value:e.id}})})),1),r("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.siteCode,callback:function(t){e.siteCode=t},expression:"siteCode"}},e._l(e.siteList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1)])]),r("div",{staticClass:"ridioBox"},[r("el-button",{staticStyle:{margin:"0 12px 20px",width:"110px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.loginAccount=!1,e.pddLoginHandler()}}},[e._v("登录拼多多")]),r("el-button",{staticStyle:{margin:"0 12px 20px",width:"110px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.loginAccount=!1,e.taobaoLogin()}}},[e._v("登录淘宝")]),r("el-button",{staticStyle:{margin:"0 12px 20px",width:"110px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.loginAccount=!1,e.AlibabaLogin()}}},[e._v("登录1688")]),r("el-button",{staticStyle:{margin:"0 12px 20px",width:"110px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.loginAccount=!1,e.jingxiLogin()}}},[e._v("登录京喜")]),r("el-button",{staticStyle:{margin:"0 12px 20px",width:"110px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.loginAccount=!1,e.lazadaLogin()}}},[e._v("登录Lazada")]),r("el-button",{staticStyle:{margin:"0 12px 20px",width:"110px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.loginAccount=!1,e.shopeeLogin()}}},[e._v("登录Shopee")])],1)]),r("el-dialog",{attrs:{title:"删除买手号",visible:e.deleteAccount,width:"380px"},on:{"update:visible":function(t){e.deleteAccount=t}}},[e.activeAccount?r("p",{staticStyle:{"font-size":"18px",padding:"0 30px","text-align":"center"}},[e._v("确定删除买手号:"+e._s(e.activeAccount.name))]):e._e(),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{width:"80px",margin:"0 20px 20px"},attrs:{size:"small"},on:{click:function(t){e.deleteAccount=!1}}},[e._v("取 消")]),r("el-button",{staticStyle:{width:"80px",margin:"0 55px"},attrs:{size:"small",type:"primary"},on:{click:function(t){e.deleteAccount=!1,e.removebuyerAccount()}}},[e._v("确 定")])],1)]),e.sycnOrderVisible?r("el-dialog",{attrs:{title:"同步订单",visible:e.sycnOrderVisible,width:"800px"},on:{"update:visible":function(t){e.sycnOrderVisible=t}}},[r("div",{staticClass:"sync-order-dialog"},[r("storeChoose",{attrs:{"is-all":!0,"span-width":"80px","select-width":"160px",source:"orderCenter"},on:{changeMallList:e.changeMallList}}),r("div",{staticClass:"row-style"},[r("div",{staticClass:"tool-item"},[r("span",[e._v("订单状态：")]),r("el-select",{staticClass:"inputBox",attrs:{placeholder:"",size:"mini",multiple:"","collapse-tags":"",filterable:""},model:{value:e.syncOrderStatus,callback:function(t){e.syncOrderStatus=t},expression:"syncOrderStatus"}},[r("el-option",{attrs:{label:"全部",value:"all"},nativeOn:{click:function(t){return e.selectAll("syncOrderStatus",e.syncStatusList)}}}),e._l(e.syncStatusList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),r("div",{staticClass:"tool-item"},[r("span",[e._v("同步天数：")]),r("el-input-number",{attrs:{min:1,max:30,size:"mini",label:"描述文字"},model:{value:e.syncDays,callback:function(t){e.syncDays=t},expression:"syncDays"}})],1)])],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{width:"80px",margin:"0 20px 20px"},attrs:{size:"small"},on:{click:function(t){e.sycnOrderVisible=!1}}},[e._v("取 消")]),r("el-button",{staticStyle:{width:"80px",margin:"0 55px"},attrs:{size:"small",type:"primary"},on:{click:function(t){return e.saveSyncOrder()}}},[e._v("确 定")])],1)]):e._e()],1)},m=[],f=(r("4e82"),r("fb6a"),r("de70")),g=r("31af"),b={TaoBao:0,PinDuoduo:1,JingDong:2,JingXi:3,HYJ:4,Alibaba:5,YunPaiDan:6,Lazada:7,Shopee:8,CrossBorder:9,OwnPlatform:10,PpxiasGhpt:11,AliExpressPlatform:12},_={name:"BuyerAccount",components:{storeChoose:p["a"]},props:{upData:{type:String,default:"buyerAccountList"},operation:{type:Object,default:function(){return{url:{getAccount:{path:"/api/buyerAccount/"},upAccount:{path:"/api/buyerAccount/store"},removeAccount:{path:"/api/buyerAccount/destroy"}},upData:"buyerAccountList",left:[{title:"登录买手号",type:"primary",key:1}],center:[{title:"拼多多账号",platform:1,centerTitle:"拼多多个人中心"},{title:"淘宝账号",platform:2,centerTitle:"淘宝个人中心"},{title:"1688账号",platform:8,centerTitle:"1688个人中心"},{title:"京喜账号",platform:10,centerTitle:"京喜个人中心"},{title:"lazada账号",platform:9,centerTitle:"lazada个人中心"},{title:"shopee账号",platform:11,centerTitle:"shopee个人中心"},{title:"天猫淘宝海外账号",platform:13,centerTitle:"刷新天猫淘宝海外平台账号"}],right:[]}}}},data:function(){return{syncStatusList:l["D"],syncDays:3,syncOrderStatus:["all"],selectMallList:[],sycnOrderVisible:!1,siteCode:"TH",siteList:[{value:"TH",label:"泰国站"},{value:"MY",label:"马来站"},{value:"VN",label:"越南站"},{value:"ID",label:"印尼站"},{value:"PH",label:"菲律宾站"},{value:"SG",label:"新加坡站"}],selectAccount:{accountpdd:"",accounttaobao:"",account1688:"",accountjx:"",accountlazada:"",accountshopee:"",accountCrossBorder:""},platformValue:{1:"accountpdd",2:"accounttaobao",8:"account1688",10:"accountjx",9:"accountlazada",11:"accountshopee",13:"accountCrossBorder"},activeAccount:null,loginAccount:!1,otherOperation:!1,deleteAccount:!1,proxyType:"",proxyList:[],isOrderSelectAllMall:!0,isCheckOrderShip:!1,buyerAccountList:[],buyerAccountListGlobal:[]}},computed:{pddAccount:function(){return this.buyerAccountList.filter((function(e){return 1==e.type}))},tbAccount:function(){return this.buyerAccountList.filter((function(e){return 2==e.type}))},albbAccount:function(){return this.buyerAccountList.filter((function(e){return 8==e.type}))},jxAccount:function(){return this.buyerAccountList.filter((function(e){return 10==e.type}))},lazadaAccount:function(){return this.buyerAccountList.filter((function(e){return 9==e.type}))},shopeeAccount:function(){return this.buyerAccountList.filter((function(e){return 11==e.type}))},globalAccount:function(){return this.buyerAccountList.filter((function(e){return 13==e.type}))}},watch:{"buyerAccountList.length":{handler:function(e,t){e!==t&&this.defaultSelect()}}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.buyerAccount();case 2:return t.next=4,e.getGlobalAccount();case 4:e.defaultSelect();case 5:case"end":return t.stop()}}),t)})))()},methods:{changeSelect:function(e,t,r){(e.includes("")||e.length!==r.length)&&e.includes("")&&e.length-1<r.length&&(this[t]=this[t].filter((function(e){return""!==e})))},selectAll:function(e,t){var r=this;this[e].length<t.length?(this[e]=[],t.map((function(t){r[e].push(t.value||t.ShipId)}))):this[e]=[]},changeMallList:function(e){this.selectMallList=e.mallList},reFreshGlobal:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.buyerAccountListGlobal.forEach(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={userId:r.user_id},t.next=3,e.$shopeemanService.postChineseLaiZan("http://api.laizand.com/api/open/refreshAccessToken",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=3,e.getGlobalAccount();case 3:e.$message.success("刷新成功!");case 4:case"end":return t.stop()}}),t)})))()},getGlobalAccount:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$appConfig.getUserInfo();case 2:return r=t.sent,a={uid:r.muid,uuid:"0",account:"",accountAliasName:"",app_key:"KYsyQGFviz2i0uQF"},t.next=6,e.$shopeemanService.getChineseLaiZan("http://api.laizand.com/api/open/getTbGlobalUser?",a,{headers:{Accept:"application/json, application/xml, text/json, text/x-json, text/javascript, text/xml","Accept-Encoding":" gzip, deflate","User-Agent":"RestSharp/106.3.1.0"}});case 6:n=t.sent,o=JSON.parse(n),i=o&&JSON.parse(o.data),i&&200===i.code&&(s=i.data.data||[],s.forEach((function(e){e.type=13})),c=s.sort((function(e,t){var r=e["updated_at"].replace(/:/g,"").replace(/-/g,"").replace(" ",""),a=t["updated_at"].replace(/:/g,"").replace(/-/g,"").replace(" ","");return r<a?1:r>a?-1:0})),e.buyerAccountListGlobal=c||s,e.$parent["buyerAccountListGlobal"]=s,e.defaultSelect());case 10:case"end":return t.stop()}}),t)})))()},syncLogistics:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=new g["a"],t.buyerAccountList.length){r.next=4;break}return t.$refs.Logs.writeLog("没有买手号，请登录买手号",!1),r.abrupt("return",t.$message.warning("没有买手号,请登录！"));case 4:if(!t.isCheckOrderShip){r.next=13;break}if(t.$parent.multipleSelection.length){r.next=7;break}return r.abrupt("return",t.$message.warning("请先选择订单数据！"));case 7:t.$parent.showConsole=e||!1,t.$parent.$refs.Logs.consoleMsg="",t.$parent.$refs.Logs.writeLog("获取采购物流轨迹开始",!0),a.start(t,t.buyerAccountList,t.$parent.$refs.Logs.writeLog,t.$parent.multipleSelection),r.next=17;break;case 13:t.$parent.showConsole=e||!1,t.$parent.$refs.Logs.consoleMsg="",t.$parent.$refs.Logs.writeLog("获取采购物流轨迹开始",!0),a.start(t,t.buyerAccountList,t.$parent.$refs.Logs.writeLog);case 17:case"end":return r.stop()}}),r)})))()},saveSyncOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.sycnOrderVisible=!1,e.$parent.showConsole=!1,e.selectMallList.length||e.$parent.$refs.Logs.writeLog("店铺数据为空，同步操作已取消!",!1),e.syncOrderStatus.length||e.$parent.$refs.Logs.writeLog("未选择同步状态，同步操作已取消!",!1),e.$parent.$refs.Logs.writeLog("开始同步订单，请耐心等待!",!0),r=0;case 6:if(!(r<e.selectMallList.length)){t.next=18;break}a=e.selectMallList[r],n=regeneratorRuntime.mark((function t(n){var o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o={},o="all"===e.syncOrderStatus[n]?{label:"全部",value:"all"}:e.syncStatusList.find((function(t){return t.value===e.syncOrderStatus[n]})),i=new f["a"](a,o,e,e.$parent.$refs.Logs.writeLog),t.next=5,i.start("".concat(r+1,"/").concat(e.selectMallList.length),"manual",e.syncDays);case 5:case"end":return t.stop()}}),t)})),o=0;case 10:if(!(o<e.syncOrderStatus.length)){t.next=15;break}return t.delegateYield(n(o),"t0",12);case 12:o++,t.next=10;break;case 15:r++,t.next=6;break;case 18:e.$parent.$refs.Logs.writeLog("订单同步已完成！！！",!0);case 19:case"end":return t.stop()}}),t)})))()},SyncOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.sycnOrderVisible=!0,t.abrupt("return");case 6:if(r=t.sent,a=r&&JSON.parse(r),a)for(n in a)mallList.push(a[n]);t.next=12;break;case 11:mallList=e.$parent.selectMallList;case 12:if(0!=mallList.length){t.next=15;break}return e.$parent.$refs.Logs.writeLog("店铺数据为空，同步操作已取消!",!1),t.abrupt("return");case 15:e.$parent.$refs.Logs.writeLog("开始同步订单，请耐心等待!",!0),o=0;case 17:if(!(o<mallList.length)){t.next=31;break}i=mallList[o],s=0;case 20:if(!(s<syncStatus.length)){t.next=28;break}return c=syncStatus[s],l=new f["a"](i,c,e,e.$parent.$refs.Logs.writeLog),t.next=25,l.start("".concat(o+1,"/").concat(mallList.length),"manual",60);case 25:s++,t.next=20;break;case 28:o++,t.next=17;break;case 31:e.$parent.$refs.Logs.writeLog("订单同步已完成！！！",!0);case 32:case"end":return t.stop()}}),t)})))()},getProxy:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={},t.next=3,e.$appConfig.getUserInfo();case 3:return a=t.sent,r.uid=a.muid,t.next=7,e.$YipService.GetIpList(JSON.stringify(r));case 7:n=t.sent,o=JSON.parse(n),e.proxyList=o&&o.data||[];case 10:case"end":return t.stop()}}),t)})))()},getBuyerLoginCookies:function(e){try{var t=JSON.parse(e);return t}catch(n){var r=e.split(";");if(r){var a=[];return r.forEach((function(e){var t=e.indexOf("="),r=e.slice(0,t),n=e.slice(t+1);r&&n&&a.push({Name:r,Value:n})})),a}}},handelBtn:function(e,t,r){switch(e){case 1:return this.loginAccount=!0,void this.getProxy();case 2:return void this.SyncOrder();case 3:return void this.syncLogistics();case 4:return void this.$parent[t]();case 5:return void(this.$parent["columnVisible"]=!0);case 6:return void this.batchUpBuyer(1);case 7:return void this.buyerAccount(1);case 8:return this.$parent["multipleSelection"].length?void(this.$parent["pushOrderToStoreVisible"]=!0):this.$message.warning("请先选择商品！");case 9:return this.$parent["multipleSelection"].length?(this.$parent["colorVisible"]=!0,void this.$parent[t]()):this.$message.warning("请先选择需要标记的商品！");case 10:return this.$parent["multipleSelection"].length?void(this.$parent["abroadVisible"]=!0):this.$message.warning("请先选择需要标记的商品！");case 11:return void this.$parent[t]()}t&&(r?this.$parent[t](r):this.$parent[t]())},publicAccount:function(e){switch(e){case 1:return this.pddAccount;case 2:return this.tbAccount;case 8:return this.albbAccount;case 9:return this.lazadaAccount;case 10:return this.jxAccount;case 11:return this.shopeeAccount;case 13:return this.globalAccount;default:return[]}},publicCenter:function(e,t){switch(t){case 1:this.pddUserCenterHandler(e);break;case 2:this.taobaoUserCenter(e);break;case 8:this.AlibabaUserCenter(e);break;case 9:this.lazadaUserCenter(e);break;case 10:this.jingxiUserCenter(e);break;case 11:this.shopeeUserCenter(e);break;default:break}},upBuyerAccountMedia:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={UserNameCache:e.cache_path,Password:"",shotOrderPlatform:t,LoginedCookies:e.loginCookies,UserName:e.name,Cookiestr:JSON.stringify(e.loginCookies),AccountType:e.type,Ua:e.ua,Country:e.country||"",proxyId:r.proxyType},o=n.AccountType+n.UserName,a.next=4,r.$appConfig.UpdateCacheInfo("buyerInfo",o,n);case 4:case"end":return a.stop()}}),a)})))()},changeType:function(e){switch(e){case 1:return b.PinDuoduo;case 2:case 3:return b.TaoBao;case 4:return b.JingDong;case 8:return b.Alibaba;case 9:return b.Lazada;case 10:return b.JingXi;case 11:return b.Shopee;case 13:return b.CrossBorder;default:return b.PinDuoduo}},changeAccountParams:function(e){var t={UserNameCache:e.cache_path,Password:"",shotOrderPlatform:this.changeType(e.type),LoginedCookies:e.login_info,UserName:e.name,Cookiestr:JSON.stringify(e.login_info),AccountType:e.type,Ua:e.ua,Country:e.site||""};return t},pddLoginHandler:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$buyerAccountService){t.next=5;break}return t.next=3,e.$buyerAccountService.pddLogin();case 3:r=t.sent,r&&e.upBuyerAccountList(r,!0);case 5:case"end":return t.stop()}}),t)})))()},pddUserCenterHandler:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=t.gotouser(e),!a){r.next=5;break}return n=t.changeAccountParams(a),r.next=5,t.$buyerAccountService.pddUserCenter(n);case 5:case"end":return r.stop()}}),r)})))()},taobaoLogin:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$buyerAccountService){t.next=5;break}return t.next=3,e.$buyerAccountService.taobaoLogin();case 3:r=t.sent,r&&e.upBuyerAccountList(r,!0);case 5:case"end":return t.stop()}}),t)})))()},taobaoUserCenter:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=t.gotouser(e),!a){r.next=5;break}return n=t.changeAccountParams(a),r.next=5,t.$buyerAccountService.taobaoUserCenter(n);case 5:case"end":return r.stop()}}),r)})))()},jingxiLogin:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$buyerAccountService){t.next=5;break}return t.next=3,e.$buyerAccountService.jingxiLogin();case 3:r=t.sent,r&&e.upBuyerAccountList(r,!0);case 5:case"end":return t.stop()}}),t)})))()},jingxiUserCenter:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=t.gotouser(e),!a){r.next=5;break}return n=t.changeAccountParams(a),r.next=5,t.$buyerAccountService.jingxiUserCenter(n);case 5:case"end":return r.stop()}}),r)})))()},AlibabaLogin:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$buyerAccountService){t.next=5;break}return t.next=3,e.$buyerAccountService.alibabaLogin();case 3:r=t.sent,r&&e.upBuyerAccountList(r,!0);case 5:case"end":return t.stop()}}),t)})))()},AlibabaUserCenter:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=t.gotouser(e),!a){r.next=5;break}return n=t.changeAccountParams(a),r.next=5,t.$buyerAccountService.AlibabaUserCenter(n);case 5:case"end":return r.stop()}}),r)})))()},lazadaLogin:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$buyerAccountService){t.next=5;break}return t.next=3,e.$buyerAccountService.lazadaLogin(e.siteCode);case 3:r=t.sent,r&&0!==r.loginCookies.length&&e.upBuyerAccountList(r,!0);case 5:case"end":return t.stop()}}),t)})))()},lazadaUserCenter:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=t.gotouser(e),!a){r.next=5;break}return n=t.changeAccountParams(a),r.next=5,t.$buyerAccountService.lazadaUserCenter(t.siteCode,n);case 5:case"end":return r.stop()}}),r)})))()},shopeeLogin:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$buyerAccountService){t.next=5;break}return t.next=3,e.$buyerAccountService.shopeeLogin(e.siteCode);case 3:r=t.sent,r&&0!==r.loginCookies.length&&e.upBuyerAccountList(r,!0);case 5:case"end":return t.stop()}}),t)})))()},shopeeUserCenter:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=t.gotouser(e),!a){r.next=5;break}return n=t.changeAccountParams(a),r.next=5,t.$buyerAccountService.shopeeUserCenter(t.siteCode,n);case 5:case"end":return r.stop()}}),r)})))()},gotouser:function(e){var t=null;return e?(this.buyerAccountList.forEach((function(r){r.id===e&&(t=r)})),t):this.$message.error("请选择账户")},batchUpBuyer:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=0;r<e.buyerAccountList.length;r++)a=e.buyerAccountList[r],a["login_info"]=JSON.stringify(a["login_info"]),e.upBuyerAccountList(a);e.$message.success("上传买手号成功!");case 2:case"end":return t.stop()}}),t)})))()},upBuyerAccountList:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n={name:e.name,password:"",type:e.type,site:9===e.type||11===e.type?r.siteCode:"",loginInfo:e.login_info,ua:e.ua,cachePath:e.cache_path,proxyId:r.proxyType},a.next=4,r.$api.upLoadBuyAccount(n);case 4:o=a.sent,i=o.data,200===i.code?(r.updataBuyInfoWeb(n),t&&r.syncLogistics(!0)):r.$message.warning("账户上传失败,请联系客服人员!"),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](0),r.$message.warning("账户上传失败,请联系客服人员!");case 12:case"end":return a.stop()}}),a,null,[[0,9]])})))()},updataBuyInfoWeb:function(e){var t=this.buyerAccountList.findIndex((function(t){return t.type==e.type&&t.name==e.name}));t>-1?(this.buyerAccountList[t].login_info=JSON.parse(e.loginInfo),this.buyerAccountList[t].cache_path=e.cachePath):this.buyerAccount()},buyerAccount:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$api.getBuyerList();case 2:a=r.sent,n=a.data,o=null,200===n.code&&(o=n.data.sort((function(e,t){var r=e["updated_at"].replace(/:/g,"").replace(/-/g,"").replace(" ",""),a=t["updated_at"].replace(/:/g,"").replace(/-/g,"").replace(" ","");return r<a?1:r>a?-1:0})),t.buyerAccountList=o||n.data,t.$parent["buyerAccountList"]=o||n.data,t.defaultSelect(),e&&t.$message.success("账户信息已更新"));case 6:case"end":return r.stop()}}),r)})))()},defaultSelect:function(){this.selectAccount.accountpdd=this.$parent[this.upData].filter((function(e){return 1===e.type}))[0]?this.$parent[this.upData].filter((function(e){return 1===e.type}))[0].id:"",this.selectAccount.accounttaobao=this.$parent[this.upData].filter((function(e){return 2===e.type}))[0]?this.$parent[this.upData].filter((function(e){return 2===e.type}))[0].id:"",this.selectAccount.account1688=this.$parent[this.upData].filter((function(e){return 8===e.type}))[0]?this.$parent[this.upData].filter((function(e){return 8===e.type}))[0].id:"",this.selectAccount.accountjx=this.$parent[this.upData].filter((function(e){return 10===e.type}))[0]?this.$parent[this.upData].filter((function(e){return 10===e.type}))[0].id:"",this.selectAccount.accountlazada=this.$parent[this.upData].filter((function(e){return 9===e.type}))[0]?this.$parent[this.upData].filter((function(e){return 9===e.type}))[0].id:"",this.selectAccount.accountshopee=this.$parent[this.upData].filter((function(e){return 11===e.type}))[0]?this.$parent[this.upData].filter((function(e){return 11===e.type}))[0].id:"",this.selectAccount.accountCrossBorder=this.buyerAccountListGlobal[0]?this.buyerAccountListGlobal[0].id:"",this.accountChange()},removebuyerAccount:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={type:e.activeAccount.type,name:e.activeAccount.name,site:e.activeAccount.site},t.next=3,e.$api.deleteBuyAccount(r);case 3:a=t.sent,n=a.data,200===n.code&&(e.$message.success("买手号删除成功"),e.selectAccount.accountpdd="",e.selectAccount.accountjx="",e.selectAccount.account1688="",e.selectAccount.accountlazada="",e.selectAccount.accountshopee="",e.selectAccount.accounttaobao="",e.buyerAccount());case 6:case"end":return t.stop()}}),t)})))()},decode:function(e){return unescape(e.replace(/\\(u[0-9a-fA-F]{4})/gm,"%$1"))},getPddCoupon:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=[],e.buyerAccountList.forEach((function(e){1===e.type&&r.push(e)})),r.length){t.next=4;break}return t.abrupt("return",e.$message.warning("暂未查询到拼多多账号优惠价"));case 4:return t.next=6,e.$buyerAccountService.pddCouponWindow(r);case 6:t.sent;case 7:case"end":return t.stop()}}),t)})))()},accountChange:function(){return this.$parent.accountpdd=this.selectAccount.accountpdd,this.$parent.accounttaobao=this.selectAccount.accounttaobao,this.$parent.account1688=this.selectAccount.account1688,this.$parent.accountjx=this.selectAccount.accountjx,this.$parent.accountlazada=this.selectAccount.accountlazada,this.$parent.accountshopee=this.selectAccount.accountshopee,this.$parent.accountCrossBorder=this.selectAccount.accountCrossBorder,{accountpdd:this.selectAccount.accountpdd,accounttaobao:this.selectAccount.accounttaobao,account1688:this.selectAccount.account1688,accountjx:this.selectAccount.accountjx,accountlazada:this.selectAccount.accountlazada,accountshopee:this.selectAccount.accountshopee,accountCrossBorder:this.selectAccount.accountCrossBorder}}}},v=_,y=(r("11ed"),r("2877")),w=Object(y["a"])(v,h,m,!1,null,"3ed752f5",null),k=w.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"purchase-info"},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"150px","label-position":"right",rules:e.rules,"inline-message":!0}},[r("el-form-item",{attrs:{label:"采购状态:",prop:"shotStatus"}},[r("el-select",{staticClass:"inputWidth",attrs:{placeholder:"请选择活动区域",size:"mini"},model:{value:e.form.shotStatus,callback:function(t){e.$set(e.form,"shotStatus",t)},expression:"form.shotStatus"}},e._l(e.shotStatuForEdit,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"拍单订单号:",prop:"shotOrderSn"}},[r("el-input",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.form.shotOrderSn,callback:function(t){e.$set(e.form,"shotOrderSn",t)},expression:"form.shotOrderSn"}})],1),r("el-form-item",{attrs:{label:"shopee订单详情链接:"}},[r("el-input",{staticClass:"inputWidth",attrs:{size:"mini",resize:"none",type:"textarea",rows:2},model:{value:e.shopeeLink,callback:function(t){e.shopeeLink=t},expression:"shopeeLink"}})],1),r("p",{staticStyle:{color:"red","margin-bottom":"10px"}},[e._v("注:shopee订单详情链接,请在个人中心订单详情页,右键复制当前链接植入")]),"single"===e.dealType?r("el-form-item",{attrs:{prop:"shotAmountRmb"}},[r("div",{attrs:{slot:"label"},slot:"label"},[r("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini"},on:{change:e.changeAmount},model:{value:e.amountType,callback:function(t){e.amountType=t},expression:"amountType"}},[r("el-option",{attrs:{label:"采购价RMB->采购价",value:1}}),r("el-option",{attrs:{label:"采购价->采购价RMB",value:2}})],1)],1),r("el-input",{staticClass:"inputWidthMini",staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{change:e.changeAmount},model:{value:e.shotAmount,callback:function(t){e.shotAmount=t},expression:"shotAmount"}}),r("span",{staticStyle:{margin:"0 10px"}},[e._v(e._s(1===e.amountType?"元":e.$filters.siteCoin(e.country)))]),r("el-input",{staticClass:"inputWidthMini",attrs:{size:"mini"},model:{value:e.shotAmountRmb,callback:function(t){e.shotAmountRmb=t},expression:"shotAmountRmb"}}),r("span",[e._v(e._s(1===e.amountType?e.$filters.siteCoin(e.country):"元"))])],1):e._e(),"batch"===e.dealType?r("el-form-item",{attrs:{label:"采购价格:",prop:"shotAmountRmb"}},[r("el-input",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.shotAmount,callback:function(t){e.shotAmount=t},expression:"shotAmount"}})],1):e._e(),r("el-form-item",{attrs:{label:"平台类型:",prop:"platformId"}},[r("el-select",{staticClass:"inputWidth",attrs:{placeholder:"请选择活动区域",size:"mini"},on:{change:e.changePlatform},model:{value:e.form.platformId,callback:function(t){e.$set(e.form,"platformId",t)},expression:"form.platformId"}},e._l(e.goodsSourceList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"采购账号:",prop:"buyAccountInfo"}},[r("el-select",{staticClass:"inputWidth",attrs:{placeholder:"请选择活动区域",size:"mini"},model:{value:e.form.buyAccountInfo,callback:function(t){e.$set(e.form,"buyAccountInfo",t)},expression:"form.buyAccountInfo"}},e._l(e.buyerAccountListFilter,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),"single"===e.dealType?r("el-form-item",{attrs:{label:"绑定仓库:",prop:"warehouseName"}},[r("p",[e._v(e._s(e.warehouse?e.warehouse.warehouse_name:""))])]):e._e(),"single"!==e.dealType?r("el-form-item",{attrs:{label:"提示1:"}},[r("span",{staticStyle:{color:"red"}},[e._v("添加采购信息前,请务必确认好已绑定仓库收货地址")])]):e._e(),"single"!==e.dealType?r("el-form-item",{attrs:{label:"提示2:"}},[r("span",{staticStyle:{color:"red"}},[e._v("运输方式修改维度针对于主订单")])]):e._e(),"single"===e.dealType?r("el-form-item",{attrs:{label:"提示:"}},[r("span",{staticStyle:{color:"red"}},[e._v("运输方式修改维度针对于主订单")])]):e._e(),r("el-form-item",{attrs:{label:"运输方式:"}},[r("el-radio-group",{attrs:{size:"mini"},model:{value:e.form.transportType,callback:function(t){e.$set(e.form,"transportType",t)},expression:"form.transportType"}},[r("el-radio",{attrs:{label:"1"}},[e._v("空运")]),r("el-radio",{attrs:{label:"2"}},[e._v("陆运")]),r("el-radio",{attrs:{label:"3"}},[e._v("海运")])],1)],1),r("el-form-item",{attrs:{label:"货物类型:"}},[r("el-radio-group",{attrs:{size:"mini"},model:{value:e.form.packageType,callback:function(t){e.$set(e.form,"packageType",t)},expression:"form.packageType"}},[r("el-radio",{attrs:{label:"1"}},[e._v("普货")]),r("el-radio",{attrs:{label:"2"}},[e._v("敏感货")]),r("el-radio",{attrs:{label:"3"}},[e._v("商检货")])],1)],1),r("div",{staticClass:"base-box"},[r("span",{staticClass:"base-title"},[e._v("备注修改")]),r("div",{staticClass:"base-item"},[r("div",{staticClass:"remark"},[r("span",{staticStyle:{"margin-right":"5px"}},[e._v("备注:")]),r("el-input",{staticStyle:{width:"300px","margin-right":"5px"},attrs:{size:"mini",type:"textarea",resize:"none",rows:2},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}}),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.batchSetRemark}},[e._v("保 存")])],1)])]),r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveBatchSetting}},[e._v("保 存")]),r("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showConsole,callback:function(t){e.showConsole=t},expression:"showConsole"}})],1)],1)],1)},S=[],L=(r("466d"),{name:"PurchaseInfo",props:{chooseData:{type:Array,default:[]},buyerAccountList:{type:Array,default:[]},dealType:{type:String,default:"batch"}},data:function(){return{showConsole:!1,form:{shotOrderSn:"",shotStatus:"",transportType:"1",packageType:"1",platformId:0,shotAmountRmb:0,shotAmount:0,buyAccountInfo:"",remark:""},amountType:1,shotStatuForEdit:l["u"],goodsSourceList:l["l"],buyerAccountListFilter:[],rules:{shotOrderSn:[{required:!0,message:"拍单订单号必填",trigger:"blur"}],shotStatus:[{required:!0,message:"请选择状态",trigger:"change"}],platformId:[{required:!0,message:"请选择平台类型",trigger:"change"}],buyAccountInfo:[{required:!0,message:"买手号不能为空",trigger:"change"}]},shopeeLink:"",remark:"",shotAmount:"",shotAmountRmb:"",rateList:[],country:"",warehouse:{},warehouseList:[],loading:!1,shopeeLinks:{MY:"https://shopee.com.my",TW:"https://shopee.tw",VN:"https://shopee.vn",ID:"https://shopee.co.id",PH:"https://shopee.ph",TH:"https://shopee.co.th",SG:"https://shopee.sg",BR:"https://shopee.com.br"}}},mounted:function(){this.getRate();var e=this.chooseData[0];this.form.platformId=Number(e.goods_info.ori_platform_id),this.changePlatform(this.form.platformId),"single"===this.dealType&&(this.form.shotOrderSn=e.shot_order_info.shot_order_sn,this.form.shotStatus=e.shot_order_info.shot_status,this.form.shotAmount=e.shot_order_info.shot_amount,this.form.shotAmountRmb=e.shot_order_info.shot_amount_rmb,this.form.buyAccountInfo=e.shot_order_info.buy_account,this.country=e.country,this.shotAmount=e.shot_order_info.shot_amount_rmb,this.shotAmountRmb=e.shot_order_info.shot_amount,11===this.form.platformId&&(e.shot_order_info.buy_account_info&&e.shot_order_info.buy_account_info.orderType&&e.shot_order_info.buy_account_info.orderId?this.shopeeLink="".concat(this.shopeeLinks[e.country],"/user/purchase/order/").concat(e.shot_order_info.buy_account_info.orderId,"?type=").concat(e.shot_order_info.buy_account_info.orderType):e.shot_order_info.shop_id&&e.shot_order_info.buy_account_info.orderId&&(this.shopeeLink="".concat(this.shopeeLinks[e.country],"user/purchase/order/").concat(e.shot_order_info.buy_account_info.orderId,"/?shopid=").concat(e.shot_order_info.shop_id))),this.getWareHouse(e.mall_info.platform_mall_id,e.goods_info.ori_platform_id))},methods:{getWareHouse:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,r.$appConfig.getWarehouseInfo(e);case 2:n=a.sent,r.warehouseList=n&&"{}"!==n&&JSON.parse(n)||[],[1,2,3,5,8,10].indexOf(Number(t))>-1?r.warehouse=r.warehouseList.find((function(e){return 0==e.type})):[9,11,12,15,13].indexOf(Number(t))>-1&&(r.warehouse=r.warehouseList.find((function(e){return 3==e.type}))),!r.warehouse&&r.warehouseList.length&&(r.warehouse=r.warehouseList[0]);case 6:case"end":return a.stop()}}),a)})))()},getRate:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window["ConfigBridgeService"].getUserInfo();case 2:r=t.sent,e.rateList=r.ExchangeRates||{};case 4:case"end":return t.stop()}}),t)})))()},changeAmount:function(){1===this.amountType?(this.form.shotAmountRmb=this.shotAmount,this.form.shotAmount=(Number(this.shotAmount)/Number(this.rateList[this.country.toUpperCase()])).toFixed(2),this.shotAmountRmb=(Number(this.shotAmount)/Number(this.rateList[this.country.toUpperCase()])).toFixed(2)):(this.form.shotAmount=this.shotAmount,this.form.shotAmountRmb=(Number(this.shotAmount)*Number(this.rateList[this.country.toUpperCase()])).toFixed(2),this.shotAmountRmb=(Number(this.shotAmount)*Number(this.rateList[this.country.toUpperCase()])).toFixed(2))},changePlatform:function(e){this.form.buyAccountInfo="",this.buyerAccountListFilter=this.buyerAccountList.filter((function(t){return t.type==e}))},dealWithShopeeLink:function(e){var t={},r=e.match(/shopid=(\d+)/);r&&(t["shopId"]=r[1]);var a=e.match(/order\/(\d+)/);a&&(t["orderId"]=a[1]);var n=e.match(/type=(\d+)/);return n&&(t["orderType"]=n[1]),t},batchSetRemark:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.chooseData.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先选择需要标记的商品！"));case 2:r=Object(i["a"])(e.chooseData),t.prev=3,r.s();case 5:if((a=r.n()).done){t.next=14;break}return n=a.value,o={id:n.id,remark:e.remark},t.next=10,e.$api.setLocalRemark(o);case 10:s=t.sent,200===s.data.code?e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】备注成功"),!0):e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】备注失败-").concat(s.data.message),!1);case 12:t.next=5;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](3),r.e(t.t0);case 19:return t.prev=19,r.f(),t.finish(19);case 22:e.$emit("close"),e.showConsole=!0;case 24:case"end":return t.stop()}}),t,null,[[3,16,19,22]])})))()},saveBatchSetting:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs["form"].validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n,o,i,s,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",!1);case 2:if(0!=e.shotAmount){t.next=4;break}return t.abrupt("return",e.$message.error("采购价不能为零"));case 4:a={},e.form.buyAccountInfo&&(n=e.buyerAccountListFilter.find((function(t){return t.name==e.form.buyAccountInfo&&t.type==e.form.platformId})),a={name:n.name,type:n.type}),t.prev=6,o=0;case 8:if(!(o<e.chooseData.length)){t.next=33;break}if(i=e.chooseData[o],e.form.shotAmount=(Number(e.form.shotAmountRmb)/Number(e.rateList[i.country.toUpperCase()])).toFixed(2),s=JSON.parse(JSON.stringify(e.form)),s.sysOrderId=i.id,s.platformId=s.platformId.toString(),s.shotStatus=s.shotStatus.toString(),11!=e.form.platformId||""!==e.shopeeLink){t.next=17;break}return t.abrupt("return",e.$message.warning("采购链接不能为空"));case 17:if("batch"===e.dealType&&(s.shotAmountRmb=e.shotAmount,s.shotAmount=(Number(e.shotAmount)/Number(e.rateList[i.country.toUpperCase()])).toFixed(2)),e.shopeeLink&&(c=e.dealWithShopeeLink(e.shopeeLink),s.shopId=c.shopId||"",a["orderId"]=c.orderId||"",a["orderType"]=c.orderType||""),s.buyAccountInfo=JSON.stringify(a),s.markStatus="0","single"!==e.dealType){t.next=25;break}if(e.warehouse){t.next=24;break}return t.abrupt("return",e.$message.warning("没有绑定正确的仓库"));case 24:s.warehouseUserId=e.warehouse.id||"";case 25:return e.loading=!0,t.next=28,e.$api.updateShotOrder(s);case 28:l=t.sent,200===l.data.code?o===e.chooseData.length-1&&(e.$message.success("设置成功!"),e.$emit("close")):(e.loading=!1,e.$message.error("设置失败-".concat(l.data.message)));case 30:o++,t.next=8;break;case 33:t.next=39;break;case 35:return t.prev=35,t.t0=t["catch"](6),e.loading=!1,t.abrupt("return",e.$message.error("发生错误，请重试,".concat(t.t0)));case 39:case"end":return t.stop()}}),t,null,[[6,35]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}}}),C=L,O=(r("47af"),Object(y["a"])(C,x,S,!1,null,"3d89026c",null)),T=O.exports,R=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"push-order"},[r("p",[e._v("温馨提示: 1:请务必确认当前订单对应店铺绑定的仓库是否正确")]),r("p",[e._v("温馨提示: 2:若店铺同时绑定了国内仓和海外仓,则通过采购平台区分(lazada和shopee默认为海外仓,其余默认国内仓,自有商品无法识别)")]),r("p",[e._v("温馨提示: 3:若店铺绑定的为自有仓库,请重新绑定仓库,否则无法将数据同步至仓库,将导致您的商品无法出库!!!")]),r("el-table",{ref:"muliTbale",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",height:"500"}},[r("el-table-column",{attrs:{"min-width":"80px",label:"站点",prop:"country",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.mall_info?[e._v(e._s(e._f("chineseSite")(t.row.mall_info.country)))]:void 0}}],null,!0)}),r("el-table-column",{attrs:{"min-width":"160px",label:"店铺名称",prop:"platform_mall_name",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.mall_info?[e._v(e._s(t.row.mall_info.mall_alias_name||t.row.mall_info.platform_mall_name))]:void 0}}],null,!0)}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"采购类型","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.sourceName.join("/")))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"仓库类型","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.sourceStoreType?[e._v(e._s(t.row.sourceStoreType))]:void 0}}],null,!0)}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"当前绑定仓库","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.sourceNameStr?[e._v(e._s(t.row.sourceNameStr))]:void 0}}],null,!0)}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"是否可同步","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.sourceNameStr?"是":"否"))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"主订单数","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.orderIDs.length))]}}])}),r("el-table-column",{attrs:{align:"center",label:"提示",width:"150","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.warn))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"操作","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.chooseStore(t.row,t.$index)}}},[e._v("选择仓库")])]}}])})],1),r("div",{staticClass:"btn"},[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.pushOrder}},[e._v("确 定")])],1),e.storeChooseVisible?r("el-dialog",{attrs:{title:"选择仓库",visible:e.storeChooseVisible,width:"400px","append-to-body":""},on:{"update:visible":function(t){e.storeChooseVisible=t}}},[r("div",[r("div",{staticClass:"item"},[r("span",[e._v("店铺名称:")]),r("p",[e._v(e._s(e.chooseRow.mall_info.mall_alias_name||e.chooseRow.mall_info.platform_mall_name))])]),r("div",{staticClass:"item"},[r("span",[e._v("系统仓库:")]),r("el-select",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.sysStore,callback:function(t){e.sysStore=t},expression:"sysStore"}},e._l(e.sysStoreList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.warehouse_name,value:e.warehouse_id}})})),1)],1)]),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.addStore(e.activeIndex)}}},[e._v("确定")])],1)]):e._e()],1)},I=[],A={name:"PushOrder",data:function(){return{goodsSourceList:l["l"],storeChooseVisible:!1,sysStore:"",mallName:"",sysStoreList:[],sysStoreListAll:[],tableData:[],activeIndex:-1}},props:{chooseData:{type:Array,default:[]}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getUserWarehouse();case 2:e.dealWithOrder(e.chooseData);case 3:case"end":return t.stop()}}),t)})))()},methods:{addStore:function(e){this.tableData[e].storeId=this.sysStore,this.storeChooseVisible=!1},pushOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=regeneratorRuntime.mark((function t(r){var a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.tableData[r],a.storeId||a.sourceNameStr){t.next=6;break}return e.$set(e.tableData[r],"warn","请先绑定".concat(e.tableData[r].sourceStoreType,"库")),t.abrupt("return","continue");case 6:if(n=[],a.orderIDs.forEach((function(e){var t={sysOrderId:e,warehouseUserId:a.storeId||a.sourceWarehouseId};n.push(t)})),!n.length){t.next=14;break}return o={lists:n},t.next=12,e.$api.uploadWarehouseOrder(o);case 12:i=t.sent,200===i.data.code?(i.data.data.success.length&&e.$set(a,"warn",i.data.data.success.join(",")),i.data.data.errors.length&&e.$set(e.tableData[r],"warn",i.data.data.errors.join(","))):e.$set(e.tableData[r],"warn",i.data.message);case 14:case"end":return t.stop()}}),t)})),a=0;case 2:if(!(a<e.tableData.length)){t.next=10;break}return t.delegateYield(r(a),"t0",4);case 4:if(n=t.t0,"continue"!==n){t.next=7;break}return t.abrupt("continue",7);case 7:a++,t.next=2;break;case 10:case"end":return t.stop()}}),t)})))()},dealWithOrder:function(e){var t=e.filter((function(e){return[1,2,3,5,8,10].indexOf(Number(e.goods_info.ori_platform_id))>-1})),r=e.filter((function(e){return[9,11,12,15,13].indexOf(Number(e.goods_info.ori_platform_id))>-1})),a=this.uniqueArr(t,"国内仓",0),n=this.uniqueArr(r,"国外仓",3);this.tableData=a.concat(n)},uniqueArr:function(e,t,r){var a,n=this,s=new Map,c=Object(i["a"])(e);try{var u=function(){var e=a.value;e.orderIDs=[],e.sourceName=[],e.sourceStoreType=t;var o=n.sysStoreListAll.find((function(t){return t.mall_info_ids.indexOf(e.mall_info.platform_mall_id)>-1&&t.type==r}));if(e.sourceNameStr=o&&o.warehouse_name,e.sourceWarehouseId=o&&o.warehouse_id,s.has(e.sys_mall_id)){var i=s.get(e.sys_mall_id);i.orderIDs.push(e.id),-1==i.sourceName.indexOf(Object(l["y"])(e.goods_info.ori_platform_id))&&i.sourceName.push(Object(l["y"])(e.goods_info.ori_platform_id))}else e.orderIDs.push(e.id),-1==e.sourceName.indexOf(Object(l["y"])(e.goods_info.ori_platform_id))&&e.sourceName.push(Object(l["y"])(e.goods_info.ori_platform_id)),s.set(e.sys_mall_id,e)};for(c.s();!(a=c.n()).done;)u()}catch(d){c.e(d)}finally{c.f()}return Object(o["a"])(s.values())},getUserWarehouse:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.getUserWarehouse();case 2:r=e.sent,200===r.data.code&&(t.sysStoreListAll=r.data.data.filter((function(e){return 1===e.warehouse_status&&e.mallInfo&&e.mallInfo.length>0}))),t.sysStoreListAll.forEach((function(e){e.mall_info_ids=[],e.mallInfo.forEach((function(t){e.mall_info_ids.push(t.platform_mall_id)}))}));case 5:case"end":return e.stop()}}),e)})))()},chooseStore:function(e,t){this.storeChooseVisible=!0,this.chooseRow=e,this.sysStoreList=this.sysStoreListAll.filter((function(t){return t.mall_info_ids.indexOf(e.mall_info.platform_mall_id)>-1})),this.sysStore="",this.activeIndex=t},changeTypeName:function(e,t){var r=t.find((function(t){return t.value===e}));return r&&r.label||""}}},$=A,D=(r("8bfc"),Object(y["a"])($,R,I,!1,null,"71c06c33",null)),N=D.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"out-store"},[r("div",{staticClass:"out-header"},[r("span",[e._v(e._s(e.clickNum)+"/"+e._s(e.chooseData.length))]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.goNext}},[e._v(e._s(e.clickNum==e.chooseData.length?"关闭":"匹配下一单")+" ")]),"3"===e.outStoreType||"4"===e.outStoreType?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.getSheetInfo}},[e._v(" 获取面单信息 ")]):e._e(),r("span",{staticClass:"warning-style"},[e._v(e._s(e.flagText))]),r("p",[e._v("温馨提示: 1、请确保该主订单下所有子订单商品在海外仓都有库存，如果只有部分订单有库存商品，请不要出库，否则会导致没有库存的商品无法发货；")]),r("p",[e._v("温馨提示: 2、商品出库前，请确保平台物流和面单已申请")]),r("p",[e._v("温馨提示: 3、共享库存暂不能作为赠品进行出库")])],1),r("div",{staticClass:"order-content"},[r("div",{staticClass:"content-left"},[r("div",{staticClass:"order-box"},[r("span",{staticClass:"order-title"},[e._v("订单商品信息")]),r("div",{staticClass:"order-item"},[r("el-table",{ref:"muliTbale",staticStyle:{width:"100%"},attrs:{data:e.orderList,"tooltip-effect":"dark",height:"200"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号","min-width":"50px"}}),r("el-table-column",{attrs:{"min-width":"120px",label:"订单编号",prop:"order_sn",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"订单状态",prop:"order_status",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.order_status?[e._v(" "+e._s(e.changeOrderStatus(t.row.order_status))+" ")]:void 0}}],null,!0)}),r("el-table-column",{attrs:{"min-width":"120px",label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{width:"120px",label:"SKUID",prop:"variation_id",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{"min-width":"120px",label:"商品规格",prop:"variation_sku",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.variation_sku||t.row.variation_name))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"goods_count",label:"商品数量",width:"80"}}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"商品图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{staticStyle:{width:"56px",height:"56px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e._f("imageRender")([t.row.goods_img])}})],1),r("el-image",{staticStyle:{width:"56px",height:"56px"},attrs:{src:e._f("imageRender")([t.row.goods_img,!0])}})],1)]}}])}),r("el-table-column",{attrs:{align:"center",prop:"escrow_amount",label:"订单收入",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.escrow_amount)+e._s(e._f("siteCoin")(t.row.country)))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticStyle:{display:"flex","justify-content":"center"}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){e.isGift=!1,e.selfGoodsStoreVisible=!0,e.addGiftAbroad="",e.clickRow=t.row,e.country=t.row.country}}},[e._v("匹配商品 ")]),"3"==e.outStoreType||"4"==e.outStoreType?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){e.isGift=!0,e.selfGoodsStoreVisible=!0,e.addGiftAbroad="gift",e.clickRow=t.row}}},[e._v("添加赠品 ")]):e._e()],1)]}}])})],1)],1)]),r("div",{staticClass:"order-box mar-top"},[r("span",{staticClass:"order-title"},[e._v("匹配商品信息")]),r("div",{staticClass:"order-item"},[r("el-table",{ref:"muliTbale2",staticStyle:{width:"100%"},attrs:{data:e.matchOrderList,"tooltip-effect":"dark",height:"300"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号","min-width":"50px"}}),r("el-table-column",{attrs:{width:"140px",label:"匹配订单号",prop:"orderSn",align:"center"}}),r("el-table-column",{attrs:{width:"120px",label:"商品编号",prop:"sku_id",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{width:"80px",label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{width:"80px",label:"商品规格",prop:"sku_name",align:"center"}}),r("el-table-column",{attrs:{align:"center",prop:"stock_num",label:"可用库存",width:"80"}}),r("el-table-column",{attrs:{align:"center",prop:"outStock",label:"出库数量","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{size:"mini"},on:{input:function(r){return e.setOutStock(t.row,t.$index)}},model:{value:e.outStock[t.$index],callback:function(r){e.$set(e.outStock,t.$index,r)},expression:"outStock[scope.$index]"}})]}}])}),r("el-table-column",{attrs:{width:"120px",label:"商品单价(RMB)",prop:"sku_price",align:"center"}}),r("el-table-column",{attrs:{label:"商品图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e.row.sku_image}})]}}])}),r("el-table-column",{attrs:{align:"center",prop:"ori_platform_id",label:"是否赠品",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.isGift?"是":"否"))]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.deleteMatchData(t.$index)}}},[e._v("删除")])]}}])})],1)],1)]),r("div",{staticClass:"order-btn"},[r("span",{staticClass:"mar-right"},[e._v("出库数")]),r("span",{staticClass:"mar-right activeColor"},[e._v(e._s(e.outTotalStock))]),r("span",{staticClass:"mar-right"},[e._v("出库总价（RMB）")]),r("span",{staticClass:"mar-right activeColor"},[e._v(e._s(e.outTotalPriceRmb))]),r("span",{staticClass:"mar-right"},[e._v("出库总价")]),r("span",{staticClass:"mar-right activeColor"},[e._v(e._s(e.outTotalPrice)+e._s(e._f("siteCoin")(e.orderInfo.country)))]),r("el-button",{attrs:{size:"mini",type:"primary",disabled:!e.matchOrderList.length||e.clickNum===e.chooseData.length&&"出库成功"===e.flagText},on:{click:e.outStore}},[e._v("立即下单 ")])],1)]),r("div",{staticClass:"content-right"},[r("div",{staticClass:"order-box"},[r("span",{staticClass:"order-title"},[e._v("订单信息")]),r("div",{staticClass:"order-item"},[r("div",{staticClass:"order-content-right"},[r("div",{staticClass:"item"},[r("span",[e._v("订单编号")]),r("p",{staticClass:"content"},[e._v(e._s(e.orderInfo.main_order_sn))])]),r("div",{staticClass:"item"},[r("span",[e._v("当前站点")]),r("p",{staticClass:"content"},[e._v(e._s(e._f("chineseSite")(e.orderInfo.country)))])]),r("div",{staticClass:"item"},[r("span",[e._v("买家姓名")]),e.orderInfo.receiver_info?r("p",{staticClass:"content"},[e._v(e._s(e.orderInfo.receiver_info.name))]):e._e()]),r("div",{staticClass:"item"},[r("span",[e._v("买家电话")]),e.orderInfo.receiver_info?r("p",{staticClass:"content"},[e._v(e._s(e.orderInfo.receiver_info.phone))]):e._e()]),r("div",{staticClass:"item"},[r("span",[e._v("买家地址")]),e.orderInfo.receiver_info?r("p",{staticClass:"content"},[e._v(e._s(e.orderInfo.receiver_info.address))]):e._e()]),r("div",{staticClass:"item"},[r("span",[e._v("物流公司")]),r("p",{staticClass:"content"},[e._v(e._s(e.orderInfo.logistics_name))])]),r("div",{staticClass:"item"},[r("span",[e._v("物流单号")]),r("p",{staticClass:"content"},[e._v(e._s(e.orderInfo.tracking_no))])]),r("div",{staticClass:"item"},[r("span",[e._v("订单收入")]),e.income?r("p",{staticClass:"content"},[e._v(e._s(e.income.toFixed(2))+e._s(e._f("siteCoin")(e.orderInfo.country))+" ("+e._s(e.incomeRmb.toFixed(2))+"元)")]):e._e()])])])]),r("div",{staticClass:"item"},[r("span",[e._v("毛利")]),r("p",{staticClass:"content color"},[e._v(e._s(e.grossProfit)+"元")])]),r("div",{staticClass:"item"},[r("span",[e._v("利率")]),r("p",{staticClass:"content color"},[e._v(e._s(e.interestRate)+"%")])])])]),e.selfGoodsStoreVisible?r("el-dialog",{attrs:{visible:e.selfGoodsStoreVisible,width:"1200px","append-to-body":"",top:"5vh"},on:{"update:visible":function(t){e.selfGoodsStoreVisible=t}}},[r("div",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.title[Number(e.outStoreType)]))]),r("div",{staticClass:"go-out-store"},["1"===e.outStoreType?r("self-goods-store",{on:{getChooseData:e.getChooseData}}):e._e(),"2"===e.outStoreType?r("product-goods-store",{on:{getChooseData:e.getChooseData}}):e._e(),"3"===e.outStoreType?r("abroad-goods-store",{attrs:{"add-gift-abroad":e.addGiftAbroad},on:{getChooseData:e.getChooseData}}):e._e(),"4"===e.outStoreType?r("inLand-goods-store",{on:{getChooseData:e.getChooseData}}):e._e()],1)]):e._e()],1)},j=[],z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"self-store"},[r("div",{staticClass:"btn-header"},[r("div",{staticClass:"item-box mar-right"},[r("span",[e._v("创建时间：")]),r("el-date-picker",{staticStyle:{width:"240px"},attrs:{size:"mini","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.searchTime,callback:function(t){e.searchTime=t},expression:"searchTime"}})],1),r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"60px"}},[e._v("站点：")]),r("el-select",{attrs:{size:"mini",filterable:""},on:{change:e.searchTableList},model:{value:e.countryVal,callback:function(t){e.countryVal=t},expression:"countryVal"}},[r("el-option",{attrs:{label:"全部",value:""}}),e._l(e.countries,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.searchTableList}},[e._v("搜 索")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{data:e.tableData,"tooltip-effect":"dark","max-height":"500"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((e.currentPage-1)*e.pageSize+t.$index+1))]}}])}),r("el-table-column",{attrs:{align:"center",type:"index",label:"站点",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("chineseSite")(t.row.country)))])]}}])}),r("el-table-column",{attrs:{width:"120px",label:"商品ID",prop:"goods_id_id",align:"center"}}),r("el-table-column",{attrs:{width:"120px",label:"SKUID",prop:"sku_id",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{width:"80px",label:"商品规格",prop:"sku_name",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"库存数量",prop:"stock_num",align:"center"}}),r("el-table-column",{attrs:{width:"120px",label:"商品单价(RMB)",prop:"sku_price",align:"center"}}),r("el-table-column",{attrs:{"min-width":"80",label:"商品链接",prop:"goods_url",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.goods_url?r("div",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.$BaseUtilService.openUrl(t.row.goods_url)}}},[e._v("查看商品")])],1):e._e()]}}])}),r("el-table-column",{attrs:{label:"商品图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return e.row.sku_image?[r("el-tooltip",{staticStyle:{width:"32px",height:"32px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.row.sku_image}})],1),r("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:e.row.sku_image}})],1)]:void 0}}],null,!0)}),r("el-table-column",{attrs:{label:"操作","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.addTo(t.row)}}},[e._v("添加到出库单")])]}}])})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)},B=[],M={name:"SelfGoodsStore",data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},tableData:[],total:0,pageSize:20,currentPage:1,countries:this.$filters.countries_option,countryVal:"",searchTime:[],tableLoading:!1}},mounted:function(){this.searchTime=Object(d["f"])(30),this.searchTableList()},methods:{addTo:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$emit("getChooseData",e);case 1:case"end":return r.stop()}}),r)})))()},searchTableList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableData=[],r={country:e.countryVal,createTime:""},r.createTime=e.$dayjs(e.searchTime[0]).format("YYYY-MM-DD")+" 00:00:00/"+e.$dayjs(e.searchTime[1]).format("YYYY-MM-DD")+" 23:59:59",r["page"]=e.currentPage,r["pageSize"]=e.pageSize,e.tableLoading=!0,t.next=8,e.$api.getUserStore(r);case 8:a=t.sent,a&&200===a.data.code?(e.total=a.data.data.total,n=a.data.data.data,n.forEach((function(t){t.user_stocks_skus.forEach((function(r){var a={goods_id:t.id,goods_name:t.goods_name,goods_url:t.goods_url,country:t.country,goods_id_id:t.goods_id};a=Object.assign(a,r),e.tableData.push(a)}))}))):e.$message.error(a.data.message),e.tableLoading=!1;case 11:case"end":return t.stop()}}),t)})))()},totalStock:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r].stock_num;return t},handleCurrentChange:function(e){this.currentPage=e,this.searchTableList()},handleSizeChange:function(e){this.pageSize=e,this.searchTableList()}}},V=M,U=(r("5a6a"),Object(y["a"])(V,z,B,!1,null,"e670eccc",null)),G=U.exports,E=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"product-store"},[r("div",{staticClass:"btn-header"},[r("div",{staticClass:"item-box mar-right"},[r("span",[e._v("创建时间：")]),r("el-date-picker",{staticStyle:{width:"230px"},attrs:{size:"mini","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.searchTime,callback:function(t){e.searchTime=t},expression:"searchTime"}})],1),r("div",{staticClass:"item-box"},[r("span",[e._v("商品名称:")]),r("el-input",{staticClass:"inputBox",attrs:{size:"mini",clearable:""},model:{value:e.goodsName,callback:function(t){e.goodsName=t},expression:"goodsName"}})],1),r("div",{staticClass:"item-box"},[r("span",[e._v("商品ID:")]),r("el-input",{staticClass:"inputBox",attrs:{size:"mini",clearable:""},model:{value:e.goodsCode,callback:function(t){e.goodsCode=t},expression:"goodsCode"}})],1),r("div",{staticClass:"item-box"},[r("span",[e._v("SKUID:")]),r("el-input",{staticClass:"inputBox",attrs:{size:"mini",clearable:""},model:{value:e.skuCode,callback:function(t){e.skuCode=t},expression:"skuCode"}})],1),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.searchTableList}},[e._v("搜 索")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{data:e.tableData,"tooltip-effect":"dark",height:"500"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((e.currentPage-1)*e.pageSize+t.$index+1))]}}])}),r("el-table-column",{attrs:{align:"center",type:"index",label:"站点",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("产品中心")])]}}])}),r("el-table-column",{attrs:{width:"120px",label:"商品ID",prop:"product_id",align:"center"}}),r("el-table-column",{attrs:{width:"130px",label:"SKUID",prop:"sku_id",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{width:"80px",label:"商品规格",prop:"sku_name",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"库存数量",prop:"stock_num",align:"center"}}),r("el-table-column",{attrs:{width:"120px",label:"商品单价(RMB)",prop:"sku_price",align:"center"}}),r("el-table-column",{attrs:{"min-width":"80",label:"商品链接",prop:"goods_url",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.goods_url?r("div",[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("查看商品")])],1):e._e()]}}])}),r("el-table-column",{attrs:{label:"商品图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return e.row.sku_image?[r("el-tooltip",{staticStyle:{width:"32px",height:"32px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.row.sku_image}})],1),r("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:e.row.sku_image}})],1)]:void 0}}],null,!0)}),r("el-table-column",{attrs:{label:"操作","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.addTo(t.row)}}},[e._v("添加到出库单")])]}}])})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)},F=[],W={name:"ProductGoodsStore",data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},tableData:[],total:0,pageSize:20,currentPage:1,searchTime:[],goodsName:"",goodsCode:"",skuCode:"",tableLoading:!1}},mounted:function(){this.searchTime=Object(d["f"])(30),this.searchTableList()},methods:{addTo:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$emit("getChooseData",e);case 1:case"end":return r.stop()}}),r)})))()},searchTableList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableData=[],r={ProductName:e.goodsName,ProductId:e.goodsCode,SkuId:e.skuCode,CateId:0,Status:"-1"},r["page"]=e.currentPage,r["pageSize"]=e.pageSize,e.tableLoading=!0,t.next=7,e.$commodityService.getProductList(r);case 7:a=t.sent,n=a&&JSON.parse(a),200===n.status_code&&(e.total=n.data.total,o=n.data.data,o.forEach(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getProductSkuList(r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.tableLoading=!1;case 11:case"end":return t.stop()}}),t)})))()},getProductSkuList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$commodityService.getProductSkuList(e.product_id);case 2:a=r.sent,n=a&&JSON.parse(a),200===n.status_code&&(o=n.data,o.forEach((function(r){r.goods_name=e.product_name,r.stock_num=r.stock,r.sku_price=r.price,r.sku_image=r.image_url,r.id=r.Id,t.tableData.push(r)})));case 5:case"end":return r.stop()}}),r)})))()},totalStock:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r].stock_num;return t},handleCurrentChange:function(e){this.currentPage=e,this.searchTableList()},handleSizeChange:function(e){this.pageSize=e,this.searchTableList()}}},J=W,H=(r("c96c"),Object(y["a"])(J,E,F,!1,null,"3d924250",null)),Y=H.exports,Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"inland-store"},[r("div",{staticClass:"btn-header"},[r("div",{staticClass:"item-box mar-right"},[r("span",[e._v("仓库名称：")]),r("el-select",{attrs:{size:"mini",filterable:""},on:{change:e.searchTableList},model:{value:e.wid,callback:function(t){e.wid=t},expression:"wid"}},e._l(e.widList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.warehouse_name,value:e.wid}})})),1)],1),r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"80px"}},[e._v("商品编号:")]),r("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.sku_id,callback:function(t){e.sku_id=t},expression:"sku_id"}})],1),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.searchTableList}},[e._v("搜 索")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{data:e.tableData,"tooltip-effect":"dark",height:"500"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((e.currentPage-1)*e.pageSize+t.$index+1))]}}])}),r("el-table-column",{attrs:{align:"center",type:"index",label:"仓库名称",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.changeName(t.row.wid)))])]}}])}),r("el-table-column",{attrs:{width:"120px",label:"系统商品ID",prop:"id",align:"center"}}),r("el-table-column",{attrs:{width:"130px",label:"商品ID",prop:"sku_id",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{width:"80px",label:"商品规格",prop:"sku_name",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"库存数量",prop:"stock_num",align:"center"}}),r("el-table-column",{attrs:{width:"120px",label:"商品单价(RMB)",prop:"sku_price",align:"center"}}),r("el-table-column",{attrs:{"min-width":"80",label:"商品链接",prop:"goods_url",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.goods_url?r("div",[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("查看商品")])],1):e._e()]}}])}),r("el-table-column",{attrs:{label:"商品图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return e.row.sku_image?[r("el-tooltip",{staticStyle:{width:"32px",height:"32px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.row.sku_image}})],1),r("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:e.row.sku_image}})],1)]:void 0}}],null,!0)}),r("el-table-column",{attrs:{label:"操作","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.addTo(t.row)}}},[e._v("添加到出库单")])]}}])})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)},K=[],q={name:"InLandGoodsStore",data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},tableData:[],total:0,pageSize:20,currentPage:1,wid:"",widList:[],sku_id:"",tableLoading:!1}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getWareHouseList();case 2:return t.next=4,e.searchTableList();case 4:case"end":return t.stop()}}),t)})))()},methods:{changeName:function(e){var t=this.widList.find((function(t){return t.wid==e}));return t?t.warehouse_name:""},getWareHouseList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$appConfig.getUserInfo();case 2:return r=t.sent,t.next=5,e.$api.getWarehouseList();case 5:a=t.sent,200===a.data.code&&(n=a.data.data||[],o=n.filter((function(e){return 2!=e.status||e.user_ids&&e.user_ids.indexOf(r.muid)>-1})),e.widList=o.length?o:n,e.wid=e.widList[0].wid||"");case 7:case"end":return t.stop()}}),t)})))()},addTo:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$emit("getChooseData",e);case 1:case"end":return r.stop()}}),r)})))()},searchTableList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={wid:e.wid,sku_id:e.sku_id},r["page"]=e.currentPage,r["page_size"]=e.pageSize,e.tableLoading=!0,t.next=6,e.$XzyNetMessageService.post("xzy.shopifyV2.get_stock",r);case 6:a=t.sent,n=a&&JSON.parse(a),o=n&&JSON.parse(n.data),o&&200===o.code&&(e.total=o.data.total,i=o.data.data,i.forEach(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.stock_num=t.stock-t.frozen_num;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.tableData=i),e.tableLoading=!1;case 11:case"end":return t.stop()}}),t)})))()},handleCurrentChange:function(e){this.currentPage=e,this.searchTableList()},handleSizeChange:function(e){this.pageSize=e,this.searchTableList()}}},Q=q,X=(r("5855"),Object(y["a"])(Q,Z,K,!1,null,"44135f26",null)),ee=X.exports,te=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"abroad-store"},[r("div",[r("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"我的海外仓库存列表",name:"myStore"}}),"gift"!==e.addGiftAbroad?r("el-tab-pane",{attrs:{label:"共享我的海外仓库存",name:"shareStore"}}):e._e()],1)],1),r("div",{staticClass:"btn-header"},[r("div",{staticClass:"item-box mar-right"},[r("span",[e._v("仓库名称：")]),r("el-select",{attrs:{size:"mini",filterable:""},on:{change:e.searchTableList},model:{value:e.wid,callback:function(t){e.wid=t},expression:"wid"}},[r("el-option",{attrs:{label:"全部",value:"0"}}),e._l(e.widList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.warehouse_name,value:e.id}})}))],2)],1),r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"90px"}},[e._v("系统商品编号:")]),r("el-input",{staticClass:"inputWidth",attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.sys_sku_id,callback:function(t){e.sys_sku_id=t},expression:"sys_sku_id"}})],1),"myStore"===e.activeName?r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"60px"}},[e._v("商品编号:")]),r("el-input",{staticClass:"inputWidth",attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.sku_id,callback:function(t){e.sku_id=t},expression:"sku_id"}})],1):e._e(),"myStore"===e.activeName?r("div",{staticClass:"item-box"},[r("span",{staticStyle:{width:"60px"}},[e._v("商品规格:")]),r("el-input",{staticClass:"inputWidth",attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.sku_name,callback:function(t){e.sku_name=t},expression:"sku_name"}})],1):e._e(),"myStore"===e.activeName?r("div",{staticClass:"item-box"},[r("el-checkbox",{model:{value:e.isFilter,callback:function(t){e.isFilter=t},expression:"isFilter"}},[e._v("过滤0库存")])],1):e._e(),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.searchTableList}},[e._v("搜 索")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{data:e.tableData,"tooltip-effect":"dark",height:"500"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((e.currentPage-1)*e.pageSize+t.$index+1))]}}])}),r("el-table-column",{attrs:{align:"center",type:"index",label:"仓库名称",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.changeName(t.row.wid)))])]}}])}),r("el-table-column",{attrs:{width:"120px",label:"系统商品编号",prop:"sys_sku_id",align:"center"}}),r("el-table-column",{attrs:{width:"130px",label:"SKUID",prop:"sku_id",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{width:"80px",label:"商品规格",prop:"sku_name",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"库存数量",prop:"stock_num",align:"center"}}),r("el-table-column",{attrs:{width:"120px",label:"商品单价(RMB)",prop:"sku_price",align:"center"}}),r("el-table-column",{attrs:{"min-width":"80",label:"商品链接",prop:"goods_url",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.goods_url?r("div",[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("查看商品")])],1):e._e()]}}])}),r("el-table-column",{attrs:{label:"商品图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return e.row.sku_image?[r("el-tooltip",{staticStyle:{width:"32px",height:"32px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e.row.sku_image}})],1),r("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:e.row.sku_image}})],1)]:void 0}}],null,!0)}),r("el-table-column",{attrs:{label:"操作","min-width":"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.addTo(t.row)}}},[e._v("添加到出库单")])]}}])})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)},re=[],ae={name:"AbroadGoodsStore",data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},tableData:[],total:0,pageSize:20,currentPage:1,wid:"0",widList:[],sku_id:"",sys_sku_id:"",sku_name:"",activeName:"myStore",tableLoading:!1,isFilter:!0}},props:{addGiftAbroad:{type:String,default:""}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableData=[],t.next=3,e.getWareHouseList();case 3:return t.next=5,e.searchTableList();case 5:case"end":return t.stop()}}),t)})))()},methods:{changeName:function(e){var t=this.widList.find((function(t){return t.id==e}));return t?t.warehouse_name:""},handleClick:function(){this.currentPage=1,this.wid="0",this.sku_id="",this.sys_sku_id="",this.sku_name="",this.total=0,this.tableData=[],this.searchTableList()},getWareHouseList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new Map,t.next=3,e.$api.getOverseasWarehouse();case 3:a=t.sent,200===a.data.code?(n=a.data.data||[],n.forEach((function(t){e.widList=e.widList.concat(t.child)}))):e.$message.error(a.data),e.widList=e.widList.filter((function(e){return!r.has(e.id)&&r.set(e.id,1)}));case 6:case"end":return t.stop()}}),t)})))()},addTo:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$emit("getChooseData",e);case 1:case"end":return r.stop()}}),r)})))()},getAbroadShareList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableData=[],r={wid:e.wid,sys_sku_id:e.sys_sku_id},r["page"]=e.currentPage,r["page_num"]=e.pageSize,e.tableLoading=!0,t.next=7,e.$XzyNetMessageService.post("xzy.getSharedIndex",r);case 7:a=t.sent,n=a&&JSON.parse(a),o=n&&JSON.parse(n.data),[],200===o.code&&(e.total=o.data.total,i=o.data.data,i.forEach((function(t){var r=t.id,a=t.stock;t=a,t.shared_id=r,t.sku_price=t.sku_price/100,e.tableData.push(t)}))),e.tableLoading=!1;case 13:case"end":return t.stop()}}),t)})))()},getAbroadList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={wid:e.wid,sku_id:e.sku_id,sys_sku_id:e.sys_sku_id,sku_name:e.sku_name},r["page"]=e.currentPage,r["page_num"]=e.pageSize,"0"==e.wid&&(r["type"]="query"),e.tableLoading=!0,t.next=7,e.$XzyNetMessageService.post("xzy.stock.index",r);case 7:a=t.sent,n=a&&JSON.parse(a),o=n&&JSON.parse(n.data),200===o.code&&(e.total=o.data.total,i=o.data.data,i.forEach((function(e){e.stock_num=e.stock_num,e.sku_price=e.sku_price/100})),e.tableData=i,e.isFilter&&(e.tableData=i.filter((function(e){return e.stock_num>0})))),e.tableLoading=!1;case 12:case"end":return t.stop()}}),t)})))()},searchTableList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.tableData=[],"myStore"===e.activeName?e.getAbroadList():e.getAbroadShareList();case 2:case"end":return t.stop()}}),t)})))()},totalStock:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r].stock_num;return t},handleCurrentChange:function(e){this.currentPage=e,this.searchTableList()},handleSizeChange:function(e){this.pageSize=e,this.searchTableList()}}},ne=ae,oe=(r("2551"),Object(y["a"])(ne,te,re,!1,null,"06d25a2e",null)),ie=oe.exports,se={name:"GoodsOutStore",components:{SelfGoodsStore:G,ProductGoodsStore:Y,InLandGoodsStore:ee,AbroadGoodsStore:ie},props:{chooseData:{type:Array,default:[]},outStoreType:{type:String,default:"1"}},data:function(){return{total:0,orderInfo:{},orderList:[],matchOrderList:[],income:0,incomeRmb:0,selfGoodsStoreVisible:!1,isGift:!1,outStock:[],showInput:[],rateList:{},outTotalPrice:0,outTotalPriceRmb:0,outTotalStock:0,grossProfit:null,interestRate:null,flagText:"",wid:"",sheetInfo:{},addGiftAbroad:"",title:["","自有仓库商品列表","产品中心库存列表","海外仓库存列表","国内仓库存列表"],clickRow:{},country:"",clickNum:1,flagBool:!1}},watch:{orderInfo:{handler:function(e){},deep:!0}},mounted:function(){this.exchangeRateList(),this.orderInfo=this.chooseData[0],this.income=0,this.incomeRmb=0,this.getDetail(this.orderInfo),"3"!==this.outStoreType&&"4"!==this.outStoreType||this.getSheetInfo()},methods:{totalPrice:function(){var e=this.matchOrderList.filter((function(e){return Number(e.outStock)>0})),t=0,r=0;e.forEach((function(e){t+=Number(e.sku_price)*Number(e.outStock),r+=Number(e.outStock)})),this.outTotalStock=r,this.outTotalPriceRmb=t.toFixed(2),this.outTotalPrice=(t/Number(this.rateList[this.orderInfo.country])).toFixed(2),this.grossProfit=(this.incomeRmb-this.outTotalPriceRmb).toFixed(2),this.interestRate=this.outTotalPriceRmb?Math.round(this.grossProfit/this.outTotalPriceRmb*100).toFixed(2):100},getSheetInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={mainOrderSns:e.orderInfo.main_order_sn},t.next=3,e.$api.getLogisticsInformationBatch(r);case 3:a=t.sent,200===a.data.code&&a.data.data.length&&a.data.data[0].url?(e.flagText="面单信息获取成功",e.flagBool=!0,e.sheetInfo=a.data.data[0]||[]):(e.flagBool=!1,e.flagText="面单信息获取失败");case 5:case"end":return t.stop()}}),t)})))()},exchangeRateList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window["ConfigBridgeService"].getUserInfo();case 2:r=t.sent,e.rateList=r.ExchangeRates||{};case 4:case"end":return t.stop()}}),t)})))()},outStore:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.matchOrderList.filter((function(e){return!e.isGift})),"TW"==e.orderInfo.country||0!=e.flagBool&&""!=e.orderInfo.tracking_no){t.next=4;break}return e.flagText="该订单面单信息或物流单号不存在，无法出库！",t.abrupt("return",e.$message.warning("该订单面单信息或物流单号不存在，无法出库！"));case 4:if(e.orderList.length===r.length){t.next=8;break}e.$confirm("订单信息不匹配，是否确认出库?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){"4"===e.outStoreType?e.homePlaceOrder():"3"===e.outStoreType?e.abroadPlaceOrder():"1"===e.outStoreType?e.selfPlaceOrder():e.productPlaceOrder()})).catch((function(){e.$message({type:"info",message:"已取消出库"})})),t.next=25;break;case 8:if("4"!==e.outStoreType){t.next=13;break}return t.next=11,e.homePlaceOrder();case 11:t.next=25;break;case 13:if("3"!==e.outStoreType){t.next=18;break}return t.next=16,e.abroadPlaceOrder();case 16:t.next=25;break;case 18:if("1"!==e.outStoreType){t.next=23;break}return t.next=21,e.selfPlaceOrder();case 21:t.next=25;break;case 23:return t.next=25,e.productPlaceOrder();case 25:case"end":return t.stop()}}),t)})))()},abroadPlaceOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.matchOrderList.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先选择商品！"));case 2:if(r=e.matchOrderList.filter((function(e){return Number(e.outStock)>0})),r.length){t.next=5;break}return t.abrupt("return",e.$message.warning("出库数量不能为零！"));case 5:if(a=[],n={},r.forEach((function(e){n[e.wid]=e.wid;var t={order_sn:e.orderSn,sys_sku_id:e.sys_sku_id,sku_id:e.sku_id,sku_name:e.sku_name,stock_num:e.stock_num,sku_num:e.outStock,goods_name:e.goods_name,sku_price:e.sku_price,sku_image:e.sku_image,sku_url:e.sku_url,is_gift:e.isGift?1:2,shared_id:e.shared_id?e.shared_id+"":"0"};a.push(t)})),!(Object.keys(n).length>1)){t.next=10;break}return t.abrupt("return",e.$message.warning("只能出库同一个仓库的商品！"));case 10:return o={wid:r[0].wid,oversea_order_sn:e.orderInfo.main_order_sn,express_pdf:e.sheetInfo.url,type:e.orderInfo.logistics_id,logistic_no:e.orderInfo.tracking_no,country:e.orderInfo.country,sku_list:a},t.next=13,e.$api.outOfStockAbroad(o);case 13:return i=t.sent,t.next=16,e.saveStockSkuId();case 16:for(s=e.orderInfo.main_order_sn,e.$message.success("下单成功"),c=0;c<e.orderList.length;c++)e.$set(e.orderList[c],"order_status",3);e.flagText="出库成功",e.matchOrderList=[],e.totalPrice(),e.$emit("setTableData",s,"order_status",3),e.goNext(),t.next=29;break;case 27:return e.flagText="出库失败，".concat(i.data.message),t.abrupt("return",e.$message.error("出库失败，".concat(i.data.message)));case 29:case"end":return t.stop()}}),t)})))()},homePlaceOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.matchOrderList.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先选择商品！"));case 2:if(r=e.matchOrderList.filter((function(e){return 0==Number(e.outStock)})),!r.length){t.next=5;break}return t.abrupt("return",e.$message.warning("出库数量不能为零！"));case 5:if("TW"==e.orderInfo.country||0!=e.flagBool&&""!=e.orderInfo.tracking_no){t.next=8;break}return e.flagText="该订单面单信息或物流单号不存在，无法出库！",t.abrupt("return",e.$message.warning("该订单面单信息或物流单号不存在，无法出库！"));case 8:if(a=e.matchOrderList[0],n=[],o={},e.matchOrderList.forEach((function(e){o[e.wid]=e.wid;var t={order_sn:e.orderSn,sku_id:e.sku_id,goods_name:e.goods_name,goods_img:e.sku_image,goods_url:e.purchase_goods_url,goods_describe:e.sku_spec,goods_count:e.outStock,goods_price:e.sku_price,is_gift:e.isGift?1:2};n.push(t)})),!(Object.keys(o).length>1)){t.next=14;break}return t.abrupt("return",e.$message.warning("只能出库同一个仓库的商品！"));case 14:return i={wid:a.wid,homeOrderSn:e.orderInfo.main_order_sn,platformTrackingNumber:e.orderInfo.tracking_no,platformLogisticsType:e.orderInfo.logistics_id,goodsList:n},t.next=17,e.$api.homeOutStockOrder(i);case 17:if(s=t.sent,200!==s.data.code){t.next=29;break}for(c=e.orderInfo.main_order_sn,e.$message.success("下单成功"),e.flagText="出库成功",l=0;l<e.orderList.length;l++)e.$set(e.orderList[l],"order_status",3);e.matchOrderList=[],e.totalPrice(),e.$emit("setTableData",c,"order_status",3),e.goNext(),t.next=31;break;case 29:return e.flagText="出库失败，".concat(s.data.message),t.abrupt("return",e.$message.error("出库失败，".concat(s.data.message)));case 31:case"end":return t.stop()}}),t)})))()},selfPlaceOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.matchOrderList.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先选择商品！"));case 2:if(r=e.matchOrderList.filter((function(e){return Number(e.outStock)>0})),r.length){t.next=5;break}return t.abrupt("return",e.$message.warning("出库数量不能为零！"));case 5:return a=[],r.forEach((function(t){var r={sys_order_id:e.orderInfo.id,sku_id:t.sku_id,number:t.outStock};a.push(r)})),t.next=9,e.$api.selfOutStock({lists:a});case 9:if(n=t.sent,200===n.data.code){for(o=e.orderInfo.main_order_sn,e.$message.success("出库成功"),e.flagText="出库成功",i=0;i<e.orderList.length;i++)e.$set(e.orderList[i],"order_status",3);e.$emit("setTableData",o,"order_status",3),e.goNext()}else e.flagText="出库失败，".concat(n.data.message),e.$message.error("出库失败，".concat(n.data.message));case 11:case"end":return t.stop()}}),t)})))()},productPlaceOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,s,c,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.matchOrderList.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先选择商品！"));case 2:if(r=e.matchOrderList.filter((function(e){return Number(e.outStock)>0})),r.length){t.next=5;break}return t.abrupt("return",e.$message.warning("出库数量不能为零！"));case 5:return a=[],r.forEach((function(t){var r={sys_order_id:e.orderInfo.id,sku_id:t.sku_id,sku_price:t.sku_price,number:t.outStock};a.push(r)})),t.next=9,e.$api.productOutStock({lists:a});case 9:if(n=t.sent,200!==n.data.code){t.next=37;break}for(o=e.orderInfo.main_order_sn,e.$message.success("出库成功"),e.flagText="出库成功",s=0;s<e.orderList.length;s++)e.$set(e.orderList[s],"order_status",3);e.$emit("setTableData",o,"order_status",3),c=Object(i["a"])(r),t.prev=17,c.s();case 19:if((l=c.n()).done){t.next=26;break}return u=l.value,t.next=23,e.$commodityService.updateSkuStock(u.sku_id,u.stock_num-u.outStock);case 23:t.sent;case 24:t.next=19;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t["catch"](17),c.e(t.t0);case 31:return t.prev=31,c.f(),t.finish(31);case 34:e.goNext(),t.next=39;break;case 37:e.flagText="出库失败，".concat(n.data.message),e.$message.error("出库失败，".concat(n.data.message));case 39:case"end":return t.stop()}}),t,null,[[17,28,31,34]])})))()},deleteMatchData:function(e){this.matchOrderList.splice(e,1),this.outStock[e]="0",this.totalPrice()},setOutStock:function(e,t){if(Number(this.outStock[t])>Number(e.stock_num))return this.outStock[t]=0,this.$message.warning("出库数量不能大于可出库数量！");this.$set(this.matchOrderList[t],"outStock",this.outStock[t]),this.totalPrice()},getChooseData:function(e){if(e.isGift=this.isGift,e.outStock=0,e.orderSn=this.clickRow.order_sn,this.isGift)this.matchOrderList.push(e),this.outStock[this.matchOrderList.length-1]="0";else{var t=this.matchOrderList.findIndex((function(t){return!t.isGift&&t.orderSn===e.orderSn}));t>-1?this.$set(this.matchOrderList,t,e):(this.matchOrderList.push(e),this.outStock[this.matchOrderList.length-1]="0")}this.selfGoodsStoreVisible=!1},getDetail:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={mainOrderSn:e.main_order_sn},r.next=3,t.$api.getDetail(a);case 3:n=r.sent,o=n.data,200===o.code&&(t.orderList=o.data.orderInfos,t.orderList.forEach((function(e){e.country=t.orderInfo.country,e.platform_mall_id=t.orderInfo.mall_info.platform_mall_id,t.income+=Number(e.escrow_amount)})),t.incomeRmb=t.income*Number(t.rateList[t.orderInfo.country])),3!==t.outStoreType&&"3"!==t.outStoreType||t.getStockSkuId();case 7:case"end":return r.stop()}}),r)})))()},goNext:function(){var e=this;this.clickNum!==this.chooseData.length?(this.orderInfo={},this.orderList=[],this.matchOrderList=[],this.grossProfit=null,this.interestRate=null,++this.clickNum,this.orderInfo=this.chooseData[this.clickNum-1],"3"!==this.outStoreType&&"4"!==this.outStoreType||this.getSheetInfo(),this.getDetail(this.orderInfo),this.flagText=""):this.$confirm("是否关闭窗口","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("close","true")})).catch((function(){}))},changeOrderStatus:l["d"],getStockSkuId:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=regeneratorRuntime.mark((function t(r){var a,n,o,i,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.orderList[r],n={platformSkuId:a.variation_id},t.next=4,e.$api.getStockSkuId(n);case 4:o=t.sent,o.data&&200===o.data.code&&(i=o.data&&o.data.data,i&&(s=i.data&&i.data[0],c=e.orderList.find((function(e){return e.variation_id===a.variation_id})),s&&c&&e.matchOrderList.push(Object.assign(s,{orderSn:c.order_sn}))));case 6:case"end":return t.stop()}}),t)})),a=0;case 2:if(!(a<e.orderList.length)){t.next=7;break}return t.delegateYield(r(a),"t0",4);case 4:a++,t.next=2;break;case 7:case"end":return t.stop()}}),t)})))()},saveStockSkuId:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=Object(i["a"])(e.matchOrderList),t.prev=1,n=regeneratorRuntime.mark((function t(){var r,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=a.value,r.shared_id||r.isGift){t.next=8;break}return n=e.orderList.findIndex((function(e){return e.order_sn===r.orderSn})),o=e.orderList[n],i={platformSkuId:o.variation_id,stockSkuId:r.sys_sku_id},t.next=7,e.$api.uploadStockSkuId(i);case 7:t.sent;case 8:case"end":return t.stop()}}),t)})),r.s();case 4:if((a=r.n()).done){t.next=8;break}return t.delegateYield(n(),"t0",6);case 6:t.next=4;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t["catch"](1),r.e(t.t1);case 13:return t.prev=13,r.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})))()}}},ce=se,le=(r("bee1"),Object(y["a"])(ce,P,j,!1,null,"b300bf7c",null)),ue=le.exports,de=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"buy-link"},[r("div",{staticClass:"link-show"},e._l(e.platformLinkList,(function(t,a){return r("div",{key:a,staticClass:"item-box"},[r("span",[e._v(e._s(t.label))]),r("p",[e._v(e._s(t.purchase_url_all))]),r("i",{staticClass:"el-icon-s-order",on:{click:function(r){return e.copyItem(t.purchase_url_all)}}})])})),0),r("div",{staticClass:"buy-content"},e._l(e.rowBuyLinks,(function(t,a){return r("div",{key:a,staticClass:"item-box"},[r("span",[e._v("采购地址"+e._s(a+1))]),r("el-input",{staticClass:"mar-right",staticStyle:{width:"600px"},attrs:{size:"mini",clearable:""},on:{change:function(t){e.changeLink(t,a)}},model:{value:t.purchase_url,callback:function(r){e.$set(t,"purchase_url",r)},expression:"item.purchase_url"}}),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.openUrl(t.purchase_url)}}},[e._v("浏览")]),r("el-button",{staticClass:"mar-right",attrs:{size:"mini",type:"primary"},on:{click:function(t){e.createUrlByIdVisible=!0,e.indexLink=a}}},[e._v("使用商品ID生成")]),r("span",[e._v("备注:")]),r("el-input",{staticClass:"mar-right",staticStyle:{width:"300px"},attrs:{size:"mini",clearable:""},model:{value:t.note,callback:function(r){e.$set(t,"note",r)},expression:"item.note"}}),r("el-radio",{attrs:{label:"1"},on:{change:function(t){return e.changeDefault(a)}},model:{value:t.is_default,callback:function(r){e.$set(t,"is_default",r)},expression:"item.is_default"}},[e._v("默认")]),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.deleteLink(a)}}},[e._v("删除")])],1)})),0),r("div",{staticClass:"btn-box"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveAddLink}},[e._v("保 存")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addBuyLink}},[e._v("添 加")])],1),e.createUrlByIdVisible?r("el-dialog",{attrs:{title:"添加采购链接",visible:e.createUrlByIdVisible,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.createUrlByIdVisible=t}}},[r("div",[r("div",{staticClass:"content-link"},[r("span",{staticClass:"mar-right spanWidth"},[e._v("商品ID")]),r("el-input",{staticClass:"mar-right",staticStyle:{width:"200px"},attrs:{size:"mini",clearable:""},model:{value:e.goodID,callback:function(t){e.goodID=t},expression:"goodID"}}),r("span",{staticClass:"mar-right spanWidth"},[e._v("采购类型")]),r("el-select",{staticClass:"inputWidth",attrs:{size:"mini"},model:{value:e.sourceType,callback:function(t){e.sourceType=t},expression:"sourceType"}},e._l(e.goodsSourceListLink,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),r("div",{staticClass:"content-link"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.creatLink()}}},[e._v("确 定")])],1)])]):e._e()],1)},pe=[],he={name:"BuyLink",props:{linkRow:{type:Object,default:{}}},data:function(){return{rowBuyLinks:[],createUrlByIdVisible:!1,radio:!0,goodID:"",sourceType:"1",goodsSourceListLink:l["m"],indexLink:-1,platformLinkList:l["s"],lazadaBuyLinkObj:l["p"]}},mounted:function(){this.addPurchaseLink()},methods:{changeLink:function(e,t){if(e){var r=/(lazada)|(shopee)/g,a=e.match(r);if(a)if(a&&"lazada"===a[0]){var n=/(http|https):\/\/?([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6}/,o=e.match(n);if(!o||!o[0])return this.rowBuyLinks[t].purchase_url="",this.$message.warning("改地址无法采购请更换");if(!l["o"].includes(o[0]))return this.rowBuyLinks[t].purchase_url="",this.$message.warning("改地址无法采购请更换！");var i=o[0];if(i.indexOf(this.linkRow.country.toLowerCase())<0)return this.rowBuyLinks[t].purchase_url="",this.$message.warning("请填写正确站点的采购地址！")}else if(a&&"shopee"===a[0]){var s=/(http|https):\/\/?([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6}/,c=e.match(s);if(c&&c[0]){var u=c[0];if(u.indexOf(this.linkRow.country.toLowerCase())<0)return this.rowBuyLinks[t].purchase_url="",this.$message.warning("请填写正确站点的采购地址！")}}}},changeDefault:function(e){this.rowBuyLinks.forEach((function(t,r){r!==e&&(t.is_default="")}))},changeSourceType:function(e,t){var r=this.platformLinkList.find((function(t){return t.purchase_platform_id==e}));this.rowBuyLinks[t].purchase_url=r.purchase_url_all},creatLink:function(){var e=this,t=this.platformLinkList.find((function(t){return t.purchase_platform_id==e.sourceType})),r=t?t.purchase_url+this.goodID:"";8==this.sourceType&&(r=t?t.purchase_url+this.goodID+".html":""),9==this.sourceType&&(r=this.lazadaBuyLinkObj[this.linkRow.country.toLowerCase()]?this.lazadaBuyLinkObj[this.linkRow.country.toLowerCase()]+"/products/i"+this.goodID+".html":""),this.rowBuyLinks[this.indexLink].purchase_url=r,this.rowBuyLinks[this.indexLink].purchase_platform_id=t?t.purchase_platform_id:"",this.createUrlByIdVisible=!1,this.rowBuyLinks[this.indexLink].is_default="1",this.changeDefault(this.indexLink)},deleteLink:function(e){this.rowBuyLinks.splice(e,1)},openUrl:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$BaseUtilService.openUrl(e);case 1:case"end":return r.stop()}}),r)})))()},addBuyLink:function(){var e={note:"",purchase_url:"",purchase_goods_id:"",purchase_platform_id:"",is_default:""};this.rowBuyLinks.push(e)},saveAddLink:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c,l,u,d,p,h,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<e.rowBuyLinks.length)){t.next=73;break}if(a=e.rowBuyLinks[r],n=/(yangkeduo.com)|(taobao.com)|(jingxi.com)|(jd.com)|(1688.com)|(tmall.com)|(pinduoduo.com)|(xiapibuy.com)|(taobao.global)|(lazada.com)|(lazada)|(shopee)/g,o=/goods_id=([0-9]*)/,i=/goodsId=(\d+)/,s=/id=([0-9]*)/,c=/sku=([0-9]*)/,l=/mpId=(\d+)/,u=/(\d+)\.html/,d=/[^\/]+(?!.*\/)/,p=a.purchase_url.match(n),p){t.next=14;break}return t.abrupt("return",e.$message.error("采购链接错误，请检查！"));case 14:if(a.purchase_url.length){t.next=16;break}return t.abrupt("return",e.$message.error("采购链接不能为空,请检查采购链接"));case 16:if(!a.purchase_url.match(o)){t.next=20;break}a.purchase_goods_id=a.purchase_url.match(o)[1],t.next=45;break;case 20:if(!a.purchase_url.match(s)){t.next=24;break}a.purchase_goods_id=a.purchase_url.match(s)[1],t.next=45;break;case 24:if(!a.purchase_url.match(c)){t.next=28;break}a.purchase_goods_id=a.purchase_url.match(c)[1],t.next=45;break;case 28:if(!a.purchase_url.match(l)){t.next=32;break}a.purchase_goods_id=a.purchase_url.match(l)[1],t.next=45;break;case 32:if(!a.purchase_url.match(u)){t.next=36;break}a.purchase_goods_id=a.purchase_url.match(u)[1],t.next=45;break;case 36:if(!a.purchase_url.match(i)){t.next=40;break}a.purchase_goods_id=a.purchase_url.match(i)[1],t.next=45;break;case 40:if(!a.purchase_url.match(d)){t.next=44;break}a.purchase_goods_id=a.purchase_url.match(d)[0],t.next=45;break;case 44:return t.abrupt("return",e.$message.error("采购链接错误,请填写正确的采购链接或参考采购链接上边的提示信息"));case 45:t.t0=p[0],t.next="yangkeduo.com"===t.t0?48:"pinduoduo.com"===t.t0?50:"taobao.com"===t.t0?52:"tmall.com"===t.t0?54:"jingxi.com"===t.t0?56:"1688.com"===t.t0?58:"lazada"===t.t0||"lazada.com"===t.t0?60:"shopee"===t.t0?62:"xiapibuy.com"===t.t0?64:"taobao.global"===t.t0?66:68;break;case 48:return a.purchase_platform_id="1",t.abrupt("break",70);case 50:return a.purchase_platform_id="1",t.abrupt("break",70);case 52:return a.purchase_platform_id="2",t.abrupt("break",70);case 54:return a.purchase_platform_id="3",t.abrupt("break",70);case 56:return a.purchase_platform_id="10",t.abrupt("break",70);case 58:return a.purchase_platform_id="8",t.abrupt("break",70);case 60:return a.purchase_platform_id="9",t.abrupt("break",70);case 62:return a.purchase_platform_id="11",t.abrupt("break",70);case 64:return a.purchase_platform_id="11",t.abrupt("break",70);case 66:return a.purchase_platform_id="13",t.abrupt("break",70);case 68:return a.purchase_platform_id="0",t.abrupt("break",70);case 70:r++,t.next=1;break;case 73:return h={goods_id:e.linkRow.goods_info.goods_id,purchase_list:e.rowBuyLinks},t.next=76,e.$api.savePurchase(h);case 76:m=t.sent,200===m.data.code?(e.$message.success("保存成功!"),e.$emit("close")):e.$message.error("保存失败".concat(m.data.message));case 78:case"end":return t.stop()}}),t)})))()},addPurchaseLink:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={goodsIdLists:e.linkRow.goods_info.goods_id},t.next=3,e.$api.getPurchaseLists(r);case 3:a=t.sent,200===a.data.code&&(n={note:"",purchase_url:"",purchase_platform_id:"",purchase_goods_id:"",is_default:""},a.data.data[0].purchase_detail.length>0?e.rowBuyLinks=a.data.data[0].purchase_detail:e.rowBuyLinks=[n]),e.addBuyLinkVisible=!0;case 6:case"end":return t.stop()}}),t)})))()},copyItem:function(e){var t=document.createElement("div");t.id="tempTarget",t.style.opacity="0",t.innerText=e,document.body.appendChild(t);try{var r=document.createRange();r.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(r),document.execCommand("copy"),window.getSelection().removeAllRanges(),this.$message.success("复制成功")}catch(a){}t.parentElement.removeChild(t)}}},me=he,fe=(r("43f3"),Object(y["a"])(me,de,pe,!1,null,"e76d1124",null)),ge=fe.exports,be=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"bill-detail"},[r("div",{staticClass:"bill-top"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"200"}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{prop:"order_sn",label:"订单编号",width:"180"}}),r("el-table-column",{attrs:{prop:"goods_name",label:"商品名称","min-width":"200","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"goods_count",label:"商品数量",width:"80"}}),r("el-table-column",{attrs:{prop:"shot_amount",label:"采购金额",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.shot_amount))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"order_status",label:"发货状态","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.changeTypeName(t.row.order_status,e.orderStatusList)))]}}])}),r("el-table-column",{attrs:{align:"center",label:"采购状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.changeTypeName(t.row.shot_status,e.shotStatusList)))]}}])})],1)],1),r("div",{staticClass:"bill-content"},[r("div",{staticClass:"content-left"},e._l(e.amountLeft,(function(t,a,n){return r("div",{key:n,staticClass:"item"},[r("p",{style:{"font-weight":t.fontWeight}},[e._v(e._s(t.label))]),r("p",[e._v(" "+e._s(e.changeMoney(t.value))+" "),e.billType?r("span",[e._v(e._s(e._f("siteCoin")(e.chooseData.country)))]):r("span",[e._v("元")])])])})),0),r("div",{staticClass:"content-right"},[e._l(e.amountRight,(function(t,a,n){return r("div",{key:n,staticClass:"item"},[r("p",{style:{"font-weight":t.fontWeight}},[e._v(e._s(t.label))]),r("p",[e._v(" "+e._s(e.changeMoney(t.value))+" "),e.billType?r("span",[e._v(e._s(e._f("siteCoin")(e.chooseData.country)))]):r("span",[e._v("元")])])])})),r("div",{staticClass:"item "},[r("p",{staticClass:"activeColor"},[e._v("当前金额单位")]),e.billType?r("p",{staticClass:"activeColor"},[e._v(e._s(e._f("siteCoin")(e.chooseData.country)))]):r("p",{staticClass:"activeColor"},[e._v("人民币")])]),r("div",{staticClass:"item "},[r("p",{staticClass:"activeColor"},[e._v("当前站点")]),r("p",{staticClass:"activeColor"},[e._v(e._s(e._f("chineseSite")(e.chooseData.country)))])]),r("div",{staticClass:"item "},[r("p",{staticClass:"activeColor"},[e._v("当前汇率")]),r("p",{staticClass:"activeColor"},[e._v(e._s(e.rateList[e.chooseData.country]))])]),r("div",{staticClass:"item"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.changeSite}},[e._v(e._s(e.billType?"显示人民币":"显示当地币种"))])],1)],2)])])},_e=[],ve={name:"BillDetail",data:function(){return{tableData:[],orderStatusList:l["q"],shotStatusList:l["v"],rateList:{},billType:!0,amountLeft:{goodsAmount:{label:"商品金额",value:0,fontWeight:900},goodsPrice:{label:"商品价格",value:0,fontWeight:0},shipAmount:{label:"运费总额",value:0,fontWeight:900},buyPayShipAmount:{label:"买家支付的运费",value:0,fontWeight:0},thirdShip:{label:"第三方运费",value:0,fontWeight:0},actualShipAmount:{label:"实际运费（shopee代付）",value:0,fontWeight:0},costAndPay:{label:"费用与收费",value:0,fontWeight:900},commission:{label:"佣金",value:0,fontWeight:0},fees:{label:"交易手续费",value:0},payService:{label:"服务费",value:0,fontWeight:0},creditFees:{label:"信用卡交易费用",value:0,fontWeight:0},customs:{label:"关税",value:0,fontWeight:0},discountAmount:{label:"优惠券与回扣",value:0,fontWeight:900},saleDiscount:{label:"卖家提供促销代码优惠",value:0,fontWeight:0},shopeeBack:{label:"shopee回扣金额",value:0,fontWeight:0},shopeeCoinBack:{label:"卖家shopee币现金返现",value:0,fontWeight:0},shopShipBack:{label:"shopee运费回扣",value:0,fontWeight:0}},amountRight:{orderIncoming:{label:"订单收入",value:0,fontWeight:900},actualPay:{label:"买家实付金额",value:0,fontWeight:900},goodsPrice:{label:"商品金额",value:0,fontWeight:0},shipAmount:{label:"运费",value:0,fontWeight:0},importTax:{label:"进口税",value:0,fontWeight:0},discountAmount:{label:"卖家优惠金额",value:0,fontWeight:0},shopeeCoin:{label:"shopee币折抵",value:0,fontWeight:0},platformDiscount:{label:"平台优惠金额",value:0,fontWeight:0},creditFees:{label:"信用卡交易费",value:0,fontWeight:0},shotAmount:{label:"采购金额",value:0,fontWeight:900},refundAmount:{label:"退款金额",value:0,fontWeight:900},grossProfitShip:{label:"毛利（含邮费）",value:0,fontWeight:900},grossProfit:{label:"毛利",value:0,fontWeight:900}},tableLoading:!1,shotAmount:0,warehouseShipAmount:0}},props:{chooseData:{type:Object,default:{}}},mounted:function(){this.getRate(),this.getAmountDetail(),this.getAmountDetailFromShopee()},methods:{changeSite:function(){this.billType=!this.billType},changeMoney:function(e){return this.billType?e:(e*Number(this.rateList[this.chooseData.country])).toFixed(2)},getAmountDetailFromShopee:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={order_id:e.chooseData.order_id,shop_id:e.chooseData.mall_info.platform_mall_id},e.tableLoading=!0,t.next=4,e.$shopeemanService.getIncomeTransactionHistoryDetail(e.chooseData.country,r);case 4:a=t.sent,200===a.code&&(n=a.data,e.amountLeft.goodsAmount.value=n.payment_info.merchant_subtotal.product_price||0,e.amountLeft.goodsPrice.value=n.payment_info.merchant_subtotal.product_price||0,e.amountLeft.buyPayShipAmount.value=n.payment_info.shipping_subtotal.shipping_fee_paid_by_buyer||0,e.amountLeft.thirdShip.value=n.payment_info.shipping_subtotal.shipping_fee_discount_3pl||0,e.amountLeft.actualShipAmount.value=n.payment_info.shipping_subtotal.shipping_fee_paid_by_shopee_on_your_behalf||0,e.amountLeft.shipAmount.value=e.amountLeft.buyPayShipAmount.value+e.amountLeft.thirdShip.value+e.amountLeft.actualShipAmount.value,e.amountLeft.commission.value=n.payment_info.fees_and_charges.commission_fee||0,e.amountLeft.fees.value=n.payment_info.fees_and_charges.transaction_fee||0,e.amountLeft.payService.value=n.payment_info.fees_and_charges.service_fee||0,e.amountLeft.creditFees.value=n.payment_info.fees_and_charges.credit_card_charge||0,e.amountLeft.customs.value=n.payment_info.buyer_paid_tax_amount||0,e.amountLeft.costAndPay.value=e.amountLeft.commission.value+e.amountLeft.fees.value+e.amountLeft.payService.value+e.amountLeft.creditFees.value+e.amountLeft.customs.value,e.amountLeft.saleDiscount.value=n.payment_info.rebate_and_voucher.voucher_code||0,e.amountLeft.shopeeBack.value=n.payment_info.rebate_and_voucher.product_discount_rebate_from_shopee||0,e.amountLeft.shopeeCoinBack.value=n.payment_info.rebate_and_voucher.seller_absorbed_coin_cash_back||0,e.amountLeft.shopShipBack.value=n.payment_info.rebate_and_voucher.shipping_rebate_from_shopee||0,e.amountLeft.discountAmount.value=e.amountLeft.saleDiscount.value+e.amountLeft.shopeeBack.value+e.amountLeft.shopeeCoinBack.value+e.amountLeft.shopShipBack.value,e.amountRight.orderIncoming.value=n.amount||0,e.amountRight.actualPay.value=n.buyer_payment_info.merchant_subtotal||0,e.amountRight.goodsPrice.value=n.payment_info.merchant_subtotal.product_price||0,e.amountRight.shipAmount.value=n.buyer_payment_info.shipping_fee||0,e.amountRight.importTax.value=n.buyer_payment_info.import_tax||0,e.amountRight.discountAmount.value=n.buyer_payment_info.seller_voucher||0,e.amountRight.shopeeCoin.value=n.buyer_payment_info.shopee_coins_redeemed||0,e.amountRight.platformDiscount.value=n.buyer_payment_info.shopee_voucher||0,e.amountRight.creditFees.value=n.buyer_payment_info.credit_card_promotion||0,e.amountRight.shotAmount.value=e.shotAmount||0,e.amountRight.refundAmount.value=n.payment_info.merchant_subtotal.refund_amount||0,e.amountRight.grossProfitShip.value=(e.amountRight.orderIncoming.value-e.shotAmount).toFixed(2),e.amountRight.grossProfit.value=(e.amountRight.orderIncoming.value-e.shotAmount-e.warehouseShipAmount).toFixed(2),e.amountRight.orderIncoming.value=n.amount||0),e.tableLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},getRate:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window["ConfigBridgeService"].getUserInfo();case 2:r=t.sent,e.rateList=r.ExchangeRates||{};case 4:case"end":return t.stop()}}),t)})))()},getAmountDetail:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={mainOrderSn:e.chooseData.main_order_sn},t.next=3,e.$api.getDetail(r);case 3:a=t.sent,200===a.data.code&&(e.tableData=a.data.data.orderInfos,e.tableData.forEach((function(t){e.shotAmount+=Number(t.shot_amount),e.warehouseShipAmount+=Number(t.warehouse_ship_amount)})));case 5:case"end":return t.stop()}}),t)})))()},changeTypeName:function(e,t){var r=t.find((function(t){return t.value==e}));return r&&r.label||""}}},ye=ve,we=(r("c1b2"),Object(y["a"])(ye,be,_e,!1,null,"72212be4",null)),ke=we.exports,xe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"report"},[r("div",{staticClass:"report-content"},e._l(e.tableData,(function(t,a){return r("div",{key:a,staticClass:"report-box"},[r("div",{staticClass:"title"},[r("span",{staticClass:"mar-right"},[e._v("报表生成时间：")]),r("p",[e._v(e._s(t.updated_at))]),r("span",{staticClass:"mar-right"},[e._v("报表生成人：")]),r("p"),r("span",{staticClass:"mar-right"},[e._v("报表状态：")]),r("p",{style:{color:e.exportStatusColor[t.status]}},[e._v(e._s(e.exportStatus[t.status]))])]),r("div",{staticClass:"content"},[r("div",{staticClass:"item"},[r("span",[e._v("创建时间：")]),r("p",{staticClass:"mar-right"},[e._v(e._s(t.export_params.createTime[0]||""))]),e._v(" - "),r("p",{staticClass:"mar-left"},[e._v(e._s(t.export_params.createTime[1]||""))])]),r("div",{staticClass:"item"},[r("span",[e._v("店铺信息：")]),r("el-select",{staticClass:"selectBox",attrs:{placeholder:"",multiple:"","collapse-tags":"",size:"mini",filterable:""},model:{value:e.mall,callback:function(t){e.mall=t},expression:"mall"}},e._l(t.sysMallIds,(function(t,a){return r("el-option",{key:a,attrs:{label:e.changeMallName(t),value:t}})})),1)],1),r("div",{staticClass:"item"},[r("span",[e._v("订单状态：")]),r("p",[e._v(e._s(e.changeStauts(t.export_params.listOrderType)))])]),e._m(0,!0)]),1==t.status?r("el-button",{attrs:{size:"mini"}},[r("a",{staticStyle:{color:"#000"},attrs:{href:t.url,download:"订单报表.xlsx"}},[e._v("下载报表")])]):r("el-button",{attrs:{size:"mini",disabled:""}},[e._v("下载报表")])],1)})),0),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)])},Se=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"item"},[r("span",[e._v("售后状态：")]),r("p")])}],Le={name:"ExportReport",data:function(){return{tableData:[],total:0,pageSize:20,currentPage:1,exportStatus:["","可下载","生成中","上传中","已下载"],exportStatusColor:["#000","#0000FF","#FF0000","#FF8C00","#008000"],mallList:[],mall:""}},mounted:function(){this.getMallList(),this.getAsyncExportOrder()},methods:{getMallList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.mallList=[],t.next=3,e.$appConfig.getGlobalCacheInfo("allMallInfo","key");case 3:if(r=t.sent,a=r&&JSON.parse(r),a)for(n in a)e.mallList.push(a[n]);case 6:case"end":return t.stop()}}),t)})))()},changeMallName:function(e){var t=this.mallList.find((function(t){return t.id==e}));return t.mall_alias_name||t.platform_mall_name||""},changeStauts:function(e){var t="";return e.forEach((function(e,r){t=0===r?Object(l["d"])(e):t+","+Object(l["d"])(e)})),t},getAsyncExportOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={page:e.currentPage,pageSize:e.pageSize},t.next=3,e.$api.getAsyncExportOrder(r);case 3:a=t.sent,200===a.data.code?(e.total=a.data.data.total,e.tableData=a.data.data.data):e.$message.error(a.data.message);case 5:case"end":return t.stop()}}),t)})))()},handleCurrentChange:function(e){this.currentPage=e,this.getAsyncExportOrder()},handleSizeChange:function(e){this.pageSize=e,this.getAsyncExportOrder()}}},Ce=Le,Oe=(r("980f"),Object(y["a"])(Ce,xe,Se,!1,null,"24e16c7f",null)),Te=Oe.exports,Re=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reply-buyer"},[r("div",{staticClass:"reply-box"},e._l(e.replyData,(function(t,a){return r("div",{key:a,staticClass:"reply-item"},[r("div",{staticClass:"item"},[r("span",[e._v(e._s(t.countryLabel))])]),r("div",{staticClass:"item box-center mar-right"},[r("p",[e._v("评论：")]),r("el-input",{attrs:{type:"textarea",rows:2,resize:"none",placeholder:"请输入内容"},model:{value:t.replyText,callback:function(r){e.$set(t,"replyText",r)},expression:"item.replyText"}})],1),r("div",{staticClass:"item box-right"},[r("p",[e._v("星级")]),r("el-rate",{staticClass:"rateSize",model:{value:t.rate,callback:function(r){e.$set(t,"rate",r)},expression:"item.rate"}})],1)])})),0),r("div",{staticClass:"reply-btn"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setReplyData}},[e._v("确定")])],1)])},Ie=[],Ae={name:"ReplyBuyer",props:{chooseData:{type:Array,default:[]}},data:function(){return{textarea:"",value1:5,replyData:[],country:this.$filters.countries_option,key:""}},mounted:function(){this.getReplyData()},methods:{getReplyData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window["ConfigBridgeService"].getUserInfo();case 2:return r=t.sent,e.key=r.Usernam+"_replyconfig",t.next=6,window["ConfigBridgeService"].temporaryCacheInfo("get",e.key,"");case 6:if(a=t.sent,"{}"!=a){t.next=14;break}return t.next=10,e.$api.getUserInfo();case 10:n=t.sent,200===n.data.code&&n.data.data.evaluate_order_buyer_config&&JSON.parse(n.data.data.evaluate_order_buyer_config).length>0?(o=JSON.parse(n.data.data.evaluate_order_buyer_config),e.replyData=o):(i=[],e.country.forEach((function(e){var t={country:e.value,countryLabel:e.label,replyText:"",rate:0};i.push(t)})),e.replyData=i),t.next=15;break;case 14:e.replyData=JSON.parse(a);case 15:case"end":return t.stop()}}),t)})))()},setReplyData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={evaluateOrderBuyerConfig:JSON.stringify(e.replyData)},t.next=3,window["ConfigBridgeService"].temporaryCacheInfo("save",e.key,e.replyData);case 3:return t.next=5,e.$api.saveUserConfig(r);case 5:if(a=t.sent,200!==a.data.code){t.next=15;break}return e.$message.success("设置成功"),t.next=10,e.getReplyData();case 10:return t.next=12,e.replyOrderBuyer();case 12:e.$emit("close"),t.next=16;break;case 15:e.$message.error("设置失败，".concat(a.data.message));case 16:case"end":return t.stop()}}),t)})))()},replyOrderBuyer:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$parent.$parent.showConsole=!1,e.$parent.$parent.$refs.Logs.consoleMsg="",r=regeneratorRuntime.mark((function t(r){var a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.chooseData[r],n=e.replyData.find((function(e){return e.country===a.country})),o={order_id:a.order_id,rate_star:n.rate,rate_comment:n.replyText,shop_id:a.mall_info.platform_mall_id},t.next=5,e.$shopeemanService.rateOrder(a.country,o);case 5:i=t.sent,200===i.code?e.$parent.$parent.$refs.Logs.writeLog("【".concat(a.order_sn,"】回复成功"),!0):e.$parent.$parent.$refs.Logs.writeLog("【".concat(a.order_sn,"】，").concat(i.data),!1);case 7:case"end":return t.stop()}}),t)})),a=0;case 4:if(!(a<e.chooseData.length)){t.next=9;break}return t.delegateYield(r(a),"t0",6);case 6:a++,t.next=4;break;case 9:e.$parent.$parent.$refs.Logs.writeLog("回复结束，请至客服聊聊查看回复信息",!0);case 10:case"end":return t.stop()}}),t)})))()}}},$e=Ae,De=(r("297f"),Object(y["a"])($e,Re,Ie,!1,null,"22e3ec96",null)),Ne=De.exports,Pe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"second-sale"},[r("div",{staticClass:"header"},[r("div",{staticClass:"btn-header"},[r("div",{staticClass:"item mar-right"},[r("span",[e._v("商品ID：")]),r("el-input",{attrs:{size:"mini"},model:{value:e.goodsId,callback:function(t){e.goodsId=t},expression:"goodsId"}})],1),r("div",{staticClass:"item mar-right"},[r("span",[e._v("规格编号：")]),r("el-input",{attrs:{size:"mini"},model:{value:e.skuId,callback:function(t){e.skuId=t},expression:"skuId"}})],1),r("div",{staticClass:"item mar-right"},[r("span",[e._v("商品货号：")]),r("el-input",{attrs:{size:"mini"},model:{value:e.goodsNum,callback:function(t){e.goodsNum=t},expression:"goodsNum"}})],1),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.getSecondSaleList}},[e._v("搜 索")])],1),r("p",[e._v("温馨提示：1：二次销售商品不会进行拆包！！！；2：同一订单不允许同时操作国内中转发货和国外二次销售！！")]),r("p",[e._v("温馨提示：3：二次销售匹配的商品会自动拉取历史的采购价进行计算；2：包裹以平台物流单号为维度进行二次出库，并推送到包裹所在仓库")])]),r("div",{staticClass:"content"},[r("div",{staticClass:"order-box"},[r("span",{staticClass:"order-title"},[e._v("订单商品信息")]),r("div",{staticClass:"order-item"},[r("el-table",{ref:"muliTbale",staticStyle:{width:"100%"},attrs:{data:e.orderList,"tooltip-effect":"dark",height:"160","header-cell-style":{textAlign:"center",backgroundColor:"#f5f7fa"}}},[r("el-table-column",{attrs:{"min-width":"130px",label:"订单编号",prop:"order_sn",align:"center"}}),r("el-table-column",{attrs:{width:"80px",label:"采购状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.order_status?[e._v(e._s(e.changeShotStatus(t.row.shot_order_info.shot_status)))]:void 0}}],null,!0)}),r("el-table-column",{attrs:{"min-width":"120px",label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.goods_info&&t.row.goods_info.goods_name))]}}])}),r("el-table-column",{attrs:{width:"120px",label:"SKUID",prop:"variation_id",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.goods_info&&t.row.goods_info.variation_id))]}}])}),r("el-table-column",{attrs:{"min-width":"120px",label:"商品规格",prop:"variation_sku",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.goods_info&&t.row.goods_info.variation_name))]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品货号","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.goods_info&&t.row.goods_info.variation_sku))]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品ID","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v(e._s(t.row.goods_info.goods_id))])]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品数量","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.goods_info.goods_count))]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品图片","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{staticStyle:{width:"56px",height:"56px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:e._f("imageRender")([t.row.goods_info.goods_img])}})],1),r("el-image",{staticStyle:{width:"56px",height:"56px"},attrs:{src:e._f("imageRender")([t.row.goods_info.goods_img,!0])}})],1)]}}])}),r("el-table-column",{attrs:{align:"center",prop:"escrow_amount",label:"订单收入","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v(" "+e._s(t.row.escrow_amount)),r("span",[e._v(e._s(e._f("siteCoin")(t.row.country)))])])]}}])})],1)],1)])]),r("div",{staticClass:"content"},[r("div",{staticClass:"order-box"},[r("span",{staticClass:"order-title"},[e._v("二次销售海外商品信息")]),r("div",{staticClass:"order-item"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"muliTbale",staticStyle:{width:"100%"},attrs:{data:e.secondOrderList,"tooltip-effect":"dark",height:"350","header-cell-style":{textAlign:"center",backgroundColor:"#f5f7fa"}}},[r("el-table-column",{attrs:{"min-width":"60px",label:"站点",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("chineseSite")(t.row.country)))]}}])}),r("el-table-column",{attrs:{width:"120px",label:"包裹所在仓库",align:"center",prop:"receive_warehouse_name"}}),r("el-table-column",{attrs:{"min-width":"120px",label:"平台物流单号",prop:"platform_tracking_number",align:"center"}}),r("el-table-column",{attrs:{width:"120px",label:"退件类型",prop:"variation_id",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.returnType[Number(t.row.id)]))]}}])}),r("el-table-column",{attrs:{"min-width":"80px",label:"退件状态",prop:"variation_sku",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.returnStatus[Number(t.row.id)]))]}}])}),r("el-table-column",{attrs:{align:"center",label:"规格编号","min-width":"120",prop:"variation_id"}}),r("el-table-column",{attrs:{align:"center",label:"商品货号","min-width":"120",prop:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(e._s(r.variation_sku))]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品ID","min-width":"120",prop:"goods_id"}}),r("el-table-column",{attrs:{align:"center",label:"商品数量","min-width":"80",prop:"goods_count"}}),r("el-table-column",{attrs:{align:"center",label:"商品图片","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-image",{staticStyle:{width:"56px",height:"56px"},attrs:{src:e._f("imageRender")([t.row.goods_img])}})]}}])}),r("el-table-column",{attrs:{align:"center",prop:"goods_price",label:"商品价格","min-width":"80"}}),r("el-table-column",{attrs:{align:"center",label:"操作","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.matchAndOut(t.row)}}},[e._v("匹配出库")])]}}])})],1)],1)])])])},je=[],ze={name:"SecondSale",props:{chooseData:{type:Object,default:{}},secondOrderData:{type:Array,default:[]}},data:function(){return{goodsId:"",skuId:"",goodsNum:"",orderList:[],secondOrderList:[],returnType:["未知","跨境","本土预售","本土拍单","采购物流单号","备货暂存"],returnStatus:["已收货或上架","已匹配订单","已下架"],tableLoading:!1}},mounted:function(){this.orderList=[this.chooseData],"skuID"===this.chooseData.secondType?this.skuId=this.chooseData.goods_info.variation_id:"goodsId"===this.chooseData.secondType?this.goodsId=this.chooseData.goods_info.goods_id:"skuName"===this.chooseData.secondType&&(this.goodsNum=this.chooseData.goods_info.goods_spec),this.secondOrderList=this.secondOrderData},methods:{matchAndOut:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.country===t.chooseData.country){r.next=2;break}return r.abrupt("return",t.$message.warning("必须为相同站点才能进行商品二次销售"));case 2:return a={id:e.id,sysOrderId:t.chooseData.id},r.next=5,t.$api.uploadSecondSale(a);case 5:n=r.sent,200===n.data.code?(t.$message.success("匹配出库成功！"),t.$emit("close")):t.$message.error("匹配出库失败，".concat(n.data.message));case 7:case"end":return r.stop()}}),r)})))()},getSecondSaleList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={goodsId:e.goodsId,variationId:e.skuId,goodsSpec:e.goodsNum},e.tableLoading=!0,t.next=4,e.$api.getsecondlist(r);case 4:a=t.sent,200===a.data.code&&(e.secondOrderList=a.data.data),e.tableLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},changeShotStatus:l["g"]}},Be=ze,Me=(r("9575"),Object(y["a"])(Be,Pe,je,!1,null,"6ac5ae9b",null)),Ve=Me.exports,Ue=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"image-collection"},[r("div",{staticClass:"detail"},[e.chooseData.goods_info&&e.chooseData.goods_info.goods_img?e._e():r("div",{staticClass:"img"},[e._v("暂无图片")]),e.chooseData.goods_info&&e.chooseData.goods_info.goods_img?r("img",{staticStyle:{"object-fit":"contain",width:"56px",height:"56px"},attrs:{src:e._f("imageRender")([e.chooseData.goods_info.goods_img])}}):e._e(),r("div",{staticClass:"desc"},[r("p",[e._v(e._s(e.chooseData.goods_info&&e.chooseData.goods_info.goods_name?e.chooseData.goods_info.goods_name:"无商品名称"))]),r("p",[e._v("商品规格: "+e._s(e.chooseData.goods_info.goods_spec))]),r("p",[e._v(" 采购来源："+e._s(e.sourceName(e.chooseData.goods_info.ori_platform_id))+" "),r("a",{staticClass:"bright",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.$BaseUtilService.openUrl(e.chooseData.goods_info.ori_url)}}},[e._v(e._s(e.chooseData.goods_info.ori_goods_id)+" ")])])])]),r("div",{staticClass:"collection-box",staticStyle:{"border-top":"1px solid #ebeef5"}},["1688"===e.collectType?r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":{backgroundColor:"#f5f7fa"},data:e.tbSameList,height:"68vh"}},[r("el-table-column",{attrs:{prop:"image",label:"主图",width:"100"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("el-tooltip",{staticStyle:{width:"56px",height:"56px"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("img",{attrs:{src:t.Image,width:"400px",height:"400px"}})]),r("el-image",{staticStyle:{"border-radius":"4px","margin-right":"5px"},attrs:{src:t.Image,alt:"",width:"56px",height:"56px"}})],1)]}}],null,!1,3607664610)}),r("el-table-column",{attrs:{prop:"url",label:"上家id",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("a",{staticClass:"tabletext bright",staticStyle:{cursor:"pointer",color:"red"},attrs:{src:"#"},on:{click:function(t){return e.$BaseUtilService.openUrl(a.Url)}}},[e._v(e._s(a.GoodsId))])]}}],null,!1,894793633)}),r("el-table-column",{attrs:{label:"标题","min-width":"280px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.Title))])]}}],null,!1,2225055460)}),r("el-table-column",{attrs:{align:"center",prop:"Price",sortable:"",label:"价格",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.Price?r("span",[e._v(e._s(a.Price))]):r("span",[e._v("-")])]}}],null,!1,2383446938)}),r("el-table-column",{attrs:{label:"销量",prop:"tradeQuantity.saleQuantity",sortable:"",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.Stock))])]}}],null,!1,2445930788)}),r("el-table-column",{attrs:{align:"center",label:"发货地",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.Location))])]}}],null,!1,4083862585)}),r("el-table-column",{attrs:{prop:"Origin",align:"center",label:"来源",width:"60"}}),r("el-table-column",{attrs:{label:"操作","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("p",{staticClass:"tabletext bright",staticStyle:{cursor:"pointer",color:"red"},on:{click:function(t){return e.setpurchasesList(a,"0","8")}}},[e._v("设置为采购地址")]),r("p",{staticClass:"tabletext bright",staticStyle:{cursor:"pointer",color:"red"},on:{click:function(t){return e.setpurchasesList(a,"1","8")}}},[e._v("设置为默认采购地址")])]}}],null,!1,1241781199)})],1):e._e(),"淘宝"===e.collectType?r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tbSameList,height:"68vh"}},[r("el-table-column",{attrs:{prop:"image",label:"主图",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("el-tooltip",{staticStyle:{width:"56px",height:"56px"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("img",{attrs:{src:t.Image,width:"400px",height:"400px"}})]),r("el-image",{staticStyle:{"border-radius":"4px","margin-right":"5px"},attrs:{src:t.Image,alt:"",width:"56px",height:"56px"}})],1)]}}],null,!1,3607664610)}),r("el-table-column",{attrs:{prop:"url",label:"上家id",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("a",{staticClass:"tabletext bright",staticStyle:{cursor:"pointer"},attrs:{src:"#"},on:{click:function(t){return e.$BaseUtilService.openUrl(a.Url)}}},[e._v(e._s(a.GoodsId))])]}}],null,!1,1321861017)}),r("el-table-column",{attrs:{prop:"raw_title",label:"标题","min-width":"280px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.Title))])]}}],null,!1,2225055460)}),r("el-table-column",{attrs:{prop:"Price",align:"center",label:"价格",sortable:"",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.Price?r("span",[e._v(e._s(a.Price))]):r("span",[e._v("-")])]}}],null,!1,2383446938)}),r("el-table-column",{attrs:{prop:"Stock",align:"center",label:"销量",sortable:"",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.Stock))])]}}],null,!1,2445930788)}),r("el-table-column",{attrs:{prop:"Location",align:"center",label:"发货地",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.Location))])]}}],null,!1,4083862585)}),r("el-table-column",{attrs:{prop:"Origin",align:"center",label:"来源",width:"60"}}),r("el-table-column",{attrs:{label:"操作","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("p",{staticClass:"tabletext bright",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.setpurchasesList(a,"0","2")}}},[e._v("设置为采购地址")]),r("p",{staticClass:"tabletext bright",staticStyle:{cursor:"pointer"},on:{click:function(t){return e.setpurchasesList(a,"1","2")}}},[e._v("设置为默认采购地址")])]}}],null,!1,29890831)})],1):e._e()],1)])},Ge=[],Ee={name:"ImageCollection",data:function(){return{tableLoading:!1,tbSameList:[],goodLinks:[]}},props:{chooseData:{type:Object,default:{}},collectType:{type:String,default:"淘宝"}},mounted:function(){this.searchFromImg()},methods:{getLinks:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={goodsIdLists:e.chooseData.goods_info.goods_id},t.next=3,e.$api.getPurchaseLists(r);case 3:a=t.sent,200===a.data.code&&(e.goodLinks=a.data.data[0].purchase_detail);case 5:case"end":return t.stop()}}),t)})))()},setpurchasesList:function(e,t,r){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var o,i,s,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.getLinks();case 2:if(o=a.goodLinks.find((function(t){return t.purchase_url==e.Url})),!o){n.next=5;break}return n.abrupt("return",a.$message.warning("已经添加过该采购链接"));case 5:return i={note:"",purchase_url:e.Url,purchase_platform_id:r,purchase_goods_id:e.GoodsId,is_default:t},s={goods_id:a.chooseData.goods_info.goods_id,purchase_list:[i]},n.next=9,a.$api.savePurchase(s);case 9:c=n.sent,200===c.data.code?a.$message.success("添加采购链接成功!"):a.$message.error("添加采购链接失败".concat(c.data.message));case 11:case"end":return n.stop()}}),n)})))()},searchFromImg:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.tableLoading=!0,r=e.$filters.imageRender([e.chooseData.goods_info.goods_img]),e.getBase64(r,function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a="2",n={ImageBase64:r},"淘宝"===e.collectType&&(a="2"),"1688"===e.collectType&&(a="8",n["Page"]=1),t.next=6,e.$collectService.imgSearch(a,n);case 6:o=t.sent;try{i=o&&JSON.parse(o),0===i.Code&&(e.tbSameList=i.ListItem),e.tableLoading=!1}catch(s){e.tableLoading=!1,e.$message.warning("".concat(o))}case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})))()},getBase64:function(e,t){var r=new Image,a="";r.src=e+"?v="+Math.random(),r.setAttribute("crossOrigin","Anonymous"),r.onload=function(){var e=document.createElement("canvas"),n=r.width,o=r.height;return e.width=n,e.height=o,e.getContext("2d").drawImage(r,0,0,n,o),a=e.toDataURL("image/jpeg"),t?t(a):null}},sourceName:l["y"]}},Fe=Ee,We=(r("7aac8"),Object(y["a"])(Fe,Ue,Ge,!1,null,"3b634ca1",null)),Je=We.exports,He=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ship-amount"},[r("div",{staticClass:"content"},[r("div",{staticClass:"content-left"},[r("div",{staticClass:"left-header-btn"},[r("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{"margin-left":"20px"},attrs:{accept:".xlsx,.xls","on-change":e.uploadShip,action:"","show-file-list":!1,"auto-upload":!1}},[r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"}},[e._v("批量导入")])],1),r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"},on:{click:e.downTemplate}},[e._v("下载批量模板")]),r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"},on:{click:e.exportData}},[e._v("导出右侧数据")]),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"仓库发货金额以主订单为维度进行上报，系统自动分配金额至子订单，金额单位为人民币",placement:"right-end"}},[r("i",{staticClass:"el-icon-question"})])],1),r("div",{staticClass:"left-log"},[r("span",[e._v("导入信息：")]),r("div",{staticClass:"consoleBox",domProps:{innerHTML:e._s(e.consoleMsg)}})]),r("div",{staticClass:"left-header-btn mar-top"},[r("el-button",{attrs:{type:"primary",size:"mini",disabled:e.clickLoading},on:{click:e.batchUpload}},[e._v("批量上报")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.closeWindow}},[e._v("关闭")])],1)]),r("div",{staticClass:"content-right"},[r("el-table",{ref:"muliTbale",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",height:"500"}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{"min-width":"80px",label:"站点",prop:"country",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("chineseSite")(t.row.country)))]}}])}),r("el-table-column",{attrs:{"min-width":"120px",label:"店铺名称",prop:"mallName",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.mallName))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"orderSn",label:"shopee订单号","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.orderSn))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"orderStatus",label:"当前订单状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.changeStatus(t.row.orderStatus)))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"amount",label:"仓库发货金额(元)","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.amount))]}}])}),r("el-table-column",{attrs:{align:"center",prop:"status",label:"操作状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.status))])]}}])})],1)],1)])])},Ye=[],Ze=r("1146"),Ke=r.n(Ze),qe={name:"UploadStoreShipAmount",data:function(){return{consoleMsg:"",tableData:[],clickLoading:!1}},methods:{changeStatus:function(e){return Object(l["r"])(e)},exportData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tableData.length){t.next=2;break}return t.abrupt("return",e.$message.warning("没有可导出的数据！"));case 2:for(r=1,a="<tr>\n        <td>编号</td>\n        <td>站点</td>\n        <td>店铺名称</td>\n        <td>shopee订单号</td>\n        <td>当前订单状态</td>\n        <td>仓库发货金额(元)</td>\n        <td>操作状态</td>\n    </tr>",n=0;n<e.tableData.length;n++)o=e.tableData[n],a+="<tr><td>".concat(r++,"</td>\n                    <td>").concat(o.country?e.$filters.chineseSite(o.country):"\t","</td>\n                    <td>").concat(o.mallName?o.mallName:"\t","</td>\n                    <td>").concat(o.orderSn?o.orderSn:"\t","</td>\n                    <td>").concat(o.orderStatus?e.changeStatus(o.orderStatus):"\t","</td>\n                    <td>").concat(o.amount?o.amount:"\t","</td> \n                    <td>").concat(o.status?o.status:"\t","</td> \n                </tr>");Object(d["j"])("仓库发货金额信息",a);case 6:case"end":return t.stop()}}),t)})))()},batchUpload:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tableData.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先导入数据"));case 2:return r="",e.tableData.forEach((function(e,t){r=0===t?e.orderSn:r+","+e.orderSn})),t.prev=4,e.clickLoading=!0,a={orderSns:r},t.next=9,e.$api.getOrderBySn(a);case 9:n=t.sent,200===n.data.code&&n.data.data.forEach((function(t){var r=e.tableData.findIndex((function(e){return e.orderSn==t.order_sn}));r>-1&&(e.tableData[r].country=t.country,e.tableData[r].mallName=t.mall_name,e.tableData[r].orderStatus=t.order_status,e.tableData[r].main_order_sn=t.main_order_sn)})),o=0;case 12:if(!(o<e.tableData.length)){t.next=26;break}if(i=e.tableData[o],i.country){t.next=18;break}e.tableData[o].status="失败，未匹配到订单",t.next=23;break;case 18:return s={mainOrderSn:i.main_order_sn,amount:i.amount},t.next=21,e.$api.uploadOrderWarehourseShipAmount(s);case 21:c=t.sent,200===c.data.code?e.tableData[o].status="成功，已上报":e.tableData[o].status="失败，".concat(c.data.message);case 23:o++,t.next=12;break;case 26:e.clickLoading=!1,t.next=33;break;case 29:return t.prev=29,t.t0=t["catch"](4),e.clickLoading=!1,t.abrupt("return",e.$message.warning("操作失败，请重试"));case 33:case"end":return t.stop()}}),t,null,[[4,29]])})))()},closeWindow:function(){this.$emit("close")},uploadShip:function(e,t){var r={0:e.raw};this.readExcel(r)},readExcel:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.consoleMsg="",t.tableData=[],t.writeLog("读取文件开始",!0),!(e.length<=0)){r.next=7;break}return r.abrupt("return",!1);case 7:if(/\.(xls|xlsx)$/.test(e[0].name.toLowerCase())){r.next=10;break}return t.$Message.error("上传格式不正确，请上传xls或者xlsx格式"),r.abrupt("return",!1);case 10:a=new FileReader,a.onload=function(e){try{var r=e.target.result,a=Ke.a.read(r,{type:"binary"}),n=a.SheetNames[0],o=Ke.a.utils.sheet_to_json(a.Sheets[n]),i=o,c=i.length;if(t.writeLog("共读取到".concat(c,"条数据"),!0),0===c)return void t.$message.error("导入信息不能为空");i.forEach(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=JSON.parse(JSON.stringify(r).replace("Shopee主订单号（必填，不要填写子订单号）","orderSn").replace("仓库发货金额（必填，单位为人民币）","amount")),n={country:"",mallName:"",orderSn:a.orderSn,orderStatus:"",amount:a.amount,status:""},t.tableData.push(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(l){}},a.readAsBinaryString(e[0]);case 13:case"end":return r.stop()}}),r)})))()},writeLog:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e){var r=t?"green":"red";this.consoleMsg='<p style="color:'.concat(r,';margin-bottom:8px;">').concat(e,"</p>")+this.consoleMsg}},downTemplate:function(){var e="<tr>\n              <td>Shopee主订单号（必填，不要填写子订单号）</td>\n              <td>仓库发货金额（必填，单位为人民币）</td>\n            </tr>";Object(d["j"])("批量上报仓库发货金额模板",e)}}},Qe=qe,Xe=(r("434e"),Object(y["a"])(Qe,He,Ye,!1,null,"1d24df78",null)),et=Xe.exports,tt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ship-amount"},[r("div",{staticClass:"content"},[r("div",{staticClass:"content-left"},[r("div",{staticClass:"left-header-btn"},[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:".xlsx,.xls","on-change":e.importTemplateEvent,action:"","show-file-list":!1,"auto-upload":!1}},[r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"}},[e._v("批量导入")])],1),r("el-button",{staticClass:"mar-right",attrs:{type:"primary",size:"mini"},on:{click:e.downloadTemplate}},[e._v("下载批量模板")]),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"订单导入数量不可超过1W条",placement:"right-end"}},[r("i",{staticClass:"el-icon-question"})])],1),r("div",{staticClass:"left-log"},[r("span",[e._v("导入信息：")]),r("div",{staticClass:"consoleBox",domProps:{innerHTML:e._s(e.consoleMsg)}})]),r("div",{staticClass:"left-header-btn mar-top"},[r("el-button",{attrs:{type:"primary",size:"mini",disabled:e.clickLoading},on:{click:e.batchUpload}},[e._v("批量发货")])],1)]),r("div",{staticClass:"content-right"},[r("u-table",{ref:"ordersShipmentTable",attrs:{data:e.ordersShipmentData,"use-virtual":"","tooltip-effect":"dark","row-height":30,height:"648","header-cell-style":{backgroundColor:"#f5f7fa"}},on:{"selection-change":e.handleSelectionChange}},[r("u-table-column",{attrs:{align:"left",type:"selection",width:"50px"}}),r("u-table-column",{attrs:{align:"left",label:"序号",type:"index",width:"60px"}}),r("u-table-column",{attrs:{align:"left",label:"站点",prop:"country",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("chineseSite")(t.row.country)))]}}])}),r("u-table-column",{attrs:{align:"left",label:"店铺名称",prop:"mallName","min-width":"120px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",{staticClass:"copyStyle",on:{dblclick:function(t){return e.copyItem(a.mall_info.mall_alias_name||a.mall_info.platform_mall_name)}}},[e._v(" "+e._s(a.mall_info.mall_alias_name||a.mall_info.platform_mall_name)+" ")])]}}])}),r("u-table-column",{attrs:{align:"left",label:"shopee订单号",prop:"orderSn",width:"170px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("i",{staticClass:"el-icon-document-copy copyStyle",on:{click:function(t){return e.copyItem(a.main_order_sn)}}}),r("span",{staticClass:"tableActive",on:{click:function(t){return e.viewDetails("orderDetail",a.order_id,a.mall_info.platform_mall_id)}}},[e._v(" "+e._s(a.main_order_sn)+" ")])]}}])}),r("u-table-column",{attrs:{align:"left",label:"当前订单状态",prop:"orderStatus",width:"100px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.changeStatus(t.row.order_status)))]}}])}),r("u-table-column",{attrs:{align:"left",label:"发货物流单号",prop:"shippingTraceNo",width:"170px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(e._s(r.shippingTraceNo||r.tracking_no))]}}])}),r("u-table-column",{attrs:{align:"left",label:"操作状态",prop:"status","min-width":"120px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.operation_status))])]}}])})],1)],1)])])},rt=[],at={name:"uploadOrdersShipment",data:function(){return{ordersShipmentData:[],tableSelect:[],clickLoading:!1,consoleMsg:""}},props:{selectMallList:{type:Array,default:[]}},methods:{writeLog:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e){var r=t?"green":"red";this.consoleMsg='<p style="color:'.concat(r,';margin-bottom:8px;">').concat(e,"</p>")+this.consoleMsg}},changeStatus:function(e){return Object(l["r"])(e)},viewDetails:function(e,t,r){var a={type:e,shopId:r,id:t};this.$BaseUtilService.getOrderDetailInfo(r,JSON.stringify(a))},copyItem:function(e){var t=document.createElement("div");t.id="tempTarget",t.style.opacity="0",t.innerText=e,document.body.appendChild(t);try{var r=document.createRange();r.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(r),document.execCommand("copy"),window.getSelection().removeAllRanges(),this.$message.success("复制成功")}catch(a){}t.parentElement.removeChild(t)},downloadTemplate:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],r=[],a="",t=["发货订单号(请填写订单主号)","发货物流单号"],a="批量订单发货模板",e.next=7,Object(d["v"])(t,r,a);case 7:case"end":return e.stop()}}),e)})))()},importTemplateEvent:function(e){var t=this;this.consoleMsg="",this.writeLog("读取文件开始",!0),this.ordersShipmentData=[];var r={0:e.raw};if(/\.(xls|xlsx)$/.test(r[0].name.toLowerCase()))if(r.length<=0)this.writeLog("表格为空",!1);else{var a=new FileReader;a.onload=function(e){var r=e.target.result,a=Ke.a.read(r,{type:"binary"}),n=a.SheetNames[0],o=Ke.a.utils.sheet_to_json(a.Sheets[n]);t.getOrdersShipment(o)},a.readAsBinaryString(r[0])}else this.writeLog("上传格式不对,请上传xls、xls格式的文件",!1)},getOrdersShipment:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,i,s,c,l,u,d,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(e.length>1e4)){r.next=3;break}return t.writeLog("订单数量超过10000条",!1),r.abrupt("return");case 3:a=0,n=Object(o["a"])(t.selectMallList.map((function(e){return e.id}))),i=0;case 6:if(!(i<e.length)){r.next=23;break}if(s=e[i],c=s["发货订单号"]||s["发货订单号(请填写订单主号)"],c=c.split("_")[0],l=s["发货物流单号"]||"",!c||!l){r.next=19;break}return u={timeType:"payTime",otherTime:"",orderStatus:"1,2,3,4,5,6,7,8,9,10,20",shotStatus:"",isOwnOrder:"",isOverseasGoods:"",paymentMenthod:"",minGrossProfit:"",maxGrossProfit:"",goodsId:"",colorLabelId:0,createTime:"",shotTime:"",sysMallId:n.toString(),logisticsIds:"",page:1,pageSize:20,orderSn:c},r.next=15,t.$api.getOrderList(u);case 15:d=r.sent,d.data&&200===d.data.code?(p=d.data.data,p.data&&p.data.length>0?function(){var e=p.data&&p.data[0],r=t.ordersShipmentData.findIndex((function(t){return t.main_order_sn===e.main_order_sn}));r<0?e.tracking_no?(t.ordersShipmentData.push(e),t.writeLog("发货订单号【".concat(c,"】已存在物流单号"),!1)):(t.ordersShipmentData.push(Object.assign(e,{shippingTraceNo:l})),t.writeLog("发货订单号【".concat(c,"】已获取到"),!0),++a):t.writeLog("发货订单号【".concat(c,"】已重复"),!1)}():t.writeLog("发货订单号【".concat(c,"】未被找到"),!1)):t.writeLog("发货订单号【".concat(c,"】未被找到"),!1),r.next=20;break;case 19:c?t.writeLog("发货订单号【".concat(c,"】未匹配到发货物流单号"),!1):l&&t.writeLog("发货物流单号【".concat(c,"】未匹配到发货订单号"),!1);case 20:i++,r.next=6;break;case 23:t.writeLog("读取文件结束共".concat(e.length,"条,成功").concat(a,"条"),!0);case 24:case"end":return r.stop()}}),r)})))()},handleSelectionChange:function(e){this.tableSelect=e||[]},batchUpload:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["c"])(e.tableSelect,e.saveHandleOut,3);case 2:e.$refs.ordersShipmentTable.toggleAllSelection();case 3:case"end":return t.stop()}}),t)})))()},saveHandleOut:function(e){var t=arguments,r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o,i,s,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.length>1&&void 0!==t[1]?t[1]:{count:1},o=r.ordersShipmentData.findIndex((function(t){return t.order_id===e.order_id})),a.prev=2,2!==e.order_status||e.tracking_no){a.next=11;break}return i={order_id:e.order_id,shipping_proof:e.logistics_name,shipping_trace_no:e.shippingTraceNo,channel_id:79900,integrated:"",shop_id:e.mall_info.platform_mall_id},a.next=7,r.$shopeemanService.handleOutOrder(e.country,i);case 7:s=a.sent,200===s.data?(r.$refs.ordersShipmentTable.toggleRowSelection(e),r.$set(r.ordersShipmentData[o],"operation_status","发货成功！")):r.$set(r.ordersShipmentData[o],"operation_status","发货失败！"),a.next=13;break;case 11:c=e.tracking_no&&r.changeStatus(e.order_status)||"已存在物流单号",r.$set(r.ordersShipmentData[o],"operation_status","无法发货：为".concat(c,"状态！"));case 13:a.next=17;break;case 15:a.prev=15,a.t0=a["catch"](2);case 17:return a.prev=17,n.count--,a.finish(17);case 20:case"end":return a.stop()}}),a,null,[[2,15,17,20]])})))()}}},nt=at,ot=(r("05e9"),Object(y["a"])(nt,tt,rt,!1,null,"a24da3ac",null)),it=ot.exports,st=r("2ef0"),ct=r.n(st),lt=r("d4ec"),ut=r("bee2"),dt=r("ade3"),pt=(r("5b81"),r("498a"),r("a91f")),ht=r("bda5"),mt=function(){function e(t,r,a,n){Object(lt["a"])(this,e),Object(dt["a"])(this,"orders",void 0),Object(dt["a"])(this,"buyerAccounts",void 0),Object(dt["a"])(this,"Ua",""),Object(dt["a"])(this,"nativeService",null),Object(dt["a"])(this,"IsPddBatchOrder",!1),Object(dt["a"])(this,"_that",null),Object(dt["a"])(this,"$configService",new pt["a"]),Object(dt["a"])(this,"$api",ht["a"]),Object(dt["a"])(this,"writeLog",void 0),Object(dt["a"])(this,"rateList",{}),Object(dt["a"])(this,"IsBatchOrder",!1),Object(dt["a"])(this,"crossBorderAccessToken",""),Object(dt["a"])(this,"goodBuyUrlList",[]),Object(dt["a"])(this,"shopBuyerAccount",[]),Object(dt["a"])(this,"shopAdressPlatform",{SPMY:"0",SPTW:"1",SPVN:"2",SPID:"3",SPPH:"4",SPTH:"5",SPSG:"6",SPBR:"7",LZDMY:"8",LZDPH:"9",LZDTH:"10",LZDSG:"11",LZDID:"12",LZDVN:"13"}),this.orders=t,this.buyerAccounts=r,this._that=a,this.nativeService=window["ShotOrderBridgeService"],this.IsPddBatchOrder=n}return Object(ut["a"])(e,[{key:"start",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,o,i,s,c,l,u,d,p=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$configService.getUserConfig();case 2:return r=e.sent,r=r&&JSON.parse(r),e.next=6,this.$configService.getUserInfo();case 6:return a=e.sent,this.writeLog=t,n=new Map,o=[],this.buyerAccounts.forEach((function(e){var t=p.conver2BuyerAccount(e);o.push(t),n.set(Number(t.shotOrderPlatform),t),p.shopBuyerAccount.push(t)})),this.crossBorderAccessToken=n.get(Number(b.CrossBorder))?n.get(Number(b.CrossBorder)).Cookiestr:"",i={UserName:"",PayPassword:"",Password:""},i.UserName=r?r.pay_account:"",i.PayPassword=r?r.pay_password:"",e.next=17,this.buildPurchaseList(this.orders);case 17:return e.next=19,this.getShortOrders(n,i,r,a);case 19:if(s=e.sent,c=[],200!==s.code){e.next=25;break}c=s.data,e.next=27;break;case 25:return this.writeLog("拍单中止".concat(s.data),!1),e.abrupt("return",!1);case 27:l={GatewayEndPoint:"129.204.71.240",AutoSelectSku:1!=r.auto_sku&&(r.auto_sku,!0),AutoPay:1!=r.auto_pay&&(r.auto_pay,!0),AutoNextOrder:1!=r.auto_next_order&&(r.auto_next_order,!0),ShowSignOrderBtn:!1,ShowAutoOrderBtn:!1,ShowSearchByPddImg:!0,LianZhongAccount:"",LianZhongPassword:"",ChaojiyingAccount:"",ChaojiyingPassword:"",HlbAppKey:"",HlbAppSecret:"",ShowRemark:!1,ParentId:"",KidId:"",KidName:"",ShowTurnToHuoLaoBan:!1,PlatFormType:"",StpBackGround:"#1f74fa",BtnGround:"#f4a000",H5x5sec:r.h5_xsec||"",TaobaoCookieForImg:n.get(Number(b.TaoBao))&&n.get(Number(b.TaoBao)).LoginedCookies||[],TaobaoRemark:r.taobao_leave_content,AlibabaRemark:r.ali_leave_content,ZhiFuBaoAwid:r.pay_cookie||"",ProfitRate:100,SkipPreSale:!1,SkipColleague:!1,SoftDomain:"",Muid:"",TaoBaoCache:this.getCache(n,Number(b.TaoBao)),PinduoduoCache:this.getCache(n,Number(b.PinDuoduo)),ListShotOrdes:c,UseLifeSpanHandler:!1,Currency:"￥",ExchangeRate:1,NeedDeleteAllAddr:!0,UseTraiffPrice:!1,ForceShowHlb:!1,Use1688GroupShot:!1,IsShowGoodsTypeStp:!0,IsShowExchangeRatePrice:!0,IsSendRemark:!1,IsNeed1688UnPaidInfo:!1,ClickHiddenPop:!1,ShowKidPayAmount:!1,IsMandatoryOrder:!0,IsOpenKidAutoOrder:!1,IsUseCloudCoding:!0,IsShowKidRate:!1,IsOpenPddShortCut:!1,IsShowMaxWindow:!1,IsUseAbsolutePath:!1,IsOpenCoding:!0,LocalProxy:"",WebProxy:"",PddBuyAccounts:this.shopBuyerAccount,IsRandomChangePddAccount:!1,IsCloudShot:!1,IsForceCloudAccount:!1,IsOpenQuickCloudShot:!1,IsOpenQuickCloudShotAndCloudShot:!1,IsOpenAutoShot:!1,IsWechatPay:!1,ShowImgSearchPdd:!0,IsRemarkPddOrder:!1,IsPddBatchOrder:!1,TransTypeList:{"陆运":"1","空运":"2","海运":"3"},GoodsTypeList:{"普货":"1","敏感货":"2"}},u=0;case 29:if(!(u<l.ListShotOrdes.length)){e.next=36;break}if(d=l.ListShotOrdes[u],d.buyerAccount){e.next=33;break}return e.abrupt("return",this.writeLog("暂无买手号信息"));case 33:u++,e.next=29;break;case 36:e.prev=36,this.nativeService.start(JSON.stringify(l),r.language_set,this.crossBorderAccessToken),e.next=43;break;case 40:return e.prev=40,e.t0=e["catch"](36),e.abrupt("return",this.writeLog("拍单失败"));case 43:case"end":return e.stop()}}),e,this,[[36,40]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setCache",value:function(e,t,r){switch(e){case 1:t.PinduoduoCache=this.getCache(r,b.PinDuoduo);break;case 2:t.TaoBaoCache=this.getCache(r,b.TaoBao);break}return t}},{key:"getCache",value:function(e,t){return e.has(t)?e.get(t).UserNameCache:null}},{key:"getShortOrders",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r,a,n){var o,i,s,c,l,u,d,p,h,m,f,g,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window["ConfigBridgeService"].getUserInfo();case 2:o=e.sent,this.rateList=o.ExchangeRates||{},i=[],s=0;case 6:if(!(s<this.orders.length)){e.next=53;break}return c=this.orders[s],e.next=10,this.$configService.getWarehouseInfo(c.mall_info.platform_mall_id);case 10:if(l=e.sent,u=l&&JSON.parse(l)||[],u.length){e.next=14;break}return e.abrupt("return",{code:50001,data:"店铺【".concat(c.mall_info.platform_mall_name,"】未匹配到收货地址，请前往【仓库收货地址设置】进行设置")});case 14:if(d=null,[1,10,2,3,8,13,15].indexOf(Number(c.goods_info.ori_platform_id))>-1?d=u.find((function(e){return 0==e.type})):[9,11].indexOf(Number(c.goods_info.ori_platform_id))>-1&&(d=u.find((function(e){return 3==e.type}))),d){e.next=20;break}return e.abrupt("return",{code:50002,data:"店铺【".concat(c.mall_info.platform_mall_name,"】未匹配到收货地址，请前往【仓库收货地址设置】进行设置")});case 20:if(d.warehouse_id){e.next=22;break}return e.abrupt("return",{code:50002,data:"店铺【".concat(c.mall_info.platform_mall_name,"】未匹配到收货地址，请前往【仓库收货地址设置】进行设置")});case 22:if(d.receiving_name){e.next=24;break}return e.abrupt("return",{code:50003,data:"店铺【".concat(c.mall_info.platform_mall_name,"】绑定的仓库未设置收件人信息，请前往【仓库收货地址设置】进行设置。")});case 24:if(d.receiving_tel){e.next=26;break}return e.abrupt("return",{code:50004,data:"店铺【".concat(c.mall_info.platform_mall_name,"】绑定的仓库未设置收件人联系电话，请前往【仓库收货地址设置】进行设置。")});case 26:if("2"!==d.warehouse_status){e.next=28;break}return e.abrupt("return",{code:50005,data:"店铺【".concat(c.mall_info.platform_mall_name,"】绑定的仓库未设置收件人联系电话，请前往【仓库收货地址设置】进行设置。")});case 28:if(0!==d.isUser||d.country===c.country){e.next=30;break}return e.abrupt("return",{code:50006,data:"店铺【".concat(c.mall_info.platform_mall_name,"】绑定的仓库地址").concat(d.warehouse_name,"站点不一致，请前往【仓库收货地址设置】进行重新选择仓库。")});case 30:if(!(0!==d.type&&[1,10,2,3,8,13,15].indexOf(c.goods_info.ori_platform_id)>-1)){e.next=32;break}return e.abrupt("return",{code:50007,data:"店铺【".concat(c.mall_info.platform_mall_name,"】绑定的仓库地址").concat(d.warehouse_name,"为海外仓，无法对拼多多/淘宝/1688订单进行拍单操作。")});case 32:if(!(3!==d.type&&[9,11].indexOf(c.goods_info.ori_platform_id)>-1)){e.next=34;break}return e.abrupt("return",{code:50008,data:"店铺【".concat(c.mall_info.platform_mall_name,"】为国内仓，无法对Lazada/Shopee订单进行拍单操作。")});case 34:if(11!=c.goods_info.ori_platform_id||d.shopee_map_id){e.next=36;break}return e.abrupt("return",{code:50001,data:"仓库未映射shopee地址，请重新映射"});case 36:return e.next=38,this.dealWithBuyerBaseInfo(d,c,a,n);case 38:if(p=e.sent,h={},200!==p.code){e.next=44;break}h=p.data,e.next=45;break;case 44:return e.abrupt("return",{code:50009,data:"".concat(p.data)});case 45:m={UserName:h["buyerName"],UserPhone:h["buyerPhone"].replaceAll("-",""),Provice:h["provinceText"],City:h["cityText"],Town:h["distinctText"],Street:h["streetText"],PostCode:h["postCode"]?h["postCode"].toString():"000000",Address:h["buyerAddress"],Remark:c.message_to_seller||"",ProviceId:h["provId"],CityId:h["cityId"],TownId:h["distId"],StreetId:h["streetId"],Country:h["country"]?h["country"]:""},f={OwnGoodsId:c.goods_info.goods_id,UrlAddress:c.goods_info.ori_url,GoodsTitle:c.goods_info.goods_name,OriGoodsId:c.goods_info.ori_goods_id,GoodsMainImage:this._that.$filters.imageRender([c.goods_info.goods_img]),SkuId:c.goods_info.variation_id,OriSkuId:c.goods_info.ori_sku_id,SkuName:""!==c.goods_info.variation_sku?c.goods_info.variation_sku.replace("=|=",","):c.goods_info.variation_name.replace("=|=",","),OriBuyNum:c.goods_info.goods_count,ShotNumber:c.goods_info.goods_count,Price:(Number(c.escrow_amount)*Number(this.rateList[c.country.toUpperCase()])).toFixed(2),ExchangePrice:c.escrow_amount,RedirectUrl:this.GetRedirectUrl(c,n),PddReamrk:c.note,LocalReamrk:c.remark,OtherInfo:this._that.$filters.chineseSite(c.country),CountryCode:c.country,CurrentExchangeRate:this.rateList[c.country.toUpperCase()],oritype:this.getShortOrderBuyerAccountPlatform(Number(c.goods_info.ori_platform_id)),ForceQuickOrder:0,GroupGoodsModels:[],IsOrderDetail:!1,Purchaselist:this.dealWithPurchaseList(c,n)},g={OrderNumber:c.order_sn,OrderPriceCnt:(Number(c.escrow_amount)*Number(this.rateList[c.country.toUpperCase()])).toFixed(2)||0,OrdeExchangerPriceCnt:c.escrow_amount+this._that.$filters.siteCoin(c.country),Tag:{SysOrderId:c.id,MallId:c.mall_info.platform_mall_id,Site:c.country,ProjectType:"shopeeman",CookieStr:"",Status:c.order_status,Note:c.note},SystemOrderId:c.id,KidPayAmount:"",MallName:"",MallId:"",IsGiftOrder:!1,IsUseHuaWeiCloudPhone:!1},b={payAccount:r,buyerAccount:t.get(this.getShortOrderBuyerAccountPlatform(Number(c.goods_info.ori_platform_id))),receiveUserInfo:m,goodsInfo:f,shotOrderInfo:g},i.push(b);case 50:s++,e.next=6;break;case 53:return e.abrupt("return",{code:200,data:i});case 54:case"end":return e.stop()}}),e,this)})));function t(t,r,a,n){return e.apply(this,arguments)}return t}()},{key:"dealWithPurchaseList",value:function(e,t){var r=this,a=[],n=this.goodBuyUrlList.find((function(t){return t.goods_id===e.goods_info.goods_id})),o=/goods_id=([0-9]*)/,i=/id=([0-9]*)/,s=/sku=([0-9]*)/,c=/mpId=([0-8]*)/,l=/(\d+)\.html/,u=/[^\/]+(?!.*\/)/;return n&&n.purchase_detail&&n.purchase_detail.length&&n.purchase_detail.forEach((function(n){n.purchase_url.match(o)?n.purchase_url.match(o)[1]:n.purchase_url.match(i)?n.purchase_url.match(i)[1]:n.purchase_url.match(s)?n.purchase_url.match(s)[1]:n.purchase_url.match(c)?n.purchase_url.match(c)[1]:n.purchase_url.match(l)?n.purchase_url.match(l)[1]:n.purchase_url.match(u)&&n.purchase_url.match(u)[0];var d={Note:n.note,Url:n.purchase_url,RedirectUrl:r.GetRedirectUrl(e,t),PurchaseGoodsId:n.purchase_platform_id};a.push(d)})),a}},{key:"buildPurchaseList",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=[],t.forEach((function(e){r.push(e.goods_info.goods_id)})),a={goodsIdLists:r.join(",")},e.next=5,this.$api.getPurchaseLists(a);case 5:n=e.sent,200===n.data.code&&(this.goodBuyUrlList=n.data.data);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"GetRedirectUrl",value:function(e,t){var r="";switch(e.goods_info.ori_platform_id){case"1":r="http://api.shopeeman.com/ddk/singlePromotion?goodsId="+e.goods_info.ori_goods_id+"&muid="+t.muid;break;case"2":case"3":r="http://api.shopeeman.com/tbk/singlePromotion?goodsId="+e.goods_info.ori_goods_id+"&muid="+t.muid;break;default:r=e.goods_info.ori_url;break}return r}},{key:"dealWithBuyName",value:function(e,t,r,a){var n={},o=a.Nickname+"#"+e.receiving_name;1===e.isUser&&(o=r.shot_order_address_label.includes("1")?o:e.receiving_name),r.shot_order_address_label.includes("2")&&(o+="-"+Object(d["g"])((new Date).getTime(),"Md")),r.shot_order_address_label.includes("3")&&(o+="-SPM"),0==e.isUser&&"23"==e.warehouse_id&&(o="SM-"+e.receiving_name),0==e.isUser&&"8"==e.warehouse_id&&(o="SPM-"+e.receiving_name),r.shot_order_address_label.includes("5")&&(o+="-"+t.order_sn.substring(t.order_sn.length-6)),n["buyerName"]=1==t.goods_info.ori_platform_id?e.receiving_name:o,n["buyerPhone"]=1==e.is_use_own_phone?e.own_phone:e.receiving_tel;var i=e.detail_address.trim();return 3!=e.type&&"SG"!=e.country&&(r.shot_order_address_label.includes("4")&&(i+="#"+t.id),r.shot_order_address_label.includes("6")&&(i+="#"+t.order_sn.substring(t.order_sn.length-6))),1==t.goods_info.ori_platform_id&&(1!=e.isUser&&(i+="#"+a.Nickname+"#"+e.receiving_name),r.shot_order_address_label.includes("2")&&(i+="-"+Object(d["g"])((new Date).getTime(),"Md")),r.shot_order_address_label.includes("3")&&(i+="-SPM")),n["buyerAddress"]=i,n}},{key:"dealWithBuyerBaseInfo",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r,a,n){var o,i,s,c,l,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o={},o["provId"]=t.province_id,o["cityId"]=t.city_id,o["distId"]=t.distinct_id,o["streetId"]="",o["provinceText"]=t.province_text,o["cityText"]=t.city_text,o["distinctText"]=t.distinct_text,o["streetText"]="",o["postCode"]=t.post_code,i=this.dealWithBuyName(t,r,a,n),o["buyerName"]=i["buyerName"],o["buyerPhone"]=i["buyerPhone"],o["buyerAddress"]=i["buyerAddress"],2!=r.goods_info.ori_platform_id&&3!=r.goods_info.ori_platform_id&&8!=r.goods_info.ori_platform_id){e.next=21;break}return e.next=17,window["BaseUtilBridgeService"].getTbAddress(t.province_text,t.distinct_text);case 17:s=e.sent,s&&(o["provId"]=s.ProvinceId,o["cityId"]=s.CityId,o["distId"]=s.DistrictId,o["streetId"]="",o["provinceText"]=s.Province,o["cityText"]=s.City,o["distinctText"]=s.District,o["streetText"]=""),e.next=63;break;case 21:if(9!=r.goods_info.ori_platform_id||"SG"===t.country){e.next=43;break}return e.next=24,window["BaseUtilBridgeService"].getLazadaAddress(t.distinct_id);case 24:if(c=e.sent,!c){e.next=36;break}if(c.DistrictId){e.next=28;break}return e.abrupt("return",{code:50001,data:"【".concat(r.order_sn,"】未匹配到用户的地址ID")});case 28:o["provId"]=c.ProvinceId,o["cityId"]=c.CityId,o["distId"]=c.DistrictId,o["streetId"]="",o["provinceText"]=c.Province.includes("/")?c.Province.split("/")[0].trim():c.Province,o["cityText"]=c.City.includes("/")?c.City.split("/")[0].trim():c.City,o["distinctText"]=c.District,o["streetText"]="";case 36:if(!n.Nickname.includes("_")&&!n.Nickname.includes("+")){e.next=38;break}return e.abrupt("return",{code:50001,data:"【用户昵称含有特殊字符，Lazada平台不支持使用特殊字符创建收件人，请联系客服修改"});case 38:l=o["buyerName"],"PH"==r.country&&(l=t.receiving_name+" SPM"),o["buyerName"]=l.replaceAll("#","-"),e.next=63;break;case 43:if(11!=r.goods_info.ori_platform_id){e.next=63;break}if("SG"===t.country||3!==t.type){e.next=63;break}if(t.shopee_map_id){e.next=47;break}return e.abrupt("return",{code:50001,data:"该仓库未映射shopee地址，请重新映射"});case 47:return e.next=49,window["BaseUtilBridgeService"].getLazadaAddress(t.distinct_id);case 49:return u=e.sent,e.next=52,this.getAllShopeeAddress(r.goods_info.ori_platform_id,t.country,t.shopee_map_id,0);case 52:if(d=e.sent,d){e.next=55;break}return e.abrupt("return",{code:50001,data:"该仓库未映射shopee地址，请重新映射"});case 55:d.provinceInfo&&(o["provId"]=Object.keys(d.provinceInfo)[0],o["provinceText"]=d.provinceInfo[Object.keys(d.provinceInfo)[0]]),d.cityInfo&&(o["cityId"]=Object.keys(d.cityInfo)[0],o["cityText"]=d.cityInfo[Object.keys(d.cityInfo)[0]]),d.distinceInfo&&(o["distId"]=Object.keys(d.distinceInfo)[0],o["distinctText"]=d.distinceInfo[Object.keys(d.distinceInfo)[0]]),d.streetInfo&&(o["streetId"]=Object.keys(d.streetInfo)[0],o["streetText"]=d.streetInfo[Object.keys(d.streetInfo)[0]]),o["provinceText"].includes("~")&&(o["provinceText"]=o["provinceText"].split("~")[0]),p=Number(u.Post),o["postCode"]=isNaN(p)||0===p?t.post_code:p,o["country"]=t.country;case 63:return e.abrupt("return",{code:200,data:o});case 64:case"end":return e.stop()}}),e,this)})));function t(t,r,a,n){return e.apply(this,arguments)}return t}()},{key:"getAllShopeeAddress",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r,a,n){var o,i,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o={};case 1:return e.next=4,this.searchShopeeAddrMappingTree(t,r,a,n);case 4:if(i=e.sent,i&&i.length){e.next=7;break}return e.abrupt("break",24);case 7:s=i[0].level,c={},c[i[0].id]=i[0].division_name,e.t0=s,e.next=1===e.t0?13:2===e.t0?15:3===e.t0?17:4===e.t0?19:21;break;case 13:return o["provinceInfo"]=c,e.abrupt("break",21);case 15:return o["cityInfo"]=c,e.abrupt("break",21);case 17:return o["distinceInfo"]=c,e.abrupt("break",21);case 19:return o["streetInfo"]=c,e.abrupt("break",21);case 21:a=i[0].parant+"",e.next=1;break;case 24:return e.abrupt("return",o);case 25:case"end":return e.stop()}}),e,this)})));function t(t,r,a,n){return e.apply(this,arguments)}return t}()},{key:"searchShopeeAddrMappingTree",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r,a,n){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=null,11!=t){e.next=32;break}e.t0=r,e.next="MY"===e.t0?5:"ID"===e.t0?9:"TH"===e.t0?13:"PH"===e.t0?17:"SG"===e.t0?21:"VN"===e.t0?25:29;break;case 5:return e.next=7,window["CommodityBridgeService"].callAddrHelper("GetAddress",this.shopAdressPlatform.SPMY,"0",a);case 7:return o=e.sent,e.abrupt("return",o&&JSON.parse(o)||null);case 9:return e.next=11,window["CommodityBridgeService"].callAddrHelper("GetAddress",this.shopAdressPlatform.SPID,"0",a);case 11:return o=e.sent,e.abrupt("return",o&&JSON.parse(o)||null);case 13:return e.next=15,window["CommodityBridgeService"].callAddrHelper("GetAddress",this.shopAdressPlatform.SPTH,"0",a);case 15:return o=e.sent,e.abrupt("return",o&&JSON.parse(o)||null);case 17:return e.next=19,window["CommodityBridgeService"].callAddrHelper("GetAddress",this.shopAdressPlatform.SPPH,"0",a);case 19:return o=e.sent,e.abrupt("return",o&&JSON.parse(o)||null);case 21:return e.next=23,window["CommodityBridgeService"].callAddrHelper("GetAddress",this.shopAdressPlatform.SPSG,"0",a);case 23:return o=e.sent,e.abrupt("return",o&&JSON.parse(o)||null);case 25:return e.next=27,window["CommodityBridgeService"].callAddrHelper("GetAddress",this.shopAdressPlatform.SPVN,"0",a);case 27:return o=e.sent,e.abrupt("return",o&&JSON.parse(o)||null);case 29:return e.abrupt("return",null);case 30:e.next=33;break;case 32:return e.abrupt("return",null);case 33:case"end":return e.stop()}}),e,this)})));function t(t,r,a,n){return e.apply(this,arguments)}return t}()},{key:"conver2BuyerAccount",value:function(e){if(13===e.type){var t={UserNameCache:"",Password:"",shotOrderPlatform:this.getShortOrderBuyerAccountPlatform(e.type),LoginedCookies:[],UserName:e.account,Cookiestr:e.access_token,AccountType:e.type,Ua:"",Country:e.site||"",ShopId:"",OrderType:""};return t}var r={UserNameCache:e.cache_path,Password:"",shotOrderPlatform:this.getShortOrderBuyerAccountPlatform(e.type),LoginedCookies:e.login_info,UserName:e.name,Cookiestr:JSON.stringify(e.login_info),AccountType:e.type,Ua:e.ua,Country:e.site||"",ShopId:"",OrderType:""};return r}},{key:"converterCookies",value:function(e){try{var t=JSON.parse(e);return t}catch(n){var r=e.split(";");if(r){var a=[];return r.forEach((function(e){var t=e.indexOf("="),r=e.slice(0,t),n=e.slice(t+1);r&&n&&a.push({Name:r,Value:n,Domain:"mobile.yangkeduo.com"})})),a}}}},{key:"getCookieStr",value:function(e,t){return 1==t?this.getPddCookieStrByName(e,"PDDAccessToken"):10==t?this.getJinxiCookieStrByName(e,"pt_key"):void 0}},{key:"getPddCookieStrByName",value:function(e,t){var r=e.find((function(e){return e.Name==t}));return r?"".concat(r.Name,"=").concat(r.Value):null}},{key:"getJinxiCookieStrByName",value:function(e,t){var r=e.find((function(e){return e.Name==t}));return r?"".concat(r.Value):null}},{key:"find",value:function(e,t,r){for(var a=e.indexOf(t),n=0;n<r-1;n++)a=e.indexOf(t,a+1);return a}},{key:"goodsSize",value:function(e){var t=JSON.parse(e),r="";return t instanceof Array?(t.forEach((function(e,a){r+=e["value"]+(a+1===t.length?"":",")})),r):t.value}},{key:"getShotOrderPlatform",value:function(e){switch(e){case 1:return b.PinDuoduo;case 2:case 3:return b.TaoBao;case 4:return b.JingDong;case 7:return b.HYJ;case 8:return b.Alibaba;case 10:return b.JingXi;default:return b.PinDuoduo}}},{key:"getShortOrderBuyerAccountPlatform",value:function(e){switch(e){case 1:return b.PinDuoduo;case 2:case 3:return b.TaoBao;case 4:return b.JingDong;case 8:return b.Alibaba;case 9:return b.Lazada;case 10:return b.JingXi;case 11:return b.Shopee;case 13:return b.CrossBorder;default:return b.PinDuoduo}}},{key:"getGoodsIdByLink",value:function(e,t){if(8==t){var r=e.match("/(?<goodsId>[0-9]*?).html"),a=r.groups.goodsId;return a}var n=this.getQueryString(e,"goods_id");if(n)return n;var o=this.getQueryString(e,"id");return o}},{key:"getQueryString",value:function(e,t){for(var r=decodeURIComponent(e.split("?")[1]).split("&"),a=[],n=[],o=0;o<r.length;o++)n=r[o].split("="),a[n[0]]=n[1];return a[t]||null}},{key:"SingleOrderData",value:function(e,t){return this.nativeService.jumpHyj(e,t)}}]),e}(),ft=r("b76a"),gt=r.n(ft),bt=r("4586"),_t={components:{draggable:gt.a,BuyerAccount:k,storeChoose:p["a"],PurchaseInfo:T,PushOrder:N,GoodsOutStore:ue,UploadStoreShipAmount:et,UploadOrdersShipment:it,BuyLink:ge,BillDetail:ke,ExportReport:Te,ReplyBuyer:Ne,SecondSale:Ve,ImageCollection:Je},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},selectForm:{timeType:"payTime",otherTime:"",orderStatus:"",shotStatus:"",isOwnOrder:"",isOverseasGoods:"",paymentMenthod:"",minGrossProfit:"",maxGrossProfit:"",goodsId:"",colorLabelId:0,createTime:"",shotTime:"",sysMallId:"",logisticsIds:""},createTime:[],logisticsIds:[""],orderStatus:[20],shotStatus:[""],inputType:"orderSn",inputContent:"",orderStatusList:l["q"],shotStatusList:l["v"],timeTypeList:l["F"],inputTypeList:l["n"],goodsSourceList:l["l"],columnConfigList:l["h"],forbidData:l["i"],forbidTHData:l["j"],buyPayMethod:l["a"],payMethodList:[{label:"全部",value:""}],shipTypeList:[],tableLoading:!1,tableData:[],pageSize:20,currentPage:1,total:0,showConsole:!0,isShow:!0,operation:{upData:"buyerAccountList",left:[{title:"登录买手号",type:"primary",key:1},{title:"同步订单",type:"primary",key:2,check:"order"},{title:"获取物流单号",type:"primary",key:3,check:"ship"},{title:"批量拍单",type:"primary",key:4,click:"purchaseHandler"},{title:"上传账号信息",type:"primary",key:6},{title:"下载账号信息",type:"primary",key:7}],center:[{title:"拼多多账号",platform:1,centerTitle:"拼多多个人中心"},{title:"淘宝账号",platform:2,centerTitle:"淘宝个人中心"},{title:"1688账号",platform:8,centerTitle:"1688个人中心"},{title:"京喜账号",platform:10,centerTitle:"京喜个人中心"},{title:"lazada账号",platform:9,centerTitle:"lazada个人中心"},{title:"shopee账号",platform:11,centerTitle:"shopee个人中心"}],right:[{title:"批量推送订单至仓库 ",key:8,type:"primary"},{title:"批量标记颜色",key:9,type:"primary",click:"getColorList"},{title:"批量标记海外商品",key:10,type:"primary"},{title:"批量添加采购信息",key:11,type:"primary",click:"batchAddBuyInfo"},{title:"批量订单发货",key:12,type:"primary",click:"ordersShipmentShow"},{title:"配置自定义列",type:"primary",key:5}]},selectMallList:[],multipleSelection:[],buyerAccountList:[],buyerAccountListGlobal:[],accountpdd:null,accounttaobao:null,account1688:null,accountjx:null,accountlazada:null,accountshopee:null,accountCrossBorder:null,columnVisible:!1,abroadVisible:!1,isAbroadGood:0,localRamarkVisible:!1,colorVisible:!1,colorList:[],selectColorList:[],colorRadio:"",colorRow:{},purchaseInfoVisible:!1,pushOrderToStoreVisible:!1,goodsOutStoreVisible:!1,outStoreTitle:"自有商品出库",outStoreType:"1",shipInfoVisible:!1,shipBindStore:"",shipStoreList:[],shipNo:"",shipCompany:"",uploadStoreShipAmountVisible:!1,dealType:"batch",addBuyLinkVisible:!1,clickRow:{},lookForbidVisible:!1,addMoreTraNumberVisible:!1,warehouseData:[],trackingNumberList:[],bindStore:"",billsDetailVisible:!1,trackPathVisible:!1,spTrackPathVisible:!1,spTrackPath:[],shipInfoLoading:!1,orderPathVisible:!1,orderPathInfoLoading:!1,orderTrackPath:[],orderReportVisible:!1,replayOrderBuyerVisible:!1,replyBuyerData:[],handOutOrderVisible:!1,shippingProof:"",shippingTraceNo:"",secondSaleVisible:!1,secondOrderList:[],collectionVisible:!1,collectType:"淘宝",rateList:{},categoryInfo:{},activeRemarkID:"",orderRemark:"",localRamarkNode:"",activeRemarkIDNode:"",orderRemarkNode:"",shipLoading:!1,colorLoading:!1,localRamark:"",ordersShipmentVisible:!1,importOrdersShipment:"",ordersShipmentData:[],tableColumnShow:!1,tableColumnList:[{key:1,name:"订单编号",width:"170",fixed:"left",align:"",iCopy:"order_sn",prop:"order_sn",rowClick:"viewDetails_orderDetail",showType:0},{key:2,name:"操作",width:"125",fixed:"left",align:"center",showType:2},{key:3,width:"120",name:"店铺所属信息",align:"",propList:[{name:"站点",filter:bt["chineseSite"],prop:"country"},{name:"分组",width:"80",prop:"group_name"}],showOverflowTooltip:!0,showType:0},{key:5,name:"店铺名称",width:"120",align:"",rowDblClick:"copyItem",prop:"mall_info.mall_alias_name,mall_info.platform_mall_name",showOverflowTooltip:!0,showType:0},{key:6,name:"采购绑定仓库",width:"120",align:"",prop:"shot_order_info.warehouse_name",showOverflowTooltip:!0,showType:0},{key:7,name:"颜色标识",width:"120",align:"center",prop:"color_id",iColor:"color_id",rowShow:"changeColorLabel",showType:4},{key:9,name:"发货状态",width:"100",align:"",rowColor:"changeOrderStatus_color",rowShow:"changeOrderStatus",prop:"order_status",sortable:!0,showType:4},{key:8,name:"订单时间信息",width:"180",align:"",prop:"created_time",sortable:!0,propList:[{name:"创建",prop:"created_time"},{name:"发货",prop:"shopee_delivery_time"}],showType:0},{key:11,name:"采购类型",width:"120",align:"center",rowShow:"changeTypeName",prop:"goods_info.ori_platform_id",propLink:"goods_info.ori_url",propLinkName:"查看采购地址",rowClick:"openUrl",sortable:!0,showType:4},{key:13,name:"是否可二次销售",width:"140",prop:"shot_order_info.buy_account_info.second_sale_num",align:"",showType:8},{key:14,name:"商品ID",width:"140",align:"",iCopy:"goods_info.goods_id",prop:"goods_info.goods_id",rowClick:"openUrl_product",sortable:!0,showType:0},{key:15,name:"商品创建时间",width:"140",align:"",prop:"goods_info.platform_create_time",sortable:!0,showType:0},{key:16,name:"商品图片",width:"80",align:"center",filter:bt["imageRender"],prop:"goods_info.goods_img",showType:10},{key:17,name:"商品单价",width:"120",filter:bt["siteCoin"],align:"",prop:"goods_info.discounted_price",sortable:!0,showType:11},{key:18,name:"商品数量",width:"70",prop:"goods_info.goods_count",showOverflowTooltip:!0,showType:0},{key:19,name:"商品标题",width:"140",prop:"goods_info.goods_name",showOverflowTooltip:!0,showType:0},{key:20,name:"搜同款",width:"120",align:"",showType:12},{key:21,name:"商品类目",width:"120",align:"",rowShow:"getCategoryName",prop:"goods_info.goods_category_id",showOverflowTooltip:!0,showType:4},{key:22,name:"规格编号",width:"120",align:"",prop:"goods_info.variation_id",showType:0},{key:23,name:"商品规格",width:"100",align:"center",propLink:"goods_info.ori_platform_id",prop:"goods_info.variation_name",showOverflowTooltip:!0,showType:4},{key:24,name:"商品货号",width:"120",align:"",rowShow:"replace_=|=",prop:"goods_info.variation_sku",showOverflowTooltip:!0,sortable:!0,showType:4},{key:25,name:"买家付款金额",width:"120",filter:bt["siteCoin"],prop:"total_amount",sortable:!0,showType:11},{key:26,name:"订单收入",width:"120",align:"",filter:bt["siteCoin"],prop:"escrow_amount",sortable:!0,showType:11},{key:27,name:"实际总邮费",width:"100",align:"",filter:bt["siteCoin"],prop:"actual_shipping_cost",showType:11},{key:28,name:"卖家补贴邮费",width:"120",align:"",filter:bt["siteCoin"],prop:"sell_shipping_cost",showType:11},{key:29,name:"采购价",width:"120",align:"",filter:bt["siteCoin"],prop:"shot_order_info.shot_amount",sortable:!0,showType:11},{key:30,name:"仓库发货金额",width:"120",align:"",filter:bt["siteCoin"],prop:"warehouse_ship_amount",sortable:!0,showType:16},{key:31,name:"含邮费毛利",width:"120",align:"",filter:bt["siteCoin"],prop:"gross_profit",showType:11},{key:32,name:"最终毛利",width:"120",align:"",filter:bt["siteCoin"],prop:"real_gross_profit",sortable:!0,showType:11},{key:33,name:"付款账号",width:"120",align:"",prop:"shot_order_info.pay_account_info.name",showType:0},{key:34,name:"采购账号",width:"120",align:"",prop:"shot_order_info.buy_account_info.name",sortable:!0,showType:0},{key:35,name:"拍单",width:"80",align:"",showType:17},{key:36,name:"采购状态",width:"120",align:"",propLink:"true",rowColor:"changeShotStatus_color",rowShow:"changeShotStatus",prop:"shot_order_info.shot_status",sortable:!0,showType:4},{key:37,name:"采购时间",width:"140",align:"",prop:"shot_order_info.shotted_at",sortable:!0,showType:0},{key:38,name:"采购订单号",width:"140",align:"",rowClick:"clickBuyOrder",prop:"shot_order_info.shot_order_sn",showOverflowTooltip:!0,showType:19},{key:39,name:"采购付款方式",width:"120",align:"",rowShow:"buyPayMethod",prop:"shot_order_info.shot_payment_method",showType:4},{key:40,name:"平台付款方式",width:"120",align:"",rowShow:"changePlatformPayMethod",prop:"payment_method",showType:4},{key:41,name:"采购物流信息",width:"140",align:"",prop:"shot_order_info.shot_logistics_company",propList:[{name:"公司",prop:"shot_order_info.shot_logistics_company"},{name:"单号",prop:"shot_order_info.shot_tracking_number"}],sortable:!0,showType:0},{key:43,name:"采购发货时间",width:"140",align:"",prop:"shot_order_info.shot_shipping_time",showType:0},{key:44,name:"商户订单号",width:"140",align:"",prop:"shot_order_info.merchant_no",showOverflowTooltip:!0,showType:0},{key:45,name:"货物运输及类型",width:"120",align:"",propList:[{name:"运输方式",filter:l["k"],prop:"transport_type"},{name:"货物类型",filter:l["e"],prop:"package_type"}],showType:0},{key:47,name:"虾皮物流信息",width:"170",align:"",propList:[{name:"公司",prop:"logistics_name"},{name:"单号",prop:"tracking_no"}],prop:"logistics_name",showOverflowTooltip:!0,showType:0},{key:48,name:"买家备注",width:"140",align:"",prop:"message_to_seller",showOverflowTooltip:!0,showType:0},{key:49,name:"虾皮物流轨迹",width:"130",align:"",rowClick:"getSHtrackPath",buttonName:"虾皮物流轨迹",prop:"123456",showType:7},{key:50,name:"截止发货时间",width:"140",align:"",prop:"ship_by_date",sortable:!0,showType:0},{key:51,name:"仓库发货状态",width:"120",align:"",filter:l["c"],prop:"delivery_status",sortable:!0,showType:0},{key:52,name:"仓库时间信息",width:"180",propList:[{name:"入库",prop:"storage_time"},{name:"出库",prop:"outbound_time"}],prop:"outbound_time",sortable:!0,showType:0},{key:54,name:"本地备注",width:"120",align:"",prop:"remark",showOverflowTooltip:!0,sortable:!0,showType:23},{key:55,name:"shopee备注",width:"120",align:"",showOverflowTooltip:!0,showType:24},{key:56,name:"shopee备注更新时间",width:"140",align:"",prop:"note_update_time",showType:0},{key:57,name:"买家信息",width:"150",align:"",propList:[{prop:"name",name:"姓名",rowDblClick:"copyItem"},{name:"手机",prop:"phone",rowDblClick:"copyItem"}],showOverflowTooltip:!0,showType:0},{key:58,name:"买家地址",width:"120",align:"",prop:"receiver_info.address",showOverflowTooltip:!0,rowDblClick:"copyItem",showType:0},{key:60,name:"订单支付时间",width:"140",align:"",prop:"pay_time",sortable:!0,showType:0},{key:61,name:"订单更新时间",width:"140",align:"",prop:"update_time",sortable:!0,showType:0},{key:62,name:"是否为海外仓商品",width:"120",rowShow:"1_or_true",align:"",prop:"goods_info.is_overseas_goods",showType:4}],columnConfigShowList:[],column_search:"",tableHeight:430,sortRule:{prop:null,order:null},tabData:""}},computed:{getCategoryName:function(){return function(e,t){return this.categoryInfo[e]||(this.categoryInfo[e]="正在获取类目...",this.getCategoryInfo(e,t)),this.categoryInfo["category_".concat(e)]||""}}},watch:{columnVisible:function(e){var t=this;e&&(this.columnConfigShowList=[],this.tableColumnList.forEach((function(e){t.columnConfigShowList.push(Object(c["a"])({},e))})))},tableColumnShow:function(e){if(e){var t=document.body.offsetHeight;t-=410,this.tableHeight=t>200&&t||200}}},mounted:function(){var e=this;this.tableLoading=!0,this.createTime=Object(d["f"])(15),this.getColorList(),this.getColumnsConfig(),this.getSecondSaleList(),this.getRate(),setTimeout((function(){e.getOrderList(1)}),2e3),this.$IpcMain.on("skuRelation",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r["OriGoodsPlatform "]=1,t.next=3,e.$commodityService.saveSkuRelation(JSON.stringify(r));case 3:if(a=t.sent,n=a&&JSON.parse(a),!n||200!==n.code){t.next=9;break}return t.abrupt("return",e.$message.success("收藏成功"));case 9:return t.abrupt("return",e.$message.error("收藏失败，".concat(n.msg)));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.$IpcMain.on("FinishShotOrderMessage",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getOrderList(null,"FinishShotOrderMessage");case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.$IpcMain.on("updateShopeeCookie",function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},methods:{sortChange:function(e){if(null!==e.order&&"ship_by_date"===e.prop){for(var t=[],r=0;r<this.tableData.length;r++)this.tableData[r].ship_by_date?t.unshift(this.tableData[r]):t.push(this.tableData[r]);this.tableData=t}null===e.order&&(this.tableData=this.tabData),this.sortRule.order=e.order,this.sortRule.prop=e.prop},tableRowBound:function(e,t,r,a){if("viewDetails_orderDetail"===e)this.viewDetails("orderDetail",t.order_id,t.mall_info.platform_mall_id);else if("copyItem"===e)this.copyItem(this.getTableRow(t,a.prop));else if("openUrl"===e)this.openUrl(t.goods_info.ori_url);else{if("changeColorLabel"===e)return this.changeColorLabel(this.getTableRow(t,a.prop),"name");if("changeOrderStatus"===e)return this.changeOrderStatus(this.getTableRow(t,a.prop));if("changeTypeName"===e)return this.changeTypeName(this.getTableRow(t,a.prop),this.goodsSourceList);if("openUrl_product"===e)this.openUrl(t,"product");else{if("getCategoryName"===e)return t.goods_info?this.getCategoryName(t.goods_info.goods_category_id,t.country):"未匹配到类目";if("replace_=|="===e)return this.getTableRow(t,a.prop).replace("=|=","");if("buyPayMethod"===e)return this.buyPayMethod[this.getTableRow(t,a.prop)];if("changePlatformPayMethod"===e)return this.changePlatformPayMethod(t.country,this.getTableRow(t,a.prop));if("1_or_true"===e)return 1==this.getTableRow(t,a.prop)?"是":"否";if("getSHtrackPath"===e)this.getSHtrackPath(t);else if("clickBuyOrder"===e)this.clickBuyOrder(t);else{if("changeOrderStatus_color"===e)return this.changeOrderStatus(this.getTableRow(t,a.prop),"color");if("changeShotStatus_color"===e)return this.changeShotStatus(this.getTableRow(t,a.prop),"color");if("changeShotStatus"===e)return this.changeShotStatus(this.getTableRow(t,a.prop))}}}},uniqueArr:function(e){var t,r=new Map,a=Object(i["a"])(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;r.has(n.main_order_sn)||r.set(n.main_order_sn,n)}}catch(s){a.e(s)}finally{a.f()}return Object(o["a"])(r.values())},clickBuyOrder:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.shot_order_info.buy_account_info){r.next=2;break}return r.abrupt("return",t.$message.warning("订单无买手号信息"));case 2:if(a=t.buyerAccountList.find((function(t){return t.name===e.shot_order_info.buy_account_info.name&&t.type==e.shot_order_info.buy_account_info.type})),n="",!a){r.next=33;break}r.t0=a.type,r.next=1===r.t0?8:2===r.t0||3===r.t0?12:8===r.t0?16:9===r.t0?20:11===r.t0?24:30;break;case 8:return n=t.changeAccountParams(a),r.next=11,t.$buyerAccountService.pddOrderCenter(n,e.shot_order_info.shot_order_sn);case 11:return r.abrupt("break",31);case 12:return n=t.changeAccountParams(a),r.next=15,t.$buyerAccountService.taobaoOrderCenter(n,e.shot_order_info.shot_order_sn);case 15:return r.abrupt("break",31);case 16:return n=t.changeAccountParams(a),r.next=19,t.$buyerAccountService.AlibabaOrderCenter(n,e.shot_order_info.shot_order_sn);case 19:return r.abrupt("break",31);case 20:return n=t.changeAccountParams(a),r.next=23,t.$buyerAccountService.lazadaOrderCenter(e.country,n,e.shot_order_info.shot_order_sn);case 23:return r.abrupt("break",31);case 24:return o="",o=e.shot_order_info.buy_account_info.orderType?"/user/purchase/order/".concat(e.shot_order_info.buy_account_info.orderId,"?type=").concat(e.shot_order_info.buy_account_info.orderType):"/user/purchase/order/".concat(e.shot_order_info.buy_account_info.orderId,"/?shopid=").concat(e.shot_order_info.shop_id),n=t.changeAccountParams(a),r.next=29,t.$buyerAccountService.shopeeOrderCenter(e.country,n,o);case 29:return r.abrupt("break",31);case 30:return r.abrupt("break",31);case 31:r.next=34;break;case 33:return r.abrupt("return",t.$message.warning("请登录相应买手号！"));case 34:case"end":return r.stop()}}),r)})))()},editRemarkNode:function(e){this.activeRemarkIDNode=e;var t=this.tableData.findIndex((function(t){return t.id===e}));this.orderRemarkNode=this.tableData[t].note,this.orderRemarkCopyNode=this.tableData[t].note},changeRemarkNode:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t.tableData.findIndex((function(t){return t.id===e})),n={order_id:t.tableData[a].order_id,new_note:t.orderRemarkNode,shop_id:t.tableData[a].mall_info.platform_mall_id},r.next=4,t.$shopeemanService.updateNode(t.tableData[a].country,n);case 4:if(o=r.sent,200!=o.code){r.next=10;break}return t.$message.error("设置备注成功"),t.tableData[a].note=n.new_note,t.activeRemarkIDNode="",r.abrupt("return");case 10:t.$message.error("设置备注失败"),t.activeRemarkIDNode="";case 12:case"end":return r.stop()}}),r)})))()},editRemark:function(e){this.activeRemarkID=e;var t=this.tableData.findIndex((function(t){return t.id===e}));this.orderRemark=this.tableData[t].remark},changeRemark:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t.orderRemark,r.next=3,t.$api.setLocalRemark({id:e,remark:a});case 3:if(n=r.sent,200!=n.data.code){r.next=10;break}return o=t.tableData.findIndex((function(t){return t.id===e})),t.$message.success("设置备注成功"),t.tableData[o].remark=a,t.activeRemarkID="",r.abrupt("return");case 10:t.$message.error("设置备注失败"),t.activeRemarkID="";case 12:case"end":return r.stop()}}),r)})))()},changeTime:function(e,t,r){if(e){var a=Object(d["n"])(new Date(e[0]).getTime(),new Date(e[1]).getTime());return a>93?(r?this[t][r]=Object(d["f"])(30):this[t]=Object(d["f"])(30),this.$message.warning("只支持查询或导出93天内的数据,请重新选择时间！")):void 0}},batchPrintOrderSurface:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c,l,u,d,p,h,m,f,g,b,_,v,y,w,k,x,S,L,C;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请选择要操作的数据！"));case 2:if(r="",a={},n="",e.multipleSelection.forEach((function(e,t){a[e.country]=e.country,r=e.country,n=0===t?e.main_order_sn:n+","+e.main_order_sn})),!(Object.keys(a).length>1)){t.next=8;break}return t.abrupt("return",e.$message.warning("由于每个站点面单不一致，请分站点批量预览和打印！"));case 8:return o={mainOrderSns:n},i=[],t.prev=10,t.next=13,e.$api.getLogisticsInformationBatch(o);case 13:if(s=t.sent,200!==s.data.code){t.next=18;break}i=s.data.data,t.next=19;break;case 18:return t.abrupt("return",e.$message.warning("面单获取失败！"));case 19:if(i.length){t.next=21;break}return t.abrupt("return",e.$message.warning("暂无面单信息"));case 21:c=[],e.showConsole=!1,l=function(t){var r=i[t];if(!r.url)return e.$refs.Logs.writeLog("订单".concat(r.order_sn,"获取面单信息为空"),!1),"continue";var a=e.multipleSelection.find((function(e){return e.main_order_sn==r.order_sn})),n={PDFUrl:r.url,OrderNo:a.main_order_sn,MainOrderNo:a.main_order_sn,PlatformLogisticsId:a.tracking_no,PlatformLogisticsName:"",CreateTime:r.created_at,BuyerName:a.name,BuyerPhone:a.phone,BuyerAddress:a.receiver_info.address,BuyerNote:"",BarInfo:{BarCode:a.main_order_sn,BarCodeWidth:200,BarCodeHeight:50},SkuList:[a.goods_info.variation_sku.replace("=|=",""),a.goods_info.goods_count],IsNeedCut:!(30008!=a.logistics_id&&30007!=a.logistics_id),IsUseA4Size:!1,PdfWidth:320,PdfHeight:425,LocationY:-420,PrintStatus:"0",MallId:a.mall_info.platform_mall_id,MallName:a.mall_info.platform_mall_name};c.push(n)},u=0;case 25:if(!(u<i.length)){t.next=32;break}if(d=l(u),"continue"!==d){t.next=29;break}return t.abrupt("continue",29);case 29:u++,t.next=25;break;case 32:return p={IsDownload:!1,PdfExtendName:".PDF",PdfExtendNameIsLower:!1,IsPrintVirtualFaceSheet:!1,Site:r,IsShowWindow:!0,PdfInfoList:c,VirtualPdfPath:{},ConvertFaceInfoList:[]},t.next=35,window["BaseUtilBridgeService"].getOrderPdfInfo(p);case 35:if(h=t.sent,m=JSON.parse(h),200!=m.code){t.next=40;break}t.next=43;break;case 40:for(g in f="",m.failList)f=f+","+m.failList[g],f=f.substring(1);return t.abrupt("return",e.$refs.Logs.writeLog("".concat(f),!1));case 43:b=[],_=function(t){var a=i[t];if(!a.url&&"TW"!==r)return e.$refs.Logs.writeLog("订单".concat(a.order_sn,"未获取到面单信息"),!1),"continue";var n=e.multipleSelection.find((function(e){return e.main_order_sn==a.order_sn})),o=m.data&&m.data.find((function(e){return e&&e.OrderSn==n.main_order_sn}))||null,s={HtmlFilePath:o?o.PDFFilePath:a.url&&a.url.includes(".html")?a.url:"",PDFFilePath:o?o.PDFFilePath:a.url&&a.url.includes(".PDF")||a.url&&a.url.includes(".pdf")?a.url:"",LogisticsId:n.logistics_id.toString(),OrderSn:n.main_order_sn,MallId:Number(n.mall_info.platform_mall_id),VirtualFilePath:""};b.push(s)},v=0;case 46:if(!(v<i.length)){t.next=53;break}if(y=_(v),"continue"!==y){t.next=50;break}return t.abrupt("continue",50);case 50:v++,t.next=46;break;case 53:return t.next=55,window["BaseUtilBridgeService"].htmlToPdf(b,!1);case 55:if(w=t.sent,k=w&&JSON.parse(w),k||200!=!k.code){t.next=61;break}for(S in x="",k.failList)x=x+","+k.failList[S],x=x.substring(1);return t.abrupt("return",e.$refs.Logs.writeLog("打印面单失败,".concat(x),!1));case 61:return L=JSON.parse(JSON.stringify(c)),L.forEach((function(e){var t=m.data.find((function(t){return t&&t.OrderSn==e.OrderNo}));t&&(e.PDFUrl=t.PDFFilePath)})),C={IsDownload:!1,PdfExtendName:".PDF",PdfExtendNameIsLower:!1,IsPrintVirtualFaceSheet:!1,Site:r,IsShowWindow:!0,PdfInfoList:L,VirtualPdfPath:{},ConvertFaceInfoList:k.data},e.tableLoading=!0,t.next=67,window["BaseUtilBridgeService"].downloadPdf(C);case 67:t.sent,e.tableLoading=!1,t.next=75;break;case 71:t.prev=71,t.t0=t["catch"](10),e.tableLoading=!1,e.$refs.Logs.writeLog("打印面单失败",!1);case 75:case"end":return t.stop()}}),t,null,[[10,71]])})))()},pushOrderToStoreSingle:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.multipleSelection=[e],t.pushOrderToStoreVisible=!0;case 2:case"end":return r.stop()}}),r)})))()},getRate:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window["ConfigBridgeService"].getUserInfo();case 2:r=t.sent,e.rateList=r.ExchangeRates||{};case 4:case"end":return t.stop()}}),t)})))()},changeMoney:function(e,t,r){var a=e;return this.rateList[t]&&(a=r?(Number(e)/Number(this.rateList[t]||1)).toFixed(2):(Number(e)*Number(this.rateList[t]||1)).toFixed(2)),a},setSKURelation:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.accountpdd){r.next=3;break}return t.$message.error("请先选择拼多多买手号"),r.abrupt("return");case 3:if(a=t.getAccountById(t.accountpdd),a){r.next=6;break}return r.abrupt("return",t.$message.warning("没有找到拼多多买手号"));case 6:n=t.changeAccountParams(a),o={OrderSn:e.order_sn,SysOrderId:e.id,OriGoodsUrl:e.goods_info.ori_url,GoodsTitle:e.goods_info.goods_name,GoodsId:e.goods_info.goods_id,GoodsSku:e.goods_info.variation_sku,GoodsSkuId:e.goods_info.variation_id,GoodsNum:e.goods_info.goods_count,GoodsPrice:e.total_amount,OriGoodsTitle:"",OriGoodsSku:"",OriGoodsSkuId:e.ori_sku_id||"",OriGoodsNum:"",OriGoodsId:e.ori_goods_id||""},t.$buyerAccountService.getSkuRelation(o,n);case 9:case"end":return r.stop()}}),r)})))()},syncOriginGoodsNum:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请选择要操作的数据"));case 2:e.showConsole=!1,e.$refs.Logs.consoleMsg="",e.$refs.Logs.writeLog("开始同步上家库存，请耐心等待！",!0),r=0;case 6:if(!(r<e.multipleSelection.length)){t.next=13;break}return a=e.multipleSelection[r],t.next=10,Object(d["h"])(a.goods_info.ori_goods_id,a.goods_info.ori_platform_id,a.mall_info.platform_mall_id,a.goods_info.goods_id,a.country,a.order_sn,e.$refs.Logs.writeLog,a.goods_info.ori_platform_mall_id,a.goods_info.ori_country,e,a);case 10:r++,t.next=6;break;case 13:case"end":return t.stop()}}),t)})))()},changeColorLabel:function(e,t){var r=this.colorList.find((function(t){return t.id==e}));return"name"===t?r&&0!==r.id?r.name:"":r?r.color:""},soSameItem:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r.clickRow=t,r.collectType=e,r.collectionVisible=!0;case 3:case"end":return a.stop()}}),a)})))()},cancelSecondSale:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={sysOrderId:e.id},r.next=3,t.$api.cancelSecondSale(a);case 3:n=r.sent,200===n.data.code?(t.$message.success("取消成功！"),t.getOrderList()):t.$message.error("取消失败，".concat(n.data.message));case 5:case"end":return r.stop()}}),r)})))()},getSecondSaleList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={goodsId:e.goodsId,variationId:e.skuId,goodsSpec:e.goodsNum},t.next=3,e.$api.getsecondlist(r);case 3:a=t.sent,200===a.data.code&&(e.secondOrderList=a.data.data);case 5:case"end":return t.stop()}}),t)})))()},isSecondSale:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.tableData.forEach((function(t,r){var a=!0,n="自选出库",o="nomal";if(t.order_sn!=t.main_order_sn)a=!1;else if(t.shot_order_info.buy_account_info&&t.shot_order_info.buy_account_info.second_sale_num)a=!1;else if(e.secondOrderList.length)if(Number(t.order_status>=6))a=!1;else if(Number(t.shot_order_info.shot_status)>=4)a=!1;else for(var i=0;i<e.secondOrderList.length;i++){var s=e.secondOrderList[i];if(t.goods_info.variation_id==s.variation_id&&t.country==s.country&&s.goods_count>0){n="规格编号匹配出库",o="skuId",a=!0;break}if(t.goods_info.goods_id==s.goods_id&&t.country==s.country&&s.goods_count>0){n="商品ID匹配出库",o="goodsId",a=!0;break}if(t.goods_info.goods_spec&&t.goods_info.goods_spec==s.variation_name&&t.country==s.country&&s.goods_count>0){n="商品货号匹配出库",o="skuName",a=!0;break}}else a=!1;e.$set(e.tableData[r],"secondSaleTitle",n),e.$set(e.tableData[r],"isSecond",a),e.$set(e.tableData[r],"secondType",o)}));case 1:case"end":return t.stop()}}),t)})))()},chooseSecondSale:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.clickRow=e,t.secondSaleVisible=!0;case 2:case"end":return r.stop()}}),r)})))()},goodsTop:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={id:Number(e.goods_info.goods_id),shop_id:e.mall_info.platform_mall_id},r.next=3,t.$shopeemanService.handleGoodsTop(e.country,a);case 3:n=r.sent,200===n.code?t.$message.success("商品置顶成功！"):t.$message.error("商品置顶失败");case 5:case"end":return r.stop()}}),r)})))()},goodsDelete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$confirm("是否删除该商品?","商品删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["a"])(t,e)})).catch((function(){}));case 1:case"end":return r.stop()}}),r)})))()},goodsDelist:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$confirm("是否下架该商品?","商品下架",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["b"])(t,e)})).catch((function(){}));case 1:case"end":return r.stop()}}),r)})))()},saveHandleOut:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={order_id:e.clickRow.order_id,shipping_proof:e.shippingProof,shipping_trace_no:e.shippingTraceNo,channel_id:79900,integrated:"",shop_id:e.clickRow.mall_info.platform_mall_id},t.next=4,e.$shopeemanService.handleOutOrder(e.clickRow.country,r);case 4:a=t.sent,200===a.data?(e.$message.success("发货成功！"),e.closeDialog()):e.$message.error("发货失败，".concat(a.data)),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})))()},handleOutOrder:function(e){this.clickRow=e,this.handOutOrderVisible=!0,this.shippingProof=e.logistics_name,this.shippingTraceNo=e.tracking_no},openPddDisount:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[],a=e.buyerAccountList.filter((function(e){return 1===e.type})),a.length&&a.forEach((function(t){var a=e.changeAccountParams(t);r.push(a)})),t.next=5,e.$buyerAccountService.pddCouponWindow(r);case 5:case"end":return t.stop()}}),t)})))()},changeAccountParams:function(e){var t={UserNameCache:e.cache_path,Password:"",shotOrderPlatform:Object(l["b"])(e.type),LoginedCookies:e.login_info,UserName:e.name,Cookiestr:JSON.stringify(e.login_info),AccountType:e.type,Ua:e.ua,Country:e.site||""};return t},getCategoryInfo:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o,i,s,c,l,u,d,p,h;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=r.categoryInfo["category_".concat(e)],n){a.next=20;break}return a.next=4,r.$appConfig.temporaryCacheInfo("get","category_".concat(e),"");case 4:if(o=a.sent,i=r.isJsonString(o),i&&"{}"!==o){a.next=19;break}return r.$appConfig.temporaryCacheInfo("save","category_".concat(e),"正在获取类目"),a.next=10,r.$commodityService.getCategoryTbInfo(t,e.toString(),"0","");case 10:l=a.sent,u=l&&r.isJsonString(l),d=u.data.categories&&u.data.categories[0]||"",p=null!==(s=null===d||void 0===d?void 0:d.category_cn_name)&&void 0!==s?s:"未匹配到类目",h=null!==(c=null===d||void 0===d?void 0:d.category_name)&&void 0!==c?c:"未匹配到类目",r.categoryInfo["category_".concat(e)]=p,r.$appConfig.temporaryCacheInfo("save","category_".concat(e),{category_name:h,category_cn_name:p}),a.next=20;break;case 19:r.categoryInfo["category_".concat(e)]=i["category_cn_name"];case 20:case"end":return a.stop()}}),a)})))()},viewDetails:function(e,t,r){var a={type:e,shopId:r,id:t};this.$BaseUtilService.getOrderDetailInfo(r,JSON.stringify(a))},batchReplyOrderBuyer:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.length){r.next=2;break}return r.abrupt("return",t.$message.warning("请选择数据！"));case 2:t.replyBuyerData=e,t.replayOrderBuyerVisible=!0;case 4:case"end":return r.stop()}}),r)})))()},getLazadaPayType:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.multipleSelection.filter((function(e){return 9==e.goods_info.ori_platform_id})),r.length){t.next=3;break}return t.abrupt("return",e.$message.warning("请选择采购类型为lazada的数据"));case 3:if(a=e.buyerAccountList.filter((function(e){return 9===e.type})),e.showConsole=!1,a.length){t.next=8;break}return e.$refs.Logs.writeLog("请登录lazada买手号",!1),t.abrupt("return",e.$message.warning("请登录lazada买手号"));case 8:e.$refs.Logs.writeLog("开始获取lazada付款方式",!0),n=regeneratorRuntime.mark((function t(n){var o,i,s,c,l,u,d,p,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=r[n],o.shot_order_info.buy_account_info){t.next=4;break}return e.$refs.Logs.writeLog("【".concat(o.order_sn,"】，当前没有拍单信息，无法获取！"),!1),t.abrupt("return","continue");case 4:if(i=o.shot_order_info.buy_account_info.name,s=a.find((function(e){return e.name===i})),s){t.next=9;break}return e.$refs.Logs.writeLog("【".concat(o.order_sn,"】，对应的买手号【").concat(i,"】没有找到，请登录对应买手号！"),!1),t.abrupt("return","continue");case 9:return c="",t.prev=10,t.next=13,e.$commodityService.getLazadaOrderDetail(o.country,JSON.stringify(s.login_info),o.shot_order_info.shot_order_sn);case 13:if(l=t.sent,c=l,u=JSON.parse(l),!u||!u.data){t.next=25;break}return t.next=19,e.$commodityService.getLazadaPayMethod(o.country,JSON.stringify(s.login_info),l,o.shot_order_info.shot_order_sn);case 19:return d=t.sent,p={sysOrderId:o.id,shotOrderSn:o.shot_order_info.shot_order_sn,paymentMethod:d},t.next=23,e.$api.uplaodLazadaPaymentMethod(p);case 23:h=t.sent,200===h.data.code?e.$refs.Logs.writeLog("【".concat(o.order_sn,"】获取付款方式成功，上报成功"),!0):e.$refs.Logs.writeLog("【".concat(o.order_sn,"】获取付款方式失败，上报失败，").concat(h.data.message),!1);case 25:t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](10),e.$refs.Logs.writeLog("【".concat(o.order_sn,"】获取付款方式失败，买手号【").concat(i,"】").concat(c||t.t0),!1);case 30:case"end":return t.stop()}}),t,null,[[10,27]])})),o=0;case 11:if(!(o<r.length)){t.next=19;break}return t.delegateYield(n(o),"t0",13);case 13:if(i=t.t0,"continue"!==i){t.next=16;break}return t.abrupt("continue",16);case 16:o++,t.next=11;break;case 19:case"end":return t.stop()}}),t)})))()},getorderPath:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.orderTrackPath=[],t.clickRow=e,t.orderPathVisible=!0,a={package_order_sn:e.order_sn},t.orderPathInfoLoading=!0,r.next=7,t.$XzyNetMessageService.post("xzy.orderTrajectoryV2",a);case 7:n=r.sent,o=n&&JSON.parse(n)&&JSON.parse(n).data&&JSON.parse(JSON.parse(n).data)||void 0,o&&200===o.code&&(t.orderTrackPath=o.data.reverse()),t.orderTrackPath.length||(i=["暂无订单信息",t.$dayjs(new Date).format("YYYY-MM-DD HH:ss")],t.orderTrackPath.push(i)),t.orderPathInfoLoading=!1;case 12:case"end":return r.stop()}}),r)})))()},getSHtrackPath:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.spTrackPathVisible=!0,t.clickRow=e,a={order_id:e.order_id,shop_id:e.mall_info.platform_mall_id},t.shipInfoLoading=!0,7!=e.order_status){r.next=11;break}return r.next=7,t.$shopeemanService.getLogisticsTrackingHistoryRefund(e.mall_info.country,a);case 7:n=r.sent,200===n.code&&(t.spTrackPath=n.data.history),r.next=15;break;case 11:return r.next=13,t.$shopeemanService.getLogisticsTrackingHistory(e.mall_info.country,a);case 13:o=r.sent,200===o.code&&(t.spTrackPath=o.data.list&&o.data.list.length&&o.data.list[0].tracking_info||[]);case 15:t.spTrackPath.length||(i={ctime:Math.round((new Date).getTime()/1e3),description:"暂无物流信息"},t.spTrackPath.push(i)),t.shipInfoLoading=!1;case 17:case"end":return r.stop()}}),r)})))()},syncLogisticsSingle:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.showConsole=!1,t.$refs.Logs.consoleMsg="",a=new g["a"],t.buyerAccountList.length||t.$refs.Logs.writeLog("没有买手号，请登录买手号",!1),t.$refs.Logs.writeLog("【".concat(e.order_id,"】获取采购物流轨迹开始"),!0),a.start(t,t.buyerAccountList,t.$refs.Logs.writeLog,[e]);case 6:case"end":return r.stop()}}),r)})))()},SyncOrderSingle:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.showConsole=!1,t.$refs.Logs.consoleMsg="",t.$refs.Logs.writeLog("【".concat(e.order_id,"】开始同步，请耐心等待!"),!0),a=new f["a"],r.next=6,a.startSingel(e,t.$refs.Logs.writeLog);case 6:case"end":return r.stop()}}),r)})))()},SyncOrder:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o,i,s,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=[e.mall_info],t.showConsole=!1,t.$refs.Logs.consoleMsg="",0!=a.length){r.next=6;break}return t.$refs.Logs.writeLog("没有获取到店铺数据，同步操作已取消!",!1),r.abrupt("return");case 6:t.$refs.Logs.writeLog("开始同步，请耐心等待!",!0),n=0;case 8:if(!(n<a.length)){r.next=22;break}o=a[n],i=0;case 11:if(!(i<l["C"].length)){r.next=19;break}return s=l["C"][i],c=new f["a"](o,s,t,t.$refs.Logs.writeLog),r.next=16,c.start("".concat(n+1,"/").concat(a.length),"manual",60);case 16:i++,r.next=11;break;case 19:n++,r.next=8;break;case 22:t.$refs.Logs.writeLog("订单同步已完成！！！",!0);case 23:case"end":return r.stop()}}),r)})))()},openUrl:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e,"product"!==t){a.next=7;break}return o={platform_mall_id:e.mall_info.platform_mall_id},a.next=5,r.$shopeemanService.getWebUrl(e.country,o);case 5:i=a.sent,n=i+"/product/"+e.mall_info.platform_mall_id+"/"+e.goods_info.goods_id;case 7:r.$BaseUtilService.openUrl(n);case 8:case"end":return a.stop()}}),a)})))()},closeDialog:function(e,t){this.colorVisible=!1,this.uploadStoreShipAmountVisible=!1,this.purchaseInfoVisible=!1,this.addBuyLinkVisible=!1,this.billsDetailVisible=!1,this.handOutOrderVisible=!1,this.replayOrderBuyerVisible=!1,this.secondSaleVisible=!1,this.abroadVisible=!1,this.goodsOutStoreVisible=!1,this.shipNo="",this.shipCompany="",this.shipBindStore="",this.shipInfoVisible=!1,this.trackingNumberList=[],this.multipleSelection=[],this.isAbroadGood=0,this.$refs.multipleTable&&this.$refs.multipleTable.clearSelection(),e||this.getOrderList(),this.clickRow={}},saveAddMoreTra:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[],e.trackingNumberList.forEach((function(e){var t={id:e.id,trackingNumber:e.original_tracking_number,trackingNumberCompany:e.original_logistics_company};r.push(t)})),a={sysOrderId:e.clickRow.id,lists:r,warehouseId:e.bindStore},t.next=5,e.$api.updateOrderTrackingNumber(a);case 5:n=t.sent,200===n.data.code?(e.$message.success("添加成功!"),e.closeDialog(),e.addMoreTraNumberVisible=!1):e.$message.error("添加失败,".concat(n.data.message));case 7:case"end":return t.stop()}}),t)})))()},addMoreTrackingNumber:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o,i,s,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.clickRow=e,t.addMoreTraNumberVisible=!0,r.next=4,t.$appConfig.getWarehouseInfo(e.mall_info.platform_mall_id);case 4:for(i in a=r.sent,n=a&&JSON.parse(a)||{},o=[],n)o.push(n[i]);return[1,2,3,5,8,10].indexOf(Number(e.goods_info.ori_platform_id))>-1?t.warehouseData=o.filter((function(e){return 0==e.type})):[9,11,12,15,13].indexOf(Number(e.goods_info.ori_platform_id))>-1&&(t.warehouseData=o.filter((function(e){return 3==e.type}))),s={sysOrderId:e.id},r.next=12,t.$api.getOrderTrackingNumber(s);case 12:c=r.sent,200===c.data.code&&c.data.data.length?t.trackingNumberList=c.data.data:t.addTraNumber();case 14:case"end":return r.stop()}}),r)})))()},deleteTraNumber:function(e,t){var r=this;this.$confirm("确定要删除此物流单号吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$api.deleteOrderTrackingNumber({id:t.id});case 2:a=e.sent,200===a.data.code?r.$message.success("删除成功"):r.$message.warning("删除失败：res.data.message");case 4:case"end":return e.stop()}}),e)})))).catch((function(){})),this.trackingNumberList.splice(e,1)},addTraNumber:function(){var e={id:"0",original_tracking_number:"",original_logistics_company:"",warehouse_user_id:""};this.trackingNumberList.push(e)},addPurchaseLink:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.clickRow=e,t.addBuyLinkVisible=!0;case 2:case"end":return r.stop()}}),r)})))()},batchAddBuyInfo:function(){if(!this.multipleSelection.length)return this.$message.warning("请先选择商品！");var e={};if(this.multipleSelection.forEach((function(t){e[Number(t.goods_info.ori_platform_id)]=t.goods_info.ori_platform_id})),Object.keys(e).length>1)return this.$message.warning("只能批量添加同一个采购平台的信息");this.dealType="batch",this.purchaseInfoVisible=!0},singleBuyInfo:function(e){this.dealType="single",this.multipleSelection=[],this.multipleSelection.push(e),this.purchaseInfoVisible=!0},batchSaveShipInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.shipNo){t.next=2;break}return t.abrupt("return",e.$message.error("物流单号不能为空！"));case 2:r="",e.shipLoading=!0,a=0;case 5:if(!(a<e.multipleSelection.length)){t.next=15;break}return n=e.multipleSelection[a],o={sysOrderId:n.id,lists:[{id:"0",trackingNumber:e.shipNo,trackingNumberCompany:e.shipCompany}],warehouseId:e.shipBindStore},t.next=10,e.$api.updateOrderTrackingNumber(o);case 10:i=t.sent,200===i.data.code?r+="<p>【".concat(n.order_sn,"】添加成功</p>\n"):r+="<p>【".concat(n.order_sn,"】添加失败").concat(i.data.message,"\n</p>\n");case 12:a++,t.next=5;break;case 15:e.shipLoading=!1,e.$alert(r,"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定"});case 17:case"end":return t.stop()}}),t)})))()},batchShipInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={},e.multipleSelection.length){t.next=3;break}return t.abrupt("return",e.$message.warning("请选择订单数据！"));case 3:if(e.multipleSelection.forEach((function(e){r[Number(e.goods_info.ori_platform_id)]=e.goods_info.ori_platform_id})),!(Object.keys(r).length>1)){t.next=6;break}return t.abrupt("return",e.$message.warning("只能批量添加同一个采购平台的物流信息！"));case 6:if(a=e.multipleSelection.filter((function(e){return e.shot_order_info.shot_tracking_number})),!a.length){t.next=12;break}return n="",a.forEach((function(e){n=n+","+e.order_sn})),n=n.substring(1),t.abrupt("return",e.$message.warning("【".concat(n,"】已经存在采购物流单号，不能进行批量添加，请勿勾选这类订单")));case 12:o=null,i=regeneratorRuntime.mark((function t(r){var a,n,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.multipleSelection[r],n=0,[1,2,3,5,8,10].indexOf(Number(a.goods_info.ori_platform_id))>-1?n=0:[9,11,12,15,13].indexOf(Number(a.goods_info.ori_platform_id))>-1&&(n=3),t.next=5,e.$appConfig.getWarehouseInfo(a.mall_info.platform_mall_id);case 5:if(i=t.sent,s="{}"==i?[]:JSON.parse(i),o=s.find((function(e){return e.type==n})),!o){t.next=10;break}return t.abrupt("return","break");case 10:case"end":return t.stop()}}),t)})),s=0;case 15:if(!(s<e.multipleSelection.length)){t.next=23;break}return t.delegateYield(i(s),"t0",17);case 17:if(c=t.t0,"break"!==c){t.next=20;break}return t.abrupt("break",23);case 20:s++,t.next=15;break;case 23:if(o){t.next=25;break}return t.abrupt("return",e.$message.error("未绑定仓库！"));case 25:e.shipStoreList=[o],e.shipInfoVisible=!0;case 27:case"end":return t.stop()}}),t)})))()},singlePurchase:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.multipleSelection=[],t.multipleSelection.push(e),t.purchaseHandler();case 3:case"end":return r.stop()}}),r)})))()},getCrossBorderOrderInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请选择要操作的订单"));case 2:if(r=e.multipleSelection.filter((function(e){return 13==e.goods_info.ori_platform_id})),r.length){t.next=5;break}return t.abrupt("return",e.$message.warning("请选择天猫淘宝海外平台订单！"));case 5:if(e.buyerAccountListGlobal.length){t.next=7;break}return t.abrupt("return",e.$message.warning("请登录天猫海外平台买手号！"));case 7:e.showConsole=!1,e.$refs.Logs.writeLog("获取天猫淘宝海外平台订单信息开始",!0),a=regeneratorRuntime.mark((function t(a){var n,o,i,s,c,l,u,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=r[a],n.shot_order_info.buy_account_info){t.next=4;break}return e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】没有拍单信息"),!1),t.abrupt("return","continue");case 4:if(o=n.shot_order_info.buy_account_info.name,i=e.buyerAccountListGlobal.find((function(e){return e.user_id==o.split("_")[1]})),i){t.next=9;break}return e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】没有登录相应的买手号【").concat(o,"】"),!1),t.abrupt("return","continue");case 9:return t.next=11,window["BaseUtilBridgeService"].getCrossBorderOrderInfo(i.access_token,n.shot_order_info.shot_order_sn);case 11:if(s=t.sent,c=s&&JSON.parse(s),!c.success){t.next=27;break}if(l=c.data&&c.data.purchase_orders||[],u=l.find((function(e){return e.outer_purchase_id==n.shot_order_info.shot_order_sn})),!u||!u.sub_purchase_orders){t.next=24;break}return d={sysOrderId:n.id,trackingNumber:u.sub_purchase_orders[0].logistic_number||"",deliveryTime:u.sub_purchase_orders[0].rts_time||"",trackingNumberCompany:u.sub_purchase_orders[0].logistic_company_name||""},t.next=20,e.$api.uploadTrackingNumber(d);case 20:p=t.sent,200===p.data.code?e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】获取成功"),!0):e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】上报失败，").concat(p.data.message),!1),t.next=25;break;case 24:e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】获取失败，暂无物流信息"),!1);case 25:t.next=28;break;case 27:e.$refs.Logs.writeLog("订单编号【".concat(n.order_sn,"】获取失败，").concat(c.message),!1);case 28:case"end":return t.stop()}}),t)})),n=0;case 11:if(!(n<r.length)){t.next=19;break}return t.delegateYield(a(n),"t0",13);case 13:if(o=t.t0,"continue"!==o){t.next=16;break}return t.abrupt("continue",16);case 16:n++,t.next=11;break;case 19:e.$refs.Logs.writeLog("获取天猫淘宝海外平台订单信息结束",!0);case 20:case"end":return t.stop()}}),t)})))()},purchaseGlobalOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请选择要操作的订单"));case 2:if(r=e.multipleSelection.filter((function(e){return 13==e.goods_info.ori_platform_id})),r.length){t.next=5;break}return t.abrupt("return",e.$message.warning("请选择天猫淘宝海外平台订单！"));case 5:if(a=e.getAccountGlobalById(e.accountCrossBorder),a){t.next=8;break}return t.abrupt("return",e.$message.warning("请登录并选择".concat(e.changeTypeName(13,e.goodsSourceList),"拍单账号")));case 8:n=[a],e.showConsole=!1,e.$refs.Logs.consoleMsg="",o=new mt(r,n,e),o.start(e.$refs.Logs.writeLog);case 13:case"end":return t.stop()}}),t)})))()},purchaseHandler:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s,c,l,u,d,p,h,m,f,g,b,_,v;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请选择要操作的订单"));case 2:if(r=JSON.parse(JSON.stringify(e.multipleSelection)),a={},n={},o={},i={},r.forEach((function(e){i[e.goods_info.ori_platform_id]=e.goods_info.ori_platform_id,!e.goods_info.ori_platform_id||2!=e.goods_info.ori_platform_id&&3!=e.goods_info.ori_platform_id?e.goods_info.ori_platform_id&&8==e.goods_info.ori_platform_id?a["1688"]="1688":e.goods_info.ori_platform_id&&9==e.goods_info.ori_platform_id?(o[e.country]=e.country,i[e.goods_info.ori_platform_id]=e.country):e.goods_info.ori_platform_id&&11==e.goods_info.ori_platform_id&&(n[e.country]=e.country,i[e.goods_info.ori_platform_id]=e.country):a["tb"]="tb"})),!(Object.keys(a).length>1)){t.next=10;break}return t.abrupt("return",e.$message.error("淘宝(天猫)与1688的订单请分开拍单"));case 10:if(s=r.filter((function(e){return e.goods_info.ori_platform_id&&12==e.goods_info.ori_platform_id})),!(s.length>0)){t.next=13;break}return t.abrupt("return",e.$message.error("请先将速卖通的采购链接更换成国内的采购链接再进行拍单！"));case 13:if(!(Object.keys(o).length>1)){t.next=15;break}return t.abrupt("return",e.$message.error("目前只支持单个站点的lazada批量拍单,请区分站点！"));case 15:if(!(Object.keys(n).length>1)){t.next=17;break}return t.abrupt("return",e.$message.error("目前只支持单个站点的Shopee批量拍单,请区分站点！"));case 17:c=[],c[1]=e.accountpdd,c[2]=e.accounttaobao,c[3]=e.accounttaobao,c[10]=e.accountjx,c[4]=e.accountjd,c[8]=e.account1688,c[9]=e.accountlazada,c[11]=e.accountshopee,c[13]=e.accountCrossBorder,l=null,u=null,d=null,p=null,h=null,m=null,f=null,g=null,t.t0=regeneratorRuntime.keys(i);case 36:if((t.t1=t.t0()).done){t.next=66;break}if(b=t.t1.value,c[b]){t.next=40;break}return t.abrupt("return",e.$message.error("请登录并选择".concat(e.changeTypeName(b,e.goodsSourceList),"拍单账号")));case 40:t.t2=b,t.next="1"===t.t2?43:"2"===t.t2||"3"===t.t2?45:"10"===t.t2?47:"8"===t.t2?49:"9"===t.t2?51:"11"===t.t2?53:"13"===t.t2?55:57;break;case 43:return l=e.getAccountById(e.accountpdd),t.abrupt("break",58);case 45:return u=e.getAccountById(e.accounttaobao),t.abrupt("break",58);case 47:return p=e.getAccountById(e.accountjx),t.abrupt("break",58);case 49:return h=e.getAccountById(e.account1688),t.abrupt("break",58);case 51:return m=e.getAccountById(e.accountlazada),t.abrupt("break",58);case 53:return f=e.getAccountById(e.accountshopee),t.abrupt("break",58);case 55:return g=e.getAccountGlobalById(e.accountCrossBorder),t.abrupt("break",58);case 57:return t.abrupt("break",58);case 58:if(9!=b||!c[9]||!m){t.next=61;break}if(m.site==i[b]){t.next=61;break}return t.abrupt("return",e.$message.error("请登录并选择对应站点的Lazada拍单账号"));case 61:if(11!=b||!c[11]||!f){t.next=64;break}if(f.site==i[b]){t.next=64;break}return t.abrupt("return",e.$message.error("请登录并选择对应站点的Shopee拍单账号"));case 64:t.next=36;break;case 66:_=ct.a.remove([l,u,d,p,h,m,f,g],(function(e){return null!=e&&void 0!==e})),e.showConsole=!1,e.$refs.Logs.consoleMsg="",v=new mt(r,_,e),v.start(e.$refs.Logs.writeLog);case 71:case"end":return t.stop()}}),t)})))()},getAccountGlobalById:function(e){var t=null;return e&&this.buyerAccountListGlobal.forEach((function(r){r.id===e&&(t=r)})),t},getAccountById:function(e){var t=null;return e&&this.buyerAccountList.forEach((function(r){r.id===e&&(t=r)})),t},outStoreBefore:function(e,t){if(!this.multipleSelection.length)return this.$message.warning("请选择数据");var r=this.multipleSelection.filter((function(e){return 2===e.order_status}));if(!r.length)return this.$message.warning("只有待发货的订单，才能进行出货！");var a={};if(this.multipleSelection.forEach((function(e){a[e.order_status]=e.order_status})),Object.keys(a).length>1)return this.$message.warning("只有待发货的订单，才能进行出货！");this.outStoreTitle=e,this.outStoreType=t,this.goodsOutStoreVisible=!0},setColorSingle:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.clickRow=e,t.multipleSelection=[e],t.colorVisible=!0,r.next=5,t.getColorList();case 5:case"end":return r.stop()}}),r)})))()},setColor:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.colorRow&&"{}"!==JSON.stringify(t.colorRow)){r.next=2;break}return r.abrupt("return",t.$message.warning("请选择要标记的颜色!"));case 2:return a="",e.forEach((function(e,t){a=0===t?e.id:a+","+e.id})),n={sysOrderIds:a,id:t.colorRow.id},r.next=7,t.$api.setColorLabel(n);case 7:o=r.sent,200===o.data.code?(e.forEach((function(e){var r=t.tableData.findIndex((function(t){return t.id==e.id}));r>-1&&(t.tableData[r].color_id=t.colorRow.id)})),t.colorVisible=!1,t.$message.success("设置成功")):t.$message.error("设置失败-".concat(o.data.message));case 9:case"end":return r.stop()}}),r)})))()},getColorList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.colorList=[],e.colorLoading=!0,t.next=4,e.$api.colorLabelList();case 4:r=t.sent,e.colorLoading=!1,200===r.data.code&&(e.selectColorList=JSON.parse(JSON.stringify(r.data.data)),e.colorList=r.data.data,a={id:0,name:"取消标识",color:""},e.colorList.unshift(a));case 7:case"end":return t.stop()}}),t)})))()},getCurrentRow:function(e){this.colorRow=e},openBefore:function(){if(!this.multipleSelection.length)return this.$message.warning("请先选择需要备注的商品！");this.localRamarkVisible=!0},batchSetRemark:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.multipleSelection.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先选择需要标记的商品！"));case 2:e.showConsole=!1,e.multipleSelection.forEach(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={id:r.id,remark:e.localRamark},t.next=3,e.$api.setLocalRemark(a);case 3:n=t.sent,200===n.data.code?(o=e.tableData.findIndex((function(e){return e.id===r.id})),e.$set(e.tableData[o],"remark",e.localRamark),e.$refs.Logs.writeLog("订单编号【".concat(r.order_sn,"】备注成功"),!0)):e.$refs.Logs.writeLog("订单编号【".concat(r.order_sn,"】备注失败-").concat(n.data.message),!1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.localRamarkVisible=!1,e.closeDialog("noRefresh");case 6:case"end":return t.stop()}}),t)})))()},setAbroadSingle:function(e){this.multipleSelection=[e],this.abroadVisible=!0},setAbroadGood:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.length){r.next=2;break}return r.abrupt("return",t.$message.warning("请先选择需要标记的商品！"));case 2:if(0!==t.isAbroadGood){r.next=4;break}return r.abrupt("return",t.$message.warning("请选择标记类型！"));case 4:t.$refs.Logs.consoleMsg="",e.forEach(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={sysOrderId:r.id,status:t.isAbroadGood},e.prev=1,e.next=4,t.$api.markGoodsIsOverseas(a);case 4:n=e.sent,200===n.data.code?(o=t.tableData.findIndex((function(e){return e.id===r.id})),t.$set(t.tableData[o].goods_info,"is_overseas_goods",t.isAbroadGood),t.$refs.multipleTable.toggleRowSelection(r,!1),t.$refs.Logs.writeLog("商品ID【".concat(r.goods_info.goods_id,"】标记成功"),!0)):t.$refs.Logs.writeLog("商品ID【".concat(r.goods_info.goods_id,"】标记失败-").concat(n.data.message),!1),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$refs.Logs.writeLog("商品ID【".concat(r.goods_info.goods_id,"】标记失败-").concat(e.t0),!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()),t.isAbroadGood=0,t.abroadVisible=!1;case 8:case"end":return r.stop()}}),r)})))()},checkAllColumn:function(e){this.columnConfigShowList=Object(o["a"])(this.columnConfigShowList.map((function(t){return Object.assign(t,{is_show:e})})))},uploadColumn:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableColumnShow=!1,e.tableColumnList=e.columnConfigShowList,r=[],e.columnConfigShowList.forEach((function(e,t){r.push({columnHeader:e.column_header,isShow:e.is_show,width:e.width,sortNumber:t})})),a={lists:r},t.next=7,e.$api.uploadColumnsConfig(a);case 7:n=t.sent,e.tableColumnShow=!0,e.closeDialog(),e.columnVisible=!1,200===n.data.code&&(e.$message.success("配置成功！"),e.columnVisible=!1);case 12:case"end":return t.stop()}}),t)})))()},getColumnsConfig:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$api.getColumnsConfig();case 3:r=t.sent,a=r.data,200===a.code&&(n=a.data||[],n.length&&(e.columnConfigList=n)),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:return t.prev=10,e.setColumnConfigShowList(),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,8,10,13]])})))()},syncLogistics:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.showConsole=!1,e.$refs.Logs.consoleMsg="",e.$refs.Logs.writeLog("获取采购物流轨迹开始",!0),r=new g["a"],e.buyerAccountList.length){t.next=7;break}return e.$refs.Logs.writeLog("没有买手号，请登录买手号",!1),t.abrupt("return",e.$message.warning("没有买手号,请登录！"));case 7:e.multipleSelection.length>0?r.start(e,e.buyerAccountList,e.$refs.Logs.writeLog,e.multipleSelection):r.start(e,e.buyerAccountList,e.$refs.Logs.writeLog);case 8:case"end":return t.stop()}}),t)})))()},applyAsyncExportOrder:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="",e.selectMallList.forEach((function(e,t){r=0===t?e.id:r+","+e.id})),a=JSON.parse(JSON.stringify(e.selectForm)),n=Number(a["minGrossProfit"])||0,o=Number(a["maxGrossProfit"])||0,n>o&&(i=a["minGrossProfit"],a["minGrossProfit"]=a["maxGrossProfit"],a["maxGrossProfit"]=i),a["page"]=e.currentPage,a["pageSize"]=e.pageSize,a["sysMallId"]=r,a[e.inputType]=e.inputContent,a["orderStatus"]=e.orderStatus.join(","),a["shotStatus"]=e.shotStatus.join(","),a["logisticsIds"]=e.logisticsIds.join(","),a["createTime"]=e.createTime.length?e.createTime[0]+" 00:00:00/"+e.createTime[1]+" 23:59:59":"",a["otherTime"]=a["otherTime"]&&a["otherTime"].length?a["otherTime"][0]+" 00:00:00/"+a["otherTime"][1]+" 23:59:59":"",a["shotTime"]=a["shotTime"]&&a["shotTime"].length?a["shotTime"][0]+" 00:00:00/"+a["shotTime"][1]+" 23:59:59":"",t.next=18,e.$api.applyAsyncExportOrder(a);case 18:if(s=t.sent,200!==s.data.code){t.next=23;break}return t.abrupt("return",e.$message.success("导出数据请求成功，可点击【导出数据报表】按钮查看导出状态"));case 23:return t.abrupt("return",e.$message.error("请求失败，".concat(s.data.message)));case 24:case"end":return t.stop()}}),t)})))()},calcGrossProfit:function(e,t,r){var a=(e-t).toFixed(2);return Number(r),a},getOrderList:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o,i,s,c,l,u,d,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n="",r.selectMallList.forEach((function(e,t){n=0===t?e.id:n+","+e.id})),o=JSON.parse(JSON.stringify(r.selectForm)),i=Number(o["minGrossProfit"])||0,s=Number(o["maxGrossProfit"])||0,i>s&&(c=o["minGrossProfit"],o["minGrossProfit"]=o["maxGrossProfit"],o["maxGrossProfit"]=c),r.currentPage=e||r.currentPage,o["page"]=r.currentPage,o["pageSize"]=r.pageSize,o["sysMallId"]=n,o[r.inputType]=r.inputContent,o["orderStatus"]=r.orderStatus.join(","),o["shotStatus"]=r.shotStatus.join(","),o["logisticsIds"]=r.logisticsIds.join(","),o["createTime"]=r.createTime&&r.createTime.length?r.createTime[0]+" 00:00:00/"+r.createTime[1]+" 23:59:59":"",o["otherTime"]=o["otherTime"]&&o["otherTime"].length?o["otherTime"][0]+" 00:00:00/"+o["otherTime"][1]+" 23:59:59":"",o["shotTime"]=o["shotTime"]&&o["shotTime"].length?o["shotTime"][0]+" 00:00:00/"+o["shotTime"][1]+" 23:59:59":"",l=r.$refs.multipleTable,u=l&&l.$el.querySelector(".el-table__body-wrapper"),d=u&&u.scrollTop||0,t||(r.tableData=[],r.tableLoading=!0),a.next=23,r.$api.getOrderList(o);case 23:p=a.sent,r.tableLoading=!1;try{p.data.code&&200===p.data.code?(r.tableData=p.data.data.data,r.tabData=p.data.data.data,null!==r.sortRule.order&&"ship_by_date"===r.sortRule.prop&&r.sortChange(r.sortRule),t&&d>0?setTimeout((function(){u.scrollTop=d}),200):(r.total=p.data.data.total,r.$nextTick((function(){r.isSecondSale(),r.dealWithTableList(),r.getSkuRelation()})))):r.$message.warning("".concat(p.data.message?p.data.message:"获取订单列表失败"))}catch(h){r.$message.warning("获取订单列表失败"),r.tableLoading=!1}case 26:case"end":return a.stop()}}),a)})))()},getSkuRelation:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="",e.tableData.forEach((function(e,t){r=0===t?e.id:r+","+e.id})),t.next=4,e.$commodityService.getSkuRelation(r.toString());case 4:if(a=t.sent,n=a&&JSON.parse(a),200===n.code)for(o=n.data.data||[],i=function(t){var r=o[t],a=e.tableData.findIndex((function(e){return e.id===r.sysOrderId}));e.tableData[a]["empty_info"]="",e.$set(e.tableData[a],"empty_info",a+1+"success")},s=0;s<o.length;s++)i(s);case 7:case"end":return t.stop()}}),t)})))()},dealWithTableList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r="",a=[],e.tableData.forEach(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n,o){var i,s,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.shot_order_info.shot_order_sn&&(i=Number(n.escrow_amount-n.shot_order_info.shot_amount).toFixed(2),i!==Number(n.gross_profit).toFixed(2)&&(n.gross_profit=i,s={sys_order_id:n.id},a.push(s))),Number(n.gross_profit)>0&&(c=(n.gross_profit-Number(n.warehouse_ship_amount)/Number(e.rateList[n.country])).toFixed(2),n.real_gross_profit=c),(Number(n.warehouse_ship_amount)>0||[3,4,8].indexOf(Number(n.order_status))>-1)&&(l=(n.escrow_amount-n.shot_order_info.shot_amount-Number(n.warehouse_ship_amount)/Number(e.rateList[n.country])).toFixed(2),n.real_gross_profit=l),r=0===o?n.id:r+","+n.id,e.isSecondSale(n,o);case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()),a.length>0&&e.$api.uploadGressProfit({lists:a});case 4:case"end":return t.stop()}}),t)})))()},changeTypeName:function(e,t){var r=t.find((function(t){return t.value==e}));return r&&r.label||""},changeSelect:function(e,t,r){(e.includes("")||e.length!==r.length)&&e.includes("")&&e.length-1<r.length&&(this[t]=this[t].filter((function(e){return""!==e})))},selectAll:function(e,t){var r=this;this[e].length<t.length?(this[e]=[],t.map((function(t){r[e].push(t.value||t.ShipId)}))):this[e]=[]},changeMallList:function(e){this.selectMallList=e.mallList,this.shipTypeList=Object(l["w"])(e.country)||[],this.logisticsIds=[],this.payMethodList=l["t"][e.country]||[]},handleCurrentChange:function(e){this.currentPage=e,this.getOrderList()},handleSizeChange:function(e){this.currentPage=1,this.pageSize=e,this.getOrderList()},handleSelectionChange:function(e){this.multipleSelection=e},changeShotStatus:l["g"],changeOrderStatus:l["d"],changePlatformPayMethod:l["f"],changePackageType:l["e"],changeDeliveryStatus:l["c"],copyItem:function(e){var t=document.createElement("div");t.id="tempTarget",t.style.opacity="0",t.innerText=e,document.body.appendChild(t);try{var r=document.createRange();r.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(r),document.execCommand("copy"),window.getSelection().removeAllRanges(),this.$message.success("复制成功")}catch(a){}t.parentElement.removeChild(t)},isJsonString:function(e){if("string"!==typeof e)return e;try{return JSON.parse(e),JSON.parse(e)}catch(t){return e}},ordersShipmentShow:function(){this.ordersShipmentVisible=!0},getTableRow:function(e,t){for(var r=t.split(",")||[],a="",n=0;n<r.length;n++){a=e;var o,s=r[n],c=s.split(".")||[],l=Object(i["a"])(c);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(a=a[u]||"",!a)break}}catch(d){l.e(d)}finally{l.f()}if(a)break}return a},datadragEnd:function(e){e.preventDefault();var t=[];this.columnConfigShowList.map((function(e,r){return t.push(Object.assign(e,{sort_number:r})),t}))},setColumnConfigShowList:function(){var e=this,t=[{},{}],r=[];try{this.tableColumnList.forEach((function(a){var n=e.columnConfigList.find((function(e){return a.name===(e&&e.column_header||"")})),o=n&&Number(n.width)||a.width;"订单编号"===a.name?t[0]=Object.assign(a,n,{width:o}):"操作"===a.name?t[1]=Object.assign(a,n,{width:o}):n&&n.sort_number&&n.sort_number>1?t[n.sort_number]=Object.assign(a,n,{width:o}):r.push(Object.assign(a,{is_show:1},{width:o}))}));for(var a=0;a<t.length;a++){var n=t[a];n||(t[a]=r.splice(0,1)[0])}for(var i=0,s=r;i<s.length;i++){var c=s[i];t.push(c)}t=Object(o["a"])(t.map((function(e,t){return Object.assign(e,{sort_number:t,column_header:e.column_header||e.name})}))),this.tableColumnList=t,this.tableColumnShow=!0}catch(l){this.$message.error("表格列表获取失败，请至【配置自定义列】中修正")}},updateTableColumnShow:function(){var e=this;this.tableColumnShow&&(this.tableColumnShow=!1,this.tableLoading=!0,setTimeout((function(){e.tableLoading=!1,e.tableColumnShow=!0,e.$message.success("表格高度自适配已完成")}),200))},setTableData:function(e,t,r){var a=this,n=this.tableData.filter((function(t){return t.main_order_sn===e}));n.forEach((function(e){a.$set(e,t,r)}))}}},vt=_t,yt=(r("5800"),r("3c61"),Object(y["a"])(vt,a,n,!1,null,"5b92355b",null));t["default"]=yt.exports},c96c:function(e,t,r){"use strict";r("ed2f")},dcd9:function(e,t,r){},e578:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i}));var a=r("1da1");r("96cf"),r("a9e3");function n(e,t){return o.apply(this,arguments)}function o(){return o=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=[{id:Number(r.goods_info.goods_id),unlisted:!0}],n={shop_id:r.mall_info.platform_mall_id},e.next=4,t.$shopeemanService.handleGoodsDelist(r.country,n,a);case 4:o=e.sent,200===o.code?t.$message.success("商品下架成功！"):t.$message.error("".concat(o.data));case 6:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function i(e,t){return s.apply(this,arguments)}function s(){return s=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={product_id_list:[Number(r.goods_info.goods_id)],shop_id:r.mall_info.platform_mall_id},e.next=3,t.$shopeemanService.handleGoodsDelete(r.country,a);case 3:n=e.sent,200===n.code?t.$message.success("商品删除成功！"):t.$message.error("".concat(n.data));case 5:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}},ed2f:function(e,t,r){},f280:function(e,t,r){},f569:function(e,t,r){},fdfd:function(e,t,r){},feb6:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("ul",{staticClass:"storeChooseUL"},[e.isMall?r("li",[e._v(e._s(e._f("chineseSite")(e.countryVal)))]):r("li",{style:e.isReset&&"margin-bottom: 5px"},[r("span",{style:{width:e.spanWidth}},[e._v("所属站点：")]),r("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:"",disabled:e.isBanPerform},model:{value:e.countryVal,callback:function(t){e.countryVal=t},expression:"countryVal"}},[e.isAll?r("el-option",{attrs:{label:"全部",value:""}}):e._e(),e._l(e.countries,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),r("li",{style:e.isReset&&"margin-bottom: 5px"},[r("span",{style:{width:e.spanWidth}},[e._v("店铺分组：")]),r("el-select",{staticClass:"selectBox",attrs:{disabled:e.isBanPerform,multiple:"","collapse-tags":"",filterable:"",size:"mini"},model:{value:e.groupId,callback:function(t){e.groupId=t},expression:"groupId"}},e._l(e.groupIdList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.group_name,value:e.id}})})),1)],1),r("li",{style:e.isReset&&"margin-bottom: 5px"},[r("span",{style:{width:e.spanWidth}},[e._v("店铺名称：")]),r("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadmoreMall,expression:"loadmoreMall"}],staticClass:"selectBox",attrs:{disabled:e.isBanPerform,placeholder:"",multiple:!e.isAShop,"collapse-tags":"","filter-method":e.filterMall,size:"mini",filterable:"",clearable:""},on:{"visible-change":function(t){return e.filterMall("")}},model:{value:e.site,callback:function(t){e.site=t},expression:"site"}},[e.isAShop?e._e():r("el-option",{attrs:{label:"全部",value:""}}),e._l(e.siteShowList,(function(t,a){return e.showMall(t,a)?r("el-option",{key:a,attrs:{label:t.mall_alias_name||t.platform_mall_name,value:t.platform_mall_id}}):e._e()}))],2)],1),e.isReset?r("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[r("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary",disabled:e.isBanPerform},on:{click:e.reset}},[e._v("　刷　　新　")])],1):e._e()])])},n=[],o=r("1da1"),i=r("b85c"),s=r("2909"),c=(r("96cf"),r("d81d"),r("fb6a"),r("caad"),r("2532"),r("d3b7"),r("25f0"),r("99af"),r("6062"),r("3ca3"),r("ddb0"),r("4de4"),r("159b"),r("c740"),r("7db0"),r("7646")),l=r("2b0e");l["default"].directive("loadmore",{bind:function(e,t){var r=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");r.addEventListener("scroll",(function(){this.scrollHeight-this.scrollTop<=this.clientHeight+50?t.value(!0,this):this.scrollTop<30&&t.value(!1,this)}))}});var u={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},parentCountry:{type:String,default:"TH"},isMall:{type:Boolean,default:function(){return!1}},isBanPerform:{type:Boolean,default:function(){return!1}},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}},isAShop:{type:Boolean,default:function(){return!1}}},data:function(){return{isAllowSet1:!0,isAllowSet2:!0,countryVal:null,groupId:[],groupIdList:[],site:[],siteList:[],siteShowList:[],countries:this.$filters.countries_option,mallListAPIInstance:new c["a"](this),isShowName:"",isShowNameAll:!1,showMallNumber:100,mallShowIndex:0,jsonMallData:[],filterMallTime:null}},watch:{siteList:function(e){this.siteShowList=e},countryVal:{handler:function(e,t){this.isShowName="",this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},deep:!0},groupId:{handler:function(e,t){var r=this;if(this.isAllowSet2){this.isShowName="",this.isAllowSet2=!1;var a=t.indexOf("")>-1,n=e.indexOf("")>-1;a!==n?this.groupId=n?Object(s["a"])(this.groupIdList.map((function(e){return e.id}))):[]:n?this.groupId=e.slice(1):this.groupIdList.length>0&&this.groupId.length===this.groupIdList.length-1&&this.groupId.unshift(""),setTimeout((function(){r.isAllowSet2=!0,r.ddMallGoodsGetMallList(2)}),10)}},deep:!0},site:{handler:function(e,t){var r=this;if(this.isAllowSet1){this.isAllowSet1=!1;var a=this.isShowName;if(!this.isAShop){var n=t.includes(""),o=e.includes("");if(n!==o||t.toString()===e.toString()&&this.isShowNameAll)if(o&&(!a||a&&!this.isShowNameAll)){var c=a&&Object(s["a"])(this.siteShowList.map((function(e){return e.platform_mall_id})))||[""].concat(Object(s["a"])(this.siteList.map((function(e){return e.platform_mall_id})))),l=new Set([].concat(Object(s["a"])(c),Object(s["a"])(t)));this.site=Object(s["a"])(l),this.isShowNameAll=!0,a&&this.siteList.length===this.site.length&&this.site.unshift("")}else{this.isShowNameAll=!1;var u=[];if(a){var d=a&&Object(s["a"])(this.siteShowList.map((function(e){return e.platform_mall_id}))),p=d.length>this.site.length&&this.site||d,h=d.length>this.site.length&&d||this.site;u=new Set(this.site);var m,f=Object(i["a"])(h);try{for(f.s();!(m=f.n()).done;){var g=m.value;p.includes(g)&&u.delete(g)}}catch(b){f.e(b)}finally{f.f()}u.delete("")}this.site=Object(s["a"])(u)}else o?this.site=e.slice(1):this.siteList.length>0&&this.siteList.length===this.site.length?this.site.unshift(""):this.isShowNameAll=!1}setTimeout((function(){r.changeMallList(),r.filterMall(a),r.isAllowSet1=!0}),10)}},deep:!0}},mounted:function(){this.countryVal=this.isMall?this.parentCountry:this.isAll?"":"TH"},methods:{reset:function(){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},ddMallGoodsGetMallList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,o,i,c,l,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.site=[],a=t.countryVal,n=[],!(t.jsonMallData.length>0)){r.next=7;break}n=t.jsonMallData,r.next=12;break;case 7:return r.next=9,t.$appConfig.temporaryCacheInfo("get","mallAllData","");case 9:o=r.sent,n=JSON.parse(o)||[],t.jsonMallData=JSON.parse(o)||[];case 12:if(!(n.length>0)){r.next=17;break}1===e&&(t.siteList=""===a?n:n.filter((function(e){return e.country===a}))),2===e&&(0===t.groupId.length?t.siteList=[]:(t.siteList=[],t.groupId.forEach((function(e){n.forEach((function(r){a?e===r.group_id&&a===r.country&&t.siteList.push(r):e===r.group_id&&t.siteList.push(r)}))})))),r.next=22;break;case 17:return i={country:"",mallGroupIds:""},r.next=20,t.mallListAPIInstance.ddMallGoodsGetMallList(i);case 20:c=r.sent,200===c.code?(t.$appConfig.temporaryCacheInfo("save","mallAllData",c.data),l=c.data||[],t.siteList=l,t.jsonMallData=l,t.siteList=""===a?l:l.filter((function(e){return e.country===a}))):t.$message.error("获取分组、店铺列表失败");case 22:u=[],0===t.groupIdList.length&&(t.groupIdList=[{group_name:"全部",id:""}],t.siteList.forEach((function(e){var t=u.findIndex((function(t){return t&&t.id===e.group_id}));e.group_name&&t<0&&u.push({group_name:e.group_name,id:e.group_id})})),u.zzSort("id"),t.groupIdList=[].concat(Object(s["a"])(t.groupIdList),u),t.groupId=[""].concat(Object(s["a"])(u.map((function(e){return e.id}))))),setTimeout((function(){t.isAllowSet2=!0,t.isAllowSet1=!0,t.site=!t.isAShop&&[""]||""}),10);case 25:case"end":return r.stop()}}),r)})))()},changeMallList:function(){var e=this,t=[],r="";if(this.isAShop){var a=this.siteList.find((function(t){return t.platform_mall_id===e.site}));r=this.site,t.push(a)}else this.site.forEach((function(a){if(a){var n=e.siteList.find((function(e){return e.platform_mall_id===a}));t.push(n),r+=a+","}}));!this.countryVal&&this.groupId.indexOf("")>-1&&(r=t.length!==this.siteList.length&&r||""),this.source?this.$emit("changeMallList",{mallList:t,source:this.source,searchAll:r,country:this.countryVal.toLocaleUpperCase()}):(t["country"]=this.countryVal,this.$emit("changeMallList",t))},filterMall:function(e){var t=this,r=e&&this.isShowName!==e?1e3:100;this.filterMallTime&&(clearTimeout(this.filterMallTime),this.filterMallTime=null),this.filterMallTime=setTimeout((function(){t.isShowName!==e&&(t.mallShowIndex=0),t.isShowName=e||"";var r=t.siteList;e&&(r=t.siteList.filter((function(t){var r=t.mall_alias_name||t.platform_mall_name;return r.includes(e)}))),t.siteShowList=r}),r)},showMall:function(e,t){var r=e.mall_alias_name||e.platform_mall_name,a=this.site[0]===e.platform_mall_id;return a||this.mallShowIndex<=t&&t<=this.mallShowIndex+this.showMallNumber&&(!this.isShowName||r.includes(this.isShowName))},loadmoreMall:function(e,t){if(this.siteShowList.length>this.showMallNumber){var r=0;e?(r=this.mallShowIndex+10,r=r<this.siteShowList.length-this.showMallNumber&&r||this.siteShowList.length-this.showMallNumber):(r=this.mallShowIndex-10,r=r>0&&r||0),r!==this.mallShowIndex&&(t.scrollTop=e?t.scrollTop-100:30),this.mallShowIndex=r}}}},d=u,p=(r("8992"),r("2877")),h=Object(p["a"])(d,a,n,!1,null,null,null);t["a"]=h.exports}}]);