(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44c9383a"],{"193a":function(e,t,a){"use strict";a("cd9b")},"3b9d":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"contaniner"},[a("el-row",{staticClass:"header"},[a("ul",{staticStyle:{"margin-bottom":"10px"}},[a("li",[a("span",[e._v("站点：")]),a("el-select",{attrs:{size:"mini",filterable:""},model:{value:e.site,callback:function(t){e.site=t},expression:"site"}},e._l(e.siteList,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("li",[a("span",[e._v("店铺分组：")]),a("el-select",{attrs:{placeholder:"请选择分组",multiple:"","collapse-tags":"",clearable:"",size:"medium",filterable:""},model:{value:e.group,callback:function(t){e.group=t},expression:"group"}},[e.selectall?a("el-option",{attrs:{label:"全部",value:0}}):e._e(),e.selectall?e._e():a("el-option",{attrs:{label:"全部",value:-2}}),e._l(e.gruopList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),a("li",[a("span",[e._v("店铺：")]),a("el-select",{attrs:{placeholder:"请选择店铺",multiple:"","collapse-tags":"",clearable:"",size:"medium",filterable:""},model:{value:e.mall,callback:function(t){e.mall=t},expression:"mall"}},[e.selectall1?a("el-option",{attrs:{label:"全部",value:0}}):e._e(),e.selectall1?e._e():a("el-option",{attrs:{label:"全部",value:-2}}),e._l(e.mallList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1)]),a("ul",[a("li",[a("span",[e._v("活动：")]),a("el-select",{attrs:{placeholder:"请选择店铺",clearable:"",size:"mini",filterable:""},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("el-option",{attrs:{label:"全部",value:1}}),e._l(e.statuslist,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),a("li",[a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getallinfo}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.creat}},[e._v("创建套装促销活动")]),a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getallinfo}},[e._v("停止活动创建")]),a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getallinfo}},[e._v("批量删除/结束勾选活动")]),a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.clearLog}},[e._v("清除日志")])],1),a("li",[a("el-checkbox",{model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")]),a("el-checkbox",{model:{value:e.showexpiredactivities,callback:function(t){e.showexpiredactivities=t},expression:"showexpiredactivities"}},[e._v("不显示过期活动")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.Loading3,expression:"Loading3"}],ref:"plTable",staticStyle:{"margin-top":"10px"},attrs:{"header-align":"center",height:"calc(100vh - 140px)",data:e.tableData,"header-cell-style":{backgroundColor:"#f5f7fa"}}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"50"}}),a("el-table-column",{attrs:{align:"center",label:"序列号",width:"100",prop:"index"}}),a("el-table-column",{attrs:{align:"center",label:"店铺",width:"180",prop:"mallname"}}),a("el-table-column",{attrs:{prop:"name",label:"套装促销名称",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"活动状态",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"num",label:"商品数量",width:"200",align:"center"}}),a("el-table-column",{attrs:{prop:"time",label:"促销期间",width:"280",align:"center"}}),a("el-table-column",{attrs:{prop:"shippingcount",label:"操作",width:"400",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[2===l.sign?a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getallinfo}},[e._v("结束")]):e._e(),a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getallinfo}},[e._v("编辑商品")]),a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getallinfo}},[e._v("复制活动")]),2===l.sign?a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getallinfo}},[e._v("分享链接")]):e._e()]}}])})],1),a("el-dialog",{attrs:{title:"关注礼概览",visible:e.creatactivity1,width:"61%"},on:{"update:visible":function(t){e.creatactivity1=t}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.Loading3,expression:"Loading3"}],ref:"plTable",staticStyle:{"margin-top":"10px"},attrs:{"header-align":"center",data:e.a,"header-cell-style":{backgroundColor:"#f5f7fa"}}},[a("el-table-column",{attrs:{align:"center",label:"关注礼名称",width:"160",prop:"follow_prize_name"}}),a("el-table-column",{attrs:{align:"center",prop:"start_day",label:"开始时间",width:"150"}}),a("el-table-column",{attrs:{align:"center",prop:"end_day",label:"结束时间",width:"150"}}),a("el-table-column",{attrs:{prop:"new_followers",label:"新粉丝",width:"100",align:"center"}}),a("el-table-column",{attrs:{align:"center",prop:"viewers",label:"观众",width:"100"}}),a("el-table-column",{attrs:{align:"center",prop:"buyers",label:"买家数",width:"130"}}),a("el-table-column",{attrs:{align:"center",prop:"sales",label:"销售量",width:"100"}}),a("el-table-column",{attrs:{prop:"sales_per_buyer",label:"每位买家的销售额",width:"130",align:"center"}})],1)],1),a("div",{staticClass:"logging"},[a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}})],1),a("el-dialog",{attrs:{title:"创建套装促销活动","close-on-click-modal":!1,"close-on-press-escape":!1,visible:e.creatactivity,width:"26%"},on:{"update:visible":function(t){e.creatactivity=t}}},[a("el-row",[a("ul",[a("li",[a("span",[e._v("套装名称：")]),a("el-input",{attrs:{clearable:"",size:"mini",placeholder:"24个字符以内",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatname,callback:function(t){e.creatname=t},expression:"creatname"}})],1)]),a("br"),a("ul",[a("li",[a("span",[e._v("套装期间：")]),a("el-date-picker",{attrs:{"unlink-panels":"",size:"mini",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.creattime,callback:function(t){e.creattime=t},expression:"creattime"}})],1)]),a("br"),a("br"),a("ul",[a("li",[a("span",[e._v("套装类型：")]),a("el-radio-group",{model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio",{attrs:{label:2}},[e._v("折扣比率")]),a("el-radio",{attrs:{label:3}},[e._v("折扣金额")]),a("el-radio",{attrs:{label:1}},[e._v("套装特价")])],1)],1)]),a("br"),a("br"),2===e.radio?a("ul",[a("li",[a("span",[e._v("购买")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatnum,callback:function(t){e.creatnum=t},expression:"creatnum"}}),a("span",[e._v("个商品")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatdiscount,callback:function(t){e.creatdiscount=t},expression:"creatdiscount"}}),a("span",[e._v("%")])],1)]):e._e(),2===e.radio?a("ul",{staticStyle:{"margin-top":"10px"}},[a("li",[a("span",{staticStyle:{color:"red"}},[e._v("*折扣比率 = 总结算价 - "+e._s(e.creatdiscount)+"%")])])]):e._e(),3===e.radio?a("ul",[a("li",[a("span",[e._v("购买")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatnum,callback:function(t){e.creatnum=t},expression:"creatnum"}}),a("span",[e._v("个商品")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatdiscount,callback:function(t){e.creatdiscount=t},expression:"creatdiscount"}}),a("span",[e._v(e._s(e.currency))])],1)]):e._e(),3===e.radio?a("ul",{staticStyle:{"margin-top":"10px"}},[a("li",[a("span",{staticStyle:{color:"red"}},[e._v("*折扣比率 = 总结算价 - "+e._s(e.currency)+e._s(e.creatdiscount)+"%")])])]):e._e(),1===e.radio?a("ul",[a("li",[a("span",[e._v("购买")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatnum,callback:function(t){e.creatnum=t},expression:"creatnum"}}),a("span",[e._v("个商品")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatdiscount,callback:function(t){e.creatdiscount=t},expression:"creatdiscount"}}),a("span",[e._v(e._s(e.currency))])],1)]):e._e(),1===e.radio?a("ul",{staticStyle:{"margin-top":"10px"}},[a("li",[a("span",{staticStyle:{color:"red"}},[e._v("套装特价 "+e._s(e.currency)+e._s(e.creatdiscount))])])]):e._e(),a("br"),a("ul",[a("li",[a("span",[e._v("购买限制：买家最多可以购买此套装优惠")]),a("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.creatcount,callback:function(t){e.creatcount=t},expression:"creatcount"}}),a("span",[e._v("次")])],1)]),a("br"),a("br"),a("ul",[a("li",[a("el-button",{staticStyle:{"margin-left":"130px"},attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.savecreat}},[e._v("保存")]),a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.cancecreat}},[e._v("取消")])],1)])])],1)],1)],1)},i=[],n=a("1da1"),r=(a("96cf"),a("99af"),a("159b"),a("a434"),a("b0c0"),{data:function(){return{Loading1:!1,Loading3:!1,selectall:!0,selectall1:!0,eidtVisible:!1,showlog:!1,showexpiredactivities:!1,creatactivity:!1,creatactivity1:!1,radio:2,creatnum:2,creatdiscount:1,creatcount:1,indexs:1,creatname:"",allgroupid:[],allmallid:[],tableData:[],tableData2:[],tableData1:[],errmall:[],creattime:[(new Date).getTime()-2592e6,(new Date).getTime()],status:1,currency:"฿",total:0,site:"TH",siteList:this.$filters.countries_option,group:0,gruopList:[],mall:[],mallList:[],start_time:Date.parse(this.$dayjs(new Date).format("YYYY-MM-DD 00:00:00"))/1e3,end_time:Math.round(new Date/1e3),statuslist:[{label:"进行中",value:3},{label:"即将到来",value:2},{label:"已到期",value:4}]}},watch:{group:function(e,t){this.mall=[];for(var a=0;a<e.length;a++)if(0===e[a])this.group=this.allgroupid,this.mall=[].concat(this.allmallid),this.selectall=!1;else if(-2===e[a])this.group=[],this.mall=[],this.selectall=!0;else for(var l=0;l<this.mallList.length;l++)e[a]===this.mallList[l].group_id&&this.mall.push(this.mallList[l].value)},mall:function(e,t){for(var a=0;a<e.length;a++)0===e[a]&&(this.mall=this.allmallid,this.selectall1=!1),-2===e[a]&&(this.mall=[],this.selectall1=!0)},site:function(e,t){this.mall=[],this.group=[],this.getInfo(),"MY"===this.site&&(this.currency="RM"),"TW"===this.site&&(this.currency="$"),"VN"===this.site&&(this.currency="₫"),"ID"===this.site&&(this.currency="Rp"),"PH"===this.site&&(this.currency="₱"),"TH"===this.site&&(this.currency="฿"),"SG"===this.site&&(this.currency="$"),"BR"===this.site&&(this.currency="R$"),"MX"===this.site&&(this.currency="MX$"),"CO"===this.site&&(this.currency="$"),"CL"===this.site&&(this.currency="$"),"PL"===this.site&&(this.currency="zł")},showexpiredactivities:function(e,t){this.tableData=!0===e?this.tableData2:this.tableData1}},mounted:function(){this.getInfo()},methods:{getInfo:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,l,i,n,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={country:e.site,mallGroupIds:e.group},t.next=3,e.$api.ddMallGoodsGetMallList(a);case 3:if(l=t.sent,e.mallList=[],e.gruopList=[],e.allgroupid=[],e.allmallid=[],200===l.data.code){for(l.data.data.forEach((function(t){t.group_id&&e.gruopList.push({label:t.group_name,value:t.group_id}),t.id&&e.mallList.push({label:t.mall_alias_name?t.mall_alias_name:t.platform_mall_name,value:t.platform_mall_id,group_id:t.group_id})})),i=0;i<e.gruopList.length-1;i++)for(n=i+1;n<e.gruopList.length;n++)e.gruopList[i].value===e.gruopList[n].value&&e.gruopList.splice(n,1);for(r=0;r<e.gruopList.length;r++)e.allgroupid.push(e.gruopList[r].value);for(s=0;s<e.mallList.length;s++)e.allmallid.push(e.mallList[s].value)}else e.$message.warning("店铺列表获取失败！");case 9:case"end":return t.stop()}}),t)})))()},getallinfo:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,l,i,n,r,s,o,c,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.mall.length>0)){t.next=30;break}e.indexs=1,e.Loading1=!0,e.Loading3=!0,a=1,e.tableData=[],e.tableData1=[],e.tableData2=[],e.exportdata=[],e.errmall=[],l=0;case 11:if(!(l<e.mall.length)){t.next=25;break}return i={mallId:e.mall[l],status:e.status,limit:10,offset:0},t.next=15,e.$shopeemanService.getdiscount(e.site,i,{headers:{"Content-Type":"application/json; charset=utf-8"}});case 15:for(n=t.sent,r=void 0,n&&(r=JSON.parse(n)),r.data=JSON.parse(r.data),s=void 0,o=0;o<e.mallList.length;o++)e.mallList[o].value===e.mall[l]&&(s=e.mallList[o].label);if(200===r.status){if(r.data.data.bundle_deal_list)for(c=0;c<r.data.data.bundle_deal_list.length;c++)u=1,r.data.data.bundle_deal_list[c].end_time>Math.round(new Date/1e3)&&(u=2),d={},d["index"]=e.indexs,e.indexs++,d["name"]=r.data.data.bundle_deal_list[c].name,d["status"]=r.data.data.bundle_deal_list[c].status,d["num"]=r.data.data.bundle_deal_list[c].extinfo_images.item_total_count,d["time"]="".concat(e.$dayjs(1e3*r.data.data.bundle_deal_list[c].start_time).format("YYYY-MM-DD HH:mm:ss"),"至").concat(e.$dayjs(1e3*r.data.data.bundle_deal_list[c].end_time).format("YYYY-MM-DD HH:mm:ss")),d["mallname"]=s,d["sign"]=u,2===u&&(d["index"]=a,a++,e.tableData2.push(d)),e.tableData1.push(d),!0===e.showexpiredactivities?e.tableData=e.tableData2:e.tableData=e.tableData1}else 403===r.status&&e.errmall.push(s);case 22:l++,t.next=11;break;case 25:e.errmall.length>0&&e.$message.error("店铺【".concat(e.errmall,"】未登录")),e.Loading1=!1,e.Loading3=!1,t.next=31;break;case 30:e.$message.warning("请选择店铺！");case 31:case"end":return t.stop()}}),t)})))()},clearLog:function(){this.$refs.Logs.consoleMsg=""},creat:function(){this.creatactivity=!0},savecreat:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,l,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.mall.length<1&&e.$message.warning("请选择店铺！"),a=1===e.radio?{mallId:e.mall,name:e.creatname,rule_type:e.radio,min_amount:e.creatnum,start_time:Math.floor(e.creattime[0]/1e3),end_time:Math.floor(e.creattime[1]/1e3),usage_limit:e.creatcount,fix_price:e.creatdiscount,discount_value:0,discount_percentage:0}:2===e.radio?{mallId:e.mall,name:e.creatname,rule_type:e.radio,min_amount:e.creatnum,start_time:Math.floor(e.creattime[0]/1e3),end_time:Math.floor(e.creattime[1]/1e3),usage_limit:e.creatcount,fix_price:0,discount_value:0,discount_percentage:e.creatdiscount}:{mallId:e.mall,name:e.creatname,rule_type:e.radio,min_amount:e.creatnum,start_time:Math.floor(e.creattime[0]/1e3),end_time:Math.floor(e.creattime[1]/1e3),usage_limit:e.creatcount,fix_price:0,discount_value:e.creatdiscount,discount_percentage:0},t.next=4,e.$shopeemanService.creatdiscount(e.site,a,{headers:{"Content-Type":"application/json; charset=utf-8"}});case 4:l=t.sent,l&&(i=JSON.parse(l)),i.data=JSON.parse(i.data);case 7:case"end":return t.stop()}}),t)})))()},cancecreat:function(){this.creatactivity=!1}}}),s=r,o=(a("193a"),a("2877")),c=Object(o["a"])(s,l,i,!1,null,"6120bc78",null);t["default"]=c.exports},cd9b:function(e,t,a){}}]);