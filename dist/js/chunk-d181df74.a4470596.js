(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d181df74"],{2648:function(e,t,a){"use strict";a("9121")},9121:function(e,t,a){},c412:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"contaniner"},[a("el-row",{staticClass:"header"},[a("ul",{staticStyle:{margin:"5px 0px"}},[a("li",{staticClass:"wareName"},[a("span",[e._v("仓库名称：")]),a("el-select",{attrs:{placeholder:"",size:"mini",filterable:""},model:{value:e.form.returnWheareHouseName,callback:function(t){e.$set(e.form,"returnWheareHouseName",t)},expression:"form.returnWheareHouseName"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),e._l(e.wherehouseNameList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.warehouse_name,value:e.id}})}))],2)],1),a("li",[a("span",[e._v("系统商品编号：")]),a("el-input",{attrs:{clearable:"",size:"mini"},model:{value:e.form.systemskuid,callback:function(t){e.$set(e.form,"systemskuid",t)},expression:"form.systemskuid"}})],1),a("li",[a("span",[e._v("商品编号：")]),a("el-input",{attrs:{clearable:"",size:"mini"},model:{value:e.form.skuid,callback:function(t){e.$set(e.form,"skuid",t)},expression:"form.skuid"}})],1),a("li",[a("span",[e._v("商品规格：")]),a("el-input",{attrs:{clearable:"",size:"mini"},model:{value:e.form.sku_name,callback:function(t){e.$set(e.form,"sku_name",t)},expression:"form.sku_name"}})],1),a("li",[a("span",[e._v("商品名称：")]),a("el-input",{attrs:{clearable:"",size:"mini"},model:{value:e.form.goods_name,callback:function(t){e.$set(e.form,"goods_name",t)},expression:"form.goods_name"}})],1),a("li",[a("el-checkbox",{on:{change:e.flt},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[e._v("过滤0库存")])],1),a("li",[a("el-button",{attrs:{type:"primary",disabled:e.Loading1,size:"mini"},on:{click:e.getoverseaswarehouse}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"mini",loading:e.Loading2},on:{click:function(t){return e.DerivedData(1)}}},[e._v("导出数据")])],1)])]),a("el-row",{staticStyle:{"margin-top":"10px",padding:"4px"},attrs:{id:"article"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.Loading3,expression:"Loading3"}],ref:"plTable",staticStyle:{"margin-top":"20px"},attrs:{"header-align":"center",height:"calc(100vh - 135px)",data:e.tableData,"header-cell-style":{backgroundColor:"#f5f7fa"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",label:"序列号",width:"100px",type:"index",fixed:""}}),a("el-table-column",{attrs:{align:"center",prop:"warehouse_name",label:"仓库名称","min-width":"150px",fixed:""}}),a("el-table-column",{attrs:{align:"center",prop:"sys_sku_id",label:"系统商品编号","min-width":"130px"}}),a("el-table-column",{attrs:{prop:"sku_id",label:"商品编号（SkuId）","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"goods_name",label:"商品名称","min-width":"150px",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"sku_name",label:"商品规格","min-width":"150px",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"stock_num",label:"可用库存","min-width":"100px",align:"center"}}),a("el-table-column",{attrs:{prop:"shared_num",label:"共享库存","min-width":"110px",align:"center"}}),a("el-table-column",{attrs:{prop:"sku_price",label:"商品单价（RMB）","min-width":"140px",align:"center"}}),a("el-table-column",{attrs:{prop:"sku_url",label:"商品链接","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.open(r.sku_url)}}},[e._v("查看商品链接")])]}}])}),a("el-table-column",{attrs:{label:"商品图片","min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.sku_image||r.real_image_url?a("el-tooltip",{staticStyle:{width:"50px",height:"50px"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:r.sku_image||r.real_image_url}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"})])],1),a("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:r.sku_image||r.real_image_url}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"})])],1):e._e()]}}])}),a("el-table-column",{attrs:{prop:"position",label:"货架仓位","min-width":"120",align:"center"}}),a("el-table-column",{attrs:{prop:"updated_at",label:"库存更新时间","min-width":"150",align:"center"}}),a("el-table-column",{attrs:{label:"操作","min-width":"200",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.change(r)}}},[e._v("商品编辑")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.share(r)}}},[e._v("共享库存")])]}}])})],1),a("el-dialog",{staticClass:"edit-group-dialog",attrs:{visible:e.changes,width:"330px",title:"修改库存价格","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.changes=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"商品名称："}},[a("el-input",{attrs:{size:"mini",disabled:""},model:{value:e.rowx.goods_name,callback:function(t){e.$set(e.rowx,"goods_name",t)},expression:"rowx.goods_name"}})],1),a("el-form-item",{attrs:{label:"skuId："}},[a("el-input",{attrs:{size:"mini",disabled:""},model:{value:e.rowx.sku_id,callback:function(t){e.$set(e.rowx,"sku_id",t)},expression:"rowx.sku_id"}})],1),a("el-form-item",{attrs:{label:"商品规格："}},[a("el-input",{attrs:{size:"mini"},model:{value:e.rowx.sku_name,callback:function(t){e.$set(e.rowx,"sku_name",t)},expression:"rowx.sku_name"}})],1),a("el-form-item",{attrs:{label:"商品链接："}},[a("el-input",{attrs:{size:"mini"},model:{value:e.rowx.sku_url,callback:function(t){e.$set(e.rowx,"sku_url",t)},expression:"rowx.sku_url"}})],1),a("el-form-item",{attrs:{label:"图片链接："}},[a("el-input",{attrs:{size:"mini"},model:{value:e.rowx.sku_image,callback:function(t){e.$set(e.rowx,"sku_image",t)},expression:"rowx.sku_image"}})],1),a("el-form-item",{attrs:{label:"商品价格："}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:e.rowx.sku_price,callback:function(t){e.$set(e.rowx,"sku_price",t)},expression:"rowx.sku_price"}}),a("span",{staticStyle:{color:"#969393"}},[e._v("RMB")])],1),a("el-form-item",{staticStyle:{"margin-top":"10px"}},[a("el-button",{staticStyle:{"margin-left":"10px",width:"100px"},attrs:{type:"primary",size:"mini"},on:{click:e.changePrice}},[e._v("确 定")])],1)],1)],1),a("el-dialog",{staticClass:"edit-group-dialog",attrs:{visible:e.changes1,width:"330px",title:"修改共享库存"},on:{"update:visible":function(t){e.changes1=t}}},[a("el-form",{attrs:{"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"商品名称："}},[e._v(" "+e._s(e.rowy.goods_name)+" ")]),a("el-form-item",{attrs:{label:"商品规格："}},[e._v(" "+e._s(e.rowy.sku_name)+" ")]),a("el-form-item",{attrs:{label:"skuid："}},[e._v(" "+e._s(e.rowy.sku_id)+" ")]),a("el-form-item",{attrs:{label:"可用库存："}},[e._v(" "+e._s(e.rowy.stock_num)+" ")]),a("el-form-item",{attrs:{label:"共享库存："}},[a("el-input",{staticStyle:{width:"150px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d.]/g,0)",clearable:""},model:{value:e.primarynum,callback:function(t){e.primarynum=t},expression:"primarynum"}})],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"10px",width:"100px"},attrs:{type:"primary",size:"mini"},on:{click:e.shareStock}},[e._v("确定")])],1)],1)],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:"total,sizes, prev, pager, next, jumper",total:e.total,"page-sizes":[100,200]},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},n=[],s=a("2909"),i=a("1da1"),o=(a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("159b"),a("99af"),a("4de4"),a("b680"),a("a9e3"),a("498a"),a("96cf"),a("0e0b")),l={data:function(){return{exportData:[],is_zero_filter:0,currentPage:1,newform:[],data1:[],tableData:[],data2:[],total:0,pageSize:100,page:1,Loading1:!1,Loading2:!1,Loading3:!1,filter:!1,changes:!1,changes1:!1,primarynum:0,sharedtype:"",newprice:0,rowx:{},rowy:{goods_name:"",sku_name:"",sku_id:"",stock_num:1,shared_num:2,id:"",wid:""},form:{app_uid:"",skuid:"",returnWheareHouseName:"0",systemskuid:"",sku_name:"",goods_name:""},wherehouseNameList:[]}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getOverseasList();case 2:return t.next=4,e.getoverseaswarehouse();case 4:case"end":return t.stop()}}),t)})))()},methods:{getOverseasList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new Map,t.prev=1,t.next=4,e.$appConfig.getGlobalCacheInfo("allWh","");case 4:r=t.sent,n=e.isJsonString(r),null!==n&&void 0!==n&&n.length?(n.forEach((function(t){e.wherehouseNameList=e.wherehouseNameList.concat(t.child)})),e.wherehouseNameList=e.wherehouseNameList.filter((function(e){return!a.has(e.id)&&a.set(e.id,1)}))):e.$message.error("仓库列表为空"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.$message.error("获取仓库列表异常： ".concat(t.t0));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},isJsonString:function(e){if("string"!==typeof e)return e;try{return JSON.parse(e),JSON.parse(e)}catch(t){return e}},open:function(e){e||this.$message.warning("暂无商品链接"),window.BaseUtilBridgeService.openUrl(e)},changePrice:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.rowx.sku_price){t.next=2;break}return t.abrupt("return",e.$message("价格不能为空"));case 2:return a={sys_sku_id:e.rowx.sys_sku_id,sku_name:e.rowx.sku_name,sku_url:e.rowx.sku_url,sku_image:e.rowx.sku_image,sku_price:parseFloat(100*e.rowx.sku_price).toFixed(2)},t.prev=3,t.next=6,e.$XzyNetMessageService.post("xzy.overseaUpdateStock",a);case 6:r=t.sent,n=JSON.parse(JSON.parse(r).data),200===n.code?(e.$message.success("商品编辑成功"),e.changes=!1,e.getoverseaswarehouse()):e.$message.error("商品编辑失败".concat(n.message)),t.next=13;break;case 11:t.prev=11,t.t0=t["catch"](3);case 13:case"end":return t.stop()}}),t,null,[[3,11]])})))()},shareStock:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(Number(e.primarynum)>Number(e.rowy.stock_num)||Number(e.primarynum)<0)){t.next=3;break}return e.$message.warning("请输入有效库存数"),t.abrupt("return");case 3:return a={wid:e.rowy.wid,shared_num:e.primarynum,sys_sku_id:e.rowy.sys_sku_id},t.prev=4,t.next=7,e.$XzyNetMessageService.post("xzy.addSharedInventory",a);case 7:r=t.sent,r=JSON.parse(r),n=JSON.parse(r.data),200===n.code?e.$message.success("数据共享成功"):e.$message.error("".concat(n.message)),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](4),e.$message.warning("".concat(t.t0));case 16:e.getoverseaswarehouse(),e.changes1=!1;case 18:case"end":return t.stop()}}),t,null,[[4,13]])})))()},change:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.newprice=0,t.changes=!0,t.rowx=JSON.parse(JSON.stringify(e));case 3:case"end":return a.stop()}}),a)})))()},share:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.changes1=!0,t.rowy.goods_name=e.goods_name,t.rowy.sku_name=e.sku_name,t.rowy.sku_id=e.sku_id,t.rowy.stock_num=e.stock_num,t.rowy.shared_num=e.shared_num,t.primarynum=Number(e.shared_num),t.rowy.id=e.id,t.rowy.wid=e.wid,t.rowy.sys_sku_id=e.sys_sku_id;case 10:case"end":return a.stop()}}),a)})))()},flt:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:!0===e.filter?(e.is_zero_filter=1,e.getoverseaswarehouse()):(e.is_zero_filter=0,e.getoverseaswarehouse());case 1:case"end":return t.stop()}}),t)})))()},getoverseaswarehouse:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.Loading3=!0,a={page_num:e.pageSize,page:e.page,wid:e.form.returnWheareHouseName,sys_sku_id:e.form.systemskuid.trim(),sku_id:e.form.skuid.trim(),sku_name:e.form.sku_name.trim(),goods_name:e.form.goods_name.trim(),is_zero_filter:e.is_zero_filter,type:"query",app_uid:""},t.prev=2,t.next=5,e.$XzyNetMessageService.post("xzy.stock.index",a);case 5:if(r=t.sent,r=JSON.parse(r),n=JSON.parse(r.data),200===n.code){t.next=12;break}e.$message.error(n.message),t.next=32;break;case 12:s=n.data.data?n.data.data:[],e.total=n.data.total,i=0;case 15:if(!(i<s.length)){t.next=31;break}return s[i].sku_price=s[i].sku_price/100,t.next=19,e.$appConfig.getGlobalCacheInfo("overseasWh",Number(s[i].wid));case 19:if(t.t0=t.sent,t.t0){t.next=22;break}t.t0="";case 22:if(o=t.t0,!(o&&JSON.parse(o)&&JSON.parse(o).warehouse_name)){t.next=27;break}s[i].warehouse_name=JSON.parse(o).warehouse_name,t.next=28;break;case 27:return t.abrupt("continue",28);case 28:i++,t.next=15;break;case 31:e.tableData=s;case 32:t.next=36;break;case 34:t.prev=34,t.t1=t["catch"](2);case 36:e.Loading3=!1;case 37:case"end":return t.stop()}}),t,null,[[2,34]])})))()},DerivedData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i,l,u,c,m,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.Loading2=!0,!(t.exportData.length<t.total)){a.next=39;break}return r={page_num:200,page:e,wid:t.form.returnWheareHouseName,sys_sku_id:t.form.systemskuid.trim(),sku_id:t.form.skuid.trim(),sku_name:t.form.sku_name.trim(),is_zero_filter:t.is_zero_filter,type:"query",app_uid:""},a.prev=3,a.next=6,t.$XzyNetMessageService.post("xzy.stock.index",r);case 6:if(n=a.sent,n=JSON.parse(n),i=JSON.parse(n.data),200===i.code){a.next=14;break}return t.$message.error(i.message),a.abrupt("return");case 14:u=i.data.data?i.data.data:[],c=0;case 16:if(!(c<u.length)){a.next=29;break}return u[c].sku_price=u[c].sku_price/100,a.next=20,t.$appConfig.getGlobalCacheInfo("overseasWh",Number(u[c].wid));case 20:if(m=a.sent,!JSON.parse(m)||!JSON.parse(m).warehouse_name){a.next=25;break}u[c].warehouse_name=JSON.parse(m).warehouse_name,a.next=26;break;case 25:return a.abrupt("continue",26);case 26:c++,a.next=16;break;case 29:(l=t.exportData).push.apply(l,Object(s["a"])(u)),t.DerivedData(e+1);case 31:a.next=37;break;case 33:a.prev=33,a.t0=a["catch"](3),t.$message.warning("".concat(a.t0)),t.Loading2=!1;case 37:a.next=44;break;case 39:t.Loading2=!1,d='<tr>\n        <td style="width: 200px; text-align:left;">所属仓库</td>\n        <td style="width: 200px; text-align:left;">系统商品编号</td>\n        <td style="width: 200px; text-align:left;">商品编号（SkuId）</td>\n        <td style="width: 200px; text-align:left;">商品名称</td>\n        <td style="width: 200px; text-align:left;">商品规格</td>\n        <td style="width: 200px; text-align:left;">可用库存</td>\n        <td style="width: 200px; text-align:left;">共享库存</td>\n        <td style="width: 200px; text-align:left;">商品单价（RMB）</td>\n        <td style="width: 800px; text-align:left;">商品链接</td>\n        <td style="width: 800px; text-align:left;">商品图片</td>\n        <td style="width: 200px; text-align:left;">货架仓位</td>\n        <td style="width: 200px; text-align:left;">库存更新时间</td>\n      </tr>',t.exportData.forEach((function(e,t){d+='\n        <tr>\n          <td style="text-align:left;">'.concat(e.warehouse_name||"",'</td>\n          <td style="text-align:left;">').concat(e.sys_sku_id||"",'</td>\n          <td style="text-align:left;">').concat(e.sku_id||"",'</td>\n          <td style="text-align:left;">').concat(e.goods_name||"",'</td>\n          <td style="text-align:left;">').concat(e.sku_name||"",'</td>\n          <td style="text-align:left;">').concat(e.stock_num,'</td>\n          <td style="text-align:left;">').concat(e.shared_num,'</td>\n          <td style="text-align:left;">').concat(e.sku_price||"",'</td>\n          <td style="text-align:left;">').concat(e.sku_url||"",'</td>\n          <td style="text-align:left;">').concat(e.sku_image||e.real_image_url||"",'</td>\n          <td style="text-align:left;">').concat(e.position||"",'</td>\n          <td style="text-align:left;">').concat(e.updated_at||"","</td>\n        </tr>\n        ")})),Object(o["j"])("海外仓库存信息",d),t.exportData=[];case 44:case"end":return a.stop()}}),a,null,[[3,33]])})))()},handleSizeChange:function(e){this.pageSize=e,this.getoverseaswarehouse()},handleCurrentChange:function(e){this.page=e,this.getoverseaswarehouse()},handleSelectionChange:function(e){this.multipleSelection=e}}},u=l,c=(a("2648"),a("2877")),m=Object(c["a"])(u,r,n,!1,null,"1b66a8b4",null);t["default"]=m.exports}}]);