(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8a4b1572"],{"22eb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("div",{staticClass:"condetion",staticStyle:{"background-color":"white",padding:"8px"}},[a("div",{staticClass:"row1"},[a("storeChoose",{staticStyle:{"margin-left":"-20px"},attrs:{"show-mall-all":!0},on:{changeMallList:e.changeMallList}}),a("div",{staticStyle:{"margin-left":"20px"}},[a("label",[e._v("状态：")]),a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.activeType,callback:function(t){e.activeType=t},expression:"activeType"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),a("el-option",{attrs:{label:"进行中",value:"1"}}),a("el-option",{attrs:{label:"接下来有活动",value:"2"}}),a("el-option",{attrs:{label:"活动已过期",value:"3"}})],1)],1),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},on:{click:e.getTableList}},[e._v("搜索")]),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},on:{click:e.stopSearch}},[e._v("停止搜索")])],1),a("div",{staticClass:"row2",staticStyle:{"margin-top":"8px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.createTestVisile}},[e._v("创建加购促销活动")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.MallvoucherDelMul}},[e._v("批量删除/结束活动")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.clearLog}},[e._v("清除日志")]),a("el-checkbox",{staticStyle:{"margin-left":"8px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")]),a("el-checkbox",{staticStyle:{"margin-left":"-10px"},model:{value:e.isShowPast,callback:function(t){e.isShowPast=t},expression:"isShowPast"}},[e._v("不显示过期活动")])],1)]),a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}}),a("div",{staticClass:"tableDetail",staticStyle:{"margin-top":"8px"}},[a("u-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{data:e.tableList,height:"800px","use-virtual":"",border:!1,"header-cell-style":{background:"#f7fafa"}},on:{"selection-change":e.handleSelectionChange}},[a("u-table-column",{attrs:{type:"selection",width:"55",fixed:""}}),a("u-table-column",{attrs:{type:"index",fixed:"",label:"序号","min-width":"50px"}}),a("u-table-column",{attrs:{prop:"mallName",label:"店铺",align:"center","min-width":"150px"}}),a("u-table-column",{attrs:{prop:"add_on_deal_name",label:"活动名称",align:"center","min-width":"150px"}}),a("u-table-column",{attrs:{prop:"sub_type",label:"活动类型",align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(1===Number(a.sub_type)?"消费满赠":"加购折扣"))]}}])}),a("u-table-column",{attrs:{prop:"voucher_status",label:"活动状态",align:"center","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["进行中"===n.voucher_status?a("span",{staticStyle:{color:"#0ad10a"}},[e._v(e._s(n.voucher_status))]):e._e(),"即将开始"===n.voucher_status?a("span",{staticStyle:{color:"orange"}},[e._v(e._s(n.voucher_status))]):e._e(),"已过期"===n.voucher_status?a("span",[e._v(e._s(n.voucher_status))]):e._e()]}}])}),a("u-table-column",{attrs:{prop:"",label:"促销期间",align:"center","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",{staticStyle:{display:"flex","flex-flow":"column"}},[a("span",[e._v(e._s(n.formStartime)+"-"+e._s(n.formEndtime))])])]}}])}),a("u-table-column",{attrs:{prop:"min_spend",label:"操作",align:"center","min-width":"180px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",{staticStyle:{display:"flex"}},["进行中"===n.voucher_status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.MallvoucherStopFun(n)}}},[e._v("停止")]):e._e(),"即将开始"===n.voucher_status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.MallvoucherDelFun(n)}}},[e._v("删除")]):e._e(),"进行中"===n.voucher_status||"即将开始"===n.voucher_status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.editGoods(n)}}},[e._v("编辑商品")]):e._e(),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.clearLog}},[e._v("复制活动")])],1)]}}])})],1)],1),a("el-dialog",{staticClass:"edit-group-dialog",attrs:{visible:e.proVisible,width:"1280px",height:"600px",top:"5vh",title:"加购优惠","close-on-click-modal":!1,"close-on-press-escape":!1,close:e.getTableList},on:{"update:visible":function(t){e.proVisible=t}}},[a("ul",[a("li",[a("div",{staticStyle:{"margin-left":"10px","margin-bottom":"5px"}},[e._v("基本资料")]),a("ul",{staticStyle:{border:"1px solid #d4d1d1",padding:"10px","border-radius":"8px"}},[a("li",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("div",[e._v(" 操作店铺 "),a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:e.optionMall,callback:function(t){e.optionMall=t},expression:"optionMall"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._l(e.selectMallList,(function(t){return a("el-option",{key:t.id,attrs:{disabled:e.disSelect,label:t.mall_alias_name||t.platform_mall_name,value:t.platform_mall_id}})}))],2)],1),a("div",{staticStyle:{"margin-left":"50px"}},[a("el-radio-group",{model:{value:e.discountType,callback:function(t){e.discountType=t},expression:"discountType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("折扣优惠")]),a("el-radio",{attrs:{label:"1"}},[e._v("赠品满最低消费")])],1),"0"===e.discountType?a("span",{staticStyle:{"margin-left":"16px"}},[e._v(" 加购限制 "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"买家在同一个订单里最多加购的商品数量是(1-100)",placement:"top-start"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},model:{value:e.addLimit,callback:function(t){e.addLimit=t},expression:"addLimit"}})],1)],1):e._e(),"1"===e.discountType?a("span",{staticStyle:{"margin-left":"16px"}},[e._v(" 赠品规则 消费"),a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},model:{value:e.costNum,callback:function(t){e.costNum=t},expression:"costNum"}}),e._v(" 以获得 "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"赠品的数量应在(1-50)内",placement:"top-start"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",onkeyup:"value=value.replace(/[^\\d]/g,0)"},model:{value:e.sendNum,callback:function(t){e.sendNum=t},expression:"sendNum"}})],1),e._v(" 个赠品 ")],1):e._e()],1)]),a("li",{staticStyle:{display:"flex"}},[a("div",[e._v(" 促销名称 "),a("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini",maxlength:"24"},model:{value:e.proName,callback:function(t){e.proName=t},expression:"proName"}})],1),a("div",{staticStyle:{"margin-left":"50px"}},[e._v(" 活动时间 "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"开始时间必须比当前时间晚一个小时;结束时间必须比开始时间晚一个小时",placement:"top-start"}},[a("el-date-picker",{staticStyle:{width:"330px"},attrs:{size:"mini","value-format":"timestamp",type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.proTime,callback:function(t){e.proTime=t},expression:"proTime"}})],1)],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:e.saveActiveInfo}},[e._v("保存活动")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.clearLog}},[e._v("清除日志")]),a("el-checkbox",{staticStyle:{"margin-left":"8px","margin-top":"5px"},model:{value:e.showlog,callback:function(t){e.showlog=t},expression:"showlog"}},[e._v("隐藏日志")])],1)])]),a("li",{staticStyle:{display:"flex","margin-top":"10px"}},[a("div",{staticClass:"masterGoods"},[a("div",{staticStyle:{"margin-left":"10px","margin-bottom":"5px"}},[e._v("主要商品")]),a("ul",{staticStyle:{border:"1px solid #d4d1d1",padding:"10px","border-radius":"8px"}},[a("li",{staticStyle:{"margin-bottom":"5px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.openShowMul(1)}}},[e._v("开启")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.openShowMul(2)}}},[e._v("关闭")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.delMasterMul}},[e._v("删除")]),a("el-button",{staticStyle:{"margin-left":"65px"},attrs:{size:"mini",type:"primary"},on:{click:e.addMasterGoods}},[e._v("添加主要商品")])],1),a("li",[a("el-table",{staticStyle:{width:"400px"},attrs:{data:e.masterGoodslist,"header-cell-style":{background:"#f7fafa"},height:"400px"},on:{"selection-change":e.MasterSelectionChange}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"mallName",label:"店铺",align:"center","min-width":"120px"}}),a("el-table-column",{attrs:{prop:"item_id",label:"商品",align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"statusShow",label:"状态",align:"center","min-width":"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(a){return e.changeShow(t.row,t.$index,e.master)}},model:{value:t.row.statusShow,callback:function(a){e.$set(t.row,"statusShow",a)},expression:"scope.row.statusShow"}})],1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"80px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.delMaster(t.row,t.$index,e.master)}}},[e._v("删除")])],1)]}}])})],1)],1)])]),a("div",{staticClass:"addGoods",staticStyle:{"margin-left":"10px"}},[a("div",{staticStyle:{"margin-left":"10px","margin-bottom":"5px"}},[e._v("加购商品")]),a("ul",{staticStyle:{border:"1px solid #d4d1d1",padding:"10px","border-radius":"8px"}},[a("li",{staticStyle:{display:"flex","margin-bottom":"5px"}},[a("div",[e._v("折扣："),a("el-input",{staticStyle:{width:"50px"},attrs:{size:"mini"},model:{value:e.addGoodsDiscount,callback:function(t){e.addGoodsDiscount=t},expression:"addGoodsDiscount"}}),e._v("%")],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"}},[e._v("批量更新")]),a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("开启")]),a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("关闭")]),a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("删除")]),a("el-button",{staticStyle:{"margin-left":"200px"},attrs:{size:"mini",type:"primary"},on:{click:e.addOtherGoodsFun}},[e._v("添加加购商品")])],1),a("li",[a("el-table",{attrs:{data:e.addGoodsList,"header-cell-style":{background:"#f7fafa"},height:"400px"}},[a("el-table-column",{attrs:{align:"center",type:"selection",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"",label:"店铺",align:"center","min-width":"120px",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(a.mall_alias_name||a.platform_mall_name))]}}])}),a("el-table-column",{attrs:{prop:"itemid",label:"商品",align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"price",label:"原价",align:"center","min-width":"100px"}}),"0"===e.othertableType?a("el-table-column",{attrs:{prop:"discount",label:"折扣",align:"center","min-width":"100px"}}):e._e(),a("el-table-column",{attrs:{prop:"addPrice",label:"加购价格",align:"center","min-width":"100px"}}),"0"===e.othertableType?a("el-table-column",{attrs:{prop:"addStatus",label:"加购显示",align:"center","min-width":"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(a){return e.changeShow(t.row,t.$index)}},model:{value:t.row.addStatus,callback:function(a){e.$set(t.row,"addStatus",a)},expression:"scope.row.addStatus"}})],1)]}}],null,!1,2492230570)}):e._e(),a("el-table-column",{attrs:{prop:"showStatus",label:"状态",align:"center","min-width":"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(a){return e.changeShow(t.row,t.$index)}},model:{value:t.row.showStatus,callback:function(a){e.$set(t.row,"showStatus",a)},expression:"scope.row.showStatus"}})],1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"100px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.delCouponGoods(n)}}},[e._v("删除")])],1)]}}])})],1)],1)])])])])]),a("div",{staticClass:"on_new_dialog"},[a("el-dialog",{attrs:{visible:e.goodsItemSelectorVisible,top:"7vh",title:"商品选择","close-on-click-modal":!1,"close-on-press-escape":!1,width:"1280px"},on:{"update:visible":function(t){e.goodsItemSelectorVisible=t}}},[e.goodsItemSelectorVisible?a("goodsItemSelector",{attrs:{"is-need-filter-act":!0,mall:e.selectMallList},on:{changeGoodsItem:e.changeGoodsItem}}):e._e()],1)],1)],1)},s=[],r=a("1da1"),i=(a("96cf"),a("c740"),a("d3b7"),a("25f0"),a("a9e3"),a("159b"),a("99af"),a("3ca3"),a("ddb0"),a("a434"),a("feb6")),o=a("a254"),l=a("0e0b"),c=a("01cd"),u={components:{storeChoose:i["a"],goodsItemSelector:c["a"]},data:function(){return{currentDate:!1,disSelect:!1,othertableType:"0",masterGoods:!1,otherGoods:!1,goodsItemSelectorVisible:!1,arrList:[],willList:[],doingList:[],pastList:[],addGoodsDiscount:"",addGoodsList:[],masterGoodslist:[],sendNum:0,costNum:0,addLimit:0,optionMall:"",discountType:"0",proTime:[],proName:"",isShowPast:!0,tableLoading:!1,MarketManagerAPIInstance:new o["a"](this),showlog:!0,activeType:"0",tableList:[],proVisible:!1,pickerOptions:{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}},shopAccountMallList:[],selectMallList:[],stoptoping:!1,mallTableSelect:[],goodsMasterTableSelect:[],goodsLitterTableSelect:[],getTable:[],getcreateNewTest:[],saveActive:!1}},created:function(){this.inittime()},methods:{editGoods:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s,r,i,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.proVisible=!0,t.currentDate=e,n=t.selectMallList.findIndex((function(t){return t.mall_alias_name===e.mallName||t.platform_mall_name===e.mallName})),t.optionMall=t.selectMallList[n].platform_mall_id,t.disSelect=!0,t.discountType=e.sub_type.toString(),t.addLimit=e.sub_item_limit,t.costNum=e.purchase_min_spend,t.sendNum=e.per_gift_num,t.proName=e.add_on_deal_name,t.proTime=[1e3*Number(e.start_time),1e3*Number(e.end_time)],s={country:e.country,mallId:e.platform_mall_id,add_on_deal_id:e.add_on_deal_id},t.$refs.Logs.writeLog("正在请求主要商品"),a.next=15,t.MarketManagerAPIInstance.getMasterGoods(s);case 15:return r=a.sent,0===r.ecode?(t.$refs.Logs.writeLog("主要商品数据加载成功",!0),i=r.data.data.main_item_list,i.forEach((function(t){t.mallName=e.mallName,t.statusShow=1===t.status})),t.masterGoodslist=i):t.$refs.Logs.writeLog("主要商品请求失败：".concat(r.message),!1),a.abrupt("return");case 21:o=a.sent,0===o.ecode?(t.$refs.Logs.writeLog("附加商品数据加载成功",!0),l=o.data.data.item_info,l.forEach((function(t){t.mallName=e.mallName})),t.masterGoodslist=l):t.$refs.Logs.writeLog("附加商品请求失败：".concat(o.message),!1);case 23:case"end":return a.stop()}}),a)})))()},inittime:function(){var e=(new Date).getTime()+3e5,t=e+36e5;this.proTime=[e,t]},stopSearch:function(){Object(l["y"])(),this.stoptoping=!0,this.$refs.Logs.writeLog("正在停止查询")},createTestVisile:function(){this.showlog=!0,this.selectMallList.length?(this.masterGoodslist=[],this.getcreateNewTest=[],this.masterGoods=!1,this.otherGoods=!1,this.proVisible=!0):this.$message.warning("请选择店铺")},saveActiveInfo:function(){if(this.saveActive=!1,"0"===this.discountType&&(0===Number(this.addLimit)||Number(this.addLimit)>100))this.$message.warning("请输入加购限制,加购限制范围在1-100");else if("1"!==this.discountType||this.costNum&&0!==Number(this.sendNum)&&!(Number(this.sendNum)>50))if(!this.proName.length||this.proName.length>24)this.$message.warning("请输入促销名称，名称长不可超过24个字符");else{var e=(new Date).getTime();if(e>Number(this.proTime[0]))this.$message.warning("请输入比当前较晚的开始时间");else if(Number(this.proTime[1]-Number(this.proTime[0])<36e5))this.$message.warning("结束时间至少比开始时间晚一个小时");else for(var t=0;t<this.selectMallList.length;t++)this.saveActiveInfoFun(this.selectMallList[t])}else this.$message.warning("请输入消费数量以及赠品数量,赠品限制范围在1-50")},saveActiveInfoFun:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.showlog=!1,n={country:e.country,mallId:e.platform_mall_id,add_on_deal_name:t.proName,start_time:Math.floor(t.proTime[0]/1e3),end_time:Math.floor(t.proTime[1]/1e3),sub_type:t.discountType,sub_item_limit:t.addLimit,purchase_min_spend:t.costNum,per_gift_num:t.sendNum},a.next=5,t.MarketManagerAPIInstance.saveActiveAddondeal(n);case 5:s=a.sent,0===s.ecode?(t.$refs.Logs.writeLog("------【".concat(e.mall_alias_name||e.platform_mall_name,"】创建成功------"),!0),t.saveActive=!0,r=s.data.data,r.country=e.country,r.mallId=e.platform_mall_id,r.mallname=e.mall_alias_name||e.platform_mall_name,t.getcreateNewTest.push(r),t.othertableType=t.discountType):t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建失败,").concat(s.message),!1),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](0),t.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】创建失败--catch,").concat(a.t0),!1);case 12:case"end":return a.stop()}}),a,null,[[0,9]])})))()},addMasterGoods:function(){this.saveActive||this.getcreateNewTest.length||this.currentDate?(this.goodsItemSelectorVisible=!0,this.masterGoods=!0):this.$message.warning("请先保存活动")},changeGoodsItem:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s,r,i,o,l,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.goodsList.length){a.next=3;break}return t.$message.warning("请先选择商品"),a.abrupt("return");case 3:if(!t.getcreateNewTest.length){a.next=21;break}if(!t.masterGoods){a.next=18;break}n=[],e.goodsList.forEach((function(e){n.push({item_id:e.itemid,status:e.status})})),t.getcreateNewTest.forEach((function(e){e.main_item_list=n})),s=regeneratorRuntime.mark((function e(a){var s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.getcreateNewTest[a],e.next=3,t.saveActiveMasterGoods(s);case 3:if(r=e.sent,0!==r.ecode){e.next=9;break}t.$refs.Logs.writeLog("------【".concat(s.mallname,"】添加成功").concat(n.length,"个商品------"),!0),s.main_item_list.forEach((function(e){e.statusShow=1===e.status,e.mallName=s.mallname,e.mallId=s.mallId;var a=t.masterGoodslist.findIndex((function(t){return t.item_id===e.item_id}));a<0?t.masterGoodslist.push(e):t.$refs.Logs.writeLog("------【".concat(s.mallname,"】已过滤重复数组------"),!0)})),e.next=11;break;case 9:return t.$refs.Logs.writeLog("【".concat(s.mallname,"】商品添加失败,").concat(r.message),!1),e.abrupt("return","continue");case 11:case"end":return e.stop()}}),e)})),r=0;case 10:if(!(r<t.getcreateNewTest.length)){a.next=18;break}return a.delegateYield(s(r),"t0",12);case 12:if(i=a.t0,"continue"!==i){a.next=15;break}return a.abrupt("continue",15);case 15:r++,a.next=10;break;case 18:if(t.otherGoods)for(o=[],e.goodsList.forEach((function(e){o.push(e)})),t.getcreateNewTest.forEach((function(e){e.item_list=o})),t.addGoodsList=[],l=0;l<t.getcreateNewTest.length;l++)t.addOtherGoods(t.getcreateNewTest[l]);a.next=29;break;case 21:if(!t.masterGoods){a.next=28;break}return c={country:t.currentDate.country,mallId:t.currentDate.platform_mall_id,add_on_deal_id:t.currentDate.add_on_deal_id,main_item_list:[]},e.goodsList.forEach((function(e){e.status=1,c.main_item_list.push({item_id:e.itemid,status:e.status})})),a.next=26,t.saveActiveMasterGoods(c);case 26:u=a.sent,0!==u.ecode?t.$refs.Logs.writeLog("【".concat(t.currentDate.mallName,"】商品添加失败,").concat(u.message),!1):(c.main_item_list.forEach((function(e){e.statusShow=1===e.status,e.mallName=t.currentDate.mallName;var a=t.masterGoodslist.findIndex((function(t){return t.item_id===e.item_id}));a<0?t.masterGoodslist.push(e):t.$refs.Logs.writeLog("------【".concat(t.currentDate.mallName,"】已过滤重复数组------"),!0)})),t.$refs.Logs.writeLog("【".concat(t.currentDate.mallName,"】商品添加成功"),!0));case 28:t.otherGoods;case 29:case"end":return a.stop()}}),a)})))()},saveActiveMasterGoods:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.showlog=!1,n={country:e.country,mallId:e.mallId,add_on_deal_id:e.add_on_deal_id,main_item_list:e.main_item_list},a.next=6,t.MarketManagerAPIInstance.ActiveAddMasterGooods(n);case 6:return s=a.sent,t.goodsItemSelectorVisible=!1,a.abrupt("return",s);case 12:a.prev=12,a.t0=a["catch"](0),t.$refs.Logs.writeLog("【".concat(e.mallname,"】操作添加失败--catch,").concat(a.t0),!1);case 15:case"end":return a.stop()}}),a,null,[[0,12]])})))()},MasterSelectionChange:function(e){this.goodsMasterTableSelect=e},openShowMul:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s,r,i,o,l,c,u,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.goodsMasterTableSelect.length){a.next=3;break}return t.$message.warning("请先选择商品信息!"),a.abrupt("return");case 3:if(!t.getcreateNewTest.length){a.next=21;break}n=0;case 5:if(!(n<t.getcreateNewTest.length)){a.next=19;break}s=t.getcreateNewTest[n],r=function(a){var n=s.main_item_list[a],r=t.goodsMasterTableSelect.findIndex((function(e){return n===e}));if(r>0){n.status=e,delete n.statusShow&&n.mallName&&n.mallId;var i=t.saveActiveMasterGoods(s);if(0!==i.ecode)return t.$refs.Logs.writeLog("【".concat(s.mallname,"】商品状态修改失败,").concat(i.message),!1),"continue";t.$refs.Logs.writeLog("【".concat(s.mallname,"】商品状态修改成功"),!0)}},i=0;case 9:if(!(i<s.main_item_list.length)){a.next=16;break}if(o=r(i),"continue"!==o){a.next=13;break}return a.abrupt("continue",13);case 13:i++,a.next=9;break;case 16:n++,a.next=5;break;case 19:a.next=28;break;case 21:for(l={country:t.currentDate.country,mallId:t.currentDate.platform_mall_id,add_on_deal_id:t.currentDate.add_on_deal_id,main_item_list:[]},c=0;c<t.goodsMasterTableSelect.length;c++)u=t.goodsMasterTableSelect[c],t.$set(u,"statusShow",!u.statusShow),u.status=e,l.main_item_list.push({status:u.status,item_id:u.item_id});return a.next=25,t.saveActiveMasterGoods(l);case 25:d=a.sent,0!==d.ecode?t.$refs.Logs.writeLog("【".concat(t.currentDate.mallName,"】商品状态修改失败,").concat(d.message),!1):t.$refs.Logs.writeLog("【".concat(t.currentDate.mallName,"】商品状态修改成功"),!0);case 28:case"end":return a.stop()}}),a)})))()},changeShow:function(e,t,a){if(this.getcreateNewTest.length,"master"===a){e.statusShow,e.main_item_list.status;var n=this.saveActiveMasterGoods(e);0!==n.ecode?this.$refs.Logs.writeLog("【".concat(e.mallname,"】操作添加失败,").concat(n.message),!1):this.$refs.Logs.writeLog("【".concat(e.mallname,"】商品状态修改成功"),!0)}},delMasterMulFun:function(){var e=this;this.masterGoodslist.length||this.$message.warning("请先选择商品信息"),this.$confirm("您确定要删除这些商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.delMasterMul();case 1:case"end":return t.stop()}}),t)}))))},delMasterMul:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,s,r,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.getcreateNewTest.length){t.next=4;break}for(a=0;a<e.getcreateNewTest.length;a++)n=e.getcreateNewTest[a],n.main_item_list.status=0,e.saveActiveMasterGoods(n);t.next=10;break;case 4:for(s={country:e.currentDate.country,mallId:e.currentDate.platform_mall_id,add_on_deal_id:e.currentDate.add_on_deal_id,main_item_list:[]},r=0;r<e.goodsMasterTableSelect.length;r++)i=e.goodsMasterTableSelect[r],i.status=0,s.main_item_list.push({status:i.status,item_id:i.item_id});return t.next=8,e.saveActiveMasterGoods(s);case 8:o=t.sent,0!==o.ecode?e.$refs.Logs.writeLog("【".concat(e.currentDate.mallName,"】商品删除修改失败,").concat(o.message),!1):(e.goodsMasterTableSelect.forEach((function(t){var a=e.masterGoodslist.findIndex((function(e){return e.item_id===t.item_id}));e.masterGoodslist.splice(a,1)})),e.$refs.Logs.writeLog("【".concat(e.currentDate.mallName,"】商品删除成功"),!0));case 10:case"end":return t.stop()}}),t)})))()},delMasterFun:function(e,t){var a=this;this.$confirm("您确定要删除改商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a.delMaster(e,t);case 1:case"end":return n.stop()}}),n)}))))},delMaster:function(e,t){e.main_item_list.status,this.saveActiveMasterGoods(e,t)},addOtherGoodsFun:function(){this.masterGoodslist.length?(this.goodsItemSelectorVisible=!0,this.otherGoods=!0):this.$message.warning("请至少选择一个主要商品")},addOtherGoods:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.showlog=!1,n=[],e.item_list.forEach((function(e){n.push(e.itemid)})),s={country:e.country,mallId:e.mallId,add_on_deal_id:e.add_on_deal_id,item_list:n},a.next=8,t.MarketManagerAPIInstance.AddotherGooods(s);case 8:r=a.sent,0===r.ecode?(t.$refs.Logs.writeLog("------【".concat(e.mallname,"】成功添加").concat(e.item_list.length,"个加购商品------"),!0),t.getcreateNewTest.length&&e.item_list.forEach((function(a){0===e.sub_type?(a.discount=0,a.addPrice=a.discount?a.price:a.price*Number(a.discount),a.addStatus=!0,a.showStatus=!0):(a.addPrice=0,a.showStatus=!0),t.addGoodsList.push(a)}))):t.$refs.Logs.writeLog("【".concat(e.mallname,"】加购商品添加失败,").concat(r.message),!1),t.goodsItemSelectorVisible=!1,a.next=17;break;case 14:a.prev=14,a.t0=a["catch"](0),t.$refs.Logs.writeLog("【".concat(e.mallname,"】加购商品添加失败--catch,").concat(a.t0),!1);case 17:case"end":return a.stop()}}),a,null,[[0,14]])})))()},clearLog:function(){this.$refs.Logs.consoleMsg=""},handleSelectionChange:function(e){this.mallTableSelect=e},MallvoucherDelMul:function(){var e=this;this.mallTableSelect.length?this.$confirm("确定要删除或停止这些活动吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.mallTableSelect.length)){t.next=12;break}if(n=e.mallTableSelect[a],"即将开始"!==n.voucher_status){t.next=6;break}return t.next=6,e.MallvoucherDel(n);case 6:if("进行中"!==n.voucher_status){t.next=9;break}return t.next=9,e.MallvoucherStop(n);case 9:a++,t.next=1;break;case 12:e.getTableList();case 13:case"end":return t.stop()}}),t)})))):this.$message.warning("请选择要操作的数据")},MallvoucherStopFun:function(e){var t=this;this.$confirm("确定要停止该活动吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.MallvoucherStop(e);case 2:t.getTableList();case 3:case"end":return a.stop()}}),a)}))))},MallvoucherStop:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={country:e.country,mallId:e.platform_mall_id,add_on_deal_id:e.add_on_deal_id},a.prev=1,t.showlog=!1,a.next=5,t.MarketManagerAPIInstance.stopOndealList(n);case 5:s=a.sent,0===s.ecode?t.$refs.Logs.writeLog("------成功停止【".concat(e.add_on_deal_name,"】优惠活动------"),!0):t.$refs.Logs.writeLog("停止【".concat(e.add_on_deal_name,"】优惠活动,").concat(s.message),!1),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),t.$refs.Logs.writeLog("停止【".concat(e.add_on_deal_name,"】--catch,").concat(a.t0),!1);case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},MallvoucherDelFun:function(e){var t=this;this.$confirm("确定要删除该活动吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.MallvoucherDel(e);case 2:t.getTableList();case 3:case"end":return a.stop()}}),a)}))))},MallvoucherDel:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={country:e.country,mallId:e.platform_mall_id,add_on_deal_id:e.add_on_deal_id},a.prev=1,t.showlog=!1,a.next=5,t.MarketManagerAPIInstance.delondealList(n);case 5:s=a.sent,0===s.ecode?t.$refs.Logs.writeLog("------成功删除【".concat(e.add_on_deal_name,"】优惠活动------"),!0):(r="","only upcoming campaign can delete"===s.message&&(r="只有即将进行的活动才能删除"),t.$refs.Logs.writeLog("删除【".concat(e.add_on_deal_name,"】优惠活动,").concat(r||s.message),!1)),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),t.$refs.Logs.writeLog("删除【".concat(e.add_on_deal_name,"】--catch,").concat(a.t0),!1);case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},stopCreate:function(){Object(l["y"])(),this.$refs.Logs.writeLog("已停止创建")},add0:function(e){return e<10?"0"+e:e},formatTime:function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,s=t.getDate(),r=t.getHours(),i=t.getMinutes(),o=t.getSeconds();return a+"-"+this.add0(n)+"-"+this.add0(s)+" "+this.add0(r)+":"+this.add0(i)+":"+this.add0(o)},changeMallList:function(e){this.selectMallList=e},getInfo:function(e){var t=arguments,a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var s,r,i,o,l,c,u,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,r={country:e.country,mallId:e.platform_mall_id,offset:e.offset,count:50},n.next=5,a.MarketManagerAPIInstance.getAddondealList(r);case 5:if(i=n.sent,0===i.ecode){n.next=11;break}return o="","token not found"===i.message&&(o="店铺未登录"),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】数据请求失败,").concat(o||i.message),!1),n.abrupt("return");case 11:if(l=0===i.ecode?i.data.data.add_on_deal_list:[],l.length){n.next=15;break}return a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】暂无数据")),n.abrupt("return");case 15:if(!l.length){n.next=45;break}if(!a.stoptoping){n.next=18;break}return n.abrupt("return");case 18:c=0;case 19:if(!(c<l.length)){n.next=33;break}if(!a.stoptoping){n.next=22;break}return n.abrupt("return");case 22:u=l[c],u.platform_mall_id=e.platform_mall_id,u.country=e.country,u.mallName=e.mall_alias_name||e.platform_mall_name,u.formStartime=a.formatTime(1e3*u.start_time),u.formEndtime=a.formatTime(1e3*u.end_time),1===Number(u.status)?(u.voucher_status="即将开始",a.willList.push(u)):2===Number(u.status)?(u.voucher_status="进行中",a.doingList.push(u)):(u.voucher_status="已过期",a.pastList.push(u)),a.arrList.push(u);case 30:c++,n.next=19;break;case 33:if(a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】,正在请求第【").concat(r.offset/r.count+1,"】页"),!0),!(l.length<r.count)){n.next=38;break}l.length=[],n.next=43;break;case 38:return r.offset=r.offset+r.count,n.next=41,a.MarketManagerAPIInstance.logisticsPromotion(r);case 41:d=n.sent,l=0===d.data.code?d.data.data.add_on_deal_list:[];case 43:n.next=15;break;case 45:a.isShowPast?"0"===a.activeType?a.getTable=a.willList.concat(a.doingList):"1"===a.activeType?a.getTable=a.doingList:"2"===a.activeType?a.getTable=a.willList:a.getTable=[]:("1"===a.activeType&&(a.getTable=a.doingList),"2"===a.activeType&&(a.getTable=a.willList),"3"===a.activeType&&(a.getTable=a.pastList),"0"===a.activeType&&(a.getTable=a.arrList)),n.next=51;break;case 48:n.prev=48,n.t0=n["catch"](1),a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】--catch，").concat(n.t0),!1);case 51:return n.prev=51,s.count--,n.finish(51);case 54:case"end":return n.stop()}}),n,null,[[1,48,51,54]])})))()},getPrizeDetail:function(e){var t=arguments,a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var s,r,i,o,l,c,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s=t.length>1&&void 0!==t[1]?t[1]:{count:1},n.prev=1,r={country:e.country,mallId:e.platform_mall_id,campaign_id:e.campaign_id},n.next=5,a.MarketManagerAPIInstance.FollowPrizeDetail(r);case 5:i=n.sent,0===i.data.code?(o=i.data.data,l=null,c=null,u=o.min_spend,0===Number(o.reward_type)&&(o.discount.value?(l=o.discount.value,c=""):(l="".concat((100-Number(o.discount.percentage))/10,"折"),c="0.00"===o.discount.cap?"无限制":o.discount.cap)),1===Number(o.reward_type)&&(l="".concat(o.coin_cash_back.percentage,"%折扣,(Shopee币回扣)"),c="0.00"===o.coin_cash_back.cap?"无限制":o.coin_cash_back.cap+"(Shopee币)"),a.$set(e,"discountInfo",l),a.$set(e,"topNum",c),a.$set(e,"min_spend",u)):a.$refs.Logs.writeLog("【".concat(e.mall_alias_name||e.platform_mall_name,"】,").concat(i.message),!1),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](1),a.$refs.Logs.writeLog("Detailcatch，".concat(n.t0),!1);case 12:return n.prev=12,s.count--,n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[1,9,12,15]])})))()},getTableList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.disSelect=!1,e.$refs.multipleTable.clearSelection(),e.selectMallList.forEach((function(e){e.offset=0})),e.getTable=[],e.arrList=[],e.willList=[],e.doingList=[],e.pastList=[],e.showlog=!1,e.tableLoading=!0,e.$refs.Logs.writeLog("正在请求数据......",!0),t.next=13,Object(l["c"])(e.selectMallList,e.getInfo);case 13:t.sent,e.$refs.Logs.writeLog("请求数据结束"),e.tableLoading=!1,e.tableList=e.getTable;case 17:case"end":return t.stop()}}),t)})))()}}},d=u,m=(a("e477"),a("2877")),p=Object(m["a"])(d,n,s,!1,null,"597208ae",null);t["default"]=p.exports},d350:function(e,t,a){},e477:function(e,t,a){"use strict";a("d350")}}]);