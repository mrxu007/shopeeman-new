(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14dd0185"],{"0cee":function(e,t,r){"use strict";r("98d5")},"98d5":function(e,t,r){},e94a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",{staticClass:"contaniner"},[r("el-row",{staticClass:"header"},[r("ul",[r("li",[r("span",[e._v("仓库名称：")]),r("el-select",{attrs:{size:"mini",filterable:""},model:{value:e.form.wid,callback:function(t){e.$set(e.form,"wid",t)},expression:"form.wid"}},e._l(e.widList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.warehouse_name,value:e.wid}})})),1)],1),r("li",[r("span",[e._v("商品编号：")]),r("el-input",{attrs:{clearable:"",size:"mini",oninput:"value=value.replace(/\\s+/g,'')"},model:{value:e.form.sku_id,callback:function(t){e.$set(e.form,"sku_id",t)},expression:"form.sku_id"}})],1),r("li",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.page=1,e.getStock()}}},[e._v("搜 索")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.exportTableData}},[e._v("导出数据")])],1)])]),r("el-row",{attrs:{id:"article"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isShowLoading,expression:"isShowLoading"}],ref:"plTable",attrs:{height:"calc(100vh - 165px)",data:e.tableData,"header-cell-style":{backgroundColor:"#f5f7fa"}}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{label:"仓库名称",align:"center","min-width":"130",prop:"warehouse_name"}}),r("el-table-column",{attrs:{label:"商品编号(SkuId)",align:"center","min-width":"150",prop:"sku_id"}}),r("el-table-column",{attrs:{label:"商品名称",align:"center","min-width":"150",prop:"goods_name","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{label:"商品规格",align:"center","min-width":"150",prop:"sku_name","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{label:"采购数量",align:"center","min-width":"100",prop:"purchase_num"}}),r("el-table-column",{attrs:{label:"仓库库存",align:"center","min-width":"90",prop:"stock"}}),r("el-table-column",{attrs:{label:"在途库存",align:"center","min-width":"90",prop:"transport_num"}}),r("el-table-column",{attrs:{label:"总库存",align:"center","min-width":"90","render-header":e.allStockTooltip},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.transport_num+r.stock)+" ")]}}])}),r("el-table-column",{attrs:{label:"占用库存",align:"center","min-width":"100",prop:"frozen_num"}}),r("el-table-column",{attrs:{label:"商品单价(RMB)",align:"center","min-width":"110",prop:"sku_price"}}),r("el-table-column",{attrs:{width:"80",align:"center",label:"商品图片"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("el-tooltip",{staticStyle:{width:"40px",height:"40px"},attrs:{src:t.sku_image,"preview-src-list":[t.sku_image]}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:t.sku_image}},[r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"})])],1),r("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:t.sku_image}},[r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"})])],1)]}}])}),r("el-table-column",{attrs:{"min-width":"130",align:"center",label:"商品链接"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.goods_url?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.openUrl(a.goods_url)}}},[e._v("查看商品链接")]):e._e()]}}])}),r("el-table-column",{attrs:{label:"货架仓位",align:"center","min-width":"100",prop:"position_code","show-overflow-tooltip":""}})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","current-page":e.page,"page-sizes":[30,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},n=[],o=r("1da1"),s=(r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0"),r("159b"),r("4de4"),r("99af"),r("96cf"),r("d4ec")),i=r("bee2"),c=function(){function e(t){Object(s["a"])(this,e),this._this=t}return Object(i["a"])(e,[{key:"getUserInfo",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._this.$appConfig.getUserInfo();case 3:return t=e.sent,e.abrupt("return",{code:200,data:t});case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"获取用户信息异常： ".concat(e.t0)});case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"transferWarehouse",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._this.$appConfig.getGlobalCacheInfo("transferWarehouse",t);case 3:if(r=e.sent,"null"===r){e.next=7;break}return a=JSON.parse(r),e.abrupt("return",{code:200,data:a.warehouse_name});case 7:return e.abrupt("return",{code:200,data:""});case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"获取仓库中文名异常： ".concat(e.t0)});case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getStock",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._this.$XzyNetMessageService.post("xzy.shopifyV2.get_stock",t);case 3:if(r=e.sent,a=JSON.parse(JSON.parse(r).data),200!==a.code){e.next=7;break}return e.abrupt("return",{code:200,data:a.data});case 7:return e.abrupt("return",{code:a.code,data:"".concat(a.message)});case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"获取国内仓库存列表异常： ".concat(e.t0)});case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getWarehouseList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._this.$api.getWarehouseList();case 3:if(t=e.sent,200!==t.data.code){e.next=6;break}return e.abrupt("return",{code:200,data:t.data.data});case 6:return e.abrupt("return",{code:t.data.code,data:"".concat(t.data.message)});case 9:return e.prev=9,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"获取仓库异常： ".concat(e.t0)});case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"temporaryCacheInfo",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,r,a){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._this.$appConfig.temporaryCacheInfo(t,r,a);case 3:if(n=e.sent,o=this.isJsonString(n),null===o||void 0===o||!o.length){e.next=7;break}return e.abrupt("return",{code:200,data:o});case 7:return e.abrupt("return",{code:201});case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",{code:-2,data:"获取缓存中转仓异常： ".concat(e.t0)});case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(t,r,a){return e.apply(this,arguments)}return t}()},{key:"isJsonString",value:function(e){if("string"!==typeof e)return e;try{return JSON.parse(e),JSON.parse(e)}catch(t){return e}}}]),e}(),u=r("0e0b"),l={data:function(){return{isShowLoading:!1,ChineseStock:new c(this),total:0,pageSize:30,page:1,tableData:[],widList:[],muid:0,form:{wid:"",sku_id:""}}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getWarehouseList();case 2:return t.next=4,e.getStock();case 4:case"end":return t.stop()}}),t)})))()},methods:{getStock:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isShowLoading=!0,e.form.page=e.page,e.form.page_size=e.pageSize,t.next=5,e.ChineseStock.getStock(e.form);case 5:if(r=t.sent,200!==r.code){t.next=21;break}e.tableData=r.data.data,e.total=r.data.total,a=0;case 10:if(!(a<e.tableData.length)){t.next=19;break}return n=e.tableData[a],t.next=14,e.ChineseStock.transferWarehouse(n.wid);case 14:o=t.sent,200===o.code?e.$set(n,"warehouse_name",o.data):e.$set(n,"warehouse_name","");case 16:a++,t.next=10;break;case 19:t.next=22;break;case 21:e.$message.error(r.data);case 22:e.isShowLoading=!1;case 23:case"end":return t.stop()}}),t)})))()},getUserInfo:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ChineseStock.getUserInfo();case 2:r=t.sent,200===r.code?e.muid=r.data.muid:e.$message.error(r.data);case 4:case"end":return t.stop()}}),t)})))()},getWarehouseList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[],a=new Map,t.next=4,e.ChineseStock.temporaryCacheInfo("get","getWarehouseList","");case 4:if(n=t.sent,200!==n.code){t.next=9;break}r=n.data,t.next=20;break;case 9:return t.next=11,e.ChineseStock.getWarehouseList();case 11:if(o=t.sent,200!==o.code){t.next=18;break}return r=o.data,t.next=16,e.ChineseStock.temporaryCacheInfo("save","getWarehouseList",r);case 16:t.next=20;break;case 18:return e.$message.error("".concat(o.data)),t.abrupt("return");case 20:r.forEach((function(t){if(t.user_ids){var r=t.user_ids.some((function(t){return t===e.muid}));r&&e.widList.push(t)}else 2!==t.status&&e.widList.push(t)})),e.widList=e.widList.filter((function(e){return!a.has(e.id)&&a.set(e.id,1)})),e.form.wid=e.widList[0].wid;case 23:case"end":return t.stop()}}),t)})))()},openUrl:function(e){window.open(e)},exportTableData:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.total){t.next=2;break}return t.abrupt("return",e.$message("暂无导出数据"));case 2:e.isShowLoading=!0,r=[],a=e.form,a.pageSize=e.pageSize,a.page=1;case 7:if(!(r.length<e.total)){t.next=22;break}return t.next=10,e.ChineseStock.getStock(a);case 10:if(n=t.sent,200!==n.code){t.next=17;break}s=n.data.data,s.forEach(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ChineseStock.transferWarehouse(a.wid);case 2:n=t.sent,200===n.code?a.warehouse_name=n.data:a.warehouse_name="",r.push(a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),a.page++,t.next=20;break;case 17:return e.$message.error("导出数据错误",n.data),e.isShowLoading=!1,t.abrupt("break",22);case 20:t.next=7;break;case 22:i="<tr>\n          <td>仓库名称</td>\n          <td>商品编号(SkuId)</td>\n          <td>商品名称</td>\n          <td>商品规格</td>\n          <td>采购数量</td>\n          <td>仓库库存</td>\n          <td>在途库存</td>\n          <td>总库存</td>\n          <td>占用库存</td>\n          <td>商品单价(RMB)</td>\n          <td>商品图片</td>\n          <td>商品链接</td>\n          <td>货架仓位</td>\n        </td>",r.forEach((function(e){i+="<tr>\n        <td>".concat(e.warehouse_name?e.warehouse_name:"\t","</td>\n        <td style=\"mso-number-format:'@';\">").concat(e.sku_id?e.sku_id:"\t","</td>\n        <td>").concat(e.goods_name?e.goods_name:"\t","</td>\n        <td>").concat(e.sku_name?e.sku_name:"\t","</td>\n        <td>").concat(e.purchase_num?e.purchase_num:"\t","</td>\n        <td>").concat(e.stock?e.stock:"\t","</td>\n        <td>").concat(e.transport_num?e.transport_num:"\t","</td>\n        <td>").concat(e.transport_num&&e.stock?e.transport_num+e.stock:"\t","</td>\n        <td>").concat(e.frozen_num?e.frozen_num:"\t","</td>\n        <td>").concat(e.sku_price?e.sku_price:"\t","</td>\n        <td>").concat(e.sku_image?e.sku_image:"\t","</td>\n        <td>").concat(e.goods_url?e.goods_url:"\t","</td>\n        <td>").concat(e.position_code?e.position_code:"\t","</td>\n        </tr>")})),e.isShowLoading=!1,Object(u["h"])("国内仓库存数据",i);case 26:case"end":return t.stop()}}),t)})))()},allStockTooltip:function(e,t){var r=t.column;return[r.label,e("el-tooltip",{props:{content:"仓库库存+在途库存",placement:"top"}},[e("span",{class:{"el-icon-question":!0}})])]},handleSizeChange:function(e){this.page=1,this.pageSize=e,this.getStock()},handleCurrentChange:function(e){this.page=e,this.getStock()}}},d=l,p=(r("0cee"),r("2877")),h=Object(p["a"])(d,a,n,!1,null,"4c1ae798",null);t["default"]=h.exports}}]);