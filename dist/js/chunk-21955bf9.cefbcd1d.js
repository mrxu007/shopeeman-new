(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21955bf9"],{"11b5":function(t,e,a){"use strict";a("97f6")},"4c28":function(t,e,a){},8992:function(t,e,a){"use strict";a("4c28")},"97f6":function(t,e,a){},e567:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"advertisement"},[a("div",{staticClass:"header-btn"},[a("storeChoose",{attrs:{"is-all":!1},on:{changeMallList:t.changeMallList}})],1),a("div",{staticClass:"select-btn"},[a("div",{staticClass:"select-item"},[a("div",{staticClass:"base-box"},[a("span",{staticClass:"base-title"},[t._v("综合统计")]),a("div",{staticClass:"base-item"},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{size:"mini","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.statisticalTime,callback:function(e){t.statisticalTime=e},expression:"statisticalTime"}}),a("el-button",{staticClass:"mar-left",attrs:{type:"primary",size:"mini",disabled:t.loading},on:{click:t.batchGetAdventList}},[t._v("搜 索")]),a("el-button",{attrs:{type:"primary",size:"mini",disabled:t.loading},on:{click:function(e){t.viewDetailVisible=!0}}},[t._v("查看详情")]),a("el-button",{attrs:{type:"primary",size:"mini",disabled:t.loading},on:{click:t.exportData}},[t._v("导出数据")]),a("div",{staticClass:"over-view"},[a("div",{staticClass:"item"},[a("span",[t._v("余额")]),a("span",{staticClass:"mar-left"},[t._v(t._s(t.totalAnalysisData.balance))])]),a("div",{staticClass:"item"},[a("span",[t._v("浏览数")]),a("span",{attrs:{lass:"mar-left"}},[t._v(t._s(t.totalAnalysisData.impression))])]),a("div",{staticClass:"item"},[a("span",[t._v("点击次数")]),a("span",{staticClass:"mar-left"},[t._v(t._s(t.totalAnalysisData.click))])]),a("div",{staticClass:"item"},[a("span",[t._v("点击率")]),a("span",{staticClass:"mar-left"},[t._v(t._s(0==t.totalAnalysisData.impression?0:(t.totalAnalysisData.click/t.totalAnalysisData.impression*100).toFixed(2))+"%")])]),a("div",{staticClass:"item"},[a("span",[t._v("订单数")]),a("span",{staticClass:"mar-left"},[t._v(t._s(t.totalAnalysisData.order))])]),a("div",{staticClass:"item"},[a("span",[t._v("商品已出售")]),a("span",{staticClass:"mar-left"},[t._v(t._s(t.totalAnalysisData.order))])]),a("div",{staticClass:"item"},[a("span",[t._v("销售金额")]),a("span",{staticClass:"mar-left"},[t._v(t._s(t.totalAnalysisData.orderGmv))])]),a("div",{staticClass:"item"},[a("span",[t._v("花费")]),a("span",{staticClass:"mar-left"},[t._v(t._s(t.totalAnalysisData.cost))])])])],1)])]),a("div",{staticClass:"select-item"},[a("div",{staticClass:"base-box"},[a("span",{staticClass:"base-title"},[t._v("商品统计")]),a("div",{staticClass:"base-item"},[a("div",{staticClass:"select-row"},[a("div",{staticClass:"item-box"},[a("span",[t._v("广告类型：")]),a("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:t.adventType,callback:function(e){t.adventType=e},expression:"adventType"}},t._l(t.adventTypeList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("div",{staticClass:"item-box"},[a("span",[t._v("活动类型：")]),a("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",size:"mini"},model:{value:t.activeType,callback:function(e){t.activeType=e},expression:"activeType"}},[a("el-option",{attrs:{label:"全部",value:"all"}}),t._l(t.activeTypeList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2)],1),a("div",{staticClass:"item-box"},[a("span",[t._v("关键字：")]),a("el-input",{attrs:{size:"mini",type:"primary",placeholder:"可输入商品标题查询活动"},model:{value:t.keyWords,callback:function(e){t.keyWords=e},expression:"keyWords"}})],1),a("el-button",{staticClass:"mar-left",attrs:{type:"primary",size:"mini",disabled:t.loading},on:{click:t.batchGetAdventList}},[t._v("搜 索")]),a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("停止搜索")]),a("el-checkbox",{staticClass:"mar-left",model:{value:t.showConsole,callback:function(e){t.showConsole=e},expression:"showConsole"}},[t._v("隐藏日志")])],1),a("div",{staticClass:"select-row"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.createType="single",t.createAdventVisible=!0}}},[t._v("创建单个商品关键字广告")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.createType="batch",t.createAdventVisible=!0}}},[t._v("创建批量商品关键字广告")]),a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("创建关联广告")]),a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("停止创建广告")]),a("el-button",{attrs:{type:"primary",size:"mini",plain:""}},[t._v("暂停广告活动")]),a("el-button",{attrs:{type:"primary",size:"mini",plain:""}},[t._v("继续广告活动")])],1)])])])]),a("div",{staticClass:"content"},[a("u-table",{ref:"editPlTable",attrs:{data:t.tableData,"use-virtual":"",height:550,"row-height":68,"data-changes-scroll-top":!1,border:!1,"header-cell-style":{textAlign:"center",backgroundColor:"#f5f7fa"}},on:{"selection-change":t.handleSelectionChange}},[a("u-table-column",{attrs:{align:"center",type:"selection",width:"50"}}),a("u-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50"}}),a("u-table-column",{attrs:{width:"120px",label:"店铺名称",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.mallInfo.country)+"-"+t._s(a.mallInfo.mall_alias_name||a.mallInfo.platform_mall_name)+" ")]}}])}),a("u-table-column",{attrs:{align:"center",label:"商品图片",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticStyle:{width:"32px",height:"32px",display:"inline-block"},attrs:{effect:"light",placement:"right-end","visible-arrow":!1,enterable:!1}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("el-image",{staticStyle:{width:"400px",height:"400px"},attrs:{src:t._f("imageRender")([e.row.image])}})],1),a("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t._f("imageRender")([e.row.image,!0])}})],1)]}}])}),a("u-table-column",{attrs:{align:"center",label:"商品ID","min-width":"150",prop:"product.itemid"}}),a("u-table-column",{attrs:{align:"center",label:"商品名称","min-width":"150",prop:"product.name","show-overflow-tooltip":""}}),a("u-table-column",{attrs:{align:"center",label:"活动类型","min-width":"150",prop:"campaign.state","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(t.activeState[a.campaign.state])+" ")]}}])}),a("u-table-column",{attrs:{align:"center",label:"活动日期",width:"260",prop:"price","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(t.$dayjs(1e3*a.campaign.start_time).format("YYYY/MM/DD HH:mm:ss")+" - "+(0==a.campaign.end_time?"":t.$dayjs(1e3*a.campaign.end_time).format("YYYY/MM/DD HH:mm:ss")))+" ")]}}])}),a("u-table-column",{attrs:{align:"center",label:"预算",width:"120",prop:"promotion_price_after_tax"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(t.dealWithQuota(a))+" ")]}}])}),a("u-table-column",{attrs:{align:"center",label:"浏览数",width:"120",prop:"report.impression.value"}}),a("u-table-column",{attrs:{align:"center",label:"点击次数","min-width":"150",prop:"report.click.value"}}),a("u-table-column",{attrs:{align:"center",label:"点击率(%)","min-width":"150",prop:"user_item_limit"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(0==Number(a.report.impression.value)?0:Math.round(Number(a.report.click.value)/Number(a.report.impression.value)*100).toFixed(2))+" ")]}}])}),a("u-table-column",{attrs:{align:"center",label:"订单数","min-width":"150",prop:"report.order_amount.value"}}),a("u-table-column",{attrs:{align:"center",label:"商品已出售","min-width":"150",prop:"report.order_amount.value"}}),a("u-table-column",{attrs:{align:"center",label:"销售金额","min-width":"150",prop:"report.order_gmv.value"}}),a("u-table-column",{attrs:{align:"center",label:"花费","min-width":"150",prop:"report.cost.value"}}),a("u-table-column",{attrs:{align:"center",label:"投资产出比","min-width":"150",prop:"user_item_limit"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(Math.round(a.report.gmv_expense_ratio.value).toFixed(2))+" ")]}}])}),a("u-table-column",{attrs:{align:"center",label:"成本收入对比(%)","min-width":"150",prop:"user_item_limit"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(Math.round(100*a.report.cir.value).toFixed(2))+" ")]}}])})],1)],1),a("Logs",{ref:"Logs",attrs:{clear:""},model:{value:t.showConsole,callback:function(e){t.showConsole=e},expression:"showConsole"}}),t.viewDetailVisible?a("el-dialog",{attrs:{title:"店铺综合统计详情概览",visible:t.viewDetailVisible,top:"5vh",width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(e){t.viewDetailVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.totalData,border:"",height:"300px"}},[a("el-table-column",{attrs:{label:"店铺名称",prop:"id"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.country)+"-"+t._s(a.mallName)+" ")]}}],null,!1,277375768)}),a("el-table-column",{attrs:{label:"余额",prop:"balance"}}),a("el-table-column",{attrs:{label:"浏览数",prop:"impression"}}),a("el-table-column",{attrs:{label:"点击次数",prop:"click"}}),a("el-table-column",{attrs:{label:"点击率(%)",prop:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(0==Number(a.impression)?0:Math.round(Number(a.click)/Number(a.impression)*100).toFixed(2))+" ")]}}],null,!1,3360262158)}),a("el-table-column",{attrs:{label:"订单数",prop:"order"}}),a("el-table-column",{attrs:{label:"商品已出售",prop:"order"}}),a("el-table-column",{attrs:{label:"销售金额",prop:"orderGmv"}}),a("el-table-column",{attrs:{label:"花费",prop:"cost"}}),a("el-table-column",{attrs:{type:"expand",label:"查看明细",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.analysisData[e.row.mallId],(function(e,l){return a("div",{key:l,staticClass:"expand-style",staticStyle:{display:"flex"}},[a("div",[a("span",[t._v(t._s(t.$dayjs(1e3*e.timestamp).format("YYYY/MM/DD HH:mm:ss")))]),a("span",{staticClass:"mar-left"},[t._v(t._s(e.impression))])]),a("div",[a("span",[t._v(t._s(t.$dayjs(1e3*e.timestamp).format("YYYY/MM/DD HH:mm:ss")))]),a("span",{staticClass:"mar-left"},[t._v(t._s(e.click))])]),a("div",[a("span",[t._v(t._s(t.$dayjs(1e3*e.timestamp).format("YYYY/MM/DD HH:mm:ss")))]),a("span",{staticClass:"mar-left"},[t._v(t._s(0==e.impression?0:(e.click/e.impression*100).toFixed(2)))])]),a("div",[a("span",[t._v(t._s(t.$dayjs(1e3*e.timestamp).format("YYYY/MM/DD HH:mm:ss")))]),a("span",{staticClass:"mar-left"},[t._v(t._s(e.order_amount))])]),a("div",[a("span",[t._v(t._s(t.$dayjs(1e3*e.timestamp).format("YYYY/MM/DD HH:mm:ss")))]),a("span",{staticClass:"mar-left"},[t._v(t._s(e.order_amount))])]),a("div",[a("span",[t._v(t._s(t.$dayjs(1e3*e.timestamp).format("YYYY/MM/DD HH:mm:ss")))]),a("span",{staticClass:"mar-left"},[t._v(t._s(e.order_gmv))])]),a("div",[a("span",[t._v(t._s(t.$dayjs(1e3*e.timestamp).format("YYYY/MM/DD HH:mm:ss")))]),a("span",{staticClass:"mar-left"},[t._v(t._s(e.cost))])])])}))}}],null,!1,2701343814)})],1)],1):t._e(),t.createAdventVisible?a("el-dialog",{attrs:{visible:t.createAdventVisible,top:"7vh",title:"创建广告关键字","close-on-click-modal":!1,"close-on-press-escape":!1,width:"1000px"},on:{"update:visible":function(e){t.createAdventVisible=e}}},[a("div",{staticClass:"create-style"},[a("div",{staticClass:"warning-top"},["single"===t.createType?a("p",[t._v("选择单个商品时，可选择是否开启自动选择关键字或手动选择关键字")]):a("p",[t._v(" 选择两个及以上商品，shopee将自动管理广告关键字。相同的预算和时长设置将应用于每个广告。"),a("br"),t._v(" 最多20个商品，超过将自动选取前20个商品 ")])]),a("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("添加商品")]),t.createChooseGoods.length?a("el-table",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:t.createChooseGoods,border:"",height:"200px"}},[a("el-table-column",{attrs:{align:"center",type:"index",label:"",width:"20"}}),a("el-table-column",{attrs:{label:"店铺名称",prop:"id",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.country)+"-"+t._s(a.mall_alias_name||a.platform_mall_name)+" ")]}}],null,!1,3013943390)}),a("el-table-column",{attrs:{label:"商品id",prop:"balance"}}),a("el-table-column",{attrs:{label:"商品图片",prop:"impression",width:"80"}}),a("el-table-column",{attrs:{label:"价格",prop:"impression"}}),a("el-table-column",{attrs:{label:"已选商品数量",prop:"impression"}}),a("el-table-column",{attrs:{label:"操作",prop:"impression"}})],1):t._e(),a("div",{staticClass:"base-box mar-top"},[a("span",{staticClass:"base-title"},[t._v("每个广告的预算")]),a("div",{staticClass:"base-item"},[a("el-radio",{attrs:{label:"1"},model:{value:t.budgetSingle,callback:function(e){t.budgetSingle=e},expression:"budgetSingle"}},[t._v("无限制")]),a("br"),"1"==t.budgetSingle?a("p",{staticStyle:{margin:"5px 0"}},[t._v("根据您目前的广告预算余额，您的广告最多可获得0个点击数。")]):t._e(),a("el-radio",{attrs:{label:"2"},model:{value:t.budgetSingle,callback:function(e){t.budgetSingle=e},expression:"budgetSingle"}},[t._v("设定预算")])],1)]),a("div",{staticClass:"base-box mar-top"},[a("span",{staticClass:"base-title"},[t._v("每个广告的时长")]),a("div",{staticClass:"base-item"},[a("el-radio",{attrs:{label:"1"},model:{value:t.timeSingle,callback:function(e){t.timeSingle=e},expression:"timeSingle"}},[t._v("不限时")]),a("br"),a("el-radio",{attrs:{label:"2"},model:{value:t.timeSingle,callback:function(e){t.timeSingle=e},expression:"timeSingle"}},[t._v("设定开始日期/结束日期")])],1)]),a("div",{staticClass:"base-box mar-top"},[a("span",{staticClass:"base-title"},[t._v("关键字")]),a("div",{staticClass:"base-item"},[a("el-checkbox",{model:{value:t.autoKeyword,callback:function(e){t.autoKeyword=e},expression:"autoKeyword"}},[t._v("自动选择")]),a("br"),a("el-checkbox",{model:{value:t.handleKeyword,callback:function(e){t.handleKeyword=e},expression:"handleKeyword"}},[t._v("手动选择")])],1)]),a("div",{staticClass:"footer-btn"},[a("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("确认发布")]),a("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("取消发布")])],1)],1)]):t._e()],1)},i=[],s=a("1da1"),n=(a("96cf"),a("159b"),a("99af"),a("b0c0"),a("a9e3"),a("b680"),a("ac1f"),a("1276"),a("feb6")),r=a("0e0b"),o={components:{storeChoose:n["a"]},data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},selectMallList:[],country:"",statisticalTime:[],showConsole:!1,adventType:"keyword",adventTypeList:[{label:"关键字广告",value:"keyword"},{label:"关联广告",value:"targeting"}],activeType:"all",activeTypeList:[{label:"已预设",value:"scheduled"},{label:"进行中",value:"ongoing"},{label:"暂停中",value:"paused"},{label:"已结束",value:"ended"}],keyWords:"",tableData:[],loading:!1,multipleSelection:[],viewDetailVisible:!1,analysisData:{},totalData:[],totalAnalysisData:{balance:0,impression:0,click:0,order:0,orderGmv:0,cost:0},activeState:{ended:"已结束",closed:"已结束",ongoing:"进行中",scheduled:"已预设",paused:"暂停中"},createAdventVisible:!0,createType:"single",createChooseGoods:[],budgetSingle:"1",timeSingle:"1",autoKeyword:!1,handleKeyword:!1}},mounted:function(){this.statisticalTime=Object(r["e"])(1)},methods:{exportData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.tableData.length){e.next=2;break}return e.abrupt("return",t.$message.warning("没有可导出的数据！"));case 2:a=1,l="<tr>\n            <td>编号</td>\n            <td>店铺</td>\n            <td>商品图片</td>\n            <td>商品ID</td>\n            <td>商品名称</td>\n            <td>活动类型</td>\n            <td>活动日期</td>\n            <td>预算</td>\n            <td>浏览数</td>\n            <td>点击次数</td>\n            <td>点击率（%）</td>\n            <td>订单数</td>\n            <td>商品已出售</td>\n            <td>销售金额</td>\n            <td>花费</td>\n            <td>投资产出比</td>\n            <td>成本收入对比（%）</td>\n            </tr>",t.tableData.forEach((function(e){l+="<tr><td>".concat(a++,"</td>\n        <td>").concat(e.mallInfo?"".concat(e.mallInfo.country,"-").concat(e.mallInfo.mall_alias_name||e.mallInfo.platform_mall_name):"\t","</td>\n        <td>").concat(e.image?t.$filters.imageRender(e.image):"\t","</td>\n        <td>").concat(e.product?e.product.itemid:"\t","</td>\n        <td>").concat(e.product?e.product.name:"\t","</td>\n        <td>").concat(e.campaign?t.activeState[e.campaign.state]:"\t","</td>\n        <td>").concat(e.campaign.start_time?"".concat($dayjs(1e3*e.campaign.start_time).format("YYYY/MM/DD HH:mm:ss")," - ").concat(0==e.campaign.end_time?"":$dayjs(1e3*e.campaign.end_time).format("YYYY/MM/DD HH:mm:ss")):"\t","</td>\n        <td>").concat(t.dealWithQuota(e)+"\t","</td>\n        <td>").concat(e.report?e.report.impression.value:"\t","</td>\n        <td>").concat(e.report?e.report.click.value:"\t","</td>\n        <td>").concat(0==Number(e.report.impression.value)?0:Math.round(Number(e.report.click.value)/Number(e.report.impression.value)*100).toFixed(2)+"\t","</td>\n        <td>").concat(e.report?e.report.order_amount.value:"\t","</td>\n        <td>").concat(e.report?e.report.order_amount.value:"\t","</td>\n        <td>").concat(e.report?e.report.order_gmv.value:"\t","</td>\n        <td>").concat(e.report?e.report.cost.value:"\t","</td>\n        <td>").concat(Math.round(e.report.gmv_expense_ratio.value).toFixed(2)+"\t","</td>\n        <td>").concat(Math.round(100*row.report.cir.value).toFixed(2)+"\t","</td>\n        </tr>\n        ")})),Object(r["i"])("商品广告信息",l);case 6:case"end":return e.stop()}}),e)})))()},getMallBalance:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var l,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return l={need_create:0,mallId:t.platform_mall_id},a.next=3,e.$shopeemanService.getMallBalance(t.country,l);case 3:if(i=a.sent,200!==i.code){a.next=9;break}return e.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】获取余额成功，余额【").concat(i.data.balance,"】"),!0),a.abrupt("return",i.data.balance);case 9:if(403!==i.code){a.next=14;break}return e.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】获取余额失败，店铺未登录"),!1),a.abrupt("return",0);case 14:return e.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】获取余额失败，").concat(i.data),!1),a.abrupt("return",0);case 16:case"end":return a.stop()}}),a)})))()},getAdventAnalysis:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function l(){var i,s,n,r,o;return regeneratorRuntime.wrap((function(l){while(1)switch(l.prev=l.next){case 0:return i=Math.round(new Date(a.statisticalTime[0]).getTime()/1e3),s=Math.round(new Date(a.statisticalTime[1]).getTime()/1e3),n={start_time:i,end_time:s,agg_interval:4,placement_list:[1,2,5],mallId:t.platform_mall_id},l.prev=3,l.next=6,a.$shopeemanService.getAdventAnalysis(t.country,n);case 6:r=l.sent,200===r.code?(o={mallId:t.platform_mall_id,mallName:t.mall_alias_name||t.platform_mall_name,country:t.country,balance:e,impression:0,click:0,order:0,orderGmv:0,cost:0},r.data.forEach((function(t){o.impression+=t.impression,o.click+=t.click,o.order+=t.order_amount,o.orderGmv+=t.order_gmv,o.cost+=t.cost})),a.totalData.push(o),a.analysisData[t.platform_mall_id]=r.data):403===r.code?a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】综合统计数据获取失败，店铺未登录"),!1):a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】综合统计数据获取失败，").concat(r.data),!1),l.next=12;break;case 10:l.prev=10,l.t0=l["catch"](3);case 12:case"end":return l.stop()}}),l,null,[[3,10]])})))()},dealWithQuota:function(t){return 0==Number(t.campaign.daily_quota)&&0==Number(t.campaign.total_expense)?"无限制":0!==Number(t.campaign.daily_quota)?"日预算-".concat(t.campaign.daily_quota):0!==Number(t.campaign.total_expense)?"总预算-".concat(t.campaign.daily_quota):void 0},batchGetAdventList:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.selectMallList.length){e.next=2;break}return e.abrupt("return",t.$message.warning("请选择店铺"));case 2:return t.tableData=[],t.analysisData={},t.totalData=[],t.loading=!0,t.totalAnalysisData={balance:0,impression:0,click:0,order:0,orderGmv:0,cost:0},e.next=9,Object(r["c"])(t.selectMallList,t.getAdventList);case 9:t.totalData.forEach((function(e){t.totalAnalysisData.balance+=e.balance,t.totalAnalysisData.impression+=e.impression,t.totalAnalysisData.click+=e.click,t.totalAnalysisData.order+=e.order,t.totalAnalysisData.orderGmv+=e.orderGmv,t.totalAnalysisData.cost+=e.cost})),t.$refs.Logs.writeLog("查询结束！",!0),t.loading=!1;case 12:case"end":return e.stop()}}),e)})))()},getAdventList:function(t){var e=arguments,a=this;return Object(s["a"])(regeneratorRuntime.mark((function l(){var i,s,n,r,o,c,d,m,u,p;return regeneratorRuntime.wrap((function(l){while(1)switch(l.prev=l.next){case 0:return i=e.length>1&&void 0!==e[1]?e[1]:{count:5},s=Math.round(new Date(a.statisticalTime[0]).getTime()/1e3),n=Math.round(new Date(a.statisticalTime[1]).getTime()/1e3),r=40,o=0,l.next=7,a.getMallBalance(t);case 7:return c=l.sent,a.getAdventAnalysis(t,c),l.prev=9,d={start_time:s,end_time:n,campaign_type:a.adventType,filter_content:a.activeType,sort_key:"mtime",sort_direction:1,search_content:"",offset:0,limit:r,mallId:t.platform_mall_id},l.next=13,a.$shopeemanService.getAdventList(t.country,d);case 13:if(m=l.sent,200!==m.code){l.next=30;break}u=m.data.campaign_ads_list||[];case 16:if(!u.length){l.next=27;break}return o+=u.length,u.forEach((function(e){e.mallInfo=t,e.image=e.product.images.split(",")[0]})),a.tableData=a.tableData.concat(u),d.offset+=r,l.next=23,a.$shopeemanService.getAdventList(t.country,d);case 23:p=l.sent,u=200===p.code?p.data.campaign_ads_list:[],l.next=16;break;case 27:a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】功获取到广告数量").concat(o,"条"),!0),l.next=31;break;case 30:403===m.code?a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】获取广告失败，店铺未登录"),!1):a.$refs.Logs.writeLog("店铺【".concat(t.mall_alias_name||t.platform_mall_name,"】获取广告失败，").concat(m.data),!1);case 31:l.next=35;break;case 33:l.prev=33,l.t0=l["catch"](9);case 35:return l.prev=35,--i.count,l.finish(35);case 38:case"end":return l.stop()}}),l,null,[[9,33,35,38]])})))()},handleSelectionChange:function(t){this.multipleSelection=t},changeMallList:function(t){this.selectMallList=t,this.country=t.country}}},c=o,d=(a("11b5"),a("2877")),m=Object(d["a"])(c,l,i,!1,null,"6ebced29",null);e["default"]=m.exports},feb6:function(t,e,a){"use strict";var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ul",{staticClass:"storeChooseUL"},[a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("所属站点：")]),a("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:""},model:{value:t.countryVal,callback:function(e){t.countryVal=e},expression:"countryVal"}},[t.isAll?a("el-option",{attrs:{label:"全部",value:""}}):t._e(),t._l(t.countries,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],2)],1),a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺分组：")]),a("el-select",{staticClass:"selectBox",attrs:{placeholder:"",multiple:"","collapse-tags":"",size:"mini",filterable:""},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._l(t.groupIdList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.group_name,value:t.id}})}))],2)],1),a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺名称：")]),a("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadmoreMall,expression:"loadmoreMall"}],staticClass:"selectBox",attrs:{placeholder:"",multiple:"","collapse-tags":"","filter-method":t.filterMall,size:"mini",filterable:""},model:{value:t.site,callback:function(e){t.site=e},expression:"site"}},[t.isShowName?t._e():a("el-option",{attrs:{label:"全部",value:""}}),t._l(t.siteShowList,(function(e,l){return t.showMall(e,l)?a("el-option",{key:l,attrs:{label:e.mall_alias_name||e.platform_mall_name,value:e.platform_mall_id}}):t._e()}))],2)],1),t.isReset?a("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[a("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary"},on:{click:t.reset}},[t._v("　刷　　新　")])],1):t._e()])])},i=[],s=a("1da1"),n=a("2909"),r=(a("96cf"),a("99af"),a("d81d"),a("fb6a"),a("d3b7"),a("25f0"),a("159b"),a("c740"),a("7db0"),a("4de4"),a("caad"),a("2532"),a("7646")),o=a("2b0e");o["default"].directive("loadmore",{bind:function(t,e){var a=t.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){this.scrollHeight-this.scrollTop<=this.clientHeight+50?e.value(!0,this):this.scrollTop<30&&e.value(!1,this)}))}});var c={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}}},data:function(){return{isAllowSet1:!0,isAllowSet2:!0,countryVal:null,groupId:[],groupIdList:[],site:[],siteList:[],siteShowList:[],countries:this.$filters.countries_option,mallListAPIInstance:new r["a"](this),isShowName:"",showMallNumber:100,mallShowIndex:0}},watch:{siteList:function(t){this.siteShowList=t},countryVal:{handler:function(t,e){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},deep:!0},groupId:{handler:function(t,e){var a=this;if(this.isAllowSet2){this.isAllowSet2=!1;var l=e.indexOf("")>-1,i=t.indexOf("")>-1;l!==i?this.groupId=i?[""].concat(Object(n["a"])(this.groupIdList.map((function(t){return t.id})))):[]:i?this.groupId=t.slice(1):this.groupIdList.length>0&&this.groupId.length===this.groupIdList.length&&this.groupId.unshift(""),setTimeout((function(){a.isAllowSet2=!0,a.ddMallGoodsGetMallList(2)}),10)}},deep:!0},site:{handler:function(t,e){var a=this;if(this.isAllowSet1){this.isAllowSet1=!1;var l=e.indexOf("")>-1,i=t.indexOf("")>-1;l!==i?this.site=i?[""].concat(Object(n["a"])(this.siteList.map((function(t){return t.platform_mall_id})))):[]:i?this.site=t.slice(1):this.siteList.length>0&&this.siteList.length===this.site.length&&this.site.unshift(""),setTimeout((function(){a.changeMallList(),a.isAllowSet1=!0}),10)}},deep:!0}},mounted:function(){this.countryVal=this.isAll?"":"TH"},methods:{reset:function(){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},ddMallGoodsGetMallList:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,l,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.site=[],a=e.countryVal,l=e.groupId.indexOf("")>-1&&e.groupId.slice(1).toString()||e.groupId.toString(),i={country:a,mallGroupIds:l},t.next=6,e.mallListAPIInstance.ddMallGoodsGetMallList(i);case 6:s=t.sent,200===s.code?(e.siteList=s.data||[],0===e.groupIdList.length&&(e.groupId=[""],e.siteList.forEach((function(t){var a=e.groupIdList.findIndex((function(e){return e.id===t.group_id}));t.group_name&&a<0&&(e.groupIdList.push({group_name:t.group_name,id:t.group_id}),e.groupId.push(t.group_id))}))),setTimeout((function(){e.isAllowSet2=!0,e.isAllowSet1=!0,e.site=[""]}),10)):e.$message.error("获取分组、店铺列表失败");case 8:case"end":return t.stop()}}),t)})))()},changeMallList:function(){var t=this,e=[],a="";this.site.forEach((function(l){if(l){var i=t.siteList.find((function(t){return t.platform_mall_id===l}));e.push(i),a+=l+","}})),!this.countryVal&&this.groupId.indexOf("")>-1&&(a=e.length!==this.siteList.length&&a||""),this.source?this.$emit("changeMallList",{mallList:e,source:this.source,searchAll:a,country:this.countryVal.toLocaleUpperCase()}):(e["country"]=this.countryVal,this.$emit("changeMallList",e))},filterMall:function(t){this.isShowName=t||"";var e=this.siteList.filter((function(e){var a=e.mall_alias_name||e.platform_mall_name;return a.includes(t)}));this.showMallNumber=e.length-this.showMallNumber;var a=this.siteList.filter((function(e){var a=e.mall_alias_name||e.platform_mall_name;return!a.includes(t)}));this.siteShowList=[].concat(Object(n["a"])(e),Object(n["a"])(a))},showMall:function(t,e){var a=t.mall_alias_name||t.platform_mall_name,l=this.site[0]===t.platform_mall_id;return l||this.mallShowIndex<=e&&e<=this.mallShowIndex+this.showMallNumber&&(!this.isShowName||a.includes(this.isShowName))},loadmoreMall:function(t,e){if(this.siteShowList.length>this.showMallNumber){var a=0;t?(a=this.mallShowIndex+10,a=a<this.siteShowList.length&&a||this.mallShowIndex):(a=this.mallShowIndex-10,a=a>0&&a||0),a!==this.mallShowIndex&&(e.scrollTop=t?e.scrollTop-100:30),this.mallShowIndex=a}}}},d=c,m=(a("8992"),a("2877")),u=Object(m["a"])(d,l,i,!1,null,null,null);e["a"]=u.exports}}]);