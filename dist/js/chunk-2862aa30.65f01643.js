(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2862aa30"],{"4c28":function(t,e,a){},5551:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var r=a("1da1"),n=a("d4ec"),i=a("bee2"),s=(a("d3b7"),a("25f0"),a("96cf"),function(){function t(e){Object(n["a"])(this,t),this._this=e}return Object(i["a"])(t,[{key:"getDiscountNominate",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.item,t.prev=1,r={},r["limit"]=100,r["offset"]=a.offset,r["mallId"]=a.platform_mall_id,r["discount_id"]=a.discount_id,t.next=9,this._this.$shopeemanService.getChinese(a.country,"/api/marketing/v3/discount/nominate/?",r);case 9:if(n=t.sent,i=this.isJsonString(this.isJsonString(n).data),!i||0!==i.code){t.next=15;break}return t.abrupt("return",{code:200,data:i.data});case 15:if(2!==i.code&&2!==i.errcode){t.next=19;break}return t.abrupt("return",{code:201,data:"店铺未登录"});case 19:return t.abrupt("return",{code:-2,data:"查询折扣活动详情失败"});case 20:t.next=25;break;case 22:return t.prev=22,t.t0=t["catch"](1),t.abrupt("return",{code:-2,data:"查询折扣活动详情异常： ".concat(t.t0)});case 25:case"end":return t.stop()}}),t,this,[[1,22]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getByDiscountids",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,r,n,i,s,o,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.mItem,r=e.promotionid,n=e.limit,i=e.discountType,t.prev=1,s={},s["discount_id_list"]=r,s["discount_type"]=i,s["limit"]=n,s["offset"]=a.offset,s["mallId"]=a.platform_mall_id,t.next=10,this._this.$shopeemanService.getChinese(a.country,"/api/marketing/v3/discount/get_by_discountids/?",s);case 10:if(o=t.sent,u=this.isJsonString(this.isJsonString(o).data),!u||0!==u.code){t.next=16;break}return t.abrupt("return",{code:200,data:u.data});case 16:if(2!==u.code&&2!==u.errcode){t.next=20;break}return t.abrupt("return",{code:201,data:"店铺未登录"});case 20:return t.abrupt("return",{code:-2,data:"获取列表数据失败"});case 21:t.next=26;break;case 23:return t.prev=23,t.t0=t["catch"](1),t.abrupt("return",{code:-2,data:"获取列表数据异常： ".concat(t.t0)});case 26:case"end":return t.stop()}}),t,this,[[1,23]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDiscountStandardSearch",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,r,n,i,s,o,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.mItem,r=e.keyword,n=e.searchType,i=e.discountType,t.prev=1,s={},s["keyword"]=r,s["search_type"]=n,"all"!==i&&(s["promotion_status"]=i),s["mallId"]=a.platform_mall_id,t.next=9,this._this.$shopeemanService.getChinese(a.country,"/api/marketing/v3/discount/standard_search/?",s);case 9:if(o=t.sent,u=this.isJsonString(this.isJsonString(o).data),!u||0!==u.code){t.next=15;break}return t.abrupt("return",{code:200,data:u.data});case 15:if(2!==u.code&&2!==u.errcode){t.next=19;break}return t.abrupt("return",{code:201,data:"店铺未登录"});case 19:return t.abrupt("return",{code:-2,data:"获取失败"});case 20:t.next=25;break;case 22:return t.prev=22,t.t0=t["catch"](1),t.abrupt("return",{code:-2,data:"获取promotionid数据异常： ".concat(t.t0)});case 25:case"end":return t.stop()}}),t,this,[[1,22]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDiscountList",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,r,n,i,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.mItem,r=e.limit,n=e.discountType,t.prev=1,i={},i["limit"]=r,i["offset"]=a.offset,i["discount_type"]=n,i["mallId"]=a.platform_mall_id,t.next=9,this._this.$shopeemanService.getChinese(a.country,"/api/marketing/v3/discount/list/?",i);case 9:if(s=t.sent,o=this.isJsonString(this.isJsonString(s).data),!o||0!==o.code){t.next=15;break}return t.abrupt("return",{code:200,data:o.data});case 15:if(2!==o.code&&2!==o.errcode){t.next=19;break}return t.abrupt("return",{code:201,data:"店铺未登录"});case 19:return t.abrupt("return",{code:-2,data:"获取失败"});case 20:t.next=25;break;case 22:return t.prev=22,t.t0=t["catch"](1),t.abrupt("return",{code:-2,data:"获取折扣列表数据异常： ".concat(t.t0)});case 25:case"end":return t.stop()}}),t,this,[[1,22]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"isJsonString",value:function(t){if("string"!==typeof t)return t;try{return JSON.parse(t),JSON.parse(t)}catch(e){return t}}},{key:"stopActive",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={},r["discount_id"]=e.discount_id.toString(),r["action"]=a,r["mallId"]=e.platform_mall_id,t.next=7,this._this.$shopeemanService.mixChinese(e.country,"/api/marketing/v3/discount/?",r,{Headers:{"Content-Type":" application/json"}},"delete");case 7:if(n=t.sent,i=n&&JSON.parse(n),!i||200!==i.status){t.next=18;break}if(s=JSON.parse(i.data),!s||0!==s.code){t.next=15;break}return t.abrupt("return",{code:200,data:s.data||[]});case 15:return t.abrupt("return",{code:50001,data:s.message||i.statusText||""});case 16:t.next=21;break;case 18:if(403!==i.status){t.next=20;break}return t.abrupt("return",{code:i.status,data:"操作失败，店铺未登录！"});case 20:return t.abrupt("return",{code:i.status,data:"操作失败".concat(i.statusText)});case 21:t.next=26;break;case 23:return t.prev=23,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"操作异常： ".concat(t.t0)});case 26:case"end":return t.stop()}}),t,this,[[0,23]])})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"createActive",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._this.$shopeemanService.postChinese(e,"/api/marketing/v3/discount/?",a,{Headers:{"Content-Type":" application/json"}});case 3:if(r=t.sent,n=r&&JSON.parse(r),!n||200!==n.status){t.next=14;break}if(i=JSON.parse(n.data),!i||0!==i.code){t.next=11;break}return t.abrupt("return",{code:200,data:i.data||[]});case 11:return t.abrupt("return",{code:50001,data:i.message||n.statusText||""});case 12:t.next=17;break;case 14:if(403!==n.status){t.next=16;break}return t.abrupt("return",{code:n.status,data:"操作失败，店铺未登录！"});case 16:return t.abrupt("return",{code:n.status,data:"操作失败".concat(n.statusText)});case 17:t.next=22;break;case 19:return t.prev=19,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"操作异常： ".concat(t.t0)});case 22:case"end":return t.stop()}}),t,this,[[0,19]])})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"putActive",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._this.$shopeemanService.mixChinese(e,"/api/marketing/v3/discount/?",a,{Headers:{"Content-Type":" application/json"}},"put");case 3:if(r=t.sent,n=r&&JSON.parse(r),!n||200!==n.status){t.next=14;break}if(i=JSON.parse(n.data),!i||0!==i.code){t.next=11;break}return t.abrupt("return",{code:200,data:i.data||[]});case 11:return t.abrupt("return",{code:50001,data:i.message||n.statusText||""});case 12:t.next=17;break;case 14:if(403!==n.status){t.next=16;break}return t.abrupt("return",{code:n.status,data:"操作失败，店铺未登录！"});case 16:return t.abrupt("return",{code:n.status,data:"操作失败".concat(n.statusText)});case 17:t.next=22;break;case 19:return t.prev=19,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"操作异常： ".concat(t.t0)});case 22:case"end":return t.stop()}}),t,this,[[0,19]])})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"putModelActive",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._this.$shopeemanService.mixChinese(e,"/api/marketing/v3/discount/nominate/",a,{Headers:{"Content-Type":" application/json"}},"put");case 3:if(r=t.sent,n=r&&JSON.parse(r),!n||200!==n.status){t.next=14;break}if(i=JSON.parse(n.data),!i||0!==i.code){t.next=11;break}return t.abrupt("return",{code:200,data:i.data||[]});case 11:return t.abrupt("return",{code:50001,data:i.message||n.statusText||""});case 12:t.next=17;break;case 14:if(403!==n.status){t.next=16;break}return t.abrupt("return",{code:n.status,data:"操作失败，店铺未登录！"});case 16:return t.abrupt("return",{code:n.status,data:"操作失败".concat(n.statusText)});case 17:t.next=22;break;case 19:return t.prev=19,t.t0=t["catch"](0),t.abrupt("return",{code:-2,data:"操作异常： ".concat(t.t0)});case 22:case"end":return t.stop()}}),t,this,[[0,19]])})));function e(e,a){return t.apply(this,arguments)}return e}()}]),t}())},8992:function(t,e,a){"use strict";a("4c28")},feb6:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ul",{staticClass:"storeChooseUL"},[t.isMall?a("li",[t._v(t._s(t._f("chineseSite")(t.countryVal)))]):a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("所属站点：")]),a("el-select",{staticClass:"siteSelectBox",attrs:{size:"mini",filterable:""},model:{value:t.countryVal,callback:function(e){t.countryVal=e},expression:"countryVal"}},[t.isAll?a("el-option",{attrs:{label:"全部",value:""}}):t._e(),t._l(t.countries,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],2)],1),a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺分组：")]),a("el-select",{staticClass:"selectBox",attrs:{placeholder:"",multiple:"","collapse-tags":"",size:"mini",filterable:""},model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},t._l(t.groupIdList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.group_name,value:t.id}})})),1)],1),a("li",{style:t.isReset&&"margin-bottom: 5px"},[a("span",{style:{width:t.spanWidth}},[t._v("店铺名称：")]),a("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:t.loadmoreMall,expression:"loadmoreMall"}],staticClass:"selectBox",attrs:{placeholder:"",multiple:"","collapse-tags":"","filter-method":t.filterMall,size:"mini",filterable:""},on:{"visible-change":function(e){return t.filterMall("")}},model:{value:t.site,callback:function(e){t.site=e},expression:"site"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._l(t.siteShowList,(function(e,r){return t.showMall(e,r)?a("el-option",{key:r,attrs:{label:e.mall_alias_name||e.platform_mall_name,value:e.platform_mall_id}}):t._e()}))],2)],1),t.isReset?a("li",{staticStyle:{"margin-bottom":"5px","margin-left":"25px"}},[a("el-button",{staticStyle:{"justify-self":"self-end"},attrs:{size:"mini",type:"primary"},on:{click:t.reset}},[t._v("　刷　　新　")])],1):t._e()])])},n=[],i=a("1da1"),s=a("b85c"),o=a("2909"),u=(a("96cf"),a("d81d"),a("fb6a"),a("caad"),a("2532"),a("d3b7"),a("25f0"),a("99af"),a("6062"),a("3ca3"),a("ddb0"),a("4de4"),a("159b"),a("c740"),a("7db0"),a("7646")),l=a("2b0e");l["default"].directive("loadmore",{bind:function(t,e){var a=t.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",(function(){this.scrollHeight-this.scrollTop<=this.clientHeight+50?e.value(!0,this):this.scrollTop<30&&e.value(!1,this)}))}});var c={name:"StoreChoose",props:{spanWidth:{type:String,default:"80px"},parentCountry:{type:String,default:"TH"},isMall:{type:Boolean,default:function(){return!1}},isAll:{type:Boolean,default:function(){return!1}},isReset:{type:Boolean,default:function(){return!1}},source:{type:String,default:function(){return""}}},data:function(){return{isAllowSet1:!0,isAllowSet2:!0,countryVal:null,groupId:[],groupIdList:[],site:[],siteList:[],siteShowList:[],countries:this.$filters.countries_option,mallListAPIInstance:new u["a"](this),isShowName:"",isShowNameAll:!1,showMallNumber:100,mallShowIndex:0,jsonMallData:[],filterMallTime:null}},watch:{siteList:function(t){this.siteShowList=t},countryVal:{handler:function(t,e){this.isShowName="",this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},deep:!0},groupId:{handler:function(t,e){var a=this;if(this.isAllowSet2){this.isShowName="",this.isAllowSet2=!1;var r=e.indexOf("")>-1,n=t.indexOf("")>-1;r!==n?this.groupId=n?Object(o["a"])(this.groupIdList.map((function(t){return t.id}))):[]:n?this.groupId=t.slice(1):this.groupIdList.length>0&&this.groupId.length===this.groupIdList.length-1&&this.groupId.unshift(""),setTimeout((function(){a.isAllowSet2=!0,a.ddMallGoodsGetMallList(2)}),10)}},deep:!0},site:{handler:function(t,e){var a=this;if(this.isAllowSet1){this.isAllowSet1=!1;var r=this.isShowName,n=e.includes(""),i=t.includes("");if(n!==i||e.toString()===t.toString()&&this.isShowNameAll)if(i&&(!r||r&&!this.isShowNameAll)){var u=r&&Object(o["a"])(this.siteShowList.map((function(t){return t.platform_mall_id})))||[""].concat(Object(o["a"])(this.siteList.map((function(t){return t.platform_mall_id})))),l=new Set([].concat(Object(o["a"])(u),Object(o["a"])(e)));this.site=Object(o["a"])(l),this.isShowNameAll=!0,r&&this.siteList.length===this.site.length&&this.site.unshift("")}else{this.isShowNameAll=!1;var c=[];if(r){var d=r&&Object(o["a"])(this.siteShowList.map((function(t){return t.platform_mall_id}))),h=d.length>this.site.length&&this.site||d,p=d.length>this.site.length&&d||this.site;c=new Set(this.site);var m,f=Object(s["a"])(p);try{for(f.s();!(m=f.n()).done;){var g=m.value;h.includes(g)&&c.delete(g)}}catch(b){f.e(b)}finally{f.f()}c.delete("")}this.site=Object(o["a"])(c)}else i?this.site=t.slice(1):this.siteList.length>0&&this.siteList.length===this.site.length?this.site.unshift(""):this.isShowNameAll=!1;setTimeout((function(){a.changeMallList(),a.filterMall(r),a.isAllowSet1=!0}),10)}},deep:!0}},mounted:function(){this.countryVal=this.isMall?this.parentCountry:this.isAll?"":"TH"},methods:{reset:function(){this.isAllowSet2=!1,this.groupId=[],this.groupIdList=[],this.ddMallGoodsGetMallList(1)},ddMallGoodsGetMallList:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i,s,o,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.site=[],r=e.countryVal,n=[],!(e.jsonMallData.length>0)){a.next=7;break}n=e.jsonMallData,a.next=12;break;case 7:return a.next=9,e.$appConfig.temporaryCacheInfo("get","mallAllData","");case 9:i=a.sent,n=JSON.parse(i)||[],e.jsonMallData=JSON.parse(i)||[];case 12:if(!(n.length>0)){a.next=17;break}1===t&&(e.siteList=""===r?n:n.filter((function(t){return t.country===r}))),2===t&&(0===e.groupId.length?e.siteList=[]:(e.siteList=[],e.groupId.forEach((function(t){n.forEach((function(a){r?t===a.group_id&&r===a.country&&e.siteList.push(a):t===a.group_id&&e.siteList.push(a)}))})))),a.next=22;break;case 17:return s={country:"",mallGroupIds:""},a.next=20,e.mallListAPIInstance.ddMallGoodsGetMallList(s);case 20:o=a.sent,200===o.code?(e.$appConfig.temporaryCacheInfo("save","mallAllData",o.data),u=o.data||[],e.siteList=u,e.jsonMallData=u,e.siteList=""===r?u:u.filter((function(t){return t.country===r}))):e.$message.error("获取分组、店铺列表失败");case 22:0===e.groupIdList.length&&(e.groupIdList=[{group_name:"全部",id:""}],e.groupId=[""],e.siteList.forEach((function(t){var a=e.groupIdList.findIndex((function(e){return e.id===t.group_id}));t.group_name&&a<0&&(e.groupIdList.push({group_name:t.group_name,id:t.group_id}),e.groupId.push(t.group_id))}))),setTimeout((function(){e.isAllowSet2=!0,e.isAllowSet1=!0,e.site=[""]}),10);case 24:case"end":return a.stop()}}),a)})))()},changeMallList:function(){var t=this,e=[],a="";this.site.forEach((function(r){if(r){var n=t.siteList.find((function(t){return t.platform_mall_id===r}));e.push(n),a+=r+","}})),!this.countryVal&&this.groupId.indexOf("")>-1&&(a=e.length!==this.siteList.length&&a||""),this.source?this.$emit("changeMallList",{mallList:e,source:this.source,searchAll:a,country:this.countryVal.toLocaleUpperCase()}):(e["country"]=this.countryVal,this.$emit("changeMallList",e))},filterMall:function(t){var e=this,a=t&&this.isShowName!==t?1e3:100;this.filterMallTime&&(clearTimeout(this.filterMallTime),this.filterMallTime=null),this.filterMallTime=setTimeout((function(){e.isShowName!==t&&(e.mallShowIndex=0),e.isShowName=t||"";var a=e.siteList;t&&(a=e.siteList.filter((function(e){var a=e.mall_alias_name||e.platform_mall_name;return a.includes(t)}))),e.siteShowList=a}),a)},showMall:function(t,e){var a=t.mall_alias_name||t.platform_mall_name,r=this.site[0]===t.platform_mall_id;return r||this.mallShowIndex<=e&&e<=this.mallShowIndex+this.showMallNumber&&(!this.isShowName||a.includes(this.isShowName))},loadmoreMall:function(t,e){if(this.siteShowList.length>this.showMallNumber){var a=0;t?(a=this.mallShowIndex+10,a=a<this.siteShowList.length-this.showMallNumber&&a||this.siteShowList.length-this.showMallNumber):(a=this.mallShowIndex-10,a=a>0&&a||0),a!==this.mallShowIndex&&(e.scrollTop=t?e.scrollTop-100:30),this.mallShowIndex=a}}}},d=c,h=(a("8992"),a("2877")),p=Object(h["a"])(d,r,n,!1,null,null,null);e["a"]=p.exports}}]);